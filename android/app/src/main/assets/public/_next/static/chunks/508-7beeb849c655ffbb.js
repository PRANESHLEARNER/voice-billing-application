"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[508],{65613:function(t,e,r){r.d(e,{X:function(){return c},bZ:function(){return o}});var a=r(57437);r(2265);var n=r(90535),s=r(94508);let i=(0,n.j)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function o(t){let{className:e,variant:r,...n}=t;return(0,a.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,s.cn)(i({variant:r}),e),...n})}function c(t){let{className:e,...r}=t;return(0,a.jsx)("div",{"data-slot":"alert-description",className:(0,s.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",e),...r})}},35974:function(t,e,r){r.d(e,{C:function(){return c}});var a=r(57437);r(2265);var n=r(37053),s=r(90535),i=r(94508);let o=(0,s.j)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function c(t){let{className:e,variant:r,asChild:s=!1,...c}=t,u=s?n.g7:"span";return(0,a.jsx)(u,{"data-slot":"badge",className:(0,i.cn)(o({variant:r}),e),...c})}},62869:function(t,e,r){r.d(e,{d:function(){return c},z:function(){return u}});var a=r(57437),n=r(2265),s=r(37053),i=r(90535),o=r(94508);let c=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}}),u=n.forwardRef((t,e)=>{let{className:r,variant:n,size:i,asChild:u=!1,...l}=t,d=u?s.g7:"button";return(0,a.jsx)(d,{ref:e,"data-slot":"button",className:(0,o.cn)(c({variant:n,size:i,className:r})),...l})});u.displayName="Button"},66070:function(t,e,r){r.d(e,{Ol:function(){return i},SZ:function(){return c},Zb:function(){return s},aY:function(){return u},ll:function(){return o}});var a=r(57437);r(2265);var n=r(94508);function s(t){let{className:e,...r}=t;return(0,a.jsx)("div",{"data-slot":"card",className:(0,n.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...r})}function i(t){let{className:e,...r}=t;return(0,a.jsx)("div",{"data-slot":"card-header",className:(0,n.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...r})}function o(t){let{className:e,...r}=t;return(0,a.jsx)("div",{"data-slot":"card-title",className:(0,n.cn)("leading-none font-semibold",e),...r})}function c(t){let{className:e,...r}=t;return(0,a.jsx)("div",{"data-slot":"card-description",className:(0,n.cn)("text-muted-foreground text-sm",e),...r})}function u(t){let{className:e,...r}=t;return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,n.cn)("px-6",e),...r})}},35410:function(t,e,r){r.d(e,{AuthProvider:function(){return o},a:function(){return c}});var a=r(57437),n=r(2265),s=r(16023);let i=(0,n.createContext)(void 0);function o(t){let{children:e}=t,[r,o]=(0,n.useState)(null),[c,u]=(0,n.useState)(!0);(0,n.useEffect)(()=>{(async()=>{try{let t=await s.O.getCurrentUser();o(t)}catch(t){console.error("Auth initialization error:",t)}finally{u(!1)}})()},[]);let l={user:r,isLoading:c,isAuthenticated:!!r,login:async(t,e)=>{try{let{user:r}=await s.O.login({email:t,password:e});o(r)}catch(t){throw t}},logout:()=>{u(!0),s.O.logout(),o(null),setTimeout(()=>{u(!1)},100)},isAdmin:(null==r?void 0:r.role)==="admin",isCashier:(null==r?void 0:r.role)==="cashier"};return(0,a.jsx)(i.Provider,{value:l,children:e})}function c(){let t=(0,n.useContext)(i);if(void 0===t)throw Error("useAuth must be used within an AuthProvider");return t}},29116:function(t,e,r){r.d(e,{apiClient:function(){return i},f:function(){return o},t:function(){return c}});var a=r(16023);let n="http://localhost:5001/api";class s{async request(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=a.O.getToken(),s="".concat(n).concat(t);console.log("\uD83C\uDF10 API Request:",{url:s,method:e.method||"GET",body:e.body,hasToken:!!r,tokenPreview:r?r.substring(0,20)+"...":"none"});let i={headers:{"Content-Type":"application/json",...r&&{Authorization:"Bearer ".concat(r)},...e.headers},...e},o=await fetch(s,i);if(!o.ok){let t=await o.json().catch(()=>({message:"Network error"}));throw console.error("❌ API Error:",{status:o.status,statusText:o.statusText,error:t,url:s,hasToken:!!r}),Error(t.message||"HTTP ".concat(o.status))}let c=await o.json();return console.log("✅ API Response:",c),c}async getClientData(){return this.request("/client-data/me")}async updateClientData(t){return this.request("/client-data/me",{method:"PATCH",body:JSON.stringify(t)})}async submitClientData(){return this.request("/client-data/me/submit",{method:"POST"})}async uploadClientDataFile(t,e){let r=new FormData;return r.append("file",t),r.append("type",e),this.request("/client-data/upload",{method:"POST",body:r,headers:{}})}async listClientData(){return this.request("/client-data")}async updateClientDataStatus(t,e){return this.request("/client-data/".concat(t,"/status"),{method:"PATCH",body:JSON.stringify({status:e})})}async getProducts(t){let e=new URLSearchParams;(null==t?void 0:t.search)&&e.append("search",t.search),(null==t?void 0:t.category)&&e.append("category",t.category),(null==t?void 0:t.active)!==void 0&&e.append("active",t.active.toString());let r=e.toString();return this.request("/products".concat(r?"?".concat(r):""))}async getProductByIdentifier(t){return this.request("/products/search/".concat(t))}async createProduct(t){return this.request("/products",{method:"POST",body:JSON.stringify(t)})}async updateProduct(t,e){return this.request("/products/".concat(t),{method:"PUT",body:JSON.stringify(e)})}async deleteProduct(t){return this.request("/products/".concat(t),{method:"DELETE"})}async logVoiceMissingItem(t){try{return await this.request("/voice/missing-items",{method:"POST",body:JSON.stringify(t)})}catch(t){return console.warn("Voice missing item logging failed",t),null}}async createBill(t){let e=t.items.reduce((t,e)=>{let r=e.rate*e.quantity,a=0;e.discount&&(a=void 0!==e.discount.discountAmount?e.discount.discountAmount:"percentage"===e.discount.discountType?e.discount.discountValue/100*r:Math.min(e.discount.discountValue*e.quantity,r));let n=r-a,s=e.taxRate/100*n;return{subtotal:t.subtotal+n,totalDiscount:t.totalDiscount+a,totalTax:t.totalTax+s,grandTotal:t.grandTotal+(n+s)}},{subtotal:0,totalDiscount:0,totalTax:0,grandTotal:0}),r=a.O.getUser();if(!r)throw Error("Unauthorized: cashier info missing");let n={...t,cashier:r.id,subtotal:e.subtotal,totalDiscount:e.totalDiscount,totalTax:e.totalTax,grandTotal:e.grandTotal,cashTendered:t.cashTendered||e.grandTotal};return this.request("/bills",{method:"POST",body:JSON.stringify(n)})}async getBills(t){let e=new URLSearchParams;(null==t?void 0:t.page)&&e.append("page",t.page.toString()),(null==t?void 0:t.limit)&&e.append("limit",t.limit.toString()),(null==t?void 0:t.search)&&e.append("search",t.search),(null==t?void 0:t.startDate)&&e.append("startDate",t.startDate),(null==t?void 0:t.endDate)&&e.append("endDate",t.endDate),(null==t?void 0:t.cashier)&&e.append("cashier",t.cashier),(null==t?void 0:t.status)&&e.append("status",t.status);let r=e.toString();return this.request("/bills".concat(r?"?".concat(r):""))}async getBill(t){return this.request("/bills/".concat(t))}async deleteBill(t){return this.request("/bills/".concat(t),{method:"DELETE"})}async sendBillByEmail(t,e){return this.request("/bills/".concat(t,"/send-email"),{method:"POST",body:JSON.stringify({email:e})})}async sendBillViaWhatsApp(t,e){return this.request("/bills/".concat(t,"/whatsapp"),{method:"POST",body:JSON.stringify({phoneNumber:e})})}async getCustomerLoyaltyStatus(t){return this.request("/bills/customer/".concat(t,"/purchase-count"))}async generateBillPDF(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en";console.log("\uD83C\uDF10 API: Generating PDF for bill:",t,"with language:",e);let r=new URLSearchParams;r.append("language",e);let s="".concat(n,"/bills/").concat(t,"/pdf?").concat(r.toString());console.log("\uD83C\uDF10 API: Full URL:",s);let i=await fetch(s,{method:"GET",headers:{Authorization:"Bearer ".concat(a.O.getToken())}});if(!i.ok)throw Error((await i.json().catch(()=>({message:"Network error"}))).message||"HTTP ".concat(i.status));return await i.blob()}async startShift(t){return this.request("/shifts/start",{method:"POST",body:JSON.stringify({openingCash:t})})}async endShift(t,e){return this.request("/shifts/end",{method:"POST",body:JSON.stringify({closingCash:t,notes:e})})}async getCurrentShift(){return this.request("/shifts/current")}async getShifts(t){let e=new URLSearchParams;(null==t?void 0:t.page)&&e.append("page",t.page.toString()),(null==t?void 0:t.limit)&&e.append("limit",t.limit.toString()),(null==t?void 0:t.startDate)&&e.append("startDate",t.startDate),(null==t?void 0:t.endDate)&&e.append("endDate",t.endDate);let r=e.toString();return this.request("/shifts".concat(r?"?".concat(r):""))}async getActiveShifts(){return this.request("/shifts/active")}async getShiftSummary(t){let e=new URLSearchParams;(null==t?void 0:t.startDate)&&e.append("startDate",t.startDate),(null==t?void 0:t.endDate)&&e.append("endDate",t.endDate);let r=e.toString();return this.request("/shifts/summary".concat(r?"?".concat(r):""))}async forceEndShift(t,e,r){return this.request("/shifts/".concat(t,"/end"),{method:"POST",body:JSON.stringify({closingCash:e,notes:r})})}async getAvailableCashiers(){return this.request("/shifts/available-cashiers")}async getEmployees(t){let e=new URLSearchParams;return(null==t?void 0:t.page)&&e.append("page",t.page.toString()),(null==t?void 0:t.limit)&&e.append("limit",t.limit.toString()),(null==t?void 0:t.search)&&e.append("search",t.search),(null==t?void 0:t.department)&&e.append("department",t.department),(null==t?void 0:t.status)&&e.append("status",t.status),(null==t?void 0:t.sortBy)&&e.append("sortBy",t.sortBy),(null==t?void 0:t.sortOrder)&&e.append("sortOrder",t.sortOrder),await this.request("/employees?".concat(e.toString()))}async getEmployee(t){return await this.request("/employees/".concat(t))}async createEmployee(t){return await this.request("/employees",{method:"POST",body:JSON.stringify(t)})}async updateEmployee(t,e){return await this.request("/employees/".concat(t),{method:"PUT",body:JSON.stringify(e)})}async deleteEmployee(t){return await this.request("/employees/".concat(t),{method:"DELETE"})}async getLeaves(t){let e=new URLSearchParams;(null==t?void 0:t.status)&&e.append("status",t.status),(null==t?void 0:t.employee)&&e.append("employee",t.employee);let r=e.toString();return this.request("/leaves".concat(r?"?".concat(r):""))}async getMyLeaves(){return this.request("/leaves/my-leaves")}async getLeaveById(t){return this.request("/leaves/".concat(t))}async createLeave(t){return this.request("/leaves",{method:"POST",body:t,headers:{}})}async approveLeave(t){return this.request("/leaves/".concat(t,"/approve"),{method:"PUT"})}async rejectLeave(t,e){return this.request("/leaves/".concat(t,"/reject"),{method:"PUT",body:JSON.stringify({rejectedReason:e})})}async cancelLeave(t){return this.request("/leaves/".concat(t,"/cancel"),{method:"PUT"})}async getSalesSummary(t){let e=new URLSearchParams;(null==t?void 0:t.startDate)&&e.append("startDate",t.startDate),(null==t?void 0:t.endDate)&&e.append("endDate",t.endDate),(null==t?void 0:t.period)&&e.append("period",t.period);let r=e.toString();return this.request("/reports/sales-summary".concat(r?"?".concat(r):""))}async getTopProducts(t){let e=new URLSearchParams;(null==t?void 0:t.startDate)&&e.append("startDate",t.startDate),(null==t?void 0:t.endDate)&&e.append("endDate",t.endDate),(null==t?void 0:t.limit)&&e.append("limit",t.limit.toString());let r=e.toString();return this.request("/reports/top-products".concat(r?"?".concat(r):""))}async getCashierPerformance(t){let e=new URLSearchParams;(null==t?void 0:t.startDate)&&e.append("startDate",t.startDate),(null==t?void 0:t.endDate)&&e.append("endDate",t.endDate);let r=e.toString();return this.request("/reports/cashier-performance".concat(r?"?".concat(r):""))}async getInventoryReport(t){let e=new URLSearchParams;(null==t?void 0:t.category)&&e.append("category",t.category),(null==t?void 0:t.lowStock)!==void 0&&e.append("lowStock",t.lowStock.toString());let r=e.toString();return this.request("/reports/inventory".concat(r?"?".concat(r):""))}async getPaymentMethodsReport(t){let e=new URLSearchParams;(null==t?void 0:t.startDate)&&e.append("startDate",t.startDate),(null==t?void 0:t.endDate)&&e.append("endDate",t.endDate);let r=e.toString();return this.request("/reports/payment-methods".concat(r?"?".concat(r):""))}async getCategoriesPerformance(t){let e=new URLSearchParams;(null==t?void 0:t.startDate)&&e.append("startDate",t.startDate),(null==t?void 0:t.endDate)&&e.append("endDate",t.endDate);let r=e.toString();return this.request("/reports/categories-performance".concat(r?"?".concat(r):""))}async getTopProductsByCategory(t){let e=new URLSearchParams;(null==t?void 0:t.startDate)&&e.append("startDate",t.startDate),(null==t?void 0:t.endDate)&&e.append("endDate",t.endDate),(null==t?void 0:t.limit)&&e.append("limit",t.limit.toString());let r=e.toString();return this.request("/reports/top-products-by-category".concat(r?"?".concat(r):""))}async sendLowStockEmail(){return this.request("/reports/send-low-stock-email",{method:"POST"})}async getDiscounts(t){let e=new URLSearchParams;return(null==t?void 0:t.page)&&e.append("page",t.page.toString()),(null==t?void 0:t.limit)&&e.append("limit",t.limit.toString()),(null==t?void 0:t.search)&&e.append("search",t.search),(null==t?void 0:t.targetType)&&e.append("targetType",t.targetType),(null==t?void 0:t.isActive)!==void 0&&e.append("isActive",t.isActive),(null==t?void 0:t.sortBy)&&e.append("sortBy",t.sortBy),(null==t?void 0:t.sortOrder)&&e.append("sortOrder",t.sortOrder),await this.request("/discounts?".concat(e.toString()))}async getDiscount(t){return await this.request("/discounts/".concat(t))}async createDiscount(t){return await this.request("/discounts",{method:"POST",body:JSON.stringify(t)})}async updateDiscount(t,e){return await this.request("/discounts/".concat(t),{method:"PUT",body:JSON.stringify(e)})}async deleteDiscount(t){return await this.request("/discounts/".concat(t),{method:"DELETE"})}async getApplicableDiscounts(t){console.log("\uD83C\uDF10 API: Getting applicable discounts for product:",t);let e=await this.request("/discounts/applicable/".concat(t));return console.log("\uD83C\uDF10 API: Response from applicable discounts:",e),e}async getBestDiscount(t,e){let r=new URLSearchParams;return e&&r.append("quantity",e.toString()),await this.request("/discounts/best/".concat(t,"?").concat(r.toString()))}async getDiscountStats(){return await this.request("/discounts/stats/overview")}async toggleDiscountStatus(t){return await this.request("/discounts/".concat(t,"/toggle"),{method:"PATCH"})}async createPaymentOrder(t){return(await this.request("/payments/create-order",{method:"POST",body:JSON.stringify(t)})).data}async verifyPayment(t){return this.request("/payments/verify",{method:"POST",body:JSON.stringify(t)})}async get(t){return await this.request(t)}async put(t,e){return await this.request(t,{method:"PUT",body:JSON.stringify(e)})}}let i=new s,o=async(t,e)=>i.sendBillByEmail(t,e),c=async(t,e)=>i.sendBillViaWhatsApp(t,e)},16023:function(t,e,r){r.d(e,{O:function(){return s}});let a="http://localhost:5001/api";class n{static getInstance(){return n.instance||(n.instance=new n),n.instance}async login(t){try{let e=await fetch("".concat(a,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok){let t=await e.json();throw Error(t.message||"Login failed")}let r=await e.json();return this.token=r.token,this.user=r.user,localStorage.setItem("pos_token",r.token),localStorage.setItem("pos_user",JSON.stringify(r.user)),r}catch(t){throw t}}async getCurrentUser(){if(!this.token)return null;try{let t=await fetch("".concat(a,"/auth/me"),{headers:{Authorization:"Bearer ".concat(this.token)}});if(!t.ok)return this.clearAuth(),null;let e=await t.json();return this.user=e,localStorage.setItem("pos_user",JSON.stringify(e)),e}catch(t){return console.error("Error fetching current user:",t),this.clearAuth(),null}}logout(){this.clearAuth()}clearAuth(){this.token=null,this.user=null,localStorage.removeItem("pos_token"),localStorage.removeItem("pos_user")}getToken(){return this.token}getUser(){return this.user}isAuthenticated(){return!!this.token&&!!this.user}isAdmin(){var t;return(null===(t=this.user)||void 0===t?void 0:t.role)==="admin"}isCashier(){var t;return(null===(t=this.user)||void 0===t?void 0:t.role)==="cashier"}constructor(){this.token=null,this.user=null;{this.token=localStorage.getItem("pos_token");let t=localStorage.getItem("pos_user");if(t)try{this.user=JSON.parse(t)}catch(t){console.error("Error parsing user data:",t),this.clearAuth()}}}}let s=n.getInstance()},94508:function(t,e,r){r.d(e,{cn:function(){return s},x:function(){return i}});var a=r(61994),n=r(53335);function s(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return(0,n.m6)((0,a.W)(e))}function i(t){return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2,maximumFractionDigits:2}).format(t)}}}]);
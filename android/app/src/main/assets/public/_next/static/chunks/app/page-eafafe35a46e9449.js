(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{70812:function(e,s,t){Promise.resolve().then(t.bind(t,49681))},49681:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return ak}});var a=t(57437),l=t(2265),r=t(35410),n=t(62869),i=t(94508);function c(e){let{className:s,type:t,...l}=e;return(0,a.jsx)("input",{type:t,"data-slot":"input",className:(0,i.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",s),...l})}var d=t(6394);function o(e){let{className:s,...t}=e;return(0,a.jsx)(d.f,{"data-slot":"label",className:(0,i.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",s),...t})}var m=t(66070),u=t(65613),x=t(51817);function h(){let[e,s]=(0,l.useState)(""),[t,i]=(0,l.useState)(""),[d,h]=(0,l.useState)(""),[p,j]=(0,l.useState)(!1),{login:g}=(0,r.a)(),f=async s=>{s.preventDefault(),h(""),j(!0);try{await g(e,t)}catch(e){h(e instanceof Error?e.message:"Login failed")}finally{j(!1)}};return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary/10 to-secondary/10 p-4",children:(0,a.jsxs)(m.Zb,{className:"w-full max-w-md",children:[(0,a.jsxs)(m.Ol,{className:"text-center",children:[(0,a.jsx)("div",{className:"flex justify-center mb-3",children:(0,a.jsx)("div",{className:"text-primary p-2 rounded-lg",children:(0,a.jsx)("img",{src:"/_next/static/media/FortuMars Dark Logo PNG.70e46a3e.png",alt:"Logo",className:"h-15 w-70 bg-gradient-to-br"})})}),(0,a.jsx)(m.ll,{className:"text-2xl font-bold text-primary",children:"Supermarket POS"}),(0,a.jsx)(m.SZ,{children:"Sign in to access the billing system"})]}),(0,a.jsxs)(m.aY,{children:[(0,a.jsxs)("form",{onSubmit:f,className:"space-y-4",children:[d&&(0,a.jsx)(u.bZ,{variant:"destructive",children:(0,a.jsx)(u.X,{children:d})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"email",children:"Email"}),(0,a.jsx)(c,{id:"email",type:"email",placeholder:"Enter your email",value:e,onChange:e=>s(e.target.value),required:!0,disabled:p})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"password",children:"Password"}),(0,a.jsx)(c,{id:"password",type:"password",placeholder:"Enter your password",value:t,onChange:e=>i(e.target.value),required:!0,disabled:p})]}),(0,a.jsx)(n.z,{type:"submit",className:"w-full",disabled:p,children:p?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Signing in..."]}):"Sign In"})]}),(0,a.jsx)("br",{})]})]})})}function p(e){let{children:s,requiredRole:t}=e,{isAuthenticated:l,isLoading:n,user:i}=(0,r.a)();return n?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(x.Z,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-primary"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Loading..."})]})}):l||n?t&&(null==i?void 0:i.role)!==t?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-destructive mb-2",children:"Access Denied"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"You don't have permission to access this page."})]})}):(0,a.jsx)(a.Fragment,{children:s}):(0,a.jsx)(h,{})}var j=t(35974),g=t(70085);function f(e){let{...s}=e;return(0,a.jsx)(g.fC,{"data-slot":"dropdown-menu",...s})}function v(e){let{...s}=e;return(0,a.jsx)(g.xz,{"data-slot":"dropdown-menu-trigger",...s})}function N(e){let{className:s,sideOffset:t=4,...l}=e;return(0,a.jsx)(g.Uv,{children:(0,a.jsx)(g.VY,{"data-slot":"dropdown-menu-content",sideOffset:t,className:(0,i.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",s),...l})})}function y(e){let{className:s,inset:t,variant:l="default",...r}=e;return(0,a.jsx)(g.ck,{"data-slot":"dropdown-menu-item","data-inset":t,"data-variant":l,className:(0,i.cn)("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...r})}function b(e){let{className:s,inset:t,...l}=e;return(0,a.jsx)(g.__,{"data-slot":"dropdown-menu-label","data-inset":t,className:(0,i.cn)("px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",s),...l})}function w(e){let{className:s,...t}=e;return(0,a.jsx)(g.Z0,{"data-slot":"dropdown-menu-separator",className:(0,i.cn)("bg-border -mx-1 my-1 h-px",s),...t})}var C=t(91723),S=t(92369),k=t(47692),D={src:"/_next/static/media/image.e0ae90d6.png"},z=t(85929),P=t(97226),A=t(99897);function Z(){let[e,s]=(0,l.useState)("system"),[t,r]=(0,l.useState)(!1);(0,l.useEffect)(()=>{r(!0);try{let e=localStorage.getItem("systemSettings");if(e){let t=JSON.parse(e);s(t.theme||"system")}}catch(e){console.error("Failed to load theme:",e)}},[]);let i=e=>{let t=document.documentElement;"dark"===e?t.classList.add("dark"):"light"===e?t.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches?t.classList.add("dark"):t.classList.remove("dark");try{let s=localStorage.getItem("systemSettings"),t=s?JSON.parse(s):{};t.theme=e,localStorage.setItem("systemSettings",JSON.stringify(t))}catch(e){console.error("Failed to save theme:",e)}s(e)};return t?(0,a.jsxs)(f,{children:[(0,a.jsx)(v,{asChild:!0,children:(0,a.jsxs)(n.z,{variant:"ghost",size:"icon",className:"w-9 h-9",children:["light"===e?(0,a.jsx)(z.Z,{className:"h-4 w-4"}):"dark"===e?(0,a.jsx)(P.Z,{className:"h-4 w-4"}):(0,a.jsx)(A.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Toggle theme"})]})}),(0,a.jsxs)(N,{align:"end",children:[(0,a.jsxs)(y,{onClick:()=>i("light"),children:[(0,a.jsx)(z.Z,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Light"})]}),(0,a.jsxs)(y,{onClick:()=>i("dark"),children:[(0,a.jsx)(P.Z,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Dark"})]}),(0,a.jsxs)(y,{onClick:()=>i("system"),children:[(0,a.jsx)(A.Z,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"System"})]})]})]}):(0,a.jsx)(n.z,{variant:"ghost",size:"icon",className:"w-9 h-9",children:(0,a.jsx)(z.Z,{className:"h-4 w-4"})})}function I(e){let{onTabChange:s}=e,{user:t,logout:i,isAdmin:c}=(0,r.a)(),[d,o]=(0,l.useState)(new Date);(0,l.useEffect)(()=>{let e=setInterval(()=>{o(new Date)},1e3);return()=>clearInterval(e)},[]);let m=e=>e.toLocaleString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"});return t?(0,a.jsx)("header",{className:"bg-[#1e293B] text-white shadow-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between px-6 py-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"bg-[#1e293B] text-primary p-2 rounded-lg",children:(0,a.jsx)("img",{src:D.src,alt:"Logo",className:"h-10 w-50 bg-[#1e293B]"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl font-bold",children:"SUPERMARKET BILLING SOFTWARE"}),(0,a.jsx)("p",{className:"text-sm text-white/80",children:"Point of Sale System"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-sm",children:[(0,a.jsx)(C.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"font-mono",children:m(d)})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(Z,{}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"font-medium",children:t.name}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(j.C,{variant:c?"secondary":"outline",className:"text-white text-xs",children:t.role.toUpperCase()}),(0,a.jsxs)("span",{className:"text-xs text-white",children:["ID: ",t.employeeId]})]})]}),(0,a.jsxs)(f,{children:[(0,a.jsx)(v,{asChild:!0,children:(0,a.jsx)("button",{className:"p-2 rounded-full hover:bg-primary-foreground/10 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-foreground","aria-label":"User Menu",children:(0,a.jsx)(S.Z,{className:"h-5 w-5 text-white"})})}),(0,a.jsxs)(N,{align:"end",className:"w-56",children:[(0,a.jsx)(b,{children:"My Account"}),(0,a.jsx)(w,{}),"cashier"!==t.role&&(0,a.jsxs)(y,{onClick:()=>null==s?void 0:s("profile"),children:[(0,a.jsx)(S.Z,{className:"mr-2 h-4 w-4"}),"Profile"]}),(0,a.jsx)(w,{}),(0,a.jsxs)(y,{onClick:i,className:"text-destructive",children:[(0,a.jsx)(k.Z,{className:"mr-2 h-4 w-4"}),"Logout"]})]})]})]})]})}):(0,a.jsx)("header",{className:"bg-[#1e293B] text-white shadow-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between px-6 py-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"bg-[#1e293B]  text-primary p-2 rounded-lg",children:(0,a.jsx)("img",{src:D.src,alt:"Logo",className:"h-10 w-50 bg-[#1e293B]"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl font-bold",children:"SUPERMARKET BILLING SOFTWARE"}),(0,a.jsx)("p",{className:"text-sm text-white/80",children:"Point of Sale System"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-sm",children:[(0,a.jsx)(C.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"font-mono",children:m(d)})]}),(0,a.jsx)("div",{children:(0,a.jsx)(n.z,{variant:"ghost",disabled:!0,children:"Loading..."})})]})})}var _=t(16275),E=t(17689),F=t(44794),T=t(59426),O=t(48736),R=t(96215),L=t(62720),B=t(95805),M=t(98728),U=t(32489),Y=t(58293);function q(e){let{activeTab:s,onTabChange:t,isSidebarOpen:c,onSidebarToggle:d}=e,{user:o,isAdmin:m}=(0,r.a)(),[u,x]=(0,l.useState)(!1),h=[{id:"billing",label:"Billing",icon:_.Z,roles:["admin","cashier"]},{id:"client-data",label:"Client Data",icon:E.Z,roles:["admin"]},{id:"products",label:"Products",icon:F.Z,roles:["admin"]},{id:"inventory",label:"Inventory",icon:T.Z,roles:["admin"]},{id:"bills",label:"Bill History",icon:O.Z,roles:["admin","cashier"]},{id:"shifts",label:"Shifts",icon:C.Z,roles:["admin","cashier"]},{id:"reports",label:"Reports",icon:R.Z,roles:["admin"]},{id:"discounts",label:"Discounts",icon:L.Z,roles:["admin"]},{id:"users",label:"Cashiers",icon:B.Z,roles:["admin"]},{id:"settings",label:"Settings",icon:M.Z,roles:["admin"]}],p=m?"admin":"cashier",g=h.filter(e=>e.roles.includes(p)),f=e=>{let{item:l}=e,r=l.icon,c=s===l.id;return(0,a.jsxs)(n.z,{variant:c?"secondary":"ghost",className:(0,i.cn)("justify-start w-full text-white hover:text-white",c&&"bg-secondary text-secondary-foreground"),onClick:()=>{t(l.id),x(!1)},children:[(0,a.jsx)(r,{className:"mr-2 h-4 w-4 text-white"}),l.label,"billing"===l.id&&(0,a.jsx)(j.C,{variant:"outline",className:"ml-auto text-white",children:"Active"})]})};return(0,l.useEffect)(()=>{let e=e=>{"Escape"===e.key&&(x(!1),d(!1))};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"lg:hidden bg-card border-b p-4",children:(0,a.jsxs)(n.z,{variant:"outline",size:"sm",onClick:()=>x(!u),children:[u?(0,a.jsx)(U.Z,{className:"h-4 w-4"}):(0,a.jsx)(Y.Z,{className:"h-4 w-4"}),"Menu"]})}),(0,a.jsx)("nav",{className:"hidden lg:block bg-[#1e293B] border-r border-slate-600 min-h-screen transition-all duration-300 ".concat(c?"w-64":"w-16"),children:(0,a.jsxs)("div",{className:"p-4 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[c&&(0,a.jsx)("h2",{className:"text-lg font-semibold text-white",children:"Navigation"}),(0,a.jsx)(n.z,{variant:"ghost",size:"sm",onClick:()=>d(!c),className:"ml-auto",children:c?(0,a.jsx)(U.Z,{className:"h-4 w-4"}):(0,a.jsx)(Y.Z,{className:"h-4 w-4"})})]}),c&&g.map(e=>(0,a.jsx)(f,{item:e},e.id)),!c&&(0,a.jsx)("div",{className:"space-y-2",children:g.map(e=>(0,a.jsx)(n.z,{variant:s===e.id?"default":"ghost",size:"sm",onClick:()=>t(e.id),className:(0,i.cn)("w-full justify-center text-white hover:text-white",s===e.id&&"bg-secondary text-secondary-foreground"),title:e.label,children:(0,a.jsx)(e.icon,{className:"h-4 w-4 text-white"})},e.id))})]})}),u&&(0,a.jsx)("div",{className:"lg:hidden fixed inset-0 z-50 bg-background/80 backdrop-blur-sm",children:(0,a.jsx)("div",{className:"fixed left-0 top-0 h-full w-64 bg-[#1e293B] border-r border-slate-600 shadow-lg",children:(0,a.jsxs)("div",{className:"p-4 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-white",children:"Navigation"}),(0,a.jsx)(n.z,{variant:"ghost",size:"sm",onClick:()=>x(!1),children:(0,a.jsx)(U.Z,{className:"h-4 w-4 "})})]}),g.map(e=>(0,a.jsx)(f,{item:e},e.id))]})})})]})}var V=t(33911),K=t(40875),G=t(30401),H=t(22135);function J(e){let{...s}=e;return(0,a.jsx)(V.fC,{"data-slot":"select",...s})}function X(e){let{...s}=e;return(0,a.jsx)(V.B4,{"data-slot":"select-value",...s})}function W(e){let{className:s,size:t="default",children:l,...r}=e;return(0,a.jsxs)(V.xz,{"data-slot":"select-trigger","data-size":t,className:(0,i.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...r,children:[l,(0,a.jsx)(V.JO,{asChild:!0,children:(0,a.jsx)(K.Z,{className:"size-4 opacity-50"})})]})}function Q(e){let{className:s,children:t,position:l="popper",...r}=e;return(0,a.jsx)(V.h_,{children:(0,a.jsxs)(V.VY,{"data-slot":"select-content",className:(0,i.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:l,...r,children:[(0,a.jsx)(ee,{}),(0,a.jsx)(V.l_,{className:(0,i.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),(0,a.jsx)(es,{})]})})}function $(e){let{className:s,children:t,...l}=e;return(0,a.jsxs)(V.ck,{"data-slot":"select-item",className:(0,i.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",s),...l,children:[(0,a.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,a.jsx)(V.wU,{children:(0,a.jsx)(G.Z,{className:"size-4"})})}),(0,a.jsx)(V.eT,{children:t})]})}function ee(e){let{className:s,...t}=e;return(0,a.jsx)(V.u_,{"data-slot":"select-scroll-up-button",className:(0,i.cn)("flex cursor-default items-center justify-center py-1",s),...t,children:(0,a.jsx)(H.Z,{className:"size-4"})})}function es(e){let{className:s,...t}=e;return(0,a.jsx)(V.$G,{"data-slot":"select-scroll-down-button",className:(0,i.cn)("flex cursor-default items-center justify-center py-1",s),...t,children:(0,a.jsx)(K.Z,{className:"size-4"})})}var et=t(90277);function ea(e){let{...s}=e;return(0,a.jsx)(et.fC,{"data-slot":"alert-dialog",...s})}function el(e){let{...s}=e;return(0,a.jsx)(et.h_,{"data-slot":"alert-dialog-portal",...s})}function er(e){let{className:s,...t}=e;return(0,a.jsx)(et.aV,{"data-slot":"alert-dialog-overlay",className:(0,i.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",s),...t})}function en(e){let{className:s,...t}=e;return(0,a.jsxs)(el,{children:[(0,a.jsx)(er,{}),(0,a.jsx)(et.VY,{"data-slot":"alert-dialog-content",className:(0,i.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",s),...t})]})}function ei(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"alert-dialog-header",className:(0,i.cn)("flex flex-col gap-2 text-center sm:text-left",s),...t})}function ec(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"alert-dialog-footer",className:(0,i.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",s),...t})}function ed(e){let{className:s,...t}=e;return(0,a.jsx)(et.Dx,{"data-slot":"alert-dialog-title",className:(0,i.cn)("text-lg font-semibold",s),...t})}function eo(e){let{className:s,...t}=e;return(0,a.jsx)(et.dk,{"data-slot":"alert-dialog-description",className:(0,i.cn)("text-muted-foreground text-sm",s),...t})}function em(e){let{className:s,...t}=e;return(0,a.jsx)(et.aU,{className:(0,i.cn)((0,n.d)(),s),...t})}function eu(e){let{className:s,...t}=e;return(0,a.jsx)(et.$j,{className:(0,i.cn)((0,n.d)({variant:"outline"}),s),...t})}var ex=t(49027);function eh(e){let{...s}=e;return(0,a.jsx)(ex.fC,{"data-slot":"dialog",...s})}function ep(e){let{...s}=e;return(0,a.jsx)(ex.xz,{"data-slot":"dialog-trigger",...s})}function ej(e){let{...s}=e;return(0,a.jsx)(ex.h_,{"data-slot":"dialog-portal",...s})}function eg(e){let{className:s,...t}=e;return(0,a.jsx)(ex.aV,{"data-slot":"dialog-overlay",className:(0,i.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",s),...t})}function ef(e){let{className:s,children:t,showCloseButton:l=!0,...r}=e;return(0,a.jsxs)(ej,{"data-slot":"dialog-portal",children:[(0,a.jsx)(eg,{}),(0,a.jsxs)(ex.VY,{"data-slot":"dialog-content",className:(0,i.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",s),...r,children:[t,l&&(0,a.jsxs)(ex.x8,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,a.jsx)(U.Z,{}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function ev(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"dialog-header",className:(0,i.cn)("flex flex-col gap-2 text-center sm:text-left",s),...t})}function eN(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"dialog-footer",className:(0,i.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",s),...t})}function ey(e){let{className:s,...t}=e;return(0,a.jsx)(ex.Dx,{"data-slot":"dialog-title",className:(0,i.cn)("text-lg leading-none font-semibold",s),...t})}function eb(e){let{className:s,...t}=e;return(0,a.jsx)(ex.dk,{"data-slot":"dialog-description",className:(0,i.cn)("text-muted-foreground text-sm",s),...t})}var ew=t(99397),eC=t(73247),eS=t(15868),ek=t(18930),eD=t(26937),ez=t(29116),eP=t(50721);function eA(e){let{className:s,...t}=e;return(0,a.jsx)(eP.fC,{"data-slot":"switch",className:(0,i.cn)("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",s),...t,children:(0,a.jsx)(eP.bU,{"data-slot":"switch-thumb",className:(0,i.cn)("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}let eZ=["Beverages","Bakery","Groceries","Dairy","Confectionery","Fruits & Vegetables","Meat & Seafood","Frozen Foods","Personal Care","Household","Electronics","Other"],eI=["pcs","kg","gm","liter","ml","bottle","packet","box","can","jar"];function e_(e){let{product:s,isOpen:t,onClose:r,onSuccess:i,initialValues:d}=e,[m,h]=(0,l.useState)({code:"",name:"",barcode:"",category:"",basePrice:"",baseCost:"",unit:"pcs",taxRate:"",isActive:!0}),[p,j]=(0,l.useState)([{size:"",price:0,cost:0,stock:0,sku:"",isActive:!0}]),[g,f]=(0,l.useState)(!1),[v,N]=(0,l.useState)(""),y=e=>{var s,t,a,l,r,n;return{code:null!==(s=null==e?void 0:e.code)&&void 0!==s?s:"",name:null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"",barcode:null!==(a=null==e?void 0:e.barcode)&&void 0!==a?a:"",category:null!==(l=null==e?void 0:e.category)&&void 0!==l?l:"",basePrice:(null==e?void 0:e.basePrice)!==void 0&&(null==e?void 0:e.basePrice)!==null?e.basePrice.toString():"",baseCost:(null==e?void 0:e.baseCost)!==void 0&&(null==e?void 0:e.baseCost)!==null?e.baseCost.toString():"",unit:null!==(r=null==e?void 0:e.unit)&&void 0!==r?r:"pcs",taxRate:(null==e?void 0:e.taxRate)!==void 0&&(null==e?void 0:e.taxRate)!==null?e.taxRate.toString():"",isActive:null===(n=null==e?void 0:e.isActive)||void 0===n||n}},b=e=>e&&e.length>0?e.map(e=>({size:e.size,price:e.price,cost:e.cost,stock:e.stock,sku:e.sku,barcode:e.barcode,isActive:e.isActive})):[{size:"",price:0,cost:0,stock:0,sku:"",isActive:!0}];(0,l.useEffect)(()=>{if(s)h(y(s)),j(b(s.variants));else{var e;h(y(d)),j(b((null==d?void 0:null===(e=d.variants)||void 0===e?void 0:e.length)?d.variants:void 0))}N("")},[s,t,d]);let w=async e=>{e.preventDefault(),N(""),f(!0);try{let e=p.filter(e=>""!==e.size.trim()&&""!==e.sku.trim());if(0===e.length){N("At least one variant with size and SKU is required"),f(!1);return}let t=e.map(e=>({...e,sku:e.sku.trim()||"".concat(m.code,"-").concat(e.size).toUpperCase()})),a={code:m.code.toUpperCase(),name:m.name,barcode:m.barcode||void 0,category:m.category,basePrice:Number.parseFloat(m.basePrice),baseCost:Number.parseFloat(m.baseCost),unit:m.unit,taxRate:Number.parseFloat(m.taxRate),isActive:m.isActive,variants:t};s?await ez.apiClient.updateProduct(s._id,a):await ez.apiClient.createProduct(a),i(),r()}catch(e){N(e instanceof Error?e.message:"An error occurred")}finally{f(!1)}},C=(e,s)=>{h(t=>({...t,[e]:s}))},S=(e,s,t)=>{j(a=>{let l=[...a];return l[e]={...l[e],[s]:t},l})},k=e=>{p.length>1&&j(s=>s.filter((s,t)=>t!==e))};return(0,a.jsx)(eh,{open:t,onOpenChange:r,children:(0,a.jsxs)(ef,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)(ev,{children:[(0,a.jsx)(ey,{children:s?"Edit Product":"Add New Product"}),(0,a.jsx)(eb,{children:s?"Update the product information below.":"Enter the details for the new product."})]}),(0,a.jsxs)("form",{onSubmit:w,className:"space-y-4",children:[v&&(0,a.jsx)(u.bZ,{variant:"destructive",children:(0,a.jsx)(u.X,{children:v})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"code",children:"Product Code *"}),(0,a.jsx)(c,{id:"code",value:m.code,onChange:e=>C("code",e.target.value.toUpperCase()),placeholder:"ABC-001",required:!0,disabled:g})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"barcode",children:"Barcode"}),(0,a.jsx)(c,{id:"barcode",value:m.barcode,onChange:e=>C("barcode",e.target.value),placeholder:"1234567890123",disabled:g})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"name",children:"Product Name *"}),(0,a.jsx)(c,{id:"name",value:m.name,onChange:e=>C("name",e.target.value),placeholder:"Enter product name",required:!0,disabled:g})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"category",children:"Category *"}),(0,a.jsxs)(J,{value:m.category,onValueChange:e=>C("category",e),disabled:g,children:[(0,a.jsx)(W,{children:(0,a.jsx)(X,{placeholder:"Select category"})}),(0,a.jsx)(Q,{children:eZ.map(e=>(0,a.jsx)($,{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"unit",children:"Unit *"}),(0,a.jsxs)(J,{value:m.unit,onValueChange:e=>C("unit",e),disabled:g,children:[(0,a.jsx)(W,{children:(0,a.jsx)(X,{placeholder:"Select unit"})}),(0,a.jsx)(Q,{children:eI.map(e=>(0,a.jsx)($,{value:e,children:e},e))})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"baseCost",children:"Base Cost Price *"}),(0,a.jsx)(c,{id:"baseCost",type:"number",step:"0.01",min:"0",value:m.baseCost,onChange:e=>C("baseCost",e.target.value),placeholder:"0.00",required:!0,disabled:g})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"basePrice",children:"Base Selling Price *"}),(0,a.jsx)(c,{id:"basePrice",type:"number",step:"0.01",min:"0",value:m.basePrice,onChange:e=>C("basePrice",e.target.value),placeholder:"0.00",required:!0,disabled:g})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"taxRate",children:"Tax Rate (%)"}),(0,a.jsx)(c,{id:"taxRate",type:"number",step:"0.01",min:"0",max:"100",value:m.taxRate,onChange:e=>C("taxRate",e.target.value),placeholder:"0.00",disabled:g})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Product Variants"}),(0,a.jsxs)(n.z,{type:"button",variant:"outline",size:"sm",onClick:()=>{j(e=>[...e,{size:"",price:0,cost:0,stock:0,sku:"",isActive:!0}])},disabled:g,children:[(0,a.jsx)(ew.Z,{className:"mr-2 h-4 w-4"}),"Add Variant"]})]}),p.map((e,s)=>(0,a.jsxs)("div",{className:"border rounded-lg p-4 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("h4",{className:"font-medium",children:["Variant ",s+1]}),p.length>1&&(0,a.jsxs)(n.z,{type:"button",variant:"outline",size:"sm",onClick:()=>k(s),disabled:g,children:[(0,a.jsx)(ek.Z,{className:"mr-2 h-4 w-4"}),"Remove"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"size-".concat(s),children:"Size *"}),(0,a.jsx)(c,{id:"size-".concat(s),value:e.size,onChange:e=>S(s,"size",e.target.value),placeholder:"250ml, 500ml, 1L",required:!0,disabled:g})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"sku-".concat(s),children:"SKU *"}),(0,a.jsx)(c,{id:"sku-".concat(s),value:e.sku,onChange:e=>S(s,"sku",e.target.value.toUpperCase()),placeholder:"AUTO-GENERATED",disabled:g})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"variantCost-".concat(s),children:"Cost Price *"}),(0,a.jsx)(c,{id:"variantCost-".concat(s),type:"number",step:"0.01",min:"0",value:e.cost,onChange:e=>S(s,"cost",Number.parseFloat(e.target.value)||0),placeholder:"0.00",required:!0,disabled:g})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"variantPrice-".concat(s),children:"Selling Price *"}),(0,a.jsx)(c,{id:"variantPrice-".concat(s),type:"number",step:"0.01",min:"0",value:e.price,onChange:e=>S(s,"price",Number.parseFloat(e.target.value)||0),placeholder:"0.00",required:!0,disabled:g})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"stock-".concat(s),children:"Stock Quantity *"}),(0,a.jsx)(c,{id:"stock-".concat(s),type:"number",min:"0",value:e.stock,onChange:e=>S(s,"stock",Number.parseInt(e.target.value)||0),placeholder:"0",required:!0,disabled:g})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"barcode-".concat(s),children:"Barcode"}),(0,a.jsx)(c,{id:"barcode-".concat(s),value:e.barcode||"",onChange:e=>S(s,"barcode",e.target.value),placeholder:"1234567890123",disabled:g})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(eA,{id:"isActive-".concat(s),checked:e.isActive,onCheckedChange:e=>S(s,"isActive",e),disabled:g}),(0,a.jsx)(o,{htmlFor:"isActive-".concat(s),children:"Active Variant"})]})]},s))]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(eA,{id:"isActive",checked:m.isActive,onCheckedChange:e=>C("isActive",e),disabled:g}),(0,a.jsx)(o,{htmlFor:"isActive",children:"Active Product"})]}),(0,a.jsxs)(eN,{children:[(0,a.jsx)(n.z,{type:"button",variant:"outline",onClick:r,disabled:g,children:"Cancel"}),(0,a.jsx)(n.z,{type:"submit",disabled:g,children:g?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.Z,{className:"mr-2 h-4 w-4 animate-spin"}),s?"Updating...":"Creating..."]}):s?"Update Product":"Create Product"})]})]})]})})}function eE(){let[e,s]=(0,l.useState)([]),[t,r]=(0,l.useState)(!0),[i,d]=(0,l.useState)(""),[h,p]=(0,l.useState)(""),[g,f]=(0,l.useState)("all"),[v,N]=(0,l.useState)("all"),[y,b]=(0,l.useState)(null),[w,C]=(0,l.useState)(!1),[S,k]=(0,l.useState)(null),[D,z]=(0,l.useState)(!1),[P,A]=(0,l.useState)(null),[Z,I]=(0,l.useState)(null),[_,E]=(0,l.useState)(""),[T,O]=(0,l.useState)(!1),R=async()=>{try{r(!0),d("");let e={};h&&(e.search=h),"all"!==g&&(e.category=g),"all"!==v&&(e.active="active"===v);let t=await ez.apiClient.getProducts(e);s(t)}catch(e){d(e instanceof Error?e.message:"Failed to load products")}finally{r(!1)}};(0,l.useEffect)(()=>{R()},[h,g,v]);let L=e=>{b(e),C(!0)},B=async()=>{if(S)try{z(!0),await ez.apiClient.deleteProduct(S._id),await R(),k(null)}catch(e){d(e instanceof Error?e.message:"Failed to delete product")}finally{z(!1)}},M=e=>{A(P===e?null:e)},U=(e,s)=>{I({product:e,variantIndex:s}),E("")},Y=async()=>{if(Z&&_)try{O(!0);let{product:e,variantIndex:s}=Z,t=parseInt(_);if(isNaN(t)||t<=0){d("Please enter a valid restock amount");return}let a={...e};a.variants=[...e.variants],a.variants[s]={...e.variants[s],stock:e.variants[s].stock+t},await ez.apiClient.updateProduct(e._id,a),await R(),I(null),E(""),d("")}catch(e){d(e instanceof Error?e.message:"Failed to restock variant")}finally{O(!1)}},q=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e),V=e=>0===e?{label:"Out of Stock",variant:"destructive"}:e<10?{label:"Low Stock",variant:"secondary"}:{label:"In Stock",variant:"default"};return(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)(m.Zb,{children:[(0,a.jsx)(m.Ol,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(m.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(F.Z,{className:"h-5 w-5"}),"Product Management"]}),(0,a.jsx)(m.SZ,{children:"Manage your product catalog and inventory"})]}),(0,a.jsxs)(n.z,{onClick:()=>{b(null),C(!0)},children:[(0,a.jsx)(ew.Z,{className:"mr-2 h-4 w-4"}),"Add Product"]})]})}),(0,a.jsxs)(m.aY,{children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(eC.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),(0,a.jsx)(c,{placeholder:"Search products by name, code, or barcode...",value:h,onChange:e=>p(e.target.value),className:"pl-10"})]}),(0,a.jsxs)(J,{value:g,onValueChange:f,children:[(0,a.jsx)(W,{className:"w-full sm:w-48",children:(0,a.jsx)(X,{placeholder:"All Categories"})}),(0,a.jsxs)(Q,{children:[(0,a.jsx)($,{value:"all",children:"All Categories"}),["Beverages","Bakery","Groceries","Dairy","Confectionery","Fruits & Vegetables","Meat & Seafood","Frozen Foods","Personal Care","Household","Electronics","Other"].map(e=>(0,a.jsx)($,{value:e,children:e},e))]})]}),(0,a.jsxs)(J,{value:v,onValueChange:N,children:[(0,a.jsx)(W,{className:"w-full sm:w-32",children:(0,a.jsx)(X,{})}),(0,a.jsxs)(Q,{children:[(0,a.jsx)($,{value:"all",children:"All"}),(0,a.jsx)($,{value:"active",children:"Active"}),(0,a.jsx)($,{value:"inactive",children:"Inactive"})]})]})]}),i&&(0,a.jsx)(u.bZ,{variant:"destructive",className:"mb-4",children:(0,a.jsx)(u.X,{children:i})}),(0,a.jsx)("div",{className:"space-y-6",children:t?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(x.Z,{className:"h-6 w-6 animate-spin mx-auto mb-2"}),"Loading products..."]}):0===e.length?(0,a.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No products found"}):Object.entries(e.reduce((e,s)=>{let t=s.category||"Uncategorized";return e[t]||(e[t]=[]),e[t].push(s),e},{})).map(e=>{let[s,t]=e;return(0,a.jsxs)(m.Zb,{children:[(0,a.jsx)(m.Ol,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(m.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(F.Z,{className:"h-5 w-5"}),s]}),(0,a.jsxs)(m.SZ,{children:[t.length," product",1!==t.length?"s":""]})]}),(0,a.jsxs)(j.C,{variant:"outline",children:[t.reduce((e,s)=>e+s.variants.reduce((e,s)=>e+s.stock,0),0)," total items"]})]})}),(0,a.jsx)(m.aY,{children:(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(e=>{var s;let t=e.variants.reduce((e,s)=>e+s.stock,0),l=V(t),r=e.variants.length>0,i=P===e._id;return(0,a.jsxs)("div",{className:"border rounded-lg p-4 space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"font-medium flex items-center gap-2",children:[e.name,r&&(0,a.jsx)("span",{className:"text-xs text-muted-foreground cursor-pointer",onClick:()=>M(e._id),children:i?"▼":"▶"})]}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground font-mono",children:e.code}),e.barcode&&(0,a.jsxs)("div",{className:"text-xs text-muted-foreground font-mono",children:["Barcode: ",e.barcode]})]}),(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)(n.z,{variant:"ghost",size:"sm",onClick:s=>{s.stopPropagation(),L(e)},children:(0,a.jsx)(eS.Z,{className:"h-4 w-4"})}),(0,a.jsx)(n.z,{variant:"ghost",size:"sm",onClick:s=>{s.stopPropagation(),k(e)},children:(0,a.jsx)(ek.Z,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Price:"}),(0,a.jsx)("span",{className:"font-medium",children:q((null===(s=e.variants[0])||void 0===s?void 0:s.price)||e.basePrice||0)})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Stock:"}),(0,a.jsxs)(j.C,{variant:l.variant,children:[l.label," (",t," ",e.unit,")"]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Status:"}),(0,a.jsx)(j.C,{variant:e.isActive?"default":"secondary",children:e.isActive?"Active":"Inactive"})]}),r&&(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:[e.variants.length," variant",1!==e.variants.length?"s":""," ",i?"(shown)":"(click to expand)"]}),r&&i&&(0,a.jsx)("div",{className:"space-y-2 pt-2 border-t",children:e.variants.map((s,t)=>{let l=V(s.stock);return(0,a.jsxs)("div",{className:"bg-muted/30 rounded p-3 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"font-medium",children:s.size}),(0,a.jsx)(j.C,{variant:l.variant,className:"text-xs",children:l.label})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"SKU: "}),(0,a.jsx)("span",{className:"font-mono",children:s.sku})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Price: "}),(0,a.jsx)("span",{children:q(s.price)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Stock: "}),(0,a.jsxs)("span",{children:[s.stock," ",e.unit]})]}),(0,a.jsx)("div",{children:(0,a.jsxs)(n.z,{variant:"outline",size:"sm",className:"h-6 text-xs",onClick:s=>{s.stopPropagation(),U(e,t)},children:[(0,a.jsx)(eD.Z,{className:"h-3 w-3 mr-1"}),"Restock"]})})]})]},t)})})]},e._id)})})})]},s)})}),(0,a.jsx)(e_,{product:y,isOpen:w,onClose:()=>C(!1),onSuccess:R}),(0,a.jsx)(ea,{open:!!S,onOpenChange:()=>k(null),children:(0,a.jsxs)(en,{children:[(0,a.jsxs)(ei,{children:[(0,a.jsx)(ed,{children:"Delete Product"}),(0,a.jsxs)(eo,{children:['Are you sure you want to delete "',null==S?void 0:S.name,'"? This action will deactivate the product and cannot be undone.']})]}),(0,a.jsxs)(ec,{children:[(0,a.jsx)(eu,{disabled:D,children:"Cancel"}),(0,a.jsx)(em,{onClick:B,disabled:D,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:D?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Deleting..."]}):"Delete"})]})]})}),(0,a.jsx)(eh,{open:!!Z,onOpenChange:()=>I(null),children:(0,a.jsxs)(ef,{className:"sm:max-w-[425px]",children:[(0,a.jsxs)(ev,{children:[(0,a.jsx)(ey,{children:"Restock Variant"}),(0,a.jsxs)(eb,{children:["Add stock to ",null==Z?void 0:Z.product.name," - ",null==Z?void 0:Z.product.variants[(null==Z?void 0:Z.variantIndex)||0].size]})]}),(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(o,{htmlFor:"restock-amount",className:"text-right",children:"Amount"}),(0,a.jsx)(c,{id:"restock-amount",type:"number",min:"1",value:_,onChange:e=>E(e.target.value),className:"col-span-3",placeholder:"Enter restock amount"})]}),Z&&(0,a.jsxs)("div",{className:"text-sm text-muted-foreground bg-muted/50 p-3 rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Current Stock:"})," ",Z.product.variants[Z.variantIndex].stock," ",Z.product.unit]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"SKU:"})," ",Z.product.variants[Z.variantIndex].sku]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Price:"})," ",q(Z.product.variants[Z.variantIndex].price)]})]})]}),(0,a.jsxs)(eN,{children:[(0,a.jsx)(n.z,{variant:"outline",onClick:()=>I(null),children:"Cancel"}),(0,a.jsx)(n.z,{onClick:Y,disabled:!_||T,children:T?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Restocking..."]}):"Restock"})]})]})})]})]})})}var eF=t(82431),eT=t(82023),eO=t(87414),eR=t(86595),eL=t(91804),eB=t(247);function eM(e){let{onProductSelect:s}=e,[t,r]=(0,l.useState)(""),[i,d]=(0,l.useState)([]),[o,u]=(0,l.useState)(!1),[x,h]=(0,l.useState)(!1),p=(0,l.useRef)(null);(0,l.useEffect)(()=>{let e=e=>{p.current&&!p.current.contains(e.target)&&h(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,l.useEffect)(()=>{let e=setTimeout(async()=>{if(t.length<2){d([]),h(!1);return}u(!0);try{let e=await ez.apiClient.getProducts({search:t,active:!0});d(e.slice(0,10)),h(!0)}catch(e){console.error("Search error:",e),d([])}finally{u(!1)}},300);return()=>clearTimeout(e)},[t]);let g=async(e,t)=>{await s(e,t),r(""),h(!1)},f=async()=>{if(t)try{u(!0);let e=await ez.apiClient.getProductByIdentifier(t);if(e.variants&&e.variants.length>0){let s=e.variants.find(e=>e.sku===t.toUpperCase()||e.barcode===t);s?g(e,s):g(e,e.variants[0])}else g(e,{size:"Default",price:e.basePrice||0,cost:e.baseCost||0,stock:0,sku:e.code,isActive:!0})}catch(e){console.error("Barcode search error:",e)}finally{u(!1)}},v=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e);return(0,a.jsxs)("div",{ref:p,className:"relative",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(eC.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),(0,a.jsx)(c,{placeholder:"Search products by name, code, or scan barcode...",value:t,onChange:e=>r(e.target.value),className:"pl-10",onFocus:()=>t.length>=2&&h(!0)})]}),(0,a.jsx)(n.z,{variant:"outline",onClick:f,disabled:o||!t,children:(0,a.jsx)(eB.Z,{className:"h-4 w-4"})})]}),x&&i.length>0&&(0,a.jsx)(m.Zb,{className:"absolute top-full left-0 right-0 z-50 mt-1 max-h-80 overflow-y-auto",children:(0,a.jsx)(m.aY,{className:"p-0",children:i.map(e=>(0,a.jsxs)("div",{className:"border-b last:border-b-0",children:[(0,a.jsx)("div",{className:"flex items-center justify-between p-3 bg-muted/50",children:(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"font-medium",children:e.name}),(0,a.jsx)(j.C,{variant:"outline",className:"text-xs",children:e.code})]}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:[e.category," • ",e.unit]})]})}),(0,a.jsx)("div",{className:"p-2 space-y-1",children:(e.variants||[]).map((s,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 hover:bg-muted cursor-pointer rounded",onClick:()=>g(e,s),children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:s.size}),(0,a.jsx)(j.C,{variant:"secondary",className:"text-xs",children:s.sku}),!s.isActive&&(0,a.jsx)(j.C,{variant:"destructive",className:"text-xs",children:"Inactive"})]}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Stock: ",s.stock," ",e.unit,s.barcode&&" • Barcode: ".concat(s.barcode)]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"font-medium text-sm",children:v(s.price)}),(0,a.jsx)(n.z,{size:"sm",variant:"ghost",className:"h-5 w-5 p-0",children:(0,a.jsx)(ew.Z,{className:"h-3 w-3"})})]})]},"".concat(e._id,"-").concat(s.sku||t)))})]},e._id))})})]})}function eU(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,a.jsx)("table",{"data-slot":"table",className:(0,i.cn)("w-full caption-bottom text-sm",s),...t})})}function eY(e){let{className:s,...t}=e;return(0,a.jsx)("thead",{"data-slot":"table-header",className:(0,i.cn)("[&_tr]:border-b",s),...t})}function eq(e){let{className:s,...t}=e;return(0,a.jsx)("tbody",{"data-slot":"table-body",className:(0,i.cn)("[&_tr:last-child]:border-0",s),...t})}function eV(e){let{className:s,...t}=e;return(0,a.jsx)("tr",{"data-slot":"table-row",className:(0,i.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",s),...t})}function eK(e){let{className:s,...t}=e;return(0,a.jsx)("th",{"data-slot":"table-head",className:(0,i.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...t})}function eG(e){let{className:s,...t}=e;return(0,a.jsx)("td",{"data-slot":"table-cell",className:(0,i.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...t})}var eH=t(21047);function eJ(e){let{items:s,onUpdateItem:t,onRemoveItem:l}=e,r=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e),i=(e,s)=>{s<=0||t(e,{quantity:s})};return(0,a.jsx)("div",{className:"border rounded-lg bg-card ",children:(0,a.jsxs)(eU,{children:[(0,a.jsx)(eY,{children:(0,a.jsxs)(eV,{className:"bg-primary text-primary-foreground hover:bg-primary",children:[(0,a.jsx)(eK,{className:"text-primary-foreground",children:"Code"}),(0,a.jsx)(eK,{className:"text-primary-foreground",children:"Item Name"}),(0,a.jsx)(eK,{className:"text-primary-foreground w-24",children:"Qty"}),(0,a.jsx)(eK,{className:"text-primary-foreground w-32",children:"Rate"}),(0,a.jsx)(eK,{className:"text-primary-foreground w-32",children:"Discount"}),(0,a.jsx)(eK,{className:"text-primary-foreground w-24",children:"Tax%"}),(0,a.jsx)(eK,{className:"text-primary-foreground w-32",children:"Amount"}),(0,a.jsx)(eK,{className:"text-primary-foreground w-16",children:"Action"})]})}),(0,a.jsx)(eq,{children:0===s.length?(0,a.jsx)(eV,{children:(0,a.jsx)(eG,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"No items added. Search and add products to start billing."})}):s.map(e=>(0,a.jsxs)(eV,{className:"hover:bg-muted/50",children:[(0,a.jsx)(eG,{children:(0,a.jsx)(j.C,{variant:"outline",className:"font-mono",children:e.product.code})}),(0,a.jsx)(eG,{children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e.product.name}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:[e.product.category," • ",e.variant.size,(0,a.jsx)(j.C,{variant:"outline",className:"ml-2 text-xs",children:e.variant.sku})]})]})}),(0,a.jsx)(eG,{children:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(n.z,{variant:"outline",size:"sm",className:"h-6 w-6 p-0 bg-transparent",onClick:()=>i(e.id,e.quantity-1),disabled:e.quantity<=1,children:(0,a.jsx)(eH.Z,{className:"h-3 w-3"})}),(0,a.jsx)(c,{type:"number",min:"1",step:"0.01",value:e.quantity,onChange:s=>i(e.id,Number.parseFloat(s.target.value)||1),className:"h-8 w-16 text-center"}),(0,a.jsx)(n.z,{variant:"outline",size:"sm",className:"h-6 w-6 p-0 bg-transparent",onClick:()=>i(e.id,e.quantity+1),children:(0,a.jsx)(ew.Z,{className:"h-3 w-3"})})]})}),(0,a.jsx)(eG,{children:(0,a.jsx)("div",{className:"font-medium",children:r(e.rate)})}),(0,a.jsx)(eG,{children:e.discount?(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(j.C,{variant:"secondary",className:"text-xs",children:"percentage"===e.discount.discountType?"".concat(e.discount.discountValue,"%"):r(e.discount.discountValue)}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:["-",r(e.discount.discountAmount)]})]}):(0,a.jsx)("span",{className:"text-muted-foreground text-sm",children:"No discount"})}),(0,a.jsx)(eG,{children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)(j.C,{variant:"secondary",children:[e.product.taxRate,"%"]}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground mt-1",children:r(e.taxAmount)})]})}),(0,a.jsx)(eG,{children:(0,a.jsx)("div",{className:"text-right",children:(0,a.jsx)("div",{className:"font-medium",children:r(e.totalAmount)})})}),(0,a.jsx)(eG,{children:(0,a.jsx)(n.z,{variant:"ghost",size:"sm",onClick:()=>l(e.id),className:"h-8 w-8 p-0 text-destructive hover:text-destructive",children:(0,a.jsx)(ek.Z,{className:"h-4 w-4"})})})]},e.id))})]})})}var eX=t(55156);function eW(e){let{className:s,orientation:t="horizontal",decorative:l=!0,...r}=e;return(0,a.jsx)(eX.f,{"data-slot":"separator",decorative:l,orientation:t,className:(0,i.cn)("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",s),...r})}function eQ(e){let{items:s,loyaltyStatus:t}=e,l=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e),r=s.reduce((e,s)=>{var t;let a=s.quantity*s.rate;return e.subtotal+=a,e.totalTax+=s.taxAmount,e.totalDiscount+=(null===(t=s.discount)||void 0===t?void 0:t.discountAmount)||0,e.totalItems+=s.quantity,e},{subtotal:0,totalTax:0,totalDiscount:0,totalItems:0}),n=(null==t?void 0:t.isEligible)?Math.round((r.subtotal+r.totalTax)*.02):0,i=r.subtotal-r.totalDiscount,c=i+r.totalTax-n,d=Math.round(c)-c,o=Math.round(c);return(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-between text-[11px]",children:[(0,a.jsx)("span",{children:"Total Items:"}),(0,a.jsx)("span",{className:"font-medium",children:r.totalItems})]}),(0,a.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,a.jsx)("span",{children:"Subtotal:"}),(0,a.jsx)("span",{className:"font-medium",children:l(r.subtotal)})]}),r.totalDiscount>0&&(0,a.jsxs)("div",{className:"flex justify-between text-xs text-green-600",children:[(0,a.jsx)("span",{children:"Total Discount:"}),(0,a.jsxs)("span",{className:"font-medium",children:["-",l(r.totalDiscount)]})]}),n>0&&(0,a.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,a.jsx)("span",{className:"text-green-600",children:"Loyalty Discount (2%):"}),(0,a.jsxs)("span",{className:"font-medium text-green-600",children:["-",l(n)]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,a.jsx)("span",{children:"Discounted Subtotal:"}),(0,a.jsx)("span",{className:"font-medium",children:l(i)})]}),(0,a.jsxs)("div",{className:"flex justify-between text-xs font-semibold text-blue-600",children:[(0,a.jsxs)("span",{children:["Total Tax (",r.totalTax>0?(r.totalTax/i*100).toFixed(1):0,"%):"]}),(0,a.jsx)("span",{className:"font-bold",children:l(r.totalTax)})]}),Math.abs(d)>.01&&(0,a.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,a.jsx)("span",{children:"Round Off:"}),(0,a.jsxs)("span",{className:"font-medium",children:[d>0?"+":"",l(d)]})]}),(0,a.jsx)(eW,{className:"my-2"}),(0,a.jsxs)("div",{className:"flex justify-between text-xs font-bold",children:[(0,a.jsx)("span",{children:"Grand Total:"}),(0,a.jsx)("span",{className:"text-primary",children:l(o)})]})]})}var e$=t(43681),e0=t(88226),e1=t(33388),e2=t(28124),e4=t(49322);function e3(e){let{isOpen:s,onClose:t,amount:r,paymentMethod:i,onSuccess:c,onError:d}=e,[o,u]=(0,l.useState)(!1),[h,p]=(0,l.useState)(""),[g,f]=(0,l.useState)(!1),[v,N]=(0,l.useState)(!1);(0,l.useEffect)(()=>{if(window.Razorpay)window.Razorpay&&N(!0);else{let e=document.createElement("script");e.src="https://checkout.razorpay.com/v1/checkout.js",e.async=!0,e.onload=()=>N(!0),e.onerror=()=>{p("Failed to load Razorpay. Please refresh the page and try again.")},document.body.appendChild(e)}return()=>{let e=document.querySelector('script[src="https://checkout.razorpay.com/v1/checkout.js"]');e&&document.body.removeChild(e)}},[]);let y=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e),b=async()=>{try{return await ez.apiClient.createPaymentOrder({amount:Math.round(100*r),currency:"INR",paymentMethod:i})}catch(e){throw Error("Failed to create payment order: ".concat(e instanceof Error?e.message:"Unknown error"))}},w=async e=>{try{return await ez.apiClient.verifyPayment(e)}catch(e){throw Error("Payment verification failed: ".concat(e instanceof Error?e.message:"Unknown error"))}},C=async()=>{if(!v){p("Razorpay is still loading. Please wait...");return}u(!0),p("");try{let e=await b(),s=e.id;if(console.log("\uD83D\uDD0D Created Razorpay order:",{orderId:s}),!s||""===s.trim())throw Error("Failed to create valid Razorpay order: Order ID is empty");let a={key:"rzp_test_RJ8Bz6OxwnZehD",amount:e.amount,currency:e.currency,name:"SuperMarket Billing",description:"Payment for purchase",order_id:s,prefill:{name:"Customer",email:"customer@example.com",contact:"9999999999"},theme:{color:"#3399cc"},modal:{amount_editable:!1,ondismiss:()=>{u(!1),d("Payment was cancelled by user")}},handler:async e=>{console.log("\uD83D\uDD0D Razorpay response received:",e),f(!0),p("");try{let a=e.razorpay_payment_id?e.razorpay_payment_id.trim():"",l=e.razorpay_order_id||s?(e.razorpay_order_id||s||"").trim():"",r=(e.razorpay_signature,(e.razorpay_signature||"pending").trim());if(console.log("\uD83D\uDD0D Extracted payment parameters:",{paymentId:a?"".concat(a.substring(0,10),"..."):"empty",orderId:l?"".concat(l.substring(0,10),"..."):"empty",signature:r?"".concat(r.substring(0,10),"..."):"empty",razorpayOrderId:s?"".concat(s.substring(0,10),"..."):"empty",responseOrderId:e.razorpay_order_id?"".concat(e.razorpay_order_id.substring(0,10),"..."):"missing"}),!a||!l)throw Error('Invalid payment parameters: { orderId: "'.concat(l,'", paymentId: "').concat(a,'" }'));let n=await w({paymentId:a,orderId:l,signature:r});console.log("✅ Payment verification successful:",n),c({paymentId:a,orderId:l,signature:r,method:"card"}),t()}catch(s){console.error("❌ Payment verification failed:",s);let e=s instanceof Error?s.message:"Payment verification failed";p(e),d(e)}finally{f(!1)}}};new window.Razorpay(a).open()}catch(s){console.error("❌ Card payment failed:",s);let e=s instanceof Error?s.message:"Card payment failed";p(e),d(e),u(!1)}},S=async()=>{if(!v){p("Razorpay is still loading. Please wait...");return}u(!0),p("");try{let e=await b(),s=e.id;if(console.log("\uD83D\uDD0D Created Razorpay order:",{orderId:s,fullOrderData:e,orderDataId:null==e?void 0:e.id,orderDataExists:!!e}),!s||""===s.trim())throw Error("Failed to create valid Razorpay order: Order ID is empty");let a={key:"rzp_test_RJ8Bz6OxwnZehD",amount:e.amount,currency:e.currency,name:"SuperMarket Billing",description:"Payment for purchase",order_id:s,prefill:{contact:"9999999999",email:"customer@example.com"},theme:{color:"#3399cc"},config:{display:{hide:[{method:"card"},{method:"netbanking"},{method:"wallet"},{method:"emi"},{method:"paylater"}]}},modal:{amount_editable:!1,ondismiss:()=>{u(!1),d("UPI payment was cancelled by user")}},handler:async e=>{console.log("\uD83D\uDD0D Razorpay UPI response received:",e),f(!0),p("");try{let a=e.razorpay_payment_id?e.razorpay_payment_id.trim():"",l=e.razorpay_order_id||s?(e.razorpay_order_id||s||"").trim():"",r=(e.razorpay_signature,(e.razorpay_signature||"pending").trim());if(console.log("\uD83D\uDD0D Extracted UPI payment parameters:",{paymentId:a?"".concat(a.substring(0,10),"..."):"empty",orderId:l?"".concat(l.substring(0,10),"..."):"empty",signature:r?"".concat(r.substring(0,10),"..."):"empty",rawResponse:e,razorpayOrderId:s?"".concat(s.substring(0,10),"..."):"empty",responseOrderId:e.razorpay_order_id?"".concat(e.razorpay_order_id.substring(0,10),"..."):"missing"}),!a||!l)throw Error('Invalid UPI payment parameters: { orderId: "'.concat(l,'", paymentId: "').concat(a,'" }'));let n=await w({paymentId:a,orderId:l,signature:r});console.log("✅ UPI payment verification successful:",n),c({paymentId:a,orderId:l,signature:r,method:"upi"}),t()}catch(s){console.error("❌ UPI payment verification failed:",s);let e=s instanceof Error?s.message:"UPI payment verification failed";p(e),d(e)}finally{f(!1)}}};new window.Razorpay(a).open()}catch(s){console.error("❌ UPI payment failed:",s);let e=s instanceof Error?s.message:"UPI payment failed";p(e),d(e),u(!1)}};return(0,a.jsx)(eh,{open:s,onOpenChange:t,children:(0,a.jsxs)(ef,{className:"sm:max-w-md",children:[(0,a.jsx)(ev,{children:(0,a.jsxs)(ey,{className:"flex items-center gap-2",children:["card"===i?(0,a.jsx)(e0.Z,{className:"h-5 w-5"}):(0,a.jsx)(e1.Z,{className:"h-5 w-5"}),"card"===i?"Card Payment":"UPI Payment"]})}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(m.Zb,{children:(0,a.jsx)(m.aY,{className:"pt-6",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Amount:"}),(0,a.jsx)("span",{className:"font-bold text-lg",children:y(r)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Payment Method:"}),(0,a.jsx)(j.C,{variant:"card"===i?"default":"secondary",children:"card"===i?"Card":"UPI"})]})]})})}),h&&(0,a.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-destructive/10 border border-destructive/20 rounded-md",children:[(0,a.jsx)(e4.Z,{className:"h-4 w-4 text-destructive"}),(0,a.jsx)("span",{className:"text-sm text-destructive",children:h})]}),g&&(0,a.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-green-50 border border-green-200 rounded-md",children:[(0,a.jsx)(x.Z,{className:"h-4 w-4 text-green-600 animate-spin"}),(0,a.jsx)("span",{className:"text-sm text-green-700",children:"Processing payment..."})]}),(0,a.jsx)(eW,{}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"font-medium",children:"Payment Instructions:"}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground space-y-1",children:"card"===i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{children:'• Click "Proceed to Payment" to open Razorpay checkout'}),(0,a.jsx)("p",{children:"• Enter your card details securely"}),(0,a.jsx)("p",{children:"• Complete the payment using OTP if required"}),(0,a.jsx)("p",{children:"• Wait for payment verification"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{children:'• Click "Proceed to Payment" to open Razorpay checkout'}),(0,a.jsx)("p",{children:"• Select your preferred UPI app"}),(0,a.jsx)("p",{children:"• Approve the payment request in your UPI app"}),(0,a.jsx)("p",{children:"• Wait for payment verification"})]})})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(n.z,{variant:"outline",onClick:t,disabled:o||g,className:"flex-1",children:"Cancel"}),(0,a.jsx)(n.z,{onClick:()=>{"card"===i?C():S()},disabled:o||g||!v,className:"flex-1",children:o?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Loading..."]}):"Proceed to ".concat(y(r))})]}),!v&&(0,a.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-yellow-50 border border-yellow-200 rounded-md",children:[(0,a.jsx)(x.Z,{className:"h-4 w-4 text-yellow-600 animate-spin"}),(0,a.jsx)("span",{className:"text-sm text-yellow-700",children:"Loading Razorpay..."})]})]})]})})}var e5=t(92735),e6=t(41671);function e8(e){let{isOpen:s,onClose:t,amount:l,onPaymentComplete:r}=e,i="https://api.qrserver.com/v1/create-qr-code/?size=250x250&data=".concat(encodeURIComponent("upi://pay?pa=".concat("merchant@upi","&pn=").concat("SuperMarket Billing","&am=").concat(l,"&cu=INR")));return(0,a.jsx)(eh,{open:s,onOpenChange:e=>!e&&t(),children:(0,a.jsxs)(ef,{className:"sm:max-w-md",children:[(0,a.jsx)(ev,{children:(0,a.jsx)(ey,{className:"text-center",children:"Scan to Pay"})}),(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center p-4 space-y-4",children:[(0,a.jsx)("div",{className:"bg-white p-4 rounded-xl border shadow-sm",children:(0,a.jsx)("div",{className:"w-48 h-48 bg-gray-50 rounded-lg flex items-center justify-center overflow-hidden border",children:(0,a.jsx)("img",{src:i,alt:"Payment QR",className:"w-full h-full object-contain",onError:e=>{e.target.src="https://placehold.co/200x200?text=QR+Error"}})})}),(0,a.jsxs)("div",{className:"text-center space-y-1",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Amount to Pay"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-primary",children:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(l)})]}),(0,a.jsx)(eW,{}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground text-center",children:["Accepting payments via UPI ",(0,a.jsx)("br",{}),"(GPay, PhonePe, Paytm, etc.)"]})]}),(0,a.jsxs)(eN,{className:"sm:justify-between gap-2",children:[(0,a.jsxs)(n.z,{variant:"outline",size:"sm",onClick:()=>{window.open(i,"_blank")},className:"gap-2",children:[(0,a.jsx)(e5.Z,{className:"w-4 h-4"}),"Save QR"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(n.z,{variant:"outline",onClick:t,children:"Cancel"}),(0,a.jsxs)(n.z,{onClick:()=>{r&&r(),t()},className:"gap-2 bg-green-600 hover:bg-green-700",children:[(0,a.jsx)(e6.Z,{className:"w-4 h-4"}),"Mark Paid"]})]})]})]})})}function e9(e){let{grandTotal:s,onPayment:t,isProcessing:r}=e,[i,d]=(0,l.useState)(""),[m,u]=(0,l.useState)(""),[h,p]=(0,l.useState)("cash"),[j,g]=(0,l.useState)(""),[f,v]=(0,l.useState)(""),[N,y]=(0,l.useState)(!1),[b,w]=(0,l.useState)(!1),[C,S]=(0,l.useState)("card"),[k,D]=(0,l.useState)(0),[z,P]=(0,l.useState)(!1),A=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e),Z=Number.parseFloat(i)||0,I=Number.parseFloat(j)||0,_=Number.parseFloat(f)||0,E=Math.max(0,Z-s),F=Z+I+_,T=Math.max(0,s-F),O=(e,s)=>{S(e),D(s),y(!0)},R=async e=>{try{let a={paymentMethod:(null==e?void 0:e.method)||h};"cash"===h?a.cashTendered=Z:"card"===h?(a.cardAmount=s,a.razorpayDetails=e):"upi"===h?(a.upiAmount=s,a.razorpayDetails=e):"mixed"===h&&(a.cashTendered=Z,a.cardAmount=I,a.upiAmount=_,I>0&&(null==e?void 0:e.method)==="card"?a.razorpayDetails=e:_>0&&(null==e?void 0:e.method)==="upi"&&(a.razorpayDetails=e)),await t(a),P(!0),d(""),g(""),v("")}catch(e){u(e instanceof Error?e.message:"Payment failed")}},L=async()=>{if(u(""),"cash"===h&&Z<s){u("Cash tendered is less than the total amount");return}if("mixed"===h&&F<s){u("Total payment is less than the grand total");return}try{await R()}catch(e){u(e instanceof Error?e.message:"Payment failed")}},B=[s,100*Math.ceil(s/100),500*Math.ceil(s/500),1e3*Math.ceil(s/1e3)].filter((e,t,a)=>a.indexOf(e)===t&&e>=s);return(0,l.useEffect)(()=>{P(!1)},[h,s]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-foreground",children:"Payment"}),(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-1 mt-2",children:[(0,a.jsxs)(n.z,{variant:"cash"===h?"default":"outline",size:"sm",onClick:()=>p("cash"),className:"flex flex-col items-center gap-1 p-2 h-auto min-h-[48px]",children:[(0,a.jsx)(e$.Z,{className:"h-3 w-3"}),(0,a.jsx)("span",{className:"text-xs font-medium",children:"Cash"})]}),(0,a.jsxs)(n.z,{variant:"card"===h?"default":"outline",size:"sm",onClick:()=>p("card"),className:"flex flex-col items-center gap-1 p-2 h-auto min-h-[48px]",children:[(0,a.jsx)(e0.Z,{className:"h-3 w-3"}),(0,a.jsx)("span",{className:"text-xs font-medium",children:"Card"})]}),(0,a.jsxs)(n.z,{variant:"upi"===h?"default":"outline",size:"sm",onClick:()=>p("upi"),className:"flex flex-col items-center gap-1 p-2 h-auto min-h-[48px]",children:[(0,a.jsx)(e1.Z,{className:"h-3 w-3"}),(0,a.jsx)("span",{className:"text-xs font-medium",children:"UPI"})]}),(0,a.jsxs)(n.z,{variant:"mixed"===h?"default":"outline",size:"sm",onClick:()=>p("mixed"),className:"flex flex-col items-center gap-1 p-2 h-auto min-h-[48px]",children:[(0,a.jsx)(e2.Z,{className:"h-3 w-3"}),(0,a.jsx)("span",{className:"text-xs font-medium",children:"Mixed"})]})]}),("upi"===h||"mixed"===h)&&(0,a.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,a.jsxs)(n.z,{variant:"outline",size:"sm",className:"flex-1 h-8 text-[10px] gap-1",onClick:()=>O("upi","upi"===h?s:T),disabled:r||"mixed"===h&&T<=0,children:[(0,a.jsx)(e1.Z,{className:"h-3 w-3"}),"Dynamic QR"]}),(0,a.jsxs)(n.z,{variant:"outline",size:"sm",className:"flex-1 h-8 text-[10px] gap-1",onClick:()=>w(!0),disabled:r||"mixed"===h&&T<=0,children:[(0,a.jsx)(e1.Z,{className:"h-3 w-3"}),"Static QR"]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm font-bold",children:[(0,a.jsx)("span",{children:"Total Amount:"}),(0,a.jsx)("span",{className:"text-primary",children:A(s)})]}),("cash"===h||"mixed"===h)&&(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(o,{htmlFor:"cashTendered",className:"text-xs",children:"Cash Tendered"}),(0,a.jsx)(c,{id:"cashTendered",type:"number",step:"0.01",min:"0",value:i,onChange:e=>d(e.target.value),placeholder:"0.00",className:"text-sm"})]}),"mixed"===h&&(0,a.jsx)(n.z,{onClick:()=>O("card",T),disabled:r||T<=0,className:"w-full h-8 text-sm",size:"sm",children:r?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"Pay Card - ".concat(A(T))}),"card"===h&&(0,a.jsx)(n.z,{onClick:()=>O("card",s),disabled:r,className:"w-full h-8 text-sm",size:"sm",children:r?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"Pay ".concat(A(s))}),"mixed"===h&&(0,a.jsx)(n.z,{onClick:()=>O("upi",T),disabled:r||T<=0,className:"w-full h-8 text-sm",size:"sm",children:r?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"Pay UPI - ".concat(A(T))}),"upi"===h&&(0,a.jsx)(n.z,{onClick:()=>O("upi",s),disabled:r,className:"w-full h-8 text-sm",size:"sm",children:r?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"Pay ".concat(A(s))}),("cash"===h||"mixed"===h)&&(0,a.jsx)("div",{className:"grid grid-cols-2 gap-1",children:B.slice(0,4).map(e=>(0,a.jsx)(n.z,{variant:"outline",size:"sm",onClick:()=>d(e.toString()),className:"text-xs h-7",children:A(e)},e))}),(Z>0||I>0||_>0)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eW,{}),(0,a.jsxs)("div",{className:"space-y-1",children:[Z>0&&(0,a.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,a.jsx)("span",{children:"Cash Tendered:"}),(0,a.jsx)("span",{className:"font-medium",children:A(Z)})]}),I>0&&(0,a.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,a.jsx)("span",{children:"Card Amount:"}),(0,a.jsx)("span",{className:"font-medium",children:A(I)})]}),_>0&&(0,a.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,a.jsx)("span",{children:"UPI Amount:"}),(0,a.jsx)("span",{className:"font-medium",children:A(_)})]}),(0,a.jsxs)("div",{className:"flex justify-between font-bold text-xs",children:[(0,a.jsx)("span",{children:"Total Paid:"}),(0,a.jsx)("span",{className:"text-primary",children:A(F)})]}),"cash"===h&&Z>0&&(0,a.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,a.jsx)("span",{children:"Change Due:"}),(0,a.jsx)("span",{className:"font-medium text-green-600",children:A(E)})]}),"mixed"===h&&T>0&&(0,a.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,a.jsx)("span",{children:"Remaining:"}),(0,a.jsx)("span",{className:"font-medium text-orange-600",children:A(T)})]})]})]}),m&&(0,a.jsx)("div",{className:"text-sm text-destructive",children:m}),("cash"===h||"mixed"===h)&&(0,a.jsx)(n.z,{onClick:L,disabled:r||"cash"===h&&Z<s||"mixed"===h&&F<s,className:"w-full h-8 text-sm",size:"sm",children:r?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"Complete Sale - ".concat(A(s))})]}),(0,a.jsx)(e3,{isOpen:N,onClose:()=>y(!1),amount:k,paymentMethod:C,onSuccess:e=>{y(!1),"mixed"===h?"card"===e.method?g(k.toString()):v(k.toString()):R(e)},onError:e=>{y(!1),u(e)}}),(0,a.jsx)(e8,{isOpen:b,onClose:()=>w(!1),amount:"upi"===h?s:T,onPaymentComplete:()=>{w(!1),R()}})]})}function e7(e){let{customerInfo:s,onCustomerInfoChange:t}=e,[r,n]=(0,l.useState)(s);(0,l.useEffect)(()=>{n(s)},[s]);let i=(e,s)=>{let a={...r,[e]:s};n(a),t(a)},d=Object.values(s).some(e=>e&&""!==e.trim());return(0,a.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-card border rounded-lg shadow-sm",children:[(0,a.jsx)(S.Z,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-wrap flex-1",children:[(0,a.jsx)(c,{value:r.name||"",onChange:e=>i("name",e.target.value),placeholder:"Customer Name",className:"h-10 text-base w-40"}),(0,a.jsx)(c,{value:r.phone||"",onChange:e=>i("phone",e.target.value),placeholder:"Customer Phone",className:"h-10 text-base w-40"}),(0,a.jsx)(c,{value:r.email||"",onChange:e=>i("email",e.target.value),type:"email",placeholder:"Customer Email",className:"h-10 text-base w-40"}),(0,a.jsx)(c,{value:r.address||"",onChange:e=>i("address",e.target.value),placeholder:"Customer Address",className:"h-10 text-base w-48"}),(0,a.jsx)(c,{value:r.gstNumber||"",onChange:e=>i("gstNumber",e.target.value.toUpperCase()),placeholder:"Customer GST",className:"h-10 text-base w-36"})]}),d&&(0,a.jsx)("button",{onClick:()=>{t({}),n({})},className:"flex-shrink-0 p-1 hover:bg-muted rounded transition-colors",children:(0,a.jsx)(U.Z,{className:"h-3 w-3 text-muted-foreground"})})]})}var se=t(48662),ss=t(33276),st=t(89227),sa=t(94394),sl=t(61094),sr=t(24880);let sn={en:"en-IN",ta:"ta-IN",bilingual:"ta-IN"},si={idle:"bg-slate-100 text-slate-700",listening:"bg-green-100 text-green-700",paused:"bg-amber-100 text-amber-700",processing:"bg-blue-100 text-blue-700",error:"bg-destructive/10 text-destructive"};function sc(e){let{onTranscript:s}=e,{language:t}=(0,sr.Z)(),{devices:r,selectedDeviceId:c,selectDevice:d,permissionState:o,ensurePermission:m,refreshDevices:x,isEnumerating:h,supportsDeviceSelection:p,deviceChangePending:g,acknowledgeDeviceChange:f}=function(){let[e,s]=(0,l.useState)([]),[t,a]=(0,l.useState)("default"),[r,n]=(0,l.useState)("prompt"),[i,c]=(0,l.useState)(!1),[d,o]=(0,l.useState)(!1),m=!!navigator.mediaDevices,u=(0,l.useRef)(null),x=(0,l.useCallback)(async()=>{var e;if(m&&(null===(e=navigator.mediaDevices)||void 0===e?void 0:e.enumerateDevices)){c(!0);try{let e=(await navigator.mediaDevices.enumerateDevices()).filter(e=>"audioinput"===e.kind);if(s(e),0===e.length){a("default");return}"default"===t||e.some(e=>e.deviceId===t)||a(e[0].deviceId||"default")}catch(e){console.error("Failed to enumerate audio devices",e)}finally{c(!1)}}},[t,m]),h=(0,l.useCallback)(async()=>{var e;if(!m||!(null===(e=navigator.mediaDevices)||void 0===e?void 0:e.getUserMedia))return n("unsupported"),!1;try{return(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(e=>e.stop()),n("granted"),await x(),!0}catch(e){return console.error("Microphone permission denied",e),n("denied"),!1}},[x,m]),p=(0,l.useCallback)(e=>{o(!1),a(e)},[]),j=(0,l.useCallback)(()=>{o(!1)},[]);(0,l.useEffect)(()=>{var e,s;if(!m){n("unsupported");return}x(),(null===(e=navigator.permissions)||void 0===e?void 0:e.query)&&navigator.permissions.query({name:"microphone"}).then(e=>{var s;n(e.state);let t=()=>n(e.state);null===(s=e.addEventListener)||void 0===s||s.call(e,"change",t),e.onchange=t,u.current=()=>{var s;null===(s=e.removeEventListener)||void 0===s||s.call(e,"change",t),e.onchange=null}}).catch(()=>{});let t=()=>{o(!0),x()};return null===(s=navigator.mediaDevices)||void 0===s||s.addEventListener("devicechange",t),()=>{var e,s;null===(e=navigator.mediaDevices)||void 0===e||e.removeEventListener("devicechange",t),null===(s=u.current)||void 0===s||s.call(u)}},[x,m]);let g=(0,l.useMemo)(()=>e.length>1,[e.length]);return{devices:e,selectedDeviceId:t,selectDevice:p,permissionState:r,ensurePermission:h,refreshDevices:x,isEnumerating:i,supportsDeviceSelection:g,deviceChangePending:d,acknowledgeDeviceChange:j}}(),{supported:v,status:N,error:y,transcripts:b,start:w,pause:C,resume:S,stop:k,inputLevel:D}=function(e){let{language:s,onTranscript:t,deviceId:a}=e,r=(0,l.useRef)(null),n=(0,l.useRef)(null),i=(0,l.useRef)(null),c=(0,l.useRef)(null),d=(0,l.useRef)(),[o,m]=(0,l.useState)(!1),[u,x]=(0,l.useState)("idle"),[h,p]=(0,l.useState)(null),[j,g]=(0,l.useState)([]),[f,v]=(0,l.useState)(0),N=(0,l.useRef)(!1),y=(0,l.useMemo)(()=>{var e;return null!==(e=sn[s])&&void 0!==e?e:"en-IN"},[s]),b=(0,l.useMemo)(()=>{if(a&&"default"!==a)return{exact:a}},[a]),w=(0,l.useCallback)(()=>{var e,s,t;d.current&&(cancelAnimationFrame(d.current),d.current=void 0),null===(e=c.current)||void 0===e||e.disconnect(),c.current=null,null===(s=i.current)||void 0===s||s.close().catch(()=>void 0),i.current=null,null===(t=n.current)||void 0===t||t.getTracks().forEach(e=>e.stop()),n.current=null,v(0)},[]),C=(0,l.useCallback)(()=>{if(!c.current)return;let e=c.current,s=new Uint8Array(e.fftSize),t=()=>{e.getByteTimeDomainData(s);let a=0;for(let e=0;e<s.length;e++){let t=s[e]/128-1;a+=t*t}let l=Math.sqrt(a/s.length);v(Number.isFinite(l)?Math.min(1,2.5*l):0),d.current=requestAnimationFrame(t)};d.current=requestAnimationFrame(t)},[]),S=(0,l.useCallback)(async()=>{var e;if(n.current)return n.current;if(!(null===(e=navigator.mediaDevices)||void 0===e?void 0:e.getUserMedia))return null;try{let e=await navigator.mediaDevices.getUserMedia({audio:{deviceId:b,noiseSuppression:!0,echoCancellation:!0,autoGainControl:!1},video:!1});n.current=e;let s=new AudioContext;i.current=s;let t=s.createMediaStreamSource(e),a=s.createAnalyser();return a.fftSize=256,c.current=a,t.connect(a),C(),e}catch(e){return console.error("Unable to access microphone",e),p("Unable to access microphone. Check device permissions or selection."),x("error"),null}},[b,C]),k=(0,l.useCallback)(()=>{if(r.current)return r.current;let e=window.SpeechRecognition||window.webkitSpeechRecognition;if(!e)return m(!1),null;let s=new e;return s.continuous=!0,s.interimResults=!0,s.maxAlternatives=1,s.onresult=e=>{let s=[];for(let a=e.resultIndex;a<e.results.length;a++){let l=e.results[a],r=l[0],n=r.transcript.trim();if(!n)continue;let i={id:"".concat(Date.now(),"-").concat(a),text:n,confidence:r.confidence,isFinal:l.isFinal,timestamp:Date.now()};s.unshift(i),l.isFinal&&(null==t||t(n,r.confidence))}s.length>0&&g(e=>[...s,...e].slice(0,10)),s.some(e=>e.isFinal)&&x("processing")},s.onerror=e=>{console.error("Voice billing error",e),p(e.error||"Voice recognition error"),x("error")},s.onend=()=>{if(N.current){x("paused");return}if("listening"===u||"processing"===u)try{s.start();return}catch(e){console.warn("Auto-restart failed",e)}x("idle")},r.current=s,m(!0),s},[t]);(0,l.useEffect)(()=>{let e=k();return e&&(e.lang=y),()=>{null==e||e.stop(),r.current=null,w()}},[k,y,w]),(0,l.useEffect)(()=>{"listening"===u&&(w(),S())},[b,S,u,w]);let D=(0,l.useCallback)(async()=>{let e=k();if(!e){p("Voice recognition is not supported in this browser");return}try{if(!await S())return;N.current=!1,e.lang=y,e.start(),p(null),x("listening")}catch(e){console.error("Failed to start voice recognition",e),p("Unable to start microphone. Check permissions and try again."),x("error")}},[S,k,y]),z=(0,l.useCallback)(()=>{let e=r.current;e&&(N.current=!1,e.stop(),x("idle"),w())},[]),P=(0,l.useCallback)(()=>{let e=r.current;e&&(N.current=!0,e.stop(),x("paused"))},[]),A=(0,l.useCallback)(()=>{if(!N.current){D();return}N.current=!1,D()},[D]);return{supported:o,status:u,error:h,transcripts:j,start:D,pause:P,resume:A,stop:z,inputLevel:f}}({language:t,onTranscript:s,deviceId:c}),[z,P]=(0,l.useState)(null),[A,Z]=(0,l.useState)(!1),[I,_]=(0,l.useState)("ok"),E=(0,l.useRef)(null),F=(0,l.useRef)(null),T=(0,l.useRef)(!1);(0,l.useEffect)(()=>{"prompt"===o&&m()},[o,m]),(0,l.useEffect)(()=>{let e=window.localStorage.getItem("voiceNoiseBaseline");if(e){let s=Number(e);Number.isNaN(s)||P(s)}},[]),(0,l.useEffect)(()=>{null!==z&&window.localStorage.setItem("voiceNoiseBaseline",z.toString())},[z]),(0,l.useEffect)(()=>()=>{E.current&&(window.clearInterval(E.current),E.current=null)},[]),(0,l.useEffect)(()=>{if(null!==z){if("listening"!==N){F.current=null,"autopaused"!==I&&_("ok");return}D-z>.35?F.current?Date.now()-F.current>2500&&!T.current&&(T.current=!0,_("autopaused"),C()):(F.current=Date.now(),"ok"===I&&_("warning")):(F.current=null,"autopaused"!==I&&"ok"!==I&&_("ok"),"autopaused"===I&&"paused"!==N&&(T.current=!1,_("ok")),"warning"===I&&_("ok"))}},[D,z,C,N,I]);let O=()=>{if(A)return;Z(!0);let e=[],s=Date.now();E.current=window.setInterval(()=>{e.push(D),Date.now()-s>=3e3&&(E.current&&(window.clearInterval(E.current),E.current=null),P(Math.min(.8,Math.max(.05,e.length?e.reduce((e,s)=>e+s,0)/e.length:D))),Z(!1))},150)},R=()=>{T.current=!1,_("ok"),S()};return v?(0,a.jsxs)("div",{className:"flex flex-col gap-2 p-3 rounded-lg border bg-muted/30",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"p-2 rounded-full bg-primary/10 text-primary",children:(0,a.jsx)(se.Z,{className:"h-4 w-4"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:"Voice Billing"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Tap start and speak product commands"})]})]}),(0,a.jsx)(j.C,{className:(0,i.cn)("text-xs capitalize",si[N]),children:N})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[(0,a.jsx)("span",{children:"Input level"}),(0,a.jsxs)("span",{children:[Math.round(100*D),"%"]})]}),(0,a.jsx)("div",{className:"h-2 rounded-full bg-muted overflow-hidden",children:(0,a.jsx)("div",{className:(0,i.cn)("h-full bg-primary transition-all duration-200",{"bg-amber-500":D>.65,"bg-green-500":D<=.65&&D>.25,"bg-red-500":D<=.25}),style:{width:"".concat(Math.min(100,Math.round(100*D)),"%")}})})]}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2 text-xs text-muted-foreground",children:[(0,a.jsxs)("span",{children:["Baseline:"," ",null!==z?"".concat(Math.round(100*z),"%"):"Not calibrated"]}),(0,a.jsx)(n.z,{size:"sm",variant:"outline",onClick:O,disabled:A,children:A?"Calibrating...":"Calibrate Noise"})]}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[p&&(0,a.jsxs)(J,{value:c,onValueChange:d,children:[(0,a.jsx)(W,{className:"flex-1 min-w-[160px]",children:(0,a.jsx)(X,{placeholder:"Select microphone"})}),(0,a.jsx)(Q,{children:r.map(e=>(0,a.jsx)($,{value:e.deviceId||"default",children:e.label||"System default"},e.deviceId||e.label))})]}),(0,a.jsx)(n.z,{size:"sm",variant:"outline",onClick:()=>m(),disabled:"granted"===o,children:"Grant Mic Access"}),(0,a.jsxs)(n.z,{size:"sm",variant:"ghost",onClick:()=>x(),disabled:h,children:[(0,a.jsx)(eF.Z,{className:(0,i.cn)("h-4 w-4 mr-1",{"animate-spin":h})}),"Rescan"]})]}),"denied"===o&&(0,a.jsx)(u.bZ,{variant:"destructive",className:"text-xs",children:(0,a.jsx)(u.X,{children:"Microphone access denied. Please allow access in your browser settings and click “Grant Mic Access”."})}),g&&(0,a.jsx)(u.bZ,{className:"text-xs",children:(0,a.jsxs)(u.X,{className:"flex items-center justify-between gap-2",children:["New audio device detected. Select it above or continue with the current microphone.",(0,a.jsx)(n.z,{size:"sm",variant:"outline",onClick:f,children:"Dismiss"})]})}),"denied"===o&&(0,a.jsx)(u.bZ,{variant:"destructive",className:"text-xs",children:(0,a.jsx)(u.X,{children:"Microphone access denied. Please allow access in your browser settings and click “Grant Mic Access”."})}),null===z&&(0,a.jsx)(u.bZ,{className:"text-xs border-amber-200 bg-amber-50",children:(0,a.jsx)(u.X,{children:"Calibrate the noise baseline to improve accuracy in busy environments."})}),"warning"===I&&(0,a.jsx)(u.bZ,{className:"text-xs border-amber-200 bg-amber-50",children:(0,a.jsx)(u.X,{children:"High ambient noise detected. Voice capture sensitivity has been reduced; consider pausing or recalibrating."})}),"autopaused"===I&&(0,a.jsx)(u.bZ,{variant:"destructive",className:"text-xs",children:(0,a.jsxs)(u.X,{className:"flex flex-col gap-2",children:["Voice billing was paused because of sustained noise. Resume once the environment is quieter or recalibrate with the current noise level.",(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(n.z,{size:"sm",variant:"secondary",onClick:R,children:"Resume anyway"}),(0,a.jsx)(n.z,{size:"sm",variant:"outline",onClick:O,disabled:A,children:"Recalibrate"})]})]})}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(n.z,{variant:"secondary",size:"sm",onClick:()=>{T.current=!1,_("ok"),w()},disabled:"listening"===N,children:[(0,a.jsx)(ss.Z,{className:"h-4 w-4 mr-1"})," Start"]}),(0,a.jsxs)(n.z,{variant:"outline",size:"sm",onClick:()=>{T.current=!1,C()},disabled:"listening"!==N,children:[(0,a.jsx)(st.Z,{className:"h-4 w-4 mr-1"})," Pause"]}),(0,a.jsxs)(n.z,{variant:"outline",size:"sm",onClick:R,disabled:"paused"!==N,children:[(0,a.jsx)(sa.Z,{className:"h-4 w-4 mr-1"})," Resume"]}),(0,a.jsxs)(n.z,{variant:"ghost",size:"sm",onClick:()=>{T.current=!1,_("ok"),k()},children:[(0,a.jsx)(sl.Z,{className:"h-4 w-4 mr-1"})," Stop"]})]}),y&&(0,a.jsx)("p",{className:"text-xs text-destructive",children:y}),b.length>0&&(0,a.jsx)("div",{className:"max-h-32 overflow-y-auto rounded-md bg-background border text-xs divide-y",children:b.map(e=>(0,a.jsxs)("div",{className:"p-2 flex items-center justify-between gap-2",children:[(0,a.jsx)("span",{className:"truncate",children:e.text}),(0,a.jsxs)("span",{className:"text-muted-foreground",children:[Math.round(100*e.confidence),"%"]})]},e.id))})]}):(0,a.jsx)("div",{className:"flex flex-col gap-2 p-3 rounded-lg border bg-muted/30",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground text-sm",children:[(0,a.jsx)(se.Z,{className:"h-4 w-4"}),"Browser voice APIs unavailable. Please use Chrome/Edge or enable the feature flag backend stack."]})})}var sd=t(77945);function so(){let{language:e,setLanguage:s}=(0,sr.Z)();return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(sd.Z,{className:"h-4 w-4"}),(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)(n.z,{variant:"en"===e?"default":"outline",size:"sm",onClick:()=>s("en"),children:"English"}),(0,a.jsx)(n.z,{variant:"ta"===e?"default":"outline",size:"sm",onClick:()=>s("ta"),children:"தமிழ்"}),(0,a.jsx)(n.z,{variant:"bilingual"===e?"default":"outline",size:"sm",onClick:()=>s("bilingual"),children:"Both"})]})]})}let sm={ஒன்று:1,ஒரு:1,ரெண்டு:2,இரண்டு:2,மூன்று:3,நான்கு:4,ஐந்து:5,ஆறு:6,ஏழு:7,எட்டு:8,ஒன்பது:9,பத்து:10},su={add:["add","give","need","want","include","plus"],remove:["remove","delete","minus","take out"],hold:["hold bill","hold"],clear:["clear","reset"]},sx={add:["சேர்","வேண்டும்","போடு","வாங்கு"],remove:["அகற்று","நீக்கு","குறை"],hold:["பில் ஹோல்ட்","ஹோல்ட்"],clear:["க்ளியர்","திருத்து"]},sh=/\b(\d+(?:\.\d+)?)\b/,sp=0,sj=new Map,sg=e=>{if(sj.has(e))return;let s=setTimeout(()=>{sj.delete(e),sy({type:"REMOVE_TOAST",toastId:e})},1e6);sj.set(e,s)},sf=(e,s)=>{switch(s.type){case"ADD_TOAST":return{...e,toasts:[s.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===s.toast.id?{...e,...s.toast}:e)};case"DISMISS_TOAST":{let{toastId:t}=s;return t?sg(t):e.toasts.forEach(e=>{sg(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===s.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==s.toastId)}}},sv=[],sN={toasts:[]};function sy(e){sN=sf(sN,e),sv.forEach(e=>{e(sN)})}function sb(e){let{...s}=e,t=(sp=(sp+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>sy({type:"DISMISS_TOAST",toastId:t});return sy({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:e=>{e||a()}}}),{id:t,dismiss:a,update:e=>sy({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function sw(){let[e,s]=l.useState(sN);return l.useEffect(()=>(sv.push(s),()=>{let e=sv.indexOf(s);e>-1&&sv.splice(e,1)}),[e]),{...e,toast:sb,dismiss:e=>sy({type:"DISMISS_TOAST",toastId:e})}}let sC=[{canonical:"milk",matchers:["paal","pal","பால்","milk packet","taza milk"]},{canonical:"curd",matchers:["thayir","தயிர்","yogurt"]},{canonical:"rice",matchers:["arisi","அரிசி","rice bag","samba rice","ponni"]},{canonical:"sugar",matchers:["sakkarai","சர்க்கரை","cheeni"]},{canonical:"oil",matchers:["ennai","எண்ணெய்","cooking oil","sunflower oil","chekku"]},{canonical:"soap",matchers:["saboon","சோப்பு","bath bar"]},{canonical:"dal",matchers:["paruppu","பருப்பு","lentils"]},{canonical:"tea",matchers:["chai","tea powder","தேநீர்"]},{canonical:"coffee",matchers:["kaapi","காபி","coffee powder"]}],sS=sC.map(e=>({canonical:sk(e.canonical),matchers:e.matchers.map(e=>sk(e)).filter(Boolean)}));function sk(e){return e?e.toLowerCase().normalize("NFKD").replace(/[\u0300-\u036f]/g,"").replace(RegExp("[^\\p{L}\\p{N}\\s]","gu")," ").replace(/\s+/g," ").trim():""}function sD(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en";if(!window.speechSynthesis)return;window.speechSynthesis.cancel();let t=new SpeechSynthesisUtterance(e);t.lang="ta"===s?"ta-IN":"en-IN",t.rate=1,t.pitch=1,window.speechSynthesis.speak(t)}function sz(e,s,t){if(!t)return 0;let a=t.split(" ").filter(Boolean);if(0===a.length)return 0;let l=[e.name,e.code,e.category,s.size,s.sku,s.barcode],r=0;for(let e of l){let s=sk(e);if(!s)continue;if(s===t){r=Math.max(r,1);continue}if(s.includes(t)||t.includes(s)){r=Math.max(r,.85);continue}let l=a.filter(e=>s.includes(e)).length/a.length;l>0&&(r=Math.max(r,.8*l))}return r}function sP(e){return e.split(" ").filter(Boolean).map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}function sA(){let{toast:e}=sw(),{language:s}=(0,sr.Z)(),[t,r]=(0,l.useState)([]),[i,c]=(0,l.useState)({name:"",phone:""}),[d,o]=(0,l.useState)(!1),[h,p]=(0,l.useState)(""),[g,f]=(0,l.useState)(""),[v,N]=(0,l.useState)([]),[y,b]=(0,l.useState)(null),[w,C]=(0,l.useState)(!1),[S,k]=(0,l.useState)(""),[D,z]=(0,l.useState)([]),[P,A]=(0,l.useState)(!1),[Z,I]=(0,l.useState)([]),[E,F]=(0,l.useState)(!1),[T,R]=(0,l.useState)(void 0),L=(0,l.useCallback)(e=>{let s=e.quantity*e.rate,t=0;e.discount&&(t="percentage"===e.discount.discountType?e.discount.discountValue/100*s:Math.min(e.discount.discountValue*e.quantity,s));let a=s-t,l=e.product.taxRate/100*a;return{...e,amount:a,taxAmount:l,totalAmount:a+l,discount:e.discount?{...e.discount,discountAmount:t}:void 0}},[]),B=async function(e,a){var l,n;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=Math.max(1,null!==(l=i.quantity)&&void 0!==l?l:1),d=null!==(n=i.source)&&void 0!==n?n:"manual",o=null;try{console.log("\uD83D\uDD0D Fetching discounts for product:",e._id,e.name,"variant:",a.size);let s=await ez.apiClient.getApplicableDiscounts(e._id);console.log("\uD83D\uDCE6 Found discounts:",s),s&&s.length>0?(o=s.sort((e,s)=>{let t="percentage"===e.type?a.price*e.value/100:Math.min(e.value,a.price);return("percentage"===s.type?a.price*s.value/100:Math.min(s.value,a.price))-t})[0],console.log("\uD83C\uDFC6 Best discount selected:",o)):console.log("❌ No applicable discounts found for product:",e.name)}catch(e){console.error("❌ Error fetching discounts:",e)}let m=t.findIndex(s=>s.product._id===e._id&&s.variant.size===a.size);if(m>=0){let e=t[m],s=L({...e,quantity:e.quantity+c,discount:e.discount});r(e=>e.map((e,t)=>t===m?s:e))}else{let t=L({id:"".concat(e._id,"-").concat(a.sku||a.size,"-").concat(Date.now()),product:e,variant:a,quantity:c,rate:a.price,source:d,discount:o?{discountId:o._id,discountName:o.name,discountType:o.type,discountValue:o.value,discountAmount:0}:void 0});if("ta"===s||"bilingual"===s){let s=sC.find(s=>sk(s.canonical)===sk(e.name)||s.matchers.some(s=>sk(s)===sk(e.name)));if(s){let a=s.matchers.find(e=>/[\u0b80-\u0bff]/.test(e));a&&(t.product={...e,name:a})}}r(e=>[...e,t])}},M=e=>{r(s=>s.filter(s=>s.id!==e))},U=()=>{r([]),c({name:"",phone:"",email:"",address:"",gstNumber:""}),p(""),f("")};t.reduce((e,s)=>e+s.totalAmount,0);let Y=t.reduce((e,s)=>{var t;let a=s.quantity*s.rate;return e.subtotal+=a,e.totalTax+=s.taxAmount,e.totalDiscount+=(null===(t=s.discount)||void 0===t?void 0:t.discountAmount)||0,e},{subtotal:0,totalTax:0,totalDiscount:0}),q=(null==y?void 0:y.isEligible)?Math.round((Y.subtotal+Y.totalTax)*.02):0,V=Math.round(Y.subtotal+Y.totalTax-q),K=(0,l.useCallback)(async e=>{if(!e||""===e.trim()){b(null);return}C(!0);try{let s=await ez.apiClient.getCustomerLoyaltyStatus(e);b(s),console.log("\uD83C\uDFAF Loyalty status checked:",s)}catch(e){console.error("❌ Error checking loyalty status:",e),b(null)}finally{C(!1)}},[]);(0,l.useEffect)(()=>{if(i.phone&&""!==i.phone.trim()){let e=setTimeout(()=>{K(i.phone)},500);return()=>clearTimeout(e)}b(null)},[i.phone,K]),(0,l.useEffect)(()=>{let e=localStorage.getItem("heldBills");if(console.log("\uD83D\uDD0D Loading held bills from localStorage:",e),e)try{let s=JSON.parse(e);console.log("✅ Parsed held bills:",s),N(s)}catch(e){console.error("❌ Error parsing held bills:",e)}else console.log("ℹ️ No held bills found in localStorage")},[]),(0,l.useEffect)(()=>{console.log("\uD83D\uDCBE Saving held bills to localStorage:",v),localStorage.setItem("heldBills",JSON.stringify(v))},[v]);let H=()=>{if(0===t.length){p("No items to hold");return}let e={id:Date.now().toString(),billItems:[...t],customerInfo:{...i},heldAt:new Date().toISOString(),grandTotal:Math.round(V)};console.log("\uD83D\uDCCB Holding bill:",e),N(s=>{let t=[e,...s];return console.log("\uD83D\uDCDD Updated held bills:",t),t}),f("Bill held successfully! (".concat(t.length," items, ₹").concat(e.grandTotal.toLocaleString("en-IN"),")")),U()},J=e=>{let s=v.find(s=>s.id===e);if(!s){p("Held bill not found");return}r(s.billItems),c(s.customerInfo),N(s=>s.filter(s=>s.id!==e)),f("Held bill retrieved! (".concat(s.billItems.length," items, ₹").concat(s.grandTotal.toLocaleString("en-IN"),")"))},X=e=>{N(s=>s.filter(s=>s.id!==e))},W=(0,l.useCallback)(s=>{if(!s)return!1;let a=sk(s);if(!a)return!1;let l=null;for(let e of t){let s=sz(e.product,e.variant,a);(!l||s>l.score)&&(l={item:e,score:s})}return!!l&&l.score>=.35&&(M(l.item.id),e({title:"Voice removal",description:"".concat(l.item.product.name," (").concat(l.item.variant.size,") removed")}),!0)},[t,M,e]),Q=(0,l.useCallback)(async function(s){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.skipSpinner||A(!0);try{"add"===s.action&&(await B(s.product,s.variant,{quantity:s.quantity,source:"voice"}),e({title:"Voice item added",description:"".concat(s.quantity," \xd7 ").concat(s.product.name," (").concat(s.variant.size,")")})),z(e=>e.filter(e=>e.id!==s.id))}catch(s){console.error("Voice suggestion apply failed",s),e({title:"Voice action failed",description:"Unable to apply the suggested product. Please try again.",variant:"destructive"})}finally{t.skipSpinner||A(!1)}},[B,e]),$=(0,l.useCallback)(e=>{z(s=>s.filter(s=>s.id!==e))},[]),ee=(0,l.useCallback)(async e=>{let{transcript:t,normalizedName:a,confidence:l}=e;if(!a)return;let r={id:"".concat(Date.now(),"-").concat(Math.random()),transcript:t,normalizedName:a,language:s,confidence:l,createdAt:new Date().toISOString()};I(e=>[r,...e].slice(0,5));try{await ez.apiClient.logVoiceMissingItem({transcript:t,normalizedName:a,language:s,confidence:l})}catch(e){console.warn("Failed to log missing voice item",e)}},[s]),es=(0,l.useCallback)(e=>{I(s=>s.filter(s=>s.id!==e))},[]),et=(0,l.useCallback)(e=>{R({name:sP(e.normalizedName)}),F(!0),es(e.id)},[es]),ea=(0,l.useCallback)(()=>{F(!1),R(void 0)},[]),el=(0,l.useCallback)(()=>{e({title:"Product created",description:"The inventory has been updated with your new item."}),ea()},[ea,e]),er=(0,l.useCallback)(async(a,l)=>{let r=a.trim();if(r){if(k(r),l<.55){e({title:"Voice confidence low",description:"Could not confidently detect the product. Please speak again clearly."});return}A(!0),z([]);try{var n,i,c;let a=function(e){let s=e.trim().toLowerCase();if(!s)return{action:"unknown"};let t=function(e){let s=e.match(sh);if(s)return Number(s[1])||void 0;for(let[s,t]of Object.entries(sm))if(e.includes(s))return t}(s),a=function(e){for(let s of[su,sx]){if(s.add.some(s=>e.includes(s)))break;if(s.remove.some(s=>e.includes(s)))return"remove";if(s.hold.some(s=>e.includes(s)))return"hold";if(s.clear.some(s=>e.includes(s)))return"clear"}return"add"}(s),l=function(e,s){if("hold"===s||"clear"===s||"unknown"===s)return;let t=e;for(let e of[...su.add,...su.remove,...sx.add,...sx.remove]){let s=RegExp(e,"gi");t=t.replace(s,"")}return(t=(t=(t=t.replace(sh,"")).replace(/\b(pieces?|units?)\b/gi,"")).replace(/[\s-]+/g," ").trim())||void 0}(s,a);return{action:a,quantity:t,terms:l}}(r),d=Math.max(1,null!==(n=a.quantity)&&void 0!==n?n:1);if("hold"===a.action){H();let t="ta"===s?"பில் நிறுத்தி வைக்கப்பட்டது. அடுத்த பில் சொல்லுங்கள்.":"Bill held. Next product please.";sD(t,s),e({title:"Bill held",description:"Current bill moved to held bills via voice command."});return}if("clear"===a.action){if(0===t.length){let t="ta"===s?"பில்லில் எதுவும் இல்லை.":"Bill is already empty.";sD(t,s),e({title:"Nothing to clear",description:"No items in the bill currently."})}else{U();let t="ta"===s?"பில் சுத்தம் செய்யப்பட்டது. அடுத்த பில் சொல்லுங்கள்.":"Bill cleared. Next product please.";sD(t,s),e({title:"Bill cleared",description:"All items removed from the bill via voice."})}return}if("remove"===a.action){if(W(a.terms)){let e="ta"===s?"பொருள் நீக்கப்பட்டது. அடுத்த பொருள்?":"Item removed. Next item?";sD(e,s)}else{let t="ta"===s?"பொருள் கிடைக்கவில்லை.":"Item not found in bill.";sD(t,s),e({title:"No matching item",description:"Could not match a billed item to remove.",variant:"destructive"})}return}let o=a.terms;if(!o){e({title:"Product not detected",description:"Please include the product name in your voice command."});return}let{variants:m,normalized:u,matchedCanonicals:x}=function(e){let s=sk(e),t=new Set,a=new Set;for(let e of(s&&t.add(s),sS))e.canonical&&e.matchers.some(e=>e&&s.includes(e))&&(a.add(e.canonical),t.add(e.canonical));return s.includes(" and ")&&s.split(" and ").map(e=>e.trim()).filter(Boolean).forEach(e=>t.add(e)),{normalized:s,variants:Array.from(t),matchedCanonicals:Array.from(a)}}(o),h=m.length>0?m:u?[u]:[];if(0===h.length){e({title:"Product not detected",description:"Please include the product name in your voice command."});return}let p=new Map,j=async e=>{let s=[];try{s=await ez.apiClient.getProducts({search:e,active:!0})}catch(s){console.error("Voice lookup failed for term:",e,s)}if(0===s.length)try{let t=await ez.apiClient.getProductByIdentifier(e);t&&(s=[t])}catch(e){}for(let e of s)p.has(e._id)||p.set(e._id,e)};for(let e of h)await j(e);if(0===p.size&&x.length>0)for(let e of x)await j(e);let g=Array.from(p.values());if(0===g.length){let s=h[0]||u;s&&await ee({transcript:r,normalizedName:s,confidence:l}),e({title:"Product not found",description:"This item is not in inventory yet. Use the quick add suggestion below."});return}let f=[];for(let e of g){let s=e.variants&&e.variants.length>0?e.variants:[{size:"Default",price:null!==(i=e.basePrice)&&void 0!==i?i:0,cost:null!==(c=e.baseCost)&&void 0!==c?c:0,stock:0,sku:e.code,isActive:!0}],t=sk(e.name),n=x.some(e=>e&&e===t);for(let t of s){if(!1===t.isActive)continue;let s=h.reduce((s,a)=>Math.max(s,sz(e,t,a)),0);if(s<=0)continue;let i=n?.1:0,c=Math.min(1,.6*s+.3*l+i);c<.3||f.push({id:"".concat(e._id,"-").concat(t.sku||t.size,"-").concat(Date.now(),"-").concat(Math.random()),product:e,variant:t,quantity:d,action:a.action,transcript:r,score:c})}}f.sort((e,s)=>s.score-e.score);let v=f.slice(0,3);if(0===v.length){let s=h[0]||u;s&&await ee({transcript:r,normalizedName:s,confidence:l}),e({title:"Product not found",description:"This item is not in inventory yet. Use the quick add suggestion below."});return}z(v);let N=v[0];if(N.score>=.65){await Q(N,{skipSpinner:!0});let t="ta"===s?"".concat(N.product.name," சேர்க்கப்பட்டது. அடுத்த பொருள்?"):"".concat(N.product.name," added. Next product?");sD(t,s),e({title:"Voice match added",description:"".concat(N.quantity," \xd7 ").concat(N.product.name," added automatically.")})}else{let t="ta"===s?"தயவுசெய்து தேர்வு செய்யவும்.":"Please select a product.";sD(t,s),e({title:"Voice suggestions ready",description:"Review the suggested products below and tap apply."})}}catch(s){console.error("Voice transcript handling failed",s),e({title:"Voice processing failed",description:"Could not process the voice command. Please retry.",variant:"destructive"})}finally{A(!1)}}},[!0,e,H,t,U,W,Q,ee]),en=async e=>{if(0===t.length){p("No items in the bill");return}o(!0),p("");try{let l={},r=[];if(e.razorpayDetails&&(l={razorpayPaymentId:e.razorpayDetails.paymentId,razorpayOrderId:e.razorpayDetails.orderId,razorpaySignature:e.razorpayDetails.signature,paymentStatus:"completed"},"card"===e.razorpayDetails.method?l.cardType="Credit Card":"upi"===e.razorpayDetails.method&&(l.upiId="customer@upi")),"cash"===e.paymentMethod)r.push({method:"cash",amount:e.cashTendered||V});else if("card"===e.paymentMethod)r.push({method:"card",amount:V,details:e.razorpayDetails?{razorpayPaymentId:e.razorpayDetails.paymentId,razorpayOrderId:e.razorpayDetails.orderId,razorpaySignature:e.razorpayDetails.signature}:void 0});else if("upi"===e.paymentMethod)r.push({method:"upi",amount:V,details:e.razorpayDetails?{razorpayPaymentId:e.razorpayDetails.paymentId,razorpayOrderId:e.razorpayDetails.orderId,razorpaySignature:e.razorpayDetails.signature}:void 0});else if("mixed"===e.paymentMethod){var s,a;e.cashTendered&&e.cashTendered>0&&r.push({method:"cash",amount:e.cashTendered}),e.cardAmount&&e.cardAmount>0&&r.push({method:"card",amount:e.cardAmount,details:(null===(s=e.razorpayDetails)||void 0===s?void 0:s.method)==="card"?{razorpayPaymentId:e.razorpayDetails.paymentId,razorpayOrderId:e.razorpayDetails.orderId,razorpaySignature:e.razorpayDetails.signature}:void 0}),e.upiAmount&&e.upiAmount>0&&r.push({method:"upi",amount:e.upiAmount,details:(null===(a=e.razorpayDetails)||void 0===a?void 0:a.method)==="upi"?{razorpayPaymentId:e.razorpayDetails.paymentId,razorpayOrderId:e.razorpayDetails.orderId,razorpaySignature:e.razorpayDetails.signature}:void 0})}let n={items:t.map(e=>({product:e.product._id,size:e.variant.size,quantity:e.quantity,rate:e.rate,taxRate:e.product.taxRate,discount:e.discount?{discountId:e.discount.discountId,discountName:e.discount.discountName,discountType:e.discount.discountType,discountValue:e.discount.discountValue,discountAmount:e.discount.discountAmount}:void 0})),customer:i,cashTendered:e.cashTendered,paymentMethod:e.paymentMethod,paymentDetails:Object.keys(l).length>0?l:void 0,paymentBreakdown:r.length>0?r:void 0,applyLoyaltyDiscount:(null==y?void 0:y.isEligible)||!1},c=await ez.apiClient.createBill(n);if(i.email&&""!==i.email.trim())try{await ez.apiClient.sendBillByEmail(c._id,i.email);let e="Bill ".concat(c.billNumber," created successfully and sent via email to ").concat(i.email,"!");(null==y?void 0:y.isEligible)&&(e+=" \uD83C\uDF89 2% Loyalty discount applied!"),f(e)}catch(s){console.error("Failed to send email:",s);let e="Bill ".concat(c.billNumber," created successfully! (Email delivery failed)");(null==y?void 0:y.isEligible)&&(e+=" \uD83C\uDF89 2% Loyalty discount applied!"),f(e)}else{let e="Bill ".concat(c.billNumber," created successfully!");(null==y?void 0:y.isEligible)&&(e+=" \uD83C\uDF89 2% Loyalty discount applied!"),f(e)}U()}catch(e){p(e instanceof Error?e.message:"Failed to create bill")}finally{o(!1)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"h-full bg-background overflow-hidden",children:(0,a.jsx)(m.Zb,{className:"h-full flex flex-col overflow-hidden",children:(0,a.jsxs)(m.aY,{className:"flex-1 p-0 flex flex-col lg:flex-row overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex-1 flex flex-col p-6 space-y-6 min-w-0 overflow-hidden",children:[h&&(0,a.jsx)(u.bZ,{variant:"destructive",className:"mb-4",children:(0,a.jsx)(u.X,{children:h})}),g&&(0,a.jsx)(u.bZ,{className:"border-green-200 bg-green-50 text-green-800 mb-4",children:(0,a.jsx)(u.X,{children:g})}),(0,a.jsxs)("div",{className:"flex-shrink-0 space-y-4",children:[(0,a.jsxs)("div",{className:"flex gap-3 items-end",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(eM,{onProductSelect:B})}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(n.z,{variant:"outline",onClick:U,disabled:0===t.length,children:[(0,a.jsx)(eF.Z,{className:"mr-2 h-4 w-4"}),"Clear All"]}),(0,a.jsxs)(n.z,{variant:"outline",onClick:H,disabled:0===t.length,children:[(0,a.jsx)(O.Z,{className:"mr-2 h-4 w-4"}),"Hold Bill"]})]}),(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(so,{})})]}),(0,a.jsx)(sc,{onTranscript:er}),S&&(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Last voice command: ",(0,a.jsx)("span",{className:"font-medium text-foreground",children:S})]}),(P||D.length>0)&&(0,a.jsxs)("div",{className:"rounded-lg border bg-background/60 p-3 space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 font-medium text-foreground",children:[(0,a.jsx)(eT.Z,{className:"h-3.5 w-3.5 text-primary"}),"Voice suggestions"]}),P&&(0,a.jsxs)(j.C,{variant:"outline",className:"text-[10px] gap-1",children:[(0,a.jsx)(x.Z,{className:"h-3 w-3 animate-spin"}),"Processing"]})]}),D.map(e=>(0,a.jsxs)("div",{className:"border rounded-md p-2 text-xs flex flex-col gap-2 bg-muted/30",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-sm text-foreground",children:e.product.name}),(0,a.jsxs)("p",{className:"text-muted-foreground text-[11px]",children:[e.variant.size," • Qty ",e.quantity]}),(0,a.jsxs)("p",{className:"text-[11px] text-muted-foreground",children:["Confidence ",(100*e.score).toFixed(0),"%"]})]}),(0,a.jsx)(j.C,{variant:"secondary",className:"text-[10px] capitalize",children:e.action})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsxs)(n.z,{size:"sm",onClick:()=>Q(e),disabled:P,className:"text-[11px] gap-1",children:[(0,a.jsx)(G.Z,{className:"h-3 w-3"}),"Apply"]}),(0,a.jsx)(n.z,{variant:"ghost",size:"sm",onClick:()=>$(e.id),disabled:P,className:"text-[11px]",children:"Dismiss"})]})]},e.id)),!P&&0===D.length&&(0,a.jsx)("p",{className:"text-[11px] text-muted-foreground",children:"Waiting for voice matches…"})]}),Z.length>0&&(0,a.jsxs)("div",{className:"rounded-lg border border-dashed bg-muted/20 p-3 space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs font-medium text-muted-foreground",children:[(0,a.jsx)("span",{children:"Not in inventory yet"}),(0,a.jsxs)(j.C,{variant:"secondary",className:"text-[10px]",children:[Z.length," pending"]})]}),Z.map(e=>(0,a.jsxs)("div",{className:"border rounded-md bg-background p-3 space-y-2 text-xs",children:[(0,a.jsx)("div",{className:"font-semibold text-foreground",children:sP(e.normalizedName)}),(0,a.jsxs)("div",{className:"text-[11px] text-muted-foreground",children:["“",e.transcript,"”"]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsx)(n.z,{size:"sm",variant:"default",onClick:()=>et(e),children:"Add to inventory"}),(0,a.jsx)(n.z,{size:"sm",variant:"ghost",onClick:()=>es(e.id),children:"Dismiss"})]})]},e.id))]})]}),(0,a.jsxs)("div",{className:"flex-shrink-0",children:[(0,a.jsx)(e7,{customerInfo:{name:i.name||"",phone:i.phone||"",email:i.email,address:i.address,gstNumber:i.gstNumber},onCustomerInfoChange:e=>{c({name:e.name||"",phone:e.phone||"",email:e.email,address:e.address,gstNumber:e.gstNumber})}}),w&&(0,a.jsx)("div",{className:"mt-2 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"animate-spin h-4 w-4 border-2 border-blue-600 border-t-transparent rounded-full"}),(0,a.jsx)("span",{className:"text-sm text-blue-700",children:"Checking loyalty status..."})]})}),y&&!w&&(0,a.jsx)("div",{className:"mt-2 p-3 rounded-lg border ".concat(y.isEligible?"bg-green-50 border-green-200":"bg-amber-50 border-amber-200"),children:(0,a.jsx)("div",{className:"flex items-center gap-2",children:y.isEligible?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eO.Z,{className:"h-4 w-4 text-green-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-green-800",children:"\uD83C\uDF89 Loyalty Discount Available!"}),(0,a.jsx)("p",{className:"text-xs text-green-700",children:"2% discount will be applied on this purchase"})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eR.Z,{className:"h-4 w-4 text-amber-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-amber-800",children:"Loyalty Status"}),(0,a.jsxs)("p",{className:"text-xs text-amber-700",children:[y.purchaseCount," purchases made •",y.nextPurchaseForDiscount>0?"".concat(y.nextPurchaseForDiscount," more purchase").concat(y.nextPurchaseForDiscount>1?"s":""," for 2% discount"):"Next purchase eligible for discount!"]})]})]})})})]}),(0,a.jsx)("div",{className:"flex-1 min-h-0",children:(0,a.jsxs)(m.Zb,{className:"h-full flex flex-col overflow-hidden",children:[(0,a.jsx)(m.Ol,{className:"flex-shrink-0 pb-3",children:(0,a.jsxs)(m.ll,{className:"text-lg",children:["Items (",t.length,")"]})}),(0,a.jsx)(m.aY,{className:"flex-1 overflow-hidden p-0",children:(0,a.jsx)("div",{className:"h-full overflow-y-auto scrollbar-thin scrollbar-thumb-muted scrollbar-track-muted/20 hover:scrollbar-thumb-muted-foreground",children:(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)(eJ,{items:t,onUpdateItem:(e,s)=>{r(t=>t.map(t=>t.id===e?L({...t,...s}):t))},onRemoveItem:M})})})})]})})]}),(0,a.jsxs)("div",{className:"w-full lg:w-80 flex-shrink-0 border-l bg-muted/50 flex flex-col",children:[(0,a.jsx)("div",{className:"flex-shrink-0 p-4 border-b",children:(0,a.jsxs)(m.Zb,{className:"bg-gradient-to-br from-background to-muted/30 shadow-sm",children:[(0,a.jsx)(m.Ol,{className:"pb-1",children:(0,a.jsxs)(m.ll,{className:"text-lg flex items-center gap-2",children:[(0,a.jsx)(_.Z,{className:"h-5 w-5"}),"Bill Summary",t.length>0&&(0,a.jsxs)("span",{className:"ml-auto text-sm bg-primary/10 text-primary px-2 py-1 rounded-full",children:[t.length," items"]})]})}),(0,a.jsx)(m.aY,{className:"pt-0",children:(0,a.jsx)(eQ,{items:t,loyaltyStatus:y})})]})}),t.length>0&&(0,a.jsx)("div",{className:"flex-shrink-0 p-4 border-b",children:(0,a.jsxs)(m.Zb,{className:"bg-gradient-to-br from-background to-muted/30 shadow-sm",children:[(0,a.jsx)(m.Ol,{className:"pb-1",children:(0,a.jsxs)(m.ll,{className:"text-lg flex items-center gap-2",children:[(0,a.jsx)(eL.Z,{className:"h-5 w-5"}),"Payment",(0,a.jsxs)("span",{className:"ml-auto text-sm bg-primary/10 text-primary px-2 py-1 rounded-full",children:["₹",Math.round(V).toLocaleString("en-IN")]})]})}),(0,a.jsx)(m.aY,{className:"pt-0",children:(0,a.jsx)(e9,{grandTotal:Math.round(V),onPayment:en,isProcessing:d})})]})}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:0===t.length&&(0,a.jsxs)(m.Zb,{className:"bg-gradient-to-br from-background to-muted/30 shadow-sm",children:[(0,a.jsx)(m.Ol,{className:"pb-2",children:(0,a.jsxs)(m.ll,{className:"text-lg flex items-center gap-2",children:[(0,a.jsx)(O.Z,{className:"h-5 w-5"}),"Held Bills",(0,a.jsxs)("span",{className:"ml-auto text-sm bg-primary/10 text-primary px-2 py-1 rounded-full",children:[v.length," held"]})]})}),(0,a.jsx)(m.aY,{className:"pt-0 space-y-2",children:v.length>0?v.map(e=>(0,a.jsxs)("div",{className:"p-3 border rounded-lg bg-background/50 hover:bg-background transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("span",{className:"text-sm font-medium",children:[e.billItems.length," items"]}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"•"}),(0,a.jsxs)("span",{className:"text-sm font-semibold text-primary",children:["₹",e.grandTotal.toLocaleString("en-IN")]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(n.z,{size:"sm",variant:"outline",onClick:()=>J(e.id),className:"h-7 px-2 text-xs",children:"Retrieve"}),(0,a.jsx)(n.z,{size:"sm",variant:"ghost",onClick:()=>X(e.id),className:"h-7 px-2 text-xs text-destructive hover:text-destructive",children:"\xd7"})]})]}),e.customerInfo.name&&(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Customer: ",e.customerInfo.name,e.customerInfo.phone&&" • ".concat(e.customerInfo.phone)]}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground mt-1",children:["Held: ",new Date(e.heldAt).toLocaleString()]})]},e.id)):(0,a.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,a.jsx)(O.Z,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),(0,a.jsx)("p",{className:"text-sm",children:"No held bills yet"}),(0,a.jsx)("p",{className:"text-xs mt-1",children:'Add items to a bill and click "Hold Bill" to save it here'})]})})]})})]})]})})}),(0,a.jsx)(e_,{product:null,isOpen:E,onClose:ea,onSuccess:el,initialValues:T})]})}var sZ=t(20271);function sI(e){let{className:s,...t}=e;return(0,a.jsx)(sZ.fC,{"data-slot":"tabs",className:(0,i.cn)("flex flex-col gap-2",s),...t})}function s_(e){let{className:s,...t}=e;return(0,a.jsx)(sZ.aV,{"data-slot":"tabs-list",className:(0,i.cn)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",s),...t})}function sE(e){let{className:s,...t}=e;return(0,a.jsx)(sZ.xz,{"data-slot":"tabs-trigger",className:(0,i.cn)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...t})}function sF(e){let{className:s,...t}=e;return(0,a.jsx)(sZ.VY,{"data-slot":"tabs-content",className:(0,i.cn)("flex-1 outline-none",s),...t})}var sT=t(95252);function sO(e){let{isOpen:s,onClose:t,onStartShift:r}=e,[i,d]=(0,l.useState)(""),[m,h]=(0,l.useState)(!1),[p,j]=(0,l.useState)(""),g=async e=>{e.preventDefault(),j("");let s=Number.parseFloat(i);if(isNaN(s)||s<0){j("Please enter a valid opening cash amount");return}h(!0);try{await r(s),d("")}catch(e){j(e instanceof Error?e.message:"Failed to start shift")}finally{h(!1)}},f=()=>{m||(d(""),j(""),t())};return(0,a.jsx)(eh,{open:s,onOpenChange:f,children:(0,a.jsxs)(ef,{children:[(0,a.jsxs)(ev,{children:[(0,a.jsxs)(ey,{className:"flex items-center gap-2",children:[(0,a.jsx)(ss.Z,{className:"h-5 w-5"}),"Start New Shift"]}),(0,a.jsx)(eb,{children:"Enter the opening cash amount in the register to start your shift. This will be used to calculate the expected cash at the end of your shift."})]}),(0,a.jsxs)("form",{onSubmit:g,className:"space-y-4",children:[p&&(0,a.jsx)(u.bZ,{variant:"destructive",children:(0,a.jsx)(u.X,{children:p})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"openingCash",children:"Opening Cash Amount"}),(0,a.jsx)(c,{id:"openingCash",type:"number",step:"0.01",min:"0",value:i,onChange:e=>d(e.target.value),placeholder:"0.00",required:!0,disabled:m,className:"text-lg"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{children:"Quick Amounts"}),(0,a.jsx)("div",{className:"grid grid-cols-5 gap-2",children:[0,500,1e3,2e3,5e3].map(e=>(0,a.jsxs)(n.z,{type:"button",variant:"outline",size:"sm",onClick:()=>d(e.toString()),disabled:m,className:"text-xs",children:["₹",e]},e))})]}),(0,a.jsxs)(eN,{children:[(0,a.jsx)(n.z,{type:"button",variant:"outline",onClick:f,disabled:m,children:"Cancel"}),(0,a.jsx)(n.z,{type:"submit",disabled:m,children:m?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Starting..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ss.Z,{className:"mr-2 h-4 w-4"}),"Start Shift"]})})]})]})]})})}function sR(e){let{className:s,...t}=e;return(0,a.jsx)("textarea",{"data-slot":"textarea",className:(0,i.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),...t})}var sL=t(76865);function sB(e){let{isOpen:s,onClose:t,onEndShift:r,currentShift:i}=e,[d,m]=(0,l.useState)(""),[h,p]=(0,l.useState)(""),[j,g]=(0,l.useState)(!1),[f,v]=(0,l.useState)(""),N=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e),y=i?i.openingCash+i.totalSales:0,b=Number.parseFloat(d)||0,w=b-y,C=Math.abs(w)>.01,S=async e=>{if(e.preventDefault(),v(""),isNaN(b)||b<0){v("Please enter a valid closing cash amount");return}g(!0);try{await r(b,h||void 0),m(""),p("")}catch(e){v(e instanceof Error?e.message:"Failed to end shift")}finally{g(!1)}},k=()=>{j||(m(""),p(""),v(""),t())};return i?(0,a.jsx)(eh,{open:s,onOpenChange:k,children:(0,a.jsxs)(ef,{className:"max-w-md",children:[(0,a.jsxs)(ev,{children:[(0,a.jsxs)(ey,{className:"flex items-center gap-2",children:[(0,a.jsx)(sl.Z,{className:"h-5 w-5"}),"End Shift"]}),(0,a.jsx)(eb,{children:"Count the cash in the register and enter the closing amount to end your shift."})]}),(0,a.jsxs)("form",{onSubmit:S,className:"space-y-4",children:[f&&(0,a.jsx)(u.bZ,{variant:"destructive",children:(0,a.jsx)(u.X,{children:f})}),(0,a.jsxs)("div",{className:"space-y-3 p-4 bg-muted rounded-lg",children:[(0,a.jsx)("h4",{className:"font-medium",children:"Shift Summary"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Opening Cash:"}),(0,a.jsx)("span",{children:N(i.openingCash)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Total Sales:"}),(0,a.jsx)("span",{className:"text-green-600 dark:text-green-400",children:N(i.totalSales)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Bills Created:"}),(0,a.jsx)("span",{children:i.totalBills})]}),(0,a.jsx)(eW,{}),(0,a.jsxs)("div",{className:"flex justify-between font-medium",children:[(0,a.jsx)("span",{children:"Expected Cash:"}),(0,a.jsx)("span",{children:N(y)})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"closingCash",children:"Actual Cash in Register"}),(0,a.jsx)(c,{id:"closingCash",type:"number",step:"0.01",min:"0",value:d,onChange:e=>m(e.target.value),placeholder:"0.00",required:!0,disabled:j,className:"text-lg"})]}),d&&C&&(0,a.jsxs)(u.bZ,{variant:w<0?"destructive":"default",children:[(0,a.jsx)(sL.Z,{className:"h-4 w-4"}),(0,a.jsxs)(u.X,{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{children:"Cash Difference:"}),(0,a.jsxs)("span",{className:"font-medium ".concat(w<0?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"),children:[w>0?"+":"",N(w)]})]}),w<0?"Cash shortage detected":"Cash overage detected"]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"notes",children:"Notes (Optional)"}),(0,a.jsx)(sR,{id:"notes",value:h,onChange:e=>p(e.target.value),placeholder:"Add any notes about the shift...",disabled:j,rows:3})]}),(0,a.jsxs)(eN,{children:[(0,a.jsx)(n.z,{type:"button",variant:"outline",onClick:k,disabled:j,children:"Cancel"}),(0,a.jsx)(n.z,{type:"submit",disabled:j,variant:"destructive",children:j?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Ending..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(sl.Z,{className:"mr-2 h-4 w-4"}),"End Shift"]})})]})]})]})}):null}function sM(){let{isAdmin:e,isCashier:s}=(0,r.a)(),[t,i]=(0,l.useState)(null),[c,d]=(0,l.useState)(!0),[o,h]=(0,l.useState)(""),[p,g]=(0,l.useState)(!1),[f,v]=(0,l.useState)(!1),N=async()=>{try{d(!0),h("");let e=await ez.apiClient.getCurrentShift();i(e)}catch(e){h(e instanceof Error?e.message:"Failed to load shift data")}finally{d(!1)}};(0,l.useEffect)(()=>{N()},[]);let y=async e=>{try{await ez.apiClient.startShift(e),await N(),g(!1)}catch(e){throw e}},b=async(e,s)=>{try{await ez.apiClient.endShift(e,s),await N(),v(!1)}catch(e){throw e}},w=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e),S=e=>{let s=new Date(e),t=new Date().getTime()-s.getTime();return"".concat(Math.floor(t/36e5),"h ").concat(Math.floor(t%36e5/6e4),"m")};return c?(0,a.jsx)(m.Zb,{children:(0,a.jsxs)(m.aY,{className:"flex items-center justify-center py-8",children:[(0,a.jsx)(x.Z,{className:"h-6 w-6 animate-spin mr-2"}),"Loading shift status..."]})}):(0,a.jsxs)("div",{className:"space-y-6",children:[o&&(0,a.jsx)(u.bZ,{variant:"destructive",children:(0,a.jsx)(u.X,{children:o})}),(0,a.jsxs)(m.Zb,{children:[(0,a.jsx)(m.Ol,{children:(0,a.jsxs)(m.ll,{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(C.Z,{className:"h-5 w-5"}),"Shift Status"]}),t?(0,a.jsx)(j.C,{variant:"default",className:"bg-green-600 dark:bg-green-700",children:"Active Shift"}):(0,a.jsx)(j.C,{variant:"secondary",children:"No Active Shift"})]})}),(0,a.jsx)(m.aY,{children:t?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Shift Started"}),(0,a.jsx)("p",{className:"font-medium",children:new Date(t.startTime).toLocaleString()}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Duration: ",S(t.startTime)]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Opening Cash"}),(0,a.jsx)("p",{className:"font-medium text-lg",children:w(t.openingCash)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Sales"}),(0,a.jsx)("p",{className:"font-medium text-lg text-green-600 dark:text-green-400",children:w(t.totalSales)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Bills Created"}),(0,a.jsx)("p",{className:"font-medium text-lg",children:t.totalBills})]})]}),(0,a.jsx)("div",{className:"bg-muted p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Expected Cash in Drawer"}),(0,a.jsx)("p",{className:"text-xl font-bold",children:w(t.openingCash+t.totalSales)})]}),(0,a.jsxs)(n.z,{onClick:()=>v(!0),variant:"destructive",children:[(0,a.jsx)(sl.Z,{className:"mr-2 h-4 w-4"}),"End Shift"]})]})})]}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(C.Z,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),(0,a.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No Active Shift"}),(0,a.jsx)("p",{className:"text-muted-foreground mb-4",children:e?"Admin users cannot start shifts. Please ask a cashier to start a shift.":"Start a new shift to begin processing sales"}),!e&&(0,a.jsxs)(n.z,{onClick:()=>g(!0),children:[(0,a.jsx)(ss.Z,{className:"mr-2 h-4 w-4"}),"Start Shift"]})]})})]}),t&&(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsx)(m.Zb,{children:(0,a.jsxs)(m.aY,{className:"flex items-center p-6",children:[(0,a.jsx)(sT.Z,{className:"h-8 w-8 text-green-600 dark:text-green-400 mr-3"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Average Sale"}),(0,a.jsx)("p",{className:"text-xl font-bold",children:w(t.totalBills>0?t.totalSales/t.totalBills:0)})]})]})}),(0,a.jsx)(m.Zb,{children:(0,a.jsxs)(m.aY,{className:"flex items-center p-6",children:[(0,a.jsx)(O.Z,{className:"h-8 w-8 text-blue-600 dark:text-blue-400 mr-3"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Sales per Hour"}),(0,a.jsx)("p",{className:"text-xl font-bold",children:(()=>{let e=(new Date().getTime()-new Date(t.startTime).getTime())/36e5;return e>0?Math.round(t.totalBills/e):0})()})]})]})}),(0,a.jsx)(m.Zb,{children:(0,a.jsxs)(m.aY,{className:"flex items-center p-6",children:[(0,a.jsx)(C.Z,{className:"h-8 w-8 text-purple-600 dark:text-purple-400 mr-3"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Shift Duration"}),(0,a.jsx)("p",{className:"text-xl font-bold",children:S(t.startTime)})]})]})})]}),(0,a.jsx)(sO,{isOpen:p,onClose:()=>g(!1),onStartShift:y}),(0,a.jsx)(sB,{isOpen:f,onClose:()=>v(!1),onEndShift:b,currentShift:t})]})}function sU(){let[e,s]=(0,l.useState)([]),[t,r]=(0,l.useState)(!0),[i,d]=(0,l.useState)(""),[o,h]=(0,l.useState)(1),[p,g]=(0,l.useState)(1),[f,v]=(0,l.useState)(""),[N,y]=(0,l.useState)(""),b=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;try{r(!0),d("");let t={page:e,limit:10};f&&(t.startDate=f),N&&(t.endDate=N);let a=await ez.apiClient.getShifts(t);s(a.shifts),g(a.totalPages),h(a.currentPage)}catch(e){d(e instanceof Error?e.message:"Failed to load shifts")}finally{r(!1)}};(0,l.useEffect)(()=>{b()},[f,N]);let w=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e),S=(e,s)=>{let t=new Date(e),a=(s?new Date(s):new Date).getTime()-t.getTime();return"".concat(Math.floor(a/36e5),"h ").concat(Math.floor(a%36e5/6e4),"m")},k=e=>{if("active"===e.status||void 0===e.closingCash)return null;let s=e.openingCash+e.totalSales;return e.closingCash-s};return(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)(m.Zb,{children:[(0,a.jsxs)(m.Ol,{children:[(0,a.jsxs)(m.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(C.Z,{className:"h-5 w-5"}),"Shift History"]}),(0,a.jsx)(m.SZ,{children:"View and manage shift records"})]}),(0,a.jsxs)(m.aY,{children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(c,{type:"date",value:f,onChange:e=>v(e.target.value),placeholder:"Start Date"})}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(c,{type:"date",value:N,onChange:e=>y(e.target.value),placeholder:"End Date"})}),(0,a.jsx)(n.z,{variant:"outline",onClick:()=>{v(""),y("")},children:"Clear"})]}),i&&(0,a.jsx)(u.bZ,{variant:"destructive",className:"mb-4",children:(0,a.jsx)(u.X,{children:i})}),(0,a.jsx)("div",{className:"border rounded-lg",children:(0,a.jsxs)(eU,{children:[(0,a.jsx)(eY,{children:(0,a.jsxs)(eV,{children:[(0,a.jsx)(eK,{children:"Cashier"}),(0,a.jsx)(eK,{children:"Start Time"}),(0,a.jsx)(eK,{children:"Duration"}),(0,a.jsx)(eK,{children:"Sales"}),(0,a.jsx)(eK,{children:"Bills"}),(0,a.jsx)(eK,{children:"Cash Difference"}),(0,a.jsx)(eK,{children:"Status"})]})}),(0,a.jsx)(eq,{children:t?(0,a.jsx)(eV,{children:(0,a.jsxs)(eG,{colSpan:7,className:"text-center py-8",children:[(0,a.jsx)(x.Z,{className:"h-6 w-6 animate-spin mx-auto mb-2"}),"Loading shifts..."]})}):0===e.length?(0,a.jsx)(eV,{children:(0,a.jsx)(eG,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No shifts found"})}):e.map(e=>{let s=k(e);return(0,a.jsxs)(eV,{children:[(0,a.jsx)(eG,{children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e.cashierName}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:new Date(e.startTime).toLocaleDateString()})]})}),(0,a.jsx)(eG,{children:(0,a.jsxs)("div",{className:"text-sm",children:[new Date(e.startTime).toLocaleTimeString(),e.endTime&&(0,a.jsxs)("div",{className:"text-muted-foreground",children:["to ",new Date(e.endTime).toLocaleTimeString()]})]})}),(0,a.jsx)(eG,{children:S(e.startTime,e.endTime)}),(0,a.jsx)(eG,{children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:w(e.totalSales)}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Avg: ",e.totalBills>0?w(e.totalSales/e.totalBills):"₹0"]})]})}),(0,a.jsx)(eG,{children:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(O.Z,{className:"h-4 w-4 text-muted-foreground"}),e.totalBills]})}),(0,a.jsx)(eG,{children:null!==s?(0,a.jsx)("div",{className:"font-medium ".concat(.01>Math.abs(s)?"text-green-600 dark:text-green-400":s<0?"text-red-600 dark:text-red-400":"text-blue-600 dark:text-blue-400"),children:.01>Math.abs(s)?"Balanced":"".concat(s>0?"+":"").concat(w(s))}):(0,a.jsx)("span",{className:"text-muted-foreground",children:"-"})}),(0,a.jsx)(eG,{children:(0,a.jsx)(j.C,{variant:"active"===e.status?"default":"secondary",children:"active"===e.status?"Active":"Closed"})})]},e._id)})})]})}),p>1&&(0,a.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Page ",o," of ",p]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(n.z,{variant:"outline",size:"sm",onClick:()=>b(o-1),disabled:o<=1||t,children:"Previous"}),(0,a.jsx)(n.z,{variant:"outline",size:"sm",onClick:()=>b(o+1),disabled:o>=p||t,children:"Next"})]})]})]})]})})}var sY=t(70525),sq=t(85954),sV=t(58896);function sK(){var e,s,t;let{user:i}=(0,r.a)(),[c,d]=(0,l.useState)(null),[o,x]=(0,l.useState)([]),[h,p]=(0,l.useState)(null),[g,f]=(0,l.useState)(!1),[v,N]=(0,l.useState)(""),[y,b]=(0,l.useState)({isOpen:!1,shiftId:"",shiftDetails:null}),[w,S]=(0,l.useState)({startDate:"",endDate:""}),k=(null==i?void 0:i.role)==="admin",D=e=>{let s=Math.floor(e);return"".concat(s,"h ").concat(Math.round((e-s)*60),"m")},z=async()=>{if(k)try{var e,s;f(!0),N("");let t=new URLSearchParams;w.startDate&&t.append("startDate",w.startDate),w.endDate&&t.append("endDate",w.endDate);let[a,l,r]=await Promise.all([ez.apiClient.getShiftSummary(w),ez.apiClient.getActiveShifts(),ez.apiClient.getAvailableCashiers()]);console.log("\uD83D\uDD0D Available Cashiers Data:",r),console.log("\uD83D\uDD0D Available Cashiers Data structure:",{hasData:!!r,hasAvailableCashiers:!!(r&&r.availableCashiers),availableCashiersLength:(null==r?void 0:null===(e=r.availableCashiers)||void 0===e?void 0:e.length)||0,allCashiersLength:(null==r?void 0:null===(s=r.allCashiers)||void 0===s?void 0:s.length)||0,activeShiftCashiers:(null==r?void 0:r.activeShiftCashiers)||0,fullData:JSON.stringify(r,null,2)}),console.log("\uD83D\uDD0D Active Shifts Data:",l),d(a),x(l),p(r)}catch(e){N(e instanceof Error?e.message:"Failed to load admin data")}finally{f(!1)}};(0,l.useEffect)(()=>{k&&z()},[k]);let P=(e,s)=>{b({isOpen:!0,shiftId:e,shiftDetails:s})},A=async()=>{try{await ez.apiClient.forceEndShift(y.shiftId),await z(),b({isOpen:!1,shiftId:"",shiftDetails:null})}catch(e){N(e instanceof Error?e.message:"Failed to end shift")}},Z=()=>{b({isOpen:!1,shiftId:"",shiftDetails:null})},I=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e);return(0,a.jsxs)("div",{className:"space-y-6",children:[v&&(0,a.jsx)(u.bZ,{variant:"destructive",children:(0,a.jsx)(u.X,{children:v})}),(0,a.jsxs)(sI,{defaultValue:k?"overview":"status",className:"w-full",children:[(0,a.jsxs)(s_,{className:"grid w-full ".concat(k?"grid-cols-3":"grid-cols-2"),children:[!k&&(0,a.jsx)(sE,{value:"status",children:"Current Shift"}),(0,a.jsx)(sE,{value:"history",children:"Shift History"}),k&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(sE,{value:"overview",children:"Overview"}),(0,a.jsx)(sE,{value:"active",children:"Active Shifts"})]})]}),!k&&(0,a.jsx)(sF,{value:"status",className:"space-y-6",children:(0,a.jsx)(sM,{})}),(0,a.jsx)(sF,{value:"history",className:"space-y-6",children:(0,a.jsx)(sU,{})}),k&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(sF,{value:"overview",className:"space-y-6",children:[(0,a.jsxs)(m.Zb,{children:[(0,a.jsx)(m.Ol,{children:(0,a.jsx)(m.ll,{children:"Date Range Filter"})}),(0,a.jsx)(m.aY,{children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Start Date"}),(0,a.jsx)("input",{type:"date",className:"w-full p-2 border rounded-md",value:w.startDate,onChange:e=>S(s=>({...s,startDate:e.target.value}))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"End Date"}),(0,a.jsx)("input",{type:"date",className:"w-full p-2 border rounded-md",value:w.endDate,onChange:e=>S(s=>({...s,endDate:e.target.value}))})]}),(0,a.jsx)("div",{className:"flex items-end",children:(0,a.jsx)(n.z,{onClick:z,className:"w-full",disabled:g,children:g?"Loading...":"Apply Filter"})})]})})]}),g?(0,a.jsx)(m.Zb,{children:(0,a.jsxs)(m.aY,{className:"flex items-center justify-center py-8",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"}),(0,a.jsx)("span",{className:"ml-2",children:"Loading overview..."})]})}):c?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsx)(m.Zb,{children:(0,a.jsxs)(m.aY,{className:"flex items-center p-6",children:[(0,a.jsx)(C.Z,{className:"h-8 w-8 text-blue-600 mr-3"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Shifts"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:c.totalShifts}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[c.activeShifts," active • ",c.closedShifts," closed"]})]})]})}),(0,a.jsx)(m.Zb,{children:(0,a.jsxs)(m.aY,{className:"flex items-center p-6",children:[(0,a.jsx)(sY.Z,{className:"h-8 w-8 text-green-600 mr-3"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Sales"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:I(c.totalSales)}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[c.totalBills," bills • ",I(c.totalSales/c.totalBills||0)," avg/bill"]})]})]})}),(0,a.jsx)(m.Zb,{children:(0,a.jsxs)(m.aY,{className:"flex items-center p-6",children:[(0,a.jsx)(sq.Z,{className:"h-8 w-8 text-purple-600 mr-3"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Avg Duration"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:D(c.averageShiftDuration)}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Per closed shift"})]})]})}),(0,a.jsx)(m.Zb,{children:(0,a.jsxs)(m.aY,{className:"flex items-center p-6",children:[(0,a.jsx)(sT.Z,{className:"h-8 w-8 text-orange-600 mr-3"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Cash Variance"}),(0,a.jsx)("p",{className:"text-2xl font-bold ".concat(c.totalCashVariance>=0?"text-green-600":"text-red-600"),children:I(c.totalCashVariance)}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[I(c.averageCashVariance)," avg/shift"]})]})]})})]}),(0,a.jsxs)(m.Zb,{children:[(0,a.jsx)(m.Ol,{children:(0,a.jsxs)(m.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(R.Z,{className:"h-5 w-5"}),"Peak Sales Hours"]})}),(0,a.jsx)(m.aY,{children:c.peakHours&&c.peakHours.length>0?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:c.peakHours.map((e,s)=>(0,a.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)(j.C,{variant:0===s?"default":"secondary",children:["#",s+1]}),(0,a.jsx)("span",{className:"font-semibold",children:e.hour})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("p",{className:"text-sm",children:["Sales: ",I(e.totalSales)]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[e.shiftCount," shifts"]})]})]},s))}):(0,a.jsx)("p",{className:"text-muted-foreground text-center py-4",children:"No peak hours data available"})})]}),(0,a.jsxs)(m.Zb,{children:[(0,a.jsx)(m.Ol,{children:(0,a.jsxs)(m.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(sV.Z,{className:"h-5 w-5"}),"Detailed Cashier Performance"]})}),(0,a.jsx)(m.aY,{children:(0,a.jsx)("div",{className:"space-y-4",children:Object.entries(c.shiftsByCashier).map(e=>{let[s,t]=e;return(0,a.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold text-lg",children:s}),(0,a.jsxs)("div",{className:"flex gap-4 text-sm text-muted-foreground",children:[(0,a.jsxs)("span",{children:[t.totalShifts," total shifts"]}),(0,a.jsxs)("span",{children:[t.activeShifts," active"]}),(0,a.jsxs)("span",{children:[t.closedShifts," closed"]})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"font-bold text-lg",children:I(t.totalSales)}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Sales"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-muted-foreground",children:"Bills"}),(0,a.jsx)("p",{className:"font-medium",children:t.totalBills}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[t.averageBillsPerShift.toFixed(1),"/shift"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-muted-foreground",children:"Avg Sales"}),(0,a.jsx)("p",{className:"font-medium",children:I(t.averageSalesPerShift)}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"per shift"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-muted-foreground",children:"Duration"}),(0,a.jsx)("p",{className:"font-medium",children:D(t.averageDuration)}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"avg shift"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-muted-foreground",children:"Cash Variance"}),(0,a.jsx)("p",{className:"font-medium ".concat(t.cashVariance>=0?"text-green-600":"text-red-600"),children:I(t.cashVariance)}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"total variance"})]})]})]},s)})})})]})]}):null]}),(0,a.jsx)(sF,{value:"active",className:"space-y-6",children:g?(0,a.jsx)(m.Zb,{children:(0,a.jsxs)(m.aY,{className:"flex items-center justify-center py-8",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"}),(0,a.jsx)("span",{className:"ml-2",children:"Loading active shifts..."})]})}):(0,a.jsxs)(a.Fragment,{children:[console.log("\uD83D\uDD0D Rendering available cashiers section:",{availableCashiers:!!h,hasAllCashiers:!!(h&&h.allCashiers),allCashiersArray:null==h?void 0:h.allCashiers,allCashiersLength:(null==h?void 0:null===(e=h.allCashiers)||void 0===e?void 0:e.length)||0,availableCashiersLength:(null==h?void 0:null===(s=h.availableCashiers)||void 0===s?void 0:s.length)||0}),h&&h.allCashiers&&(0,a.jsxs)(m.Zb,{children:[(0,a.jsx)(m.Ol,{children:(0,a.jsxs)(m.ll,{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{children:"All Cashiers"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(j.C,{variant:"secondary",children:[h.allCashiers.length," total"]}),(0,a.jsxs)(j.C,{variant:"outline",children:[h.availableCashiers.length," available"]}),(0,a.jsxs)(j.C,{variant:"destructive",children:[h.activeShiftCashiers," on shift"]})]})]})}),(0,a.jsx)(m.aY,{children:h.allCashiers.length>0?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:h.allCashiers.map(e=>{let s=!h.availableCashiers.some(s=>s._id===e._id);return(0,a.jsxs)("div",{className:"p-4 border rounded-lg ".concat(s?"bg-destructive/10 border-destructive/30 dark:bg-destructive/20 dark:border-destructive/40":"bg-green-100 border-green-300 dark:bg-green-900/30 dark:border-green-700"),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("p",{className:"font-medium",children:e.user.name}),(0,a.jsx)(j.C,{variant:s?"destructive":"default",children:s?"On Shift":"Available"})]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:e.user.employeeId}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:e.user.email}),(0,a.jsx)(j.C,{variant:"outline",className:"mt-2",children:e.employmentDetails.department})]},e._id)})}):(0,a.jsx)("p",{className:"text-center text-muted-foreground py-4",children:"No cashiers found in the system."})})]}),(0,a.jsxs)(m.Zb,{children:[(0,a.jsx)(m.Ol,{children:(0,a.jsxs)(m.ll,{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{children:"Currently Active Shifts"}),(0,a.jsxs)(j.C,{variant:"destructive",children:[o.length," active"]})]})}),(0,a.jsx)(m.aY,{children:o.length>0?(0,a.jsx)("div",{className:"space-y-4",children:o.map(e=>{var s,t;return(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-green-100 border-green-300 dark:bg-green-900/30 dark:border-green-700",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsx)("p",{className:"font-medium text-lg",children:(null===(s=e.cashier)||void 0===s?void 0:s.name)||"Unknown"}),(0,a.jsx)(j.C,{className:"bg-green-600 dark:bg-green-700",children:"Active Shift"})]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Employee ID: ",(null===(t=e.cashier)||void 0===t?void 0:t.employeeId)||"N/A"]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Started: ",new Date(e.startTime).toLocaleString()]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-3",children:[(0,a.jsxs)("div",{className:"text-center p-2 bg-background rounded border",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Opening Cash"}),(0,a.jsx)("p",{className:"font-semibold",children:I(e.openingCash)})]}),(0,a.jsxs)("div",{className:"text-center p-2 bg-background rounded border",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Total Sales"}),(0,a.jsx)("p",{className:"font-semibold text-green-600 dark:text-green-400",children:I(e.totalSales)})]}),(0,a.jsxs)("div",{className:"text-center p-2 bg-background rounded border",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Bills"}),(0,a.jsx)("p",{className:"font-semibold",children:e.totalBills})]}),(0,a.jsxs)("div",{className:"text-center p-2 bg-background rounded border",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Duration"}),(0,a.jsx)("p",{className:"font-semibold",children:D((new Date().getTime()-new Date(e.startTime).getTime())/36e5)})]})]})]}),(0,a.jsx)("div",{className:"ml-4",children:(0,a.jsx)(n.z,{size:"sm",variant:"destructive",onClick:()=>P(e._id,e),className:"whitespace-nowrap",children:"Force End Shift"})})]},e._id)})}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("div",{className:"text-muted-foreground mb-2",children:"No active shifts at the moment."}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"All cashiers are currently available to start their shifts."})]})})]})]})})]})]}),(0,a.jsx)(eh,{open:y.isOpen,onOpenChange:Z,children:(0,a.jsxs)(ef,{children:[(0,a.jsxs)(ev,{children:[(0,a.jsxs)(ey,{className:"flex items-center gap-2",children:[(0,a.jsx)(sL.Z,{className:"h-5 w-5 text-destructive"}),"Confirm Force End Shift"]}),(0,a.jsxs)(eb,{children:["Are you sure you want to force end the shift for ",null===(t=y.shiftDetails)||void 0===t?void 0:t.employeeName,"? This action cannot be undone and may affect the employee's current session."]})]}),y.shiftDetails&&(0,a.jsxs)("div",{className:"space-y-3 p-4 bg-muted rounded-lg",children:[(0,a.jsx)("h4",{className:"font-medium",children:"Shift Details"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Employee:"}),(0,a.jsx)("span",{children:y.shiftDetails.employeeName})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Start Time:"}),(0,a.jsx)("span",{children:new Date(y.shiftDetails.startTime).toLocaleString()})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Total Sales:"}),(0,a.jsx)("span",{className:"text-green-600 dark:text-green-400",children:I(y.shiftDetails.totalSales)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Bills Created:"}),(0,a.jsx)("span",{children:y.shiftDetails.totalBills})]})]})]}),(0,a.jsxs)(eN,{children:[(0,a.jsx)(n.z,{type:"button",variant:"outline",onClick:Z,children:"Cancel"}),(0,a.jsx)(n.z,{type:"button",variant:"destructive",onClick:A,children:"Force End Shift"})]})]})})]})}var sG=t(42208),sH=t(17625),sJ=t(90740);function sX(e){let{onSearch:s,isLoading:t}=e,[r,i]=(0,l.useState)({}),[d,u]=(0,l.useState)(!1),x=(e,t)=>{let a={...r,[e]:t||void 0};i(a),s(a)},h=Object.values(r).some(e=>e);return(0,a.jsxs)(m.Zb,{children:[(0,a.jsx)(m.Ol,{children:(0,a.jsxs)(m.ll,{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(eC.Z,{className:"h-5 w-5"}),"Search Bills"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(n.z,{variant:"outline",size:"sm",onClick:()=>u(!d),className:"text-xs",children:[(0,a.jsx)(sJ.Z,{className:"mr-1 h-3 w-3"}),d?"Simple":"Advanced"]}),h&&(0,a.jsxs)(n.z,{variant:"outline",size:"sm",onClick:()=>{i({}),s({})},className:"text-xs bg-transparent",children:[(0,a.jsx)(U.Z,{className:"mr-1 h-3 w-3"}),"Clear"]})]})]})}),(0,a.jsxs)(m.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"search",children:"Search by Bill Number, Customer Name, or Phone"}),(0,a.jsx)(c,{id:"search",placeholder:"Enter bill number, customer name, or phone...",value:r.search||"",onChange:e=>x("search",e.target.value),disabled:t})]}),d&&(0,a.jsxs)("div",{className:"space-y-4 pt-4 border-t",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"startDate",children:"Start Date"}),(0,a.jsx)(c,{id:"startDate",type:"date",value:r.startDate||"",onChange:e=>x("startDate",e.target.value),disabled:t})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"endDate",children:"End Date"}),(0,a.jsx)(c,{id:"endDate",type:"date",value:r.endDate||"",onChange:e=>x("endDate",e.target.value),disabled:t})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"status",children:"Status"}),(0,a.jsxs)(J,{value:r.status||"all",onValueChange:e=>x("status",e),children:[(0,a.jsx)(W,{children:(0,a.jsx)(X,{placeholder:"All Statuses"})}),(0,a.jsxs)(Q,{children:[(0,a.jsx)($,{value:"all",children:"All Statuses"}),(0,a.jsx)($,{value:"completed",children:"Completed"}),(0,a.jsx)($,{value:"cancelled",children:"Cancelled"}),(0,a.jsx)($,{value:"refunded",children:"Refunded"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"cashier",children:"Cashier ID"}),(0,a.jsx)(c,{id:"cashier",placeholder:"Enter cashier ID...",value:r.cashier||"",onChange:e=>x("cashier",e.target.value),disabled:t})]})]})]})]})]})}var sW=t(89345),sQ=t(53417);function s$(e){var s,r,i,c,d;let{bill:o,isOpen:m,onClose:u}=e;if(!o)return null;let{language:h}=(0,sr.Z)(),[p,g]=(0,l.useState)(!1),[f,v]=(0,l.useState)((null===(s=o.customer)||void 0===s?void 0:s.email)||""),[N,y]=(0,l.useState)(!1),[b,w]=(0,l.useState)(""),[C,S]=(0,l.useState)(!1),[k,D]=(0,l.useState)(!1),z=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e),P=async()=>{try{console.log("\uD83C\uDF0D Current language from context:",h),console.log("\uD83D\uDD0D Language type:",typeof h);let{apiClient:e}=await Promise.resolve().then(t.bind(t,29116)),s=await e.generateBillPDF(o._id,h),a=window.URL.createObjectURL(s),l=document.createElement("a");l.href=a,l.download="bill_".concat(o.billNumber,"_").concat(h,".pdf"),document.body.appendChild(l),l.click(),setTimeout(()=>{document.body.removeChild(l),window.URL.revokeObjectURL(a)},100)}catch(s){console.error("Error downloading PDF:",s);let e=window.open("","_blank");if(e){let s=I(o);e.document.write(s),e.document.close(),e.print()}}},A=async()=>{if(!f.trim()){w("Please enter an email address");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(f)){w("Please enter a valid email address");return}w(""),g(!0);try{var e;await (0,ez.f)(o._id,f),y(!1),v((null===(e=o.customer)||void 0===e?void 0:e.email)||""),console.log("Bill sent successfully to:",f)}catch(e){console.error("Error sending bill:",e),w("Failed to send bill. Please try again.")}finally{g(!1)}},Z=async()=>{var e;if(o&&(null===(e=o.customer)||void 0===e?void 0:e.phone)){S(!0),D(!1);try{let e=await (0,ez.t)(o._id,o.customer.phone);e.whatsappUrl&&window.open(e.whatsappUrl,"_blank"),console.log("Bill sent successfully via WhatsApp!")}catch(e){console.error("Error sending WhatsApp:",e)}finally{S(!1)}}},I=e=>{let s=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:2}).format(e),t=function(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:38,a=s.toString(),l=e.toString(),r=t-l.length-a.length;return l+" ".repeat(Math.max(1,r))+a},a=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:42,t=e.length,a=Math.floor((s-t)/2);return" ".repeat(Math.max(0,a))+e+" ".repeat(Math.max(0,s-t-a))},l="\n       *************************************\n       *".concat(a("SUPERMARKET STORE",35),"*\n       *").concat(a("123 Main Street, City",35),"*\n       *").concat(a("State, Country - 123456",35),"*\n       *").concat(a("Phone: +1 234 567 8900",35),"*\n       *************************************\n       \n       BILL #: ").concat(e.billNumber,"\n       DATE:  ").concat(new Date(e.createdAt).toLocaleString("en-IN",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),"\n       CASHIER: ").concat(e.cashierName,"\n       -------------------------------------\n      ");if(e.customer&&(l+="\n       CUSTOMER: ".concat(e.customer.name||"Walk-in Customer","\n       ").concat(e.customer.phone?"PHONE: ".concat(e.customer.phone):"","\n       ").concat(e.customer.email?"EMAIL: ".concat(e.customer.email):"","\n      --------------------------------------\n        ")),l+="     ITEMS                  AMOUNT\n      --------------------------------------\n",e.items.forEach(e=>{let a=" ".concat(e.productName," ").concat(e.size?"(".concat(e.size,")"):""),r=a.length>30?a.substring(0,27)+"...":a,n=s(e.totalAmount),i=" ".concat(e.quantity," x ").concat(s(e.rate));l+="     ".concat(r,"\n")+"     ".concat(t(i,n),"\n")+"\n"}),l+="     ---------------------------------------\n"+"     ".concat(t("SUBTOTAL:",s(e.subtotal)),"\n"),e.loyaltyDiscount&&e.loyaltyDiscount.discountAmount>0&&(l+="     ".concat(t("LOYALTY DISCOUNT:","-"+s(e.loyaltyDiscount.discountAmount)),"\n")),e.totalDiscount>0&&(l+="     ".concat(t("TOTAL DISCOUNT:","-"+s(e.totalDiscount)),"\n")),l+="     ".concat(t("TOTAL TAX:",s(e.totalTax)),"\n"),Math.abs(e.roundOff)>.01){let a=(e.roundOff>0?"+":"")+s(e.roundOff);l+="     ".concat(t("ROUND OFF:",a),"\n")}return l+="     =======================================\n"+"     ".concat(t("TOTAL:",s(e.grandTotal)),"\n")+"     =======================================\n     \n"+"     PAYMENT METHOD: ".concat(e.paymentMethod.toUpperCase(),"\n"),"cash"===e.paymentMethod&&(l+="     ".concat(t("CASH TENDERED:",s(e.cashTendered)),"\n")+"     ".concat(t("CHANGE:",s(e.changeDue)),"\n")),l+="\n    ---------------------------------------\n         THANK YOU FOR YOUR PURCHASE!\n              PLEASE VISIT AGAIN\n           ".concat("completed"===e.status?"     *** PAID ***":"","\n    ****************************************\n      "),'\n      <!DOCTYPE html>\n      <html lang="en">\n      <head>\n        <meta charset="UTF-8">\n        <meta name="viewport" content="width=device-width, initial-scale=1.0">\n        <title>Bill '.concat(e.billNumber,"</title>\n        <style>\n          * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n          }\n          \n          body {\n            font-family: 'Courier New', monospace;\n            font-size: 9px;\n            line-height: 1.2;\n            background: white;\n            color: black;\n            padding: 2px;\n            max-width: 280px;\n            margin: 0 auto;\n            white-space: pre;\n          }\n          \n          .no-print {\n            margin-top: 20px;\n            text-align: center;\n            white-space: normal;\n          }\n          \n          .no-print button {\n            padding: 8px 16px;\n            margin: 5px;\n            cursor: pointer;\n            border: 1px solid #ccc;\n            background: #f5f5f5;\n            border-radius: 4px;\n            font-family: Arial, sans-serif;\n            font-size: 12px;\n          }\n          \n          @media print {\n            body {\n              margin: 0;\n              padding: 0;\n              font-size: 8px;\n            }\n            .no-print {\n              display: none;\n            }\n          }\n        </style>\n      </head>\n      <body>\n        ").concat(l,'\n        \n        <div class="no-print">\n          <button onclick="window.print()">Print Receipt</button>\n          <button onclick="window.close()">Close</button>\n        </div>\n      </body>\n      </html>\n    ')};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eh,{open:m,onOpenChange:u,children:(0,a.jsxs)(ef,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)(ev,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)(j.C,{variant:(e=>{switch(e){case"completed":return"default";case"cancelled":return"destructive";case"refunded":return"secondary";default:return"outline"}})(o.status),children:o.status.toUpperCase()})}),(0,a.jsxs)("div",{className:"flex items-center gap-2 pr-8",children:[(0,a.jsxs)(n.z,{variant:"outline",size:"sm",onClick:()=>{var e,s;let t=I(o),a=document.createElement("iframe");a.style.display="none",document.body.appendChild(a);let l=a.contentDocument||(null===(e=a.contentWindow)||void 0===e?void 0:e.document);l&&(l.open(),l.write(t),l.close(),null===(s=a.contentWindow)||void 0===s||s.print(),setTimeout(()=>{document.body.removeChild(a)},1e3))},children:[(0,a.jsx)(sH.Z,{className:"mr-2 h-4 w-4"}),"Print"]}),(0,a.jsxs)(n.z,{variant:"outline",size:"sm",onClick:P,children:[(0,a.jsx)(e5.Z,{className:"mr-2 h-4 w-4"}),"PDF"]}),(0,a.jsxs)(n.z,{variant:"outline",size:"sm",onClick:()=>y(!0),children:[(0,a.jsx)(sW.Z,{className:"mr-2 h-4 w-4"}),"Email"]}),(0,a.jsx)(n.z,{variant:"outline",size:"sm",onClick:()=>{var e;if(!(null===(e=o.customer)||void 0===e?void 0:e.phone)||""===o.customer.phone.trim()){console.error("Customer phone number is required to send WhatsApp message");return}D(!0)},disabled:C||!(null===(r=o.customer)||void 0===r?void 0:r.phone)||""===o.customer.phone.trim(),className:"text-green-600 hover:text-green-700 hover:bg-green-50",children:C?(0,a.jsx)(x.Z,{className:"h-4 w-4 animate-spin"}):(0,a.jsx)(sQ.Z,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(ey,{className:"text-2xl font-bold mb-2",children:"Supermarket"}),(0,a.jsxs)(eb,{className:"text-sm",children:["123 Main Street, City",(0,a.jsx)("br",{}),"State, Country - 123456",(0,a.jsx)("br",{}),"Phone: +1 234 567 8900"]}),(0,a.jsx)("div",{className:"border-b border-dashed border-gray-300 my-4"})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,a.jsx)("div",{className:"space-y-2",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold mb-2",children:"Bill Information"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Bill Number:"}),(0,a.jsx)("span",{className:"font-mono font-medium",children:o.billNumber})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Date & Time:"}),(0,a.jsx)("span",{className:"text-right",children:new Date(o.createdAt).toLocaleString()})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Cashier:"}),(0,a.jsx)("span",{className:"text-right",children:o.cashierName})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Payment Method:"}),(0,a.jsx)("span",{className:"capitalize text-right",children:o.paymentMethod})]})]})]})}),(0,a.jsx)("div",{className:"space-y-2",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold mb-2",children:"Customer Information"}),(0,a.jsx)("div",{className:"space-y-2 text-sm",children:(null===(i=o.customer)||void 0===i?void 0:i.name)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Name:"}),(0,a.jsx)("span",{className:"text-right",children:o.customer.name})]}),o.customer.phone&&(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Phone:"}),(0,a.jsx)("span",{className:"text-right",children:o.customer.phone})]}),o.customer.address&&(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsx)("span",{className:"text-muted-foreground mt-1",children:"Address:"}),(0,a.jsx)("span",{className:"text-right max-w-[60%]",children:o.customer.address})]}),o.customer.gstNumber&&(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"GST Number:"}),(0,a.jsx)("span",{className:"font-mono text-right break-all",children:o.customer.gstNumber})]})]}):(0,a.jsx)("div",{className:"text-muted-foreground italic",children:"Walk-in Customer"})})]})})]}),(0,a.jsx)(eW,{}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"font-semibold mb-4",children:["Items (",o.items.length,")"]}),(0,a.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,a.jsxs)(eU,{className:"w-full table-fixed",children:[(0,a.jsx)(eY,{children:(0,a.jsxs)(eV,{children:[(0,a.jsx)(eK,{className:"text-right w-[8%]",children:"S.No"}),(0,a.jsx)(eK,{className:"w-[32%]",children:"Product"}),(0,a.jsx)(eK,{className:"text-center w-[8%] px-0",children:"Qty"}),(0,a.jsx)(eK,{className:"text-right w-[12%]",children:"Rate"}),(0,a.jsx)(eK,{className:"text-right w-[12%]",children:"Discount"}),(0,a.jsx)(eK,{className:"text-right w-[12%]",children:"Tax"}),(0,a.jsx)(eK,{className:"text-right w-[14%] font-semibold",children:"Amount"})]})}),(0,a.jsx)(eq,{children:o.items.map((e,s)=>(0,a.jsxs)(eV,{children:[(0,a.jsx)(eG,{className:"align-top py-2",children:s+1}),(0,a.jsx)(eG,{className:"align-top py-2",children:(0,a.jsxs)("div",{className:"font-medium break-words whitespace-normal",children:[e.productName,e.size&&(0,a.jsxs)("span",{className:"text-xs text-blue-600 ml-2",children:["(",e.size,")"]})]})}),(0,a.jsx)(eG,{className:"text-center align-middle py-2 px-0",children:e.quantity}),(0,a.jsx)(eG,{className:"text-right align-middle py-2",children:z(e.rate)}),(0,a.jsx)(eG,{className:"text-right align-middle py-2",children:e.discount&&e.discount.discountAmount>0?(0,a.jsxs)("span",{className:"text-green-600",children:["-",z(e.discount.discountAmount)]}):"-"}),(0,a.jsx)(eG,{className:"text-right align-middle py-2",children:e.taxAmount>0?z(e.taxAmount):"-"}),(0,a.jsx)(eG,{className:"text-right align-middle py-2 font-semibold",children:z(e.totalAmount)})]},s))})]})})]})]}),(0,a.jsx)(eW,{}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h3",{className:"font-semibold",children:"Payment Details"}),(0,a.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Payment Method:"}),(0,a.jsx)(j.C,{variant:"outline",className:"capitalize",children:o.paymentMethod})]}),o.paymentBreakdown&&o.paymentBreakdown.length>0&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"font-medium text-muted-foreground",children:"Payment Breakdown:"}),(0,a.jsx)("div",{className:"space-y-1",children:o.paymentBreakdown.map((e,s)=>{var t,l;return(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"capitalize",children:"card"===e.method&&(null===(t=e.details)||void 0===t?void 0:t.cardLast4)?"Card (**** ".concat(e.details.cardLast4,")"):"upi"===e.method&&(null===(l=e.details)||void 0===l?void 0:l.upiId)?"UPI (".concat(e.details.upiId,")"):e.method}),(0,a.jsx)("span",{className:"font-medium",children:z(e.amount)})]},s)})})]}),o.paymentDetails&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"font-medium text-muted-foreground",children:"Payment Information:"}),(0,a.jsxs)("div",{className:"space-y-1",children:[o.paymentDetails.razorpayPaymentId&&(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Transaction ID:"}),(0,a.jsx)("span",{className:"font-mono text-xs break-all",children:o.paymentDetails.razorpayPaymentId})]}),o.paymentDetails.cardLast4&&(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Card Number:"}),(0,a.jsxs)("span",{children:["**** ",o.paymentDetails.cardLast4]})]}),o.paymentDetails.cardType&&(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Card Type:"}),(0,a.jsx)("span",{className:"capitalize",children:o.paymentDetails.cardType})]}),o.paymentDetails.upiId&&(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"UPI ID:"}),(0,a.jsx)("span",{children:o.paymentDetails.upiId})]}),o.paymentDetails.paymentStatus&&(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Payment Status:"}),(0,a.jsx)(j.C,{variant:"completed"===o.paymentDetails.paymentStatus?"default":"failed"===o.paymentDetails.paymentStatus?"destructive":"secondary",className:"capitalize",children:o.paymentDetails.paymentStatus})]})]})]}),"cash"===o.paymentMethod&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Cash Tendered:"}),(0,a.jsx)("span",{className:"font-medium",children:z(o.cashTendered)})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Change Due:"}),(0,a.jsx)("span",{className:"text-green-600 font-medium",children:z(o.changeDue)})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h3",{className:"font-semibold",children:"Bill Summary"}),(0,a.jsx)("div",{className:"space-y-2 text-sm",children:(()=>{var e,s;let t=o.items.reduce((e,s)=>{var t;let a=s.quantity*s.rate;return e.subtotal+=a,e.totalTax+=s.taxAmount,e.totalDiscount+=(null===(t=s.discount)||void 0===t?void 0:t.discountAmount)||0,e},{subtotal:0,totalTax:0,totalDiscount:0}),l=(null===(e=o.loyaltyDiscount)||void 0===e?void 0:e.discountAmount)||0,r=t.subtotal+t.totalTax-l,n=Math.round(r)-r,i=Math.round(r);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Subtotal:"}),(0,a.jsx)("span",{className:"font-medium text-right",children:z(t.subtotal)})]}),t.totalDiscount>0&&(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Total Discount:"}),(0,a.jsxs)("span",{className:"font-medium text-right text-green-600",children:["-",z(t.totalDiscount)]})]}),l>0&&(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,a.jsxs)("span",{className:"text-muted-foreground",children:["Loyalty Discount (",(null===(s=o.loyaltyDiscount)||void 0===s?void 0:s.discountValue)||2,"%):"]}),(0,a.jsxs)("span",{className:"font-medium text-right text-emerald-600",children:["-",z(l)]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Total Tax:"}),(0,a.jsx)("span",{className:"font-medium text-right",children:z(t.totalTax)})]}),Math.abs(n)>.01&&(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Round Off:"}),(0,a.jsxs)("span",{className:"font-medium text-right",children:[n>0?"+":"",z(n)]})]}),(0,a.jsx)(eW,{}),(0,a.jsxs)("div",{className:"flex justify-between items-center text-lg font-bold",children:[(0,a.jsx)("span",{children:"Grand Total:"}),(0,a.jsx)("span",{className:"text-right",children:z(i)})]})]})})()})]})]})]})}),(0,a.jsx)(eh,{open:N,onOpenChange:y,children:(0,a.jsxs)(ef,{className:"max-w-md",children:[(0,a.jsxs)(ev,{children:[(0,a.jsx)(ey,{children:"Send Bill via Email"}),(0,a.jsx)(eb,{children:"Enter the email address to send the bill PDF to."})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"email",className:"text-sm font-medium",children:"Email Address"}),(0,a.jsx)("input",{id:"email",type:"email",value:f,onChange:e=>v(e.target.value),placeholder:"customer@example.com",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),b&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:b})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(n.z,{variant:"outline",onClick:()=>{y(!1),w("")},disabled:p,children:"Cancel"}),(0,a.jsx)(n.z,{onClick:A,disabled:p,children:p?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Sending..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(sW.Z,{className:"mr-2 h-4 w-4"}),"Send Bill"]})})]})]})]})}),(0,a.jsx)(eh,{open:k,onOpenChange:D,children:(0,a.jsxs)(ef,{className:"max-w-md",children:[(0,a.jsxs)(ev,{children:[(0,a.jsx)(ey,{children:"Send Bill via WhatsApp"}),(0,a.jsxs)(eb,{children:["Are you sure you want to send this bill to ",(null==o?void 0:null===(c=o.customer)||void 0===c?void 0:c.name)||"the customer"," via WhatsApp?"]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"space-y-2",children:(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["The bill will be sent to: ",(null==o?void 0:null===(d=o.customer)||void 0===d?void 0:d.phone)||"No phone number available"]})}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(n.z,{variant:"outline",onClick:()=>D(!1),disabled:C,children:"Cancel"}),(0,a.jsx)(n.z,{onClick:Z,disabled:C,className:"bg-green-600 hover:bg-green-700",children:C?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Sending..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(sQ.Z,{className:"mr-2 h-4 w-4"}),"Send via WhatsApp"]})})]})]})]})})]})}function s0(){let[e,s]=(0,l.useState)([]),[t,r]=(0,l.useState)(!0),[i,c]=(0,l.useState)(""),[d,o]=(0,l.useState)(1),[h,p]=(0,l.useState)(1),[g,f]=(0,l.useState)(0),[v,N]=(0,l.useState)({}),[y,b]=(0,l.useState)(null),[w,C]=(0,l.useState)(!1),S=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v;try{r(!0),c("");let a={page:e,limit:20,...t},l=await ez.apiClient.getBills(a);s(l.bills),p(l.totalPages),o(l.currentPage),f(l.total)}catch(e){c(e instanceof Error?e.message:"Failed to load bills")}finally{r(!1)}};(0,l.useEffect)(()=>{S()},[]);let k=async e=>{try{let s=await ez.apiClient.getBill(e._id);b(s),C(!0)}catch(e){c(e instanceof Error?e.message:"Failed to load bill details")}},D=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e),z=e=>{switch(e){case"completed":return"default";case"cancelled":return"destructive";case"refunded":return"secondary";default:return"outline"}},P=e=>{switch(e){case"cash":return"\uD83D\uDCB5";case"card":return"\uD83D\uDCB3";case"upi":return"\uD83D\uDCF1";case"mixed":return"\uD83D\uDD04";default:return"\uD83D\uDCB0"}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(sX,{onSearch:e=>{N(e),o(1),S(1,e)},isLoading:t}),i&&(0,a.jsx)(u.bZ,{variant:"destructive",children:(0,a.jsx)(u.X,{children:i})}),(0,a.jsxs)(m.Zb,{children:[(0,a.jsx)(m.Ol,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(m.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(O.Z,{className:"h-5 w-5"}),"Bill History"]}),(0,a.jsx)(m.SZ,{children:g>0?"Showing ".concat(e.length," of ").concat(g," bills"):"No bills found"})]}),(0,a.jsxs)(n.z,{variant:"outline",onClick:()=>S(d),disabled:t,children:[(0,a.jsx)(eF.Z,{className:"mr-2 h-4 w-4 ".concat(t?"animate-spin":"")}),"Refresh"]})]})}),(0,a.jsxs)(m.aY,{children:[(0,a.jsx)("div",{className:"border rounded-lg",children:(0,a.jsxs)(eU,{children:[(0,a.jsx)(eY,{children:(0,a.jsxs)(eV,{children:[(0,a.jsx)(eK,{children:"Bill Number"}),(0,a.jsx)(eK,{children:"Date & Time"}),(0,a.jsx)(eK,{children:"Customer"}),(0,a.jsx)(eK,{children:"Items"}),(0,a.jsx)(eK,{children:"Amount"}),(0,a.jsx)(eK,{children:"Payment"}),(0,a.jsx)(eK,{children:"Cashier"}),(0,a.jsx)(eK,{children:"Status"}),(0,a.jsx)(eK,{children:"Actions"})]})}),(0,a.jsx)(eq,{children:t?(0,a.jsx)(eV,{children:(0,a.jsxs)(eG,{colSpan:9,className:"text-center py-8",children:[(0,a.jsx)(x.Z,{className:"h-6 w-6 animate-spin mx-auto mb-2"}),"Loading bills..."]})}):0===e.length?(0,a.jsx)(eV,{children:(0,a.jsx)(eG,{colSpan:9,className:"text-center py-8 text-muted-foreground",children:"No bills found matching your criteria"})}):e.map(e=>{var s;return(0,a.jsxs)(eV,{className:"hover:bg-muted/50",children:[(0,a.jsx)(eG,{children:(0,a.jsx)("div",{className:"font-mono font-medium",children:e.billNumber})}),(0,a.jsx)(eG,{children:(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("div",{children:new Date(e.createdAt).toLocaleDateString()}),(0,a.jsx)("div",{className:"text-muted-foreground",children:new Date(e.createdAt).toLocaleTimeString()})]})}),(0,a.jsx)(eG,{children:(0,a.jsx)("div",{className:"text-sm",children:(null===(s=e.customer)||void 0===s?void 0:s.name)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"font-medium",children:e.customer.name}),e.customer.phone&&(0,a.jsx)("div",{className:"text-muted-foreground",children:e.customer.phone})]}):(0,a.jsx)("span",{className:"text-muted-foreground",children:"Walk-in Customer"})})}),(0,a.jsx)(eG,{children:(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsxs)("div",{className:"font-medium",children:[e.items.length," items"]}),(0,a.jsxs)("div",{className:"text-muted-foreground",children:["Qty: ",e.items.reduce((e,s)=>e+s.quantity,0)]})]})}),(0,a.jsx)(eG,{children:(0,a.jsx)("div",{className:"text-sm",children:(0,a.jsx)("div",{className:"font-medium",children:D(e.grandTotal)})})}),(0,a.jsxs)(eG,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 text-sm",children:[(0,a.jsx)("span",{children:P(e.paymentMethod)}),(0,a.jsx)("span",{className:"capitalize",children:e.paymentMethod})]}),e.changeDue>0&&(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Change: ",D(e.changeDue)]})]}),(0,a.jsx)(eG,{children:(0,a.jsx)("div",{className:"text-sm",children:(0,a.jsx)("div",{className:"font-medium",children:e.cashierName})})}),(0,a.jsx)(eG,{children:(0,a.jsx)(j.C,{variant:z(e.status),children:e.status.toUpperCase()})}),(0,a.jsx)(eG,{children:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(n.z,{variant:"ghost",size:"sm",onClick:()=>k(e),children:(0,a.jsx)(sG.Z,{className:"h-4 w-4"})}),(0,a.jsx)(n.z,{variant:"ghost",size:"sm",disabled:!0,children:(0,a.jsx)(sH.Z,{className:"h-4 w-4"})})]})})]},e._id)})})]})}),h>1&&(0,a.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Page ",d," of ",h," • ",g," total bills"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(n.z,{variant:"outline",size:"sm",onClick:()=>S(d-1),disabled:d<=1||t,children:"Previous"}),(0,a.jsx)(n.z,{variant:"outline",size:"sm",onClick:()=>S(d+1),disabled:d>=h||t,children:"Next"})]})]})]})]}),(0,a.jsx)(s$,{bill:y,isOpen:w,onClose:()=>{C(!1),b(null)}})]})}var s1=t(88501),s2=t(3085);function s4(e){let{startDate:s,endDate:t}=e,[r,n]=(0,l.useState)(null),[i,c]=(0,l.useState)(!0),[d,o]=(0,l.useState)(""),u=async()=>{try{c(!0),o("");let e=await ez.apiClient.getSalesSummary({startDate:s,endDate:t});n(e)}catch(e){o(e instanceof Error?e.message:"Failed to load sales data")}finally{c(!1)}};(0,l.useEffect)(()=>{u()},[s,t]);let x=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e);if(i)return(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(m.Zb,{children:(0,a.jsx)(m.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"animate-pulse",children:[(0,a.jsx)("div",{className:"h-4 bg-muted rounded w-3/4 mb-2"}),(0,a.jsx)("div",{className:"h-8 bg-muted rounded w-1/2"})]})})},s))});if(d||!r)return(0,a.jsx)(m.Zb,{children:(0,a.jsx)(m.aY,{className:"p-6 text-center text-muted-foreground",children:d||"No sales data available"})});let{totals:h}=r;return(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsx)(m.Zb,{children:(0,a.jsxs)(m.aY,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Sales"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:x(h.totalSales)})]}),(0,a.jsx)("div",{className:"bg-green-100 p-3 rounded-full",children:(0,a.jsx)(sT.Z,{className:"h-6 w-6 text-green-600"})})]}),(0,a.jsxs)("div",{className:"mt-2 flex items-center",children:[(0,a.jsx)(sY.Z,{className:"h-4 w-4 text-green-600 mr-1"}),(0,a.jsx)("span",{className:"text-sm text-green-600",children:"Revenue"})]})]})}),(0,a.jsx)(m.Zb,{children:(0,a.jsxs)(m.aY,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Bills"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:h.totalBills})]}),(0,a.jsx)("div",{className:"bg-blue-100 p-3 rounded-full",children:(0,a.jsx)(_.Z,{className:"h-6 w-6 text-blue-600"})})]}),(0,a.jsx)("div",{className:"mt-2 flex items-center",children:(0,a.jsxs)(j.C,{variant:"outline",className:"text-xs",children:["Avg: ",x(h.avgBillValue)]})})]})}),(0,a.jsx)(m.Zb,{children:(0,a.jsxs)(m.aY,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Items Sold"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:h.totalItems})]}),(0,a.jsx)("div",{className:"bg-purple-100 p-3 rounded-full",children:(0,a.jsx)(F.Z,{className:"h-6 w-6 text-purple-600"})})]}),(0,a.jsx)("div",{className:"mt-2 flex items-center",children:(0,a.jsxs)("span",{className:"text-sm text-muted-foreground",children:[h.totalBills>0?(h.totalItems/h.totalBills).toFixed(1):0," per bill"]})})]})}),(0,a.jsx)(m.Zb,{children:(0,a.jsxs)(m.aY,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Discount"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:x(h.totalDiscount)})]}),(0,a.jsx)("div",{className:"bg-orange-100 p-3 rounded-full",children:(0,a.jsx)(s2.Z,{className:"h-6 w-6 text-orange-600"})})]}),(0,a.jsx)("div",{className:"mt-2 flex items-center",children:(0,a.jsxs)("span",{className:"text-sm text-muted-foreground",children:[h.totalSales>0?(h.totalDiscount/h.totalSales*100).toFixed(1):0,"% of sales"]})})]})})]})}function s3(e){let{startDate:s,endDate:t,limit:r=10}=e,[n,i]=(0,l.useState)([]),[c,d]=(0,l.useState)(!0),[o,u]=(0,l.useState)(""),x=async()=>{try{d(!0),u("");let e=await ez.apiClient.getTopProducts({startDate:s,endDate:t,limit:r});i(e)}catch(e){u(e instanceof Error?e.message:"Failed to load top products")}finally{d(!1)}};(0,l.useEffect)(()=>{x()},[s,t,r]);let h=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e);return(0,a.jsxs)(m.Zb,{children:[(0,a.jsxs)(m.Ol,{children:[(0,a.jsxs)(m.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(F.Z,{className:"h-5 w-5"}),"Top Selling Products"]}),(0,a.jsx)(m.SZ,{children:"Best performing products by revenue"})]}),(0,a.jsx)(m.aY,{children:c?(0,a.jsx)("div",{className:"space-y-3",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)("div",{className:"animate-pulse",children:(0,a.jsx)("div",{className:"h-4 bg-muted rounded w-full mb-2"})},s))}):o?(0,a.jsx)("div",{className:"text-center text-muted-foreground py-8",children:o}):0===n.length?(0,a.jsx)("div",{className:"text-center text-muted-foreground py-8",children:"No products data available"}):(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)(eU,{children:[(0,a.jsx)(eY,{children:(0,a.jsxs)(eV,{children:[(0,a.jsx)(eK,{children:"Rank"}),(0,a.jsx)(eK,{children:"Product"}),(0,a.jsx)(eK,{className:"text-right",children:"Quantity"}),(0,a.jsx)(eK,{className:"text-right",children:"Revenue"}),(0,a.jsx)(eK,{className:"text-right",children:"Orders"})]})}),(0,a.jsx)(eq,{children:n.map((e,s)=>(0,a.jsxs)(eV,{children:[(0,a.jsx)(eG,{children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(j.C,{variant:s<3?"default":"outline",className:"w-8 h-8 rounded-full p-0 flex items-center justify-center",children:s+1}),0===s&&(0,a.jsx)(sY.Z,{className:"h-4 w-4 text-green-600"})]})}),(0,a.jsx)(eG,{children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e._id.productName}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Code: ",e._id.productCode]})]})}),(0,a.jsx)(eG,{className:"text-right font-medium",children:e.totalQuantity}),(0,a.jsx)(eG,{className:"text-right font-medium text-green-600",children:h(e.totalRevenue)}),(0,a.jsx)(eG,{className:"text-right",children:e.totalOrders})]},e._id.productId))})]})})})]})}var s5=t(77031),s6=t(56940),s8=t(97059),s9=t(62994),s7=t(8147),te=t(22190),ts=t(31699),tt=t(5481),ta=t(23263),tl=t(21156),tr=t(54061),tn=t(47625),ti=t(75169),tc=t(3574),td=t(20407),to=t(42488),tm=t(40370);let tu=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8","#82CA9D"];function tx(e){let{startDate:s,endDate:t}=e,[r,i]=(0,l.useState)([]),[c,d]=(0,l.useState)([]),[o,u]=(0,l.useState)(!0),[x,h]=(0,l.useState)(""),[p,j]=(0,l.useState)("line"),[g,f]=(0,l.useState)("daily"),v=async()=>{try{u(!0),h("");let e=(await ez.apiClient.getSalesSummary({startDate:s,endDate:t,period:g})).salesData.map(e=>{let s="";return"daily"===g?s="".concat(e._id.day,"/").concat(e._id.month,"/").concat(e._id.year):"weekly"===g?s="Week ".concat(e._id.week,", ").concat(e._id.year):"monthly"===g&&(s="".concat(["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e._id.month-1]," ").concat(e._id.year)),{date:s,sales:e.totalSales,bills:e.totalBills,items:e.totalItems,discount:e.totalDiscount,tax:e.totalTax}});i(e);let a=await ez.apiClient.getPaymentMethodsReport({startDate:s,endDate:t}),l=a.reduce((e,s)=>e+s.totalAmount,0),r=a.map(e=>({method:e._id,count:e.totalTransactions,amount:e.totalAmount,percentage:l>0?e.totalAmount/l*100:0}));d(r)}catch(e){h(e instanceof Error?e.message:"Failed to load chart data")}finally{u(!1)}};(0,l.useEffect)(()=>{v()},[s,t,g]);let N=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),y=e=>{let{active:s,payload:t,label:l}=e;return s&&t&&t.length?(0,a.jsxs)("div",{className:"bg-white p-3 border rounded-lg shadow-lg",children:[(0,a.jsx)("p",{className:"font-semibold text-gray-800",children:l}),t.map((e,s)=>(0,a.jsxs)("p",{style:{color:e.color},children:["sales"===e.dataKey&&"Sales: ".concat(N(e.value)),"bills"===e.dataKey&&"Bills: ".concat(e.value),"items"===e.dataKey&&"Items: ".concat(e.value),"discount"===e.dataKey&&"Discount: ".concat(N(e.value)),"tax"===e.dataKey&&"Tax: ".concat(N(e.value))]},s))]}):null};return o?(0,a.jsxs)(m.Zb,{children:[(0,a.jsxs)(m.Ol,{children:[(0,a.jsxs)(m.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(to.Z,{className:"h-5 w-5"}),"Sales Trends"]}),(0,a.jsx)(m.SZ,{children:"Daily sales performance over time"})]}),(0,a.jsx)(m.aY,{children:(0,a.jsxs)("div",{className:"animate-pulse",children:[(0,a.jsx)("div",{className:"h-64 bg-muted rounded mb-4"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("div",{className:"h-8 bg-muted rounded w-20"}),(0,a.jsx)("div",{className:"h-8 bg-muted rounded w-20"}),(0,a.jsx)("div",{className:"h-8 bg-muted rounded w-20"})]})]})})]}):x?(0,a.jsxs)(m.Zb,{children:[(0,a.jsxs)(m.Ol,{children:[(0,a.jsxs)(m.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(to.Z,{className:"h-5 w-5"}),"Sales Trends"]}),(0,a.jsx)(m.SZ,{children:"Daily sales performance over time"})]}),(0,a.jsx)(m.aY,{children:(0,a.jsx)("div",{className:"text-center text-muted-foreground py-8",children:x})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(m.Zb,{children:[(0,a.jsx)(m.Ol,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(m.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(to.Z,{className:"h-5 w-5"}),"Sales Trends"]}),(0,a.jsx)(m.SZ,{children:"Daily sales performance over time"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(n.z,{variant:"line"===p?"default":"outline",size:"sm",onClick:()=>j("line"),children:"Line"}),(0,a.jsx)(n.z,{variant:"bar"===p?"default":"outline",size:"sm",onClick:()=>j("bar"),children:"Bar"}),(0,a.jsx)(n.z,{variant:"area"===p?"default":"outline",size:"sm",onClick:()=>j("area"),children:"Area"})]})]})}),(0,a.jsx)(m.aY,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(n.z,{variant:"daily"===g?"default":"outline",size:"sm",onClick:()=>f("daily"),children:"Daily"}),(0,a.jsx)(n.z,{variant:"weekly"===g?"default":"outline",size:"sm",onClick:()=>f("weekly"),children:"Weekly"}),(0,a.jsx)(n.z,{variant:"monthly"===g?"default":"outline",size:"sm",onClick:()=>f("monthly"),children:"Monthly"})]}),(0,a.jsx)("div",{className:"h-64",children:(0,a.jsx)(tn.h,{width:"100%",height:"100%",children:(()=>{let e={data:r,margin:{top:5,right:30,left:20,bottom:5}};switch(p){case"bar":return(0,a.jsxs)(s5.v,{...e,children:[(0,a.jsx)(s6.q,{strokeDasharray:"3 3"}),(0,a.jsx)(s8.K,{dataKey:"date"}),(0,a.jsx)(s9.B,{}),(0,a.jsx)(s7.u,{content:(0,a.jsx)(y,{})}),(0,a.jsx)(te.D,{}),(0,a.jsx)(ts.$,{dataKey:"sales",fill:"#8884d8",name:"Sales Amount"}),(0,a.jsx)(ts.$,{dataKey:"discount",fill:"#82ca9d",name:"Discount"})]});case"area":return(0,a.jsxs)(tt.T,{...e,children:[(0,a.jsx)(s6.q,{strokeDasharray:"3 3"}),(0,a.jsx)(s8.K,{dataKey:"date"}),(0,a.jsx)(s9.B,{}),(0,a.jsx)(s7.u,{content:(0,a.jsx)(y,{})}),(0,a.jsx)(te.D,{}),(0,a.jsx)(ta.u,{type:"monotone",dataKey:"sales",stackId:"1",stroke:"#8884d8",fill:"#8884d8",name:"Sales Amount"}),(0,a.jsx)(ta.u,{type:"monotone",dataKey:"discount",stackId:"2",stroke:"#82ca9d",fill:"#82ca9d",name:"Discount"})]});default:return(0,a.jsxs)(tl.w,{...e,children:[(0,a.jsx)(s6.q,{strokeDasharray:"3 3"}),(0,a.jsx)(s8.K,{dataKey:"date"}),(0,a.jsx)(s9.B,{}),(0,a.jsx)(s7.u,{content:(0,a.jsx)(y,{})}),(0,a.jsx)(te.D,{}),(0,a.jsx)(tr.x,{type:"monotone",dataKey:"sales",stroke:"#8884d8",name:"Sales Amount",strokeWidth:2}),(0,a.jsx)(tr.x,{type:"monotone",dataKey:"bills",stroke:"#82ca9d",name:"Number of Bills",strokeWidth:2})]})}})()})})]})})]}),(0,a.jsxs)(m.Zb,{children:[(0,a.jsxs)(m.Ol,{children:[(0,a.jsxs)(m.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(tm.Z,{className:"h-5 w-5"}),"Payment Methods Distribution"]}),(0,a.jsx)(m.SZ,{children:"Breakdown of payment methods used"})]}),(0,a.jsx)(m.aY,{children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsx)("div",{className:"h-48",children:(0,a.jsx)(tn.h,{width:"100%",height:"100%",children:(0,a.jsxs)(ti.u,{children:[(0,a.jsx)(tc.b,{data:c,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{method:s,percentage:t}=e;return"".concat(s,": ").concat(t.toFixed(1),"%")},outerRadius:60,fill:"#8884d8",dataKey:"amount",children:c.map((e,s)=>(0,a.jsx)(td.b,{fill:tu[s%tu.length]},"cell-".concat(s)))}),(0,a.jsx)(s7.u,{formatter:e=>N(e)})]})})}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h4",{className:"font-semibold",children:"Payment Method Details"}),c.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:tu[s%tu.length]}}),(0,a.jsx)("span",{className:"font-medium",children:e.method})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"font-semibold",children:N(e.amount)}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:[e.count," bills"]})]})]},e.method))]})]})})]})]})}var th=t(962);function tp(e){let{...s}=e;return(0,a.jsx)(th.fC,{"data-slot":"collapsible",...s})}function tj(e){let{...s}=e;return(0,a.jsx)(th.Fw,{"data-slot":"collapsible-content",...s})}var tg=t(49474),tf=t(10407),tv=t(66142);let tN=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884d8","#82ca9d","#ffc658","#ff7300"];function ty(e){let{startDate:s,endDate:t}=e,[r,c]=(0,l.useState)([]),[d,o]=(0,l.useState)([]),[u,x]=(0,l.useState)([]),[h,p]=(0,l.useState)(!0),[g,f]=(0,l.useState)(null),[v,N]=(0,l.useState)("bar"),[y,b]=(0,l.useState)("bar"),[w,C]=(0,l.useState)(new Set);(0,l.useEffect)(()=>{Promise.all([S(),k(),D()])},[s,t]);let S=async()=>{try{p(!0),f(null);let e=await ez.apiClient.getCategoriesPerformance({startDate:s,endDate:t});c(e)}catch(e){console.error("Error fetching categories performance:",e),f("Failed to fetch categories performance data")}finally{p(!1)}},k=async()=>{try{let e=await ez.apiClient.get("/reports/top-products-by-category?startDate=".concat(s||"","&endDate=").concat(t||""));o(e)}catch(e){console.error("Error fetching top products by category:",e)}},D=async()=>{try{let e=await ez.apiClient.get("/reports/top-products?startDate=".concat(s||"","&endDate=").concat(t||"","&limit=10"));x(e)}catch(e){console.error("Error fetching top products:",e)}},z=e=>{let s=new Set(w);s.has(e)?s.delete(e):s.add(e),C(s)},P=e=>{let s=d.find(s=>s.category===e);return s?s.products:[]};return h?(0,a.jsxs)(m.Zb,{children:[(0,a.jsxs)(m.Ol,{children:[(0,a.jsxs)(m.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(sY.Z,{className:"h-5 w-5"}),"Product Categories Performance"]}),(0,a.jsx)(m.SZ,{children:"Loading categories performance data..."})]}),(0,a.jsx)(m.aY,{children:(0,a.jsx)("div",{className:"h-64 flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})})]}):g?(0,a.jsxs)(m.Zb,{children:[(0,a.jsxs)(m.Ol,{children:[(0,a.jsxs)(m.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(sY.Z,{className:"h-5 w-5"}),"Product Categories Performance"]}),(0,a.jsx)(m.SZ,{children:"Error loading data"})]}),(0,a.jsx)(m.aY,{children:(0,a.jsx)("div",{className:"h-64 flex items-center justify-center text-red-500",children:g})})]}):(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)(m.Zb,{children:[(0,a.jsx)(m.Ol,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(m.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(sY.Z,{className:"h-5 w-5"}),"Product Categories Performance"]}),(0,a.jsx)(m.SZ,{children:"Revenue and quantity by product category"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(n.z,{variant:"bar"===v?"default":"outline",size:"sm",onClick:()=>N("bar"),children:"Bar"}),(0,a.jsx)(n.z,{variant:"pie"===v?"default":"outline",size:"sm",onClick:()=>N("pie"),children:"Pie"})]})]})}),(0,a.jsx)(m.aY,{children:(0,a.jsx)("div",{className:"h-64",children:(0,a.jsx)(tn.h,{width:"100%",height:"100%",children:"bar"===v?(0,a.jsxs)(s5.v,{data:r,children:[(0,a.jsx)(s6.q,{strokeDasharray:"3 3"}),(0,a.jsx)(s8.K,{dataKey:"category",angle:-45,textAnchor:"end",height:80,fontSize:12}),(0,a.jsx)(s9.B,{tick:{fontSize:12},width:60}),(0,a.jsx)(s7.u,{formatter:(e,s)=>"totalRevenue"===s?(0,i.x)(e):e.toLocaleString()}),(0,a.jsx)(te.D,{}),(0,a.jsx)(ts.$,{dataKey:"totalRevenue",fill:"#8884d8",name:"Total Revenue"}),(0,a.jsx)(ts.$,{dataKey:"totalQuantity",fill:"#82ca9d",name:"Total Quantity"})]}):(0,a.jsxs)(ti.u,{children:[(0,a.jsx)(tc.b,{data:r,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{category:s,totalRevenue:t}=e;return"".concat(s,": ").concat((0,i.x)(t))},outerRadius:80,fill:"#8884d8",dataKey:"totalRevenue",children:r.map((e,s)=>(0,a.jsx)(td.b,{fill:tN[s%tN.length]},"cell-".concat(s)))}),(0,a.jsx)(s7.u,{formatter:e=>(0,i.x)(e)})]})})})})]}),(0,a.jsxs)(m.Zb,{children:[(0,a.jsxs)(m.Ol,{children:[(0,a.jsxs)(m.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(tm.Z,{className:"h-5 w-5"}),"Category Details"]}),(0,a.jsx)(m.SZ,{children:"Detailed breakdown of each category's performance"})]}),(0,a.jsx)(m.aY,{children:(0,a.jsx)("div",{className:"space-y-3",children:r.map((e,s)=>{let t=0===s,l=1===s,n=r.length>0?e.totalRevenue/r[0].totalRevenue*100:0,c=P(e.category),d=w.has(e.category);return(0,a.jsxs)(tp,{open:d,onOpenChange:()=>z(e.category),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg transition-all hover:shadow-md cursor-pointer ".concat(t?"bg-gradient-to-r from-yellow-50 to-amber-50 dark:from-yellow-950/20 dark:to-amber-950/10 border-yellow-200 dark:border-yellow-800":l?"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-950/20 dark:to-indigo-950/10 border-blue-200 dark:border-blue-800":"bg-background"),onClick:()=>z(e.category),children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[t?(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-yellow-400 to-amber-500 flex items-center justify-center text-white font-bold text-sm shadow-sm",children:(0,a.jsx)(tg.Z,{className:"w-4 h-4"})}):l?(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-blue-400 to-indigo-500 flex items-center justify-center text-white font-bold text-sm shadow-sm",children:(0,a.jsx)(eR.Z,{className:"w-4 h-4"})}):(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-muted flex items-center justify-center text-muted-foreground font-bold text-sm",children:s+1}),(0,a.jsx)("div",{className:"w-4 h-4 rounded-full mt-1",style:{backgroundColor:tN[s%tN.length]}})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"font-semibold text-base text-foreground",children:e.category}),t&&(0,a.jsx)(j.C,{className:"bg-gradient-to-r from-yellow-400 to-amber-500 text-white border-none text-xs",children:"Best Seller"}),l&&(0,a.jsx)(j.C,{variant:"secondary",className:"bg-gradient-to-r from-blue-400 to-indigo-500 text-white text-xs",children:"Top Performer"}),c.length>0&&(0,a.jsxs)(j.C,{variant:"outline",className:"text-xs",children:[c.length," top products"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm text-muted-foreground mt-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(F.Z,{className:"w-3 h-3"}),(0,a.jsxs)("span",{children:[e.totalQuantity.toLocaleString()," items"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(_.Z,{className:"w-3 h-3"}),(0,a.jsxs)("span",{children:[e.totalOrders," orders"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(eR.Z,{className:"w-3 h-3"}),(0,a.jsxs)("span",{children:[e.uniqueProductsCount," products"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(sY.Z,{className:"w-3 h-3"}),(0,a.jsxs)("span",{children:[(0,i.x)(e.totalRevenue/e.totalQuantity),"/item"]})]})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(sT.Z,{className:"w-4 h-4 text-green-600 dark:text-green-400"}),(0,a.jsx)("span",{className:"font-bold text-lg text-green-700 dark:text-green-400",children:(0,i.x)(e.totalRevenue)})]}),(0,a.jsxs)("div",{className:"space-y-1 mt-2",children:[(0,a.jsx)("div",{className:"flex items-center justify-end gap-1 text-sm text-muted-foreground",children:(0,a.jsxs)("span",{children:["Avg: ",(0,i.x)(e.avgOrderValue),"/order"]})}),(0,a.jsx)("div",{className:"flex items-center justify-end gap-1 text-xs text-muted-foreground",children:(0,a.jsxs)("span",{children:[(e.totalRevenue/r.reduce((e,s)=>e+s.totalRevenue,0)*100).toFixed(1),"% of total"]})}),n<100&&(0,a.jsx)("div",{className:"flex items-center justify-end gap-1 text-xs text-muted-foreground",children:(0,a.jsxs)("span",{children:[n.toFixed(1),"% of top"]})})]}),(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsxs)(j.C,{variant:"outline",className:"text-xs ".concat(t?"border-green-200 text-green-700 dark:border-green-800 dark:text-green-400":l?"border-blue-200 text-blue-700 dark:border-blue-800 dark:text-blue-400":"border-gray-200 text-gray-600 dark:border-gray-700 dark:text-gray-400"),children:["#",s+1," Rank"]})})]}),(0,a.jsx)("div",{className:"flex flex-col items-center",children:d?(0,a.jsx)(K.Z,{className:"w-5 h-5 text-muted-foreground"}):(0,a.jsx)(tf.Z,{className:"w-5 h-5 text-muted-foreground"})})]})]}),(0,a.jsx)(tj,{className:"mt-2",children:(0,a.jsxs)("div",{className:"ml-16 p-4 bg-muted/50 rounded-lg border border-border",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(tv.Z,{className:"w-4 h-4 text-amber-600"}),(0,a.jsxs)("span",{className:"font-medium text-sm text-foreground",children:["Top Products in ",e.category]})]}),(0,a.jsxs)(j.C,{variant:"outline",className:"text-xs",children:[c.length," products"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2 mb-3 text-xs text-muted-foreground bg-background/50 p-2 rounded",children:[(0,a.jsx)("div",{className:"text-center",children:"Product"}),(0,a.jsx)("div",{className:"text-center",children:"Revenue"}),(0,a.jsx)("div",{className:"text-center",children:"Avg Price"})]}),c.length>0?(0,a.jsx)("div",{className:"space-y-2",children:c.map((s,t)=>(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2 p-3 bg-background rounded-lg border border-border items-center",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-6 h-6 rounded-full bg-gradient-to-r from-amber-100 to-yellow-100 dark:from-amber-900/30 dark:to-yellow-900/30 flex items-center justify-center text-amber-700 dark:text-amber-300 font-bold text-xs",children:t+1}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-sm text-foreground truncate",title:s.productName,children:s.productName}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:[s.totalQuantity.toLocaleString()," • ",s.totalOrders," orders"]})]})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"font-semibold text-green-700 dark:text-green-400",children:(0,i.x)(s.totalRevenue)}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:[(s.totalRevenue/e.totalRevenue*100).toFixed(1),"% of category"]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"font-semibold text-blue-700 dark:text-blue-400",children:(0,i.x)(s.avgPrice)}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"avg price"})]})]},s.productId))}):(0,a.jsx)("div",{className:"text-center py-4 text-muted-foreground text-sm",children:"No product data available for this category"})]})})]},e.category)})})})]}),(0,a.jsxs)(m.Zb,{className:"lg:col-span-2",children:[(0,a.jsx)(m.Ol,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(m.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(tg.Z,{className:"h-5 w-5"}),"Best Selling Products Performance"]}),(0,a.jsx)(m.SZ,{children:"Revenue and quantity analysis of top-performing products"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(n.z,{variant:"bar"===y?"default":"outline",size:"sm",onClick:()=>b("bar"),children:"Bar"}),(0,a.jsx)(n.z,{variant:"pie"===y?"default":"outline",size:"sm",onClick:()=>b("pie"),children:"Pie"})]})]})}),(0,a.jsxs)(m.aY,{children:[(0,a.jsx)("div",{className:"h-80",children:(0,a.jsx)(tn.h,{width:"100%",height:"100%",children:(()=>{let e=u.map(e=>({...e,productId:e._id.productId,productName:e._id.productName,productCode:e._id.productCode}));return"bar"===y?(0,a.jsxs)(s5.v,{data:e,children:[(0,a.jsx)(s6.q,{strokeDasharray:"3 3"}),(0,a.jsx)(s8.K,{dataKey:"productName",angle:-45,textAnchor:"end",height:100,fontSize:10,interval:0}),(0,a.jsx)(s9.B,{tick:{fontSize:12},width:80}),(0,a.jsx)(s7.u,{formatter:(e,s)=>"totalRevenue"===s||"avgPrice"===s?(0,i.x)(e):e.toLocaleString(),labelFormatter:e=>"Product: ".concat(e)}),(0,a.jsx)(te.D,{}),(0,a.jsx)(ts.$,{dataKey:"totalRevenue",fill:"#10B981",name:"Total Revenue"}),(0,a.jsx)(ts.$,{dataKey:"totalQuantity",fill:"#3B82F6",name:"Quantity Sold"})]}):(0,a.jsxs)(ti.u,{children:[(0,a.jsx)(tc.b,{data:e,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{productName:s,totalRevenue:t}=e;return"".concat(s.substring(0,15),"...: ").concat((0,i.x)(t))},outerRadius:80,fill:"#8884d8",dataKey:"totalRevenue",nameKey:"productName",children:e.map((e,s)=>(0,a.jsx)(td.b,{fill:tN[s%tN.length]},"cell-".concat(s)))}),(0,a.jsx)(s7.u,{formatter:e=>(0,i.x)(e),labelFormatter:e=>"Product: ".concat(e)}),(0,a.jsx)(te.D,{})]})})()})}),(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,a.jsx)(tv.Z,{className:"w-4 h-4 text-amber-600"}),(0,a.jsx)("h3",{className:"font-semibold text-sm",children:"Top 10 Best Selling Products"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-5 gap-2 mb-3 text-xs text-muted-foreground bg-muted/50 p-2 rounded font-medium",children:[(0,a.jsx)("div",{children:"Rank"}),(0,a.jsx)("div",{children:"Product Name"}),(0,a.jsx)("div",{className:"text-center",children:"Revenue"}),(0,a.jsx)("div",{className:"text-center",children:"Quantity"}),(0,a.jsx)("div",{className:"text-center",children:"Avg Price"})]}),(0,a.jsx)("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:u.map((e,s)=>{let t=e._id.productId,l=e._id.productName;return e._id.productCode,(0,a.jsxs)("div",{className:"grid grid-cols-5 gap-2 p-2 bg-background rounded border border-border text-sm",children:[(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold text-white ".concat(0===s?"bg-gradient-to-r from-yellow-400 to-amber-500":1===s?"bg-gradient-to-r from-gray-300 to-gray-400":2===s?"bg-gradient-to-r from-amber-600 to-amber-700":"bg-gradient-to-r from-blue-500 to-blue-600"),children:s+1})}),(0,a.jsx)("div",{className:"font-medium truncate",title:l,children:l}),(0,a.jsx)("div",{className:"text-center font-semibold text-green-700 dark:text-green-400",children:(0,i.x)(e.totalRevenue)}),(0,a.jsx)("div",{className:"text-center text-blue-700 dark:text-blue-400",children:e.totalQuantity.toLocaleString()}),(0,a.jsx)("div",{className:"text-center text-muted-foreground",children:(0,i.x)(e.avgPrice)})]},t)})})]})]})]})]})}function tb(){let[e,s]=(0,l.useState)(""),[t,r]=(0,l.useState)(""),i=e=>{let t=new Date,a=new Date;a.setDate(a.getDate()-e),s(a.toISOString().split("T")[0]),r(t.toISOString().split("T")[0])};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(m.Zb,{children:[(0,a.jsxs)(m.Ol,{children:[(0,a.jsxs)(m.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(s1.Z,{className:"h-5 w-5"}),"Reports & Analytics"]}),(0,a.jsx)(m.SZ,{children:"Comprehensive business insights and performance metrics"})]}),(0,a.jsx)(m.aY,{children:(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4 items-end",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 flex-1",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"startDate",children:"Start Date"}),(0,a.jsx)(c,{id:"startDate",type:"date",value:e,onChange:e=>s(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"endDate",children:"End Date"}),(0,a.jsx)(c,{id:"endDate",type:"date",value:t,onChange:e=>r(e.target.value)})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,a.jsx)(n.z,{variant:"outline",size:"sm",onClick:()=>i(7),children:"Last 7 Days"}),(0,a.jsx)(n.z,{variant:"outline",size:"sm",onClick:()=>i(30),children:"Last 30 Days"}),(0,a.jsx)(n.z,{variant:"outline",size:"sm",onClick:()=>i(90),children:"Last 90 Days"}),(0,a.jsx)(n.z,{variant:"outline",size:"sm",onClick:()=>{s(""),r("")},children:"Clear"})]})]})})]}),(0,a.jsxs)(sI,{defaultValue:"sales",className:"w-full",children:[(0,a.jsxs)(s_,{className:"grid w-full grid-cols-2",children:[(0,a.jsx)(sE,{value:"sales",children:"Sales Analytics"}),(0,a.jsx)(sE,{value:"products",children:"Product Performance"})]}),(0,a.jsxs)(sF,{value:"sales",className:"space-y-6",children:[(0,a.jsx)(s4,{startDate:e,endDate:t}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsx)(tx,{startDate:e,endDate:t})}),(0,a.jsx)(s3,{startDate:e,endDate:t,limit:10})]})]}),(0,a.jsxs)(sF,{value:"products",className:"space-y-6",children:[(0,a.jsx)(s3,{startDate:e,endDate:t,limit:20}),(0,a.jsx)(ty,{startDate:e,endDate:t})]})]})]})}var tw=t(98420);function tC(){let[e,s]=(0,l.useState)(null),[t,r]=(0,l.useState)(!0),[i,c]=(0,l.useState)(""),[d,o]=(0,l.useState)(!1),[u,x]=(0,l.useState)(!1),[h,p]=(0,l.useState)(""),g=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{r(!0),c("");let t=await ez.apiClient.getInventoryReport({lowStock:e});s(t)}catch(e){c(e instanceof Error?e.message:"Failed to load inventory data")}finally{r(!1)}},f=async()=>{try{x(!0),p(""),await ez.apiClient.sendLowStockEmail(),p("✅ Low stock email sent successfully!")}catch(e){p("❌ Error sending email: ".concat(e instanceof Error?e.message:"Unknown error"))}finally{x(!1)}};(0,l.useEffect)(()=>{g(d)},[d]);let v=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e),N=e=>e<5?{label:"Out of Stock",variant:"destructive",icon:sL.Z}:e<20?{label:"Low Stock",variant:"secondary",icon:s2.Z}:{label:"In Stock",variant:"default",icon:F.Z};return(0,a.jsxs)("div",{className:"space-y-6",children:[e&&(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsx)(m.Zb,{children:(0,a.jsx)(m.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Products"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:e.summary.totalProducts})]}),(0,a.jsx)("div",{className:"bg-blue-100 p-3 rounded-full",children:(0,a.jsx)(F.Z,{className:"h-6 w-6 text-blue-600"})})]})})}),(0,a.jsx)(m.Zb,{children:(0,a.jsx)(m.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Inventory Value"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:v(e.summary.inventoryValue)})]}),(0,a.jsx)("div",{className:"bg-green-100 p-3 rounded-full",children:(0,a.jsx)(tw.Z,{className:"h-6 w-6 text-green-600"})})]})})}),(0,a.jsx)(m.Zb,{children:(0,a.jsx)(m.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Low Stock"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:e.summary.lowStockCount})]}),(0,a.jsx)("div",{className:"bg-orange-100 p-3 rounded-full",children:(0,a.jsx)(s2.Z,{className:"h-6 w-6 text-orange-600"})})]})})}),(0,a.jsx)(m.Zb,{children:(0,a.jsx)(m.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Out of Stock"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-red-600",children:e.summary.outOfStockCount})]}),(0,a.jsx)("div",{className:"bg-red-100 p-3 rounded-full",children:(0,a.jsx)(sL.Z,{className:"h-6 w-6 text-red-600"})})]})})})]}),(0,a.jsxs)(m.Zb,{children:[(0,a.jsxs)(m.Ol,{children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(m.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(F.Z,{className:"h-5 w-5"}),"Inventory Status"]}),(0,a.jsx)(m.SZ,{children:d?"Products with low stock levels":"All active products"})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,a.jsxs)(n.z,{variant:"outline",onClick:f,disabled:u||!e||0===e.summary.lowStockCount,className:"flex items-center gap-2",children:[(0,a.jsx)(sW.Z,{className:"h-4 w-4"}),u?"Sending...":"Send Low Stock Email"]}),(0,a.jsx)(n.z,{variant:d?"default":"outline",onClick:()=>o(!d),children:d?"Show All":"Show Low Stock"})]})]}),h&&(0,a.jsx)("div",{className:"space-y-1",children:(0,a.jsx)("div",{className:"text-sm p-2 rounded bg-muted",children:h})})]}),(0,a.jsx)(m.aY,{children:t?(0,a.jsx)("div",{className:"space-y-3",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)("div",{className:"animate-pulse",children:(0,a.jsx)("div",{className:"h-4 bg-muted rounded w-full mb-2"})},s))}):i?(0,a.jsx)("div",{className:"text-center text-muted-foreground py-8",children:i}):e&&0!==e.products.length?(0,a.jsxs)(eU,{children:[(0,a.jsx)(eY,{children:(0,a.jsxs)(eV,{children:[(0,a.jsx)(eK,{children:"Product"}),(0,a.jsx)(eK,{children:"Category"}),(0,a.jsx)(eK,{className:"text-right",children:"Stock"}),(0,a.jsx)(eK,{className:"text-right",children:"Cost Value"}),(0,a.jsx)(eK,{children:"Status"})]})}),(0,a.jsx)(eq,{children:e.products.slice(0,20).map(e=>{let s=N(e.stock),t=s.icon;return(0,a.jsxs)(eV,{children:[(0,a.jsx)(eG,{children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e.name}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Code: ",e.code]})]})}),(0,a.jsx)(eG,{children:e.category}),(0,a.jsx)(eG,{className:"text-right",children:(0,a.jsxs)("div",{className:"font-medium",children:[e.stock," ",e.unit]})}),(0,a.jsx)(eG,{className:"text-right",children:v(e.stock*e.cost)}),(0,a.jsx)(eG,{children:(0,a.jsxs)(j.C,{variant:s.variant,className:"flex items-center gap-1 w-fit",children:[(0,a.jsx)(t,{className:"h-3 w-3"}),s.label]})})]},e._id)})})]}):(0,a.jsx)("div",{className:"text-center text-muted-foreground py-8",children:"No products found"})})]})]})}var tS=t(16023);function tk(e){let{employee:s,onSuccess:t,onCancel:r}=e,[i,d]=(0,l.useState)({email:(null==s?void 0:s.user.email)||"",password:"",role:"cashier",employeeId:(null==s?void 0:s.user.employeeId)||"",firstName:(null==s?void 0:s.personalDetails.firstName)||"",lastName:(null==s?void 0:s.personalDetails.lastName)||"",dateOfBirth:(null==s?void 0:s.personalDetails.dateOfBirth)?new Date(s.personalDetails.dateOfBirth).toISOString().split("T")[0]:"",gender:(null==s?void 0:s.personalDetails.gender)||"",bloodGroup:(null==s?void 0:s.personalDetails.bloodGroup)||"",phone:(null==s?void 0:s.contactDetails.phone)||"",emergencyPhone:(null==s?void 0:s.contactDetails.emergencyPhone)||"",street:(null==s?void 0:s.contactDetails.address.street)||"",city:(null==s?void 0:s.contactDetails.address.city)||"",state:(null==s?void 0:s.contactDetails.address.state)||"",postalCode:(null==s?void 0:s.contactDetails.address.postalCode)||"",country:(null==s?void 0:s.contactDetails.address.country)||"India",aadhaarNumber:(null==s?void 0:s.identification.aadhaarNumber)||"",panNumber:(null==s?void 0:s.identification.panNumber)||"",department:"cashier",position:(null==s?void 0:s.employmentDetails.position)||"Cashier",dateOfJoining:(null==s?void 0:s.employmentDetails.dateOfJoining)?new Date(s.employmentDetails.dateOfJoining).toISOString().split("T")[0]:"",salary:(null==s?void 0:s.employmentDetails.salary)||0,status:(null==s?void 0:s.status)||"active"}),[u,x]=(0,l.useState)({aadhaarCard:null,panCard:null,photo:null}),[h,p]=(0,l.useState)(!1),{toast:j}=sw(),g=(e,s)=>{d(t=>({...t,[e]:s}))},f=(e,s)=>{x(t=>({...t,[e]:s}))},v=async e=>{e.preventDefault(),p(!0);try{let e=new FormData;e.append("email",i.email),e.append("password",i.password),e.append("role",i.role),e.append("employeeId",i.employeeId),e.append("personalDetails",JSON.stringify({firstName:i.firstName,lastName:i.lastName,dateOfBirth:i.dateOfBirth,gender:i.gender,bloodGroup:i.bloodGroup})),e.append("contactDetails",JSON.stringify({phone:i.phone,emergencyPhone:i.emergencyPhone,address:{street:i.street,city:i.city,state:i.state,postalCode:i.postalCode,country:i.country}})),e.append("identification",JSON.stringify({aadhaarNumber:i.aadhaarNumber,panNumber:i.panNumber})),e.append("employmentDetails",JSON.stringify({department:i.department,position:i.position,dateOfJoining:i.dateOfJoining,salary:i.salary||0})),u.aadhaarCard&&e.append("aadhaarCard",u.aadhaarCard),u.panCard&&e.append("panCard",u.panCard),u.photo&&e.append("photo",u.photo);let a=s?"http://localhost:5001/api/employees/".concat(s._id):"http://localhost:5001/api/employees",l=tS.O.getToken(),r=await fetch(a,{method:s?"PUT":"POST",body:e,headers:{Authorization:"Bearer ".concat(l)}});if(!r.ok){let e=await r.json();throw console.error("Server error response:",e),Error(e.message||e.error||"Failed to save employee (Status: ".concat(r.status,")"))}await r.json(),j({title:"Success",description:s?"Employee updated successfully":"Employee created successfully"}),t()}catch(e){console.error("Form submission error:",e),j({title:"Error",description:e instanceof Error?e.message:"Failed to save employee",variant:"destructive"})}finally{p(!1)}};return(0,a.jsxs)("form",{onSubmit:v,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)(m.Zb,{children:[(0,a.jsx)(m.Ol,{children:(0,a.jsx)(m.ll,{children:"User Account Details"})}),(0,a.jsxs)(m.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{htmlFor:"email",children:"Email"}),(0,a.jsx)(c,{id:"email",type:"email",value:i.email,onChange:e=>g("email",e.target.value),required:!0})]}),!s&&(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{htmlFor:"password",children:"Password"}),(0,a.jsx)(c,{id:"password",type:"password",value:i.password,onChange:e=>g("password",e.target.value),required:!s})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{htmlFor:"employeeId",children:"Employee ID"}),(0,a.jsx)(c,{id:"employeeId",value:i.employeeId,onChange:e=>g("employeeId",e.target.value),required:!0})]})]})]}),(0,a.jsxs)(m.Zb,{children:[(0,a.jsx)(m.Ol,{children:(0,a.jsx)(m.ll,{children:"Personal Details"})}),(0,a.jsxs)(m.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{htmlFor:"firstName",children:"First Name"}),(0,a.jsx)(c,{id:"firstName",value:i.firstName,onChange:e=>g("firstName",e.target.value),required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{htmlFor:"lastName",children:"Last Name"}),(0,a.jsx)(c,{id:"lastName",value:i.lastName,onChange:e=>g("lastName",e.target.value),required:!0})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{htmlFor:"dateOfBirth",children:"Date of Birth"}),(0,a.jsx)(c,{id:"dateOfBirth",type:"date",value:i.dateOfBirth,onChange:e=>g("dateOfBirth",e.target.value),required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{htmlFor:"gender",children:"Gender"}),(0,a.jsxs)(J,{value:i.gender,onValueChange:e=>g("gender",e),children:[(0,a.jsx)(W,{children:(0,a.jsx)(X,{})}),(0,a.jsxs)(Q,{children:[(0,a.jsx)($,{value:"male",children:"Male"}),(0,a.jsx)($,{value:"female",children:"Female"}),(0,a.jsx)($,{value:"other",children:"Other"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{htmlFor:"bloodGroup",children:"Blood Group"}),(0,a.jsxs)(J,{value:i.bloodGroup,onValueChange:e=>g("bloodGroup",e),children:[(0,a.jsx)(W,{children:(0,a.jsx)(X,{placeholder:"Select blood group"})}),(0,a.jsxs)(Q,{children:[(0,a.jsx)($,{value:"A+",children:"A+"}),(0,a.jsx)($,{value:"A-",children:"A-"}),(0,a.jsx)($,{value:"B+",children:"B+"}),(0,a.jsx)($,{value:"B-",children:"B-"}),(0,a.jsx)($,{value:"AB+",children:"AB+"}),(0,a.jsx)($,{value:"AB-",children:"AB-"}),(0,a.jsx)($,{value:"O+",children:"O+"}),(0,a.jsx)($,{value:"O-",children:"O-"})]})]})]})]})]}),(0,a.jsxs)(m.Zb,{children:[(0,a.jsx)(m.Ol,{children:(0,a.jsx)(m.ll,{children:"Contact Details"})}),(0,a.jsxs)(m.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{htmlFor:"phone",children:"Phone Number"}),(0,a.jsx)(c,{id:"phone",value:i.phone,onChange:e=>g("phone",e.target.value),required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{htmlFor:"emergencyPhone",children:"Emergency Phone"}),(0,a.jsx)(c,{id:"emergencyPhone",value:i.emergencyPhone,onChange:e=>g("emergencyPhone",e.target.value)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{htmlFor:"street",children:"Street Address"}),(0,a.jsx)(c,{id:"street",value:i.street,onChange:e=>g("street",e.target.value),required:!0})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{htmlFor:"city",children:"City"}),(0,a.jsx)(c,{id:"city",value:i.city,onChange:e=>g("city",e.target.value),required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{htmlFor:"state",children:"State"}),(0,a.jsx)(c,{id:"state",value:i.state,onChange:e=>g("state",e.target.value),required:!0})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{htmlFor:"postalCode",children:"Postal Code"}),(0,a.jsx)(c,{id:"postalCode",value:i.postalCode,onChange:e=>g("postalCode",e.target.value),required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{htmlFor:"country",children:"Country"}),(0,a.jsx)(c,{id:"country",value:i.country,onChange:e=>g("country",e.target.value),required:!0})]})]})]})]}),(0,a.jsxs)(m.Zb,{children:[(0,a.jsx)(m.Ol,{children:(0,a.jsx)(m.ll,{children:"Identification"})}),(0,a.jsxs)(m.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{htmlFor:"aadhaarNumber",children:"Aadhaar Number"}),(0,a.jsx)(c,{id:"aadhaarNumber",value:i.aadhaarNumber,onChange:e=>g("aadhaarNumber",e.target.value),required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{htmlFor:"panNumber",children:"PAN Number"}),(0,a.jsx)(c,{id:"panNumber",value:i.panNumber,onChange:e=>g("panNumber",e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{children:"Aadhaar Card"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(c,{type:"file",accept:".pdf,.jpg,.jpeg,.png",onChange:e=>{var s;return f("aadhaarCard",(null===(s=e.target.files)||void 0===s?void 0:s[0])||null)}}),u.aadhaarCard&&(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:u.aadhaarCard.name})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{children:"PAN Card"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(c,{type:"file",accept:".pdf,.jpg,.jpeg,.png",onChange:e=>{var s;return f("panCard",(null===(s=e.target.files)||void 0===s?void 0:s[0])||null)}}),u.panCard&&(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:u.panCard.name})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{children:"Photo"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(c,{type:"file",accept:".jpg,.jpeg,.png",onChange:e=>{var s;return f("photo",(null===(s=e.target.files)||void 0===s?void 0:s[0])||null)}}),u.photo&&(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:u.photo.name})]})]})]})]})]}),(0,a.jsxs)(m.Zb,{children:[(0,a.jsx)(m.Ol,{children:(0,a.jsx)(m.ll,{children:"Employment Details"})}),(0,a.jsxs)(m.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{htmlFor:"position",children:"Position"}),(0,a.jsx)(c,{id:"position",value:i.position,onChange:e=>g("position",e.target.value),placeholder:"e.g., Senior Cashier, Junior Cashier",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{htmlFor:"dateOfJoining",children:"Date of Joining"}),(0,a.jsx)(c,{id:"dateOfJoining",type:"date",value:i.dateOfJoining,onChange:e=>g("dateOfJoining",e.target.value),required:!0})]})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,a.jsx)(n.z,{type:"button",variant:"outline",onClick:r,children:"Cancel"}),(0,a.jsx)(n.z,{type:"submit",disabled:h,children:h?"Saving...":s?"Update Cashier":"Create Cashier"})]})]})}var tD=t(13041),tz=t(83774),tP=t(5005),tA=t(31047);function tZ(e){var s,t,r;let{employee:i,onClose:c}=e,[d,o]=(0,l.useState)([]),[u,x]=(0,l.useState)(!0);(0,l.useEffect)(()=>{h()},[i._id]);let h=async()=>{try{let e=tS.O.getToken(),s=await fetch("http://localhost:5001/api/employees/".concat(i._id,"/leaves"),{headers:{Authorization:"Bearer ".concat(e)}});if(s.ok){let e=await s.json();o(e)}}catch(e){console.error("Failed to fetch employee leaves:",e)}finally{x(!1)}},p=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),g=(e,s)=>{if(e&&e.path){let t=document.createElement("a");t.href="http://localhost:5001/api/files/download?path=".concat(encodeURIComponent(e.path),"&filename=").concat(encodeURIComponent(s)),t.download=s,document.body.appendChild(t),t.click(),document.body.removeChild(t)}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[i.identification.photo?(0,a.jsx)("img",{src:"http://localhost:5001/api/files/download?path=".concat(encodeURIComponent(i.identification.photo.path),"&filename=").concat(encodeURIComponent(i.identification.photo.filename)),alt:i.user.name,className:"w-16 h-16 rounded-full object-cover"}):(0,a.jsx)("div",{className:"w-16 h-16 rounded-full bg-gray-200 flex items-center justify-center",children:(0,a.jsx)(S.Z,{className:"w-8 h-8 text-gray-500"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold",children:i.user.name}),(0,a.jsx)("p",{className:"text-muted-foreground",children:i.user.employeeId}),(0,a.jsx)(j.C,{className:(e=>{switch(e){case"active":return"bg-green-100 text-green-800";case"inactive":return"bg-red-100 text-red-800";case"on_leave":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}})(i.status),children:i.status.replace("_"," ").toUpperCase()})]})]}),(0,a.jsx)(n.z,{onClick:c,variant:"outline",children:"Close"})]}),(0,a.jsxs)(sI,{defaultValue:"personal",className:"w-full",children:[(0,a.jsxs)(s_,{className:"grid w-full grid-cols-4",children:[(0,a.jsx)(sE,{value:"personal",children:"Personal"}),(0,a.jsx)(sE,{value:"employment",children:"Employment"}),(0,a.jsx)(sE,{value:"documents",children:"Documents"}),(0,a.jsx)(sE,{value:"leaves",children:"Leaves"})]}),(0,a.jsx)(sF,{value:"personal",className:"space-y-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)(m.Zb,{children:[(0,a.jsx)(m.Ol,{children:(0,a.jsxs)(m.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(S.Z,{className:"w-5 h-5"}),"Personal Information"]})}),(0,a.jsxs)(m.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"First Name"}),(0,a.jsx)("p",{className:"text-lg",children:i.personalDetails.firstName})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Last Name"}),(0,a.jsx)("p",{className:"text-lg",children:i.personalDetails.lastName})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Date of Birth"}),(0,a.jsx)("p",{className:"text-lg",children:p(i.personalDetails.dateOfBirth)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Gender"}),(0,a.jsx)("p",{className:"text-lg capitalize",children:i.personalDetails.gender})]}),i.personalDetails.bloodGroup&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Blood Group"}),(0,a.jsx)("p",{className:"text-lg",children:i.personalDetails.bloodGroup})]})]})]}),(0,a.jsxs)(m.Zb,{children:[(0,a.jsx)(m.Ol,{children:(0,a.jsxs)(m.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(tD.Z,{className:"w-5 h-5"}),"Contact Information"]})}),(0,a.jsxs)(m.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(sW.Z,{className:"w-4 h-4 text-muted-foreground"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Email"}),(0,a.jsx)("p",{className:"text-lg",children:i.user.email})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(tD.Z,{className:"w-4 h-4 text-muted-foreground"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Phone"}),(0,a.jsx)("p",{className:"text-lg",children:i.contactDetails.phone})]})]}),i.contactDetails.emergencyPhone&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Emergency Phone"}),(0,a.jsx)("p",{className:"text-lg",children:i.contactDetails.emergencyPhone})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(tz.Z,{className:"w-4 h-4 text-muted-foreground"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Address"}),(0,a.jsxs)("p",{className:"text-lg",children:[i.contactDetails.address.street,",",(0,a.jsx)("br",{}),i.contactDetails.address.city,", ",i.contactDetails.address.state," ",i.contactDetails.address.postalCode,(0,a.jsx)("br",{}),i.contactDetails.address.country]})]})]})]})]})]})}),(0,a.jsxs)(sF,{value:"employment",className:"space-y-6",children:[(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:(0,a.jsxs)(m.Zb,{children:[(0,a.jsx)(m.Ol,{children:(0,a.jsxs)(m.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(tP.Z,{className:"w-5 h-5"}),"Employment Details"]})}),(0,a.jsxs)(m.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Department"}),(0,a.jsx)("p",{className:"text-lg capitalize",children:i.employmentDetails.department})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Position"}),(0,a.jsx)("p",{className:"text-lg",children:i.employmentDetails.position})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(tA.Z,{className:"w-4 h-4 text-muted-foreground"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Date of Joining"}),(0,a.jsx)("p",{className:"text-lg",children:p(i.employmentDetails.dateOfJoining)})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Role"}),(0,a.jsx)("p",{className:"text-lg capitalize",children:i.user.role})]})]})]})}),(0,a.jsxs)(m.Zb,{children:[(0,a.jsx)(m.Ol,{children:(0,a.jsx)(m.ll,{children:"Leave Balance"})}),(0,a.jsx)(m.aY,{children:(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:(null===(s=i.leaveBalance)||void 0===s?void 0:s.casual)||0}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Casual Leaves"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-green-600",children:(null===(t=i.leaveBalance)||void 0===t?void 0:t.sick)||0}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Sick Leaves"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-purple-600",children:(null===(r=i.leaveBalance)||void 0===r?void 0:r.earned)||0}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Earned Leaves"})]})]})})]})]}),(0,a.jsx)(sF,{value:"documents",className:"space-y-6",children:(0,a.jsxs)(m.Zb,{children:[(0,a.jsx)(m.Ol,{children:(0,a.jsxs)(m.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(O.Z,{className:"w-5 h-5"}),"Identification Documents"]})}),(0,a.jsxs)(m.aY,{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Aadhaar Number"}),(0,a.jsx)("p",{className:"text-lg",children:i.identification.aadhaarNumber})]}),i.identification.panNumber&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"PAN Number"}),(0,a.jsx)("p",{className:"text-lg",children:i.identification.panNumber})]}),(0,a.jsx)(eW,{}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.identification.aadhaarCard&&(0,a.jsx)(m.Zb,{children:(0,a.jsxs)(m.aY,{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("p",{className:"font-medium",children:"Aadhaar Card"}),(0,a.jsx)(n.z,{size:"sm",variant:"outline",onClick:()=>g(i.identification.aadhaarCard,i.identification.aadhaarCard.filename),children:(0,a.jsx)(e5.Z,{className:"w-4 h-4"})})]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Uploaded: ",p(i.identification.aadhaarCard.uploadedAt)]})]})}),i.identification.panCard&&(0,a.jsx)(m.Zb,{children:(0,a.jsxs)(m.aY,{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("p",{className:"font-medium",children:"PAN Card"}),(0,a.jsx)(n.z,{size:"sm",variant:"outline",onClick:()=>g(i.identification.panCard,i.identification.panCard.filename),children:(0,a.jsx)(e5.Z,{className:"w-4 h-4"})})]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Uploaded: ",p(i.identification.panCard.uploadedAt)]})]})}),i.identification.photo&&(0,a.jsx)(m.Zb,{children:(0,a.jsxs)(m.aY,{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("p",{className:"font-medium",children:"Photo"}),(0,a.jsx)(n.z,{size:"sm",variant:"outline",onClick:()=>g(i.identification.photo,i.identification.photo.filename),children:(0,a.jsx)(e5.Z,{className:"w-4 h-4"})})]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Uploaded: ",p(i.identification.photo.uploadedAt)]})]})})]})]})]})}),(0,a.jsx)(sF,{value:"leaves",className:"space-y-6",children:(0,a.jsxs)(m.Zb,{children:[(0,a.jsx)(m.Ol,{children:(0,a.jsx)(m.ll,{children:"Leave History"})}),(0,a.jsx)(m.aY,{children:u?(0,a.jsx)("div",{className:"flex items-center justify-center h-32",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"})}):d.length>0?(0,a.jsx)("div",{className:"space-y-4",children:d.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"font-medium",children:[e.leaveType.charAt(0).toUpperCase()+e.leaveType.slice(1)," Leave"]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[p(e.startDate)," - ",p(e.endDate)]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.totalDays," days"]})]}),(0,a.jsx)(j.C,{className:"approved"===e.status?"bg-green-100 text-green-800":"rejected"===e.status?"bg-red-100 text-red-800":"pending"===e.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800",children:e.status.toUpperCase()})]},e._id))}):(0,a.jsx)("p",{className:"text-center text-muted-foreground",children:"No leave records found"})})]})})]})]})}function tI(){let[e,s]=(0,l.useState)([]),[t,i]=(0,l.useState)([]),[d,o]=(0,l.useState)(!0),[u,x]=(0,l.useState)(""),[h,p]=(0,l.useState)("all"),[g,f]=(0,l.useState)(null),[v,N]=(0,l.useState)(!1),[y,b]=(0,l.useState)(!1),[w,C]=(0,l.useState)(null),{toast:S}=sw(),{isAdmin:k}=(0,r.a)();(0,l.useEffect)(()=>{D()},[]),(0,l.useEffect)(()=>{z()},[e,u,h]);let D=async()=>{try{let e=tS.O.getToken(),t=await fetch("http://localhost:5001/api/employees",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();s(e)}else S({title:"Error",description:"Failed to fetch employees",variant:"destructive"})}catch(e){S({title:"Error",description:"Failed to fetch employees",variant:"destructive"})}finally{o(!1)}},z=()=>{let s=e;u&&(s=s.filter(e=>{var s,t,a,l;return(null===(t=e.user)||void 0===t?void 0:null===(s=t.name)||void 0===s?void 0:s.toLowerCase().includes(u.toLowerCase()))||(null===(l=e.user)||void 0===l?void 0:null===(a=l.employeeId)||void 0===a?void 0:a.toLowerCase().includes(u.toLowerCase()))||e.personalDetails.firstName.toLowerCase().includes(u.toLowerCase())||e.personalDetails.lastName.toLowerCase().includes(u.toLowerCase())||e.contactDetails.phone.includes(u)})),"all"!==h&&(s=s.filter(e=>e.status===h)),i(s)},P=e=>{C(e),N(!0)},A=e=>{f(e),b(!0)},Z=async e=>{if(confirm("Are you sure you want to deactivate this employee?"))try{let s=tS.O.getToken();(await fetch("http://localhost:5001/api/employees/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(s)}})).ok?(S({title:"Success",description:"Employee deactivated successfully"}),D()):S({title:"Error",description:"Failed to deactivate employee",variant:"destructive"})}catch(e){S({title:"Error",description:"Failed to deactivate employee",variant:"destructive"})}},I=e=>{switch(e){case"active":return"bg-green-100 text-green-800";case"inactive":return"bg-red-100 text-red-800";case"on_leave":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}};return d?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Cashier Management"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Manage cashiers and their details"})]}),k&&(0,a.jsxs)(eh,{open:v,onOpenChange:N,children:[(0,a.jsx)(ep,{asChild:!0,children:(0,a.jsxs)(n.z,{onClick:()=>C(null),children:[(0,a.jsx)(ew.Z,{className:"mr-2 h-4 w-4"}),"Add Cashier"]})}),(0,a.jsxs)(ef,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(ev,{children:(0,a.jsx)(ey,{children:w?"Edit Cashier":"Add New Cashier"})}),(0,a.jsx)(tk,{employee:w,onSuccess:()=>{D(),N(!1),C(null)},onCancel:()=>{N(!1),C(null)}})]})]})]}),(0,a.jsxs)(m.Zb,{children:[(0,a.jsx)(m.Ol,{children:(0,a.jsx)(m.ll,{children:"Filters"})}),(0,a.jsx)(m.aY,{children:(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(eC.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),(0,a.jsx)(c,{placeholder:"Search employees...",value:u,onChange:e=>x(e.target.value),className:"pl-10"})]})}),(0,a.jsxs)(J,{value:h,onValueChange:p,children:[(0,a.jsx)(W,{className:"w-48",children:(0,a.jsx)(X,{placeholder:"Filter by status"})}),(0,a.jsxs)(Q,{children:[(0,a.jsx)($,{value:"all",children:"All Status"}),(0,a.jsx)($,{value:"active",children:"Active"}),(0,a.jsx)($,{value:"inactive",children:"Inactive"}),(0,a.jsx)($,{value:"on_leave",children:"On Leave"}),(0,a.jsx)($,{value:"terminated",children:"Terminated"})]})]})]})})]}),(0,a.jsxs)(m.Zb,{children:[(0,a.jsx)(m.Ol,{children:(0,a.jsxs)(m.ll,{children:["Cashiers (",t.length,")"]})}),(0,a.jsxs)(m.aY,{children:[(0,a.jsxs)(eU,{children:[(0,a.jsx)(eY,{children:(0,a.jsxs)(eV,{children:[(0,a.jsx)(eK,{children:"Employee ID"}),(0,a.jsx)(eK,{children:"Name"}),(0,a.jsx)(eK,{children:"Department"}),(0,a.jsx)(eK,{children:"Position"}),(0,a.jsx)(eK,{children:"Contact"}),(0,a.jsx)(eK,{children:"Status"}),(0,a.jsx)(eK,{className:"text-right",children:"Actions"})]})}),(0,a.jsx)(eq,{children:t.map(e=>{var s,t,l;return(0,a.jsxs)(eV,{children:[(0,a.jsx)(eG,{className:"font-medium",children:(null===(s=e.user)||void 0===s?void 0:s.employeeId)||"N/A"}),(0,a.jsx)(eG,{children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:(null===(t=e.user)||void 0===t?void 0:t.name)||"Unknown"}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:(null===(l=e.user)||void 0===l?void 0:l.email)||"No email"})]})}),(0,a.jsx)(eG,{children:e.employmentDetails.department}),(0,a.jsx)(eG,{children:e.employmentDetails.position}),(0,a.jsx)(eG,{children:e.contactDetails.phone}),(0,a.jsx)(eG,{children:(0,a.jsx)(j.C,{className:I(e.status),children:e.status.replace("_"," ").toUpperCase()})}),(0,a.jsx)(eG,{className:"text-right",children:(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(n.z,{variant:"ghost",size:"sm",onClick:()=>A(e),children:(0,a.jsx)(sG.Z,{className:"h-4 w-4"})}),k&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.z,{variant:"ghost",size:"sm",onClick:()=>P(e),children:(0,a.jsx)(eS.Z,{className:"h-4 w-4"})}),(0,a.jsx)(n.z,{variant:"ghost",size:"sm",onClick:()=>Z(e._id),children:(0,a.jsx)(ek.Z,{className:"h-4 w-4"})})]})]})})]},e._id)})})]}),0===t.length&&(0,a.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No cashiers found matching your criteria"})]})]}),(0,a.jsx)(eh,{open:y,onOpenChange:b,children:(0,a.jsxs)(ef,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(ev,{children:(0,a.jsx)(ey,{children:"Cashier Details"})}),g&&(0,a.jsx)(tZ,{employee:g,onClose:()=>b(!1)})]})})]})}var t_=t(26034),tE=t(38866),tF=t(27312);function tT(e){let{...s}=e;return(0,a.jsx)(tF.fC,{"data-slot":"popover",...s})}function tO(e){let{...s}=e;return(0,a.jsx)(tF.xz,{"data-slot":"popover-trigger",...s})}function tR(e){let{className:s,align:t="center",sideOffset:l=4,...r}=e;return(0,a.jsx)(tF.h_,{children:(0,a.jsx)(tF.VY,{"data-slot":"popover-content",align:t,sideOffset:l,className:(0,i.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",s),...r})})}var tL=t(45008),tB=t(92451),tM=t(92658),tU=t(77090);function tY(){let e=(0,tL._)(["rtl:**:[.rdp-button_next>svg]:rotate-180"],["rtl:**:[.rdp-button\\_next>svg]:rotate-180"]);return tY=function(){return e},e}function tq(){let e=(0,tL._)(["rtl:**:[.rdp-button_previous>svg]:rotate-180"],["rtl:**:[.rdp-button\\_previous>svg]:rotate-180"]);return tq=function(){return e},e}function tV(e){let{className:s,classNames:t,showOutsideDays:l=!0,captionLayout:r="label",buttonVariant:c="ghost",formatters:d,components:o,...m}=e,u=(0,tM.U)();return(0,a.jsx)(tU._,{showOutsideDays:l,className:(0,i.cn)("bg-background group/calendar p-3 [--cell-size:--spacing(8)] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent",String.raw(tY()),String.raw(tq()),s),captionLayout:r,formatters:{formatMonthDropdown:e=>e.toLocaleString("default",{month:"short"}),...d},classNames:{root:(0,i.cn)("w-fit",u.root),months:(0,i.cn)("flex gap-4 flex-col md:flex-row relative",u.months),month:(0,i.cn)("flex flex-col w-full gap-4",u.month),nav:(0,i.cn)("flex items-center gap-1 w-full absolute top-0 inset-x-0 justify-between",u.nav),button_previous:(0,i.cn)((0,n.d)({variant:c}),"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",u.button_previous),button_next:(0,i.cn)((0,n.d)({variant:c}),"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",u.button_next),month_caption:(0,i.cn)("flex items-center justify-center h-(--cell-size) w-full px-(--cell-size)",u.month_caption),dropdowns:(0,i.cn)("w-full flex items-center text-sm font-medium justify-center h-(--cell-size) gap-1.5",u.dropdowns),dropdown_root:(0,i.cn)("relative has-focus:border-ring border border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] rounded-md",u.dropdown_root),dropdown:(0,i.cn)("absolute bg-popover inset-0 opacity-0",u.dropdown),caption_label:(0,i.cn)("select-none font-medium","label"===r?"text-sm":"rounded-md pl-2 pr-1 flex items-center gap-1 text-sm h-8 [&>svg]:text-muted-foreground [&>svg]:size-3.5",u.caption_label),table:"w-full border-collapse",weekdays:(0,i.cn)("flex",u.weekdays),weekday:(0,i.cn)("text-muted-foreground rounded-md flex-1 font-normal text-[0.8rem] select-none",u.weekday),week:(0,i.cn)("flex w-full mt-2",u.week),week_number_header:(0,i.cn)("select-none w-(--cell-size)",u.week_number_header),week_number:(0,i.cn)("text-[0.8rem] select-none text-muted-foreground",u.week_number),day:(0,i.cn)("relative w-full h-full p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md group/day aspect-square select-none",u.day),range_start:(0,i.cn)("rounded-l-md bg-accent",u.range_start),range_middle:(0,i.cn)("rounded-none",u.range_middle),range_end:(0,i.cn)("rounded-r-md bg-accent",u.range_end),today:(0,i.cn)("bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none",u.today),outside:(0,i.cn)("text-muted-foreground aria-selected:text-muted-foreground",u.outside),disabled:(0,i.cn)("text-muted-foreground opacity-50",u.disabled),hidden:(0,i.cn)("invisible",u.hidden),...t},components:{Root:e=>{let{className:s,rootRef:t,...l}=e;return(0,a.jsx)("div",{"data-slot":"calendar",ref:t,className:(0,i.cn)(s),...l})},Chevron:e=>{let{className:s,orientation:t,...l}=e;return"left"===t?(0,a.jsx)(tB.Z,{className:(0,i.cn)("size-4",s),...l}):"right"===t?(0,a.jsx)(tf.Z,{className:(0,i.cn)("size-4",s),...l}):(0,a.jsx)(K.Z,{className:(0,i.cn)("size-4",s),...l})},DayButton:tK,WeekNumber:e=>{let{children:s,...t}=e;return(0,a.jsx)("td",{...t,children:(0,a.jsx)("div",{className:"flex size-(--cell-size) items-center justify-center text-center",children:s})})},...o},...m})}function tK(e){let{className:s,day:t,modifiers:r,...c}=e,d=(0,tM.U)(),o=l.useRef(null);return l.useEffect(()=>{var e;r.focused&&(null===(e=o.current)||void 0===e||e.focus())},[r.focused]),(0,a.jsx)(n.z,{ref:o,variant:"ghost",size:"icon","data-day":t.date.toLocaleDateString(),"data-selected-single":r.selected&&!r.range_start&&!r.range_end&&!r.range_middle,"data-range-start":r.range_start,"data-range-end":r.range_end,"data-range-middle":r.range_middle,className:(0,i.cn)("data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 dark:hover:text-accent-foreground flex aspect-square size-auto w-full min-w-(--cell-size) flex-col gap-1 leading-none font-normal group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] data-[range-end=true]:rounded-md data-[range-end=true]:rounded-r-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md data-[range-start=true]:rounded-l-md [&>span]:text-xs [&>span]:opacity-70",d.day,s),...c})}var tG=t(52255);function tH(e){let{discount:s,onSuccess:t,onCancel:r}=e,[d,u]=(0,l.useState)({name:"",description:"",type:"percentage",value:"",targetType:"all",targetCategory:"",targetProduct:"",minPurchaseAmount:"",maxDiscountAmount:"",usageLimit:"",startDate:new Date,endDate:new Date(Date.now()+2592e6),isActive:!0}),[x,h]=(0,l.useState)([]),[p,j]=(0,l.useState)([]),[g,f]=(0,l.useState)(!1),[v,N]=(0,l.useState)(!0);(0,l.useEffect)(()=>{if(s){var e,t,a,l;u({name:s.name,description:s.description||"",type:s.type,value:s.value.toString(),targetType:s.targetType,targetCategory:s.targetCategory||"",targetProduct:(null===(e=s.targetProduct)||void 0===e?void 0:e._id)||"",minPurchaseAmount:(null===(t=s.minPurchaseAmount)||void 0===t?void 0:t.toString())||"",maxDiscountAmount:(null===(a=s.maxDiscountAmount)||void 0===a?void 0:a.toString())||"",usageLimit:(null===(l=s.usageLimit)||void 0===l?void 0:l.toString())||"",startDate:new Date(s.startDate),endDate:new Date(s.endDate),isActive:s.isActive})}},[s]),(0,l.useEffect)(()=>{y()},[]);let y=async()=>{try{N(!0);let e=await ez.apiClient.getProducts({active:!0});h(e||[]);let s=[...new Set(e.map(e=>e.category))];j(s)}catch(e){console.error("Error fetching products:",e)}finally{N(!1)}},b=async e=>{e.preventDefault(),f(!0);try{let e={...d,value:parseFloat(d.value),minPurchaseAmount:d.minPurchaseAmount?parseFloat(d.minPurchaseAmount):0,maxDiscountAmount:d.maxDiscountAmount?parseFloat(d.maxDiscountAmount):void 0,usageLimit:d.usageLimit?parseInt(d.usageLimit):void 0,startDate:d.startDate.toISOString(),endDate:d.endDate.toISOString(),type:d.type,targetType:d.targetType,targetProduct:"product"===d.targetType&&d.targetProduct?x.find(e=>e._id===d.targetProduct):void 0};s?await ez.apiClient.updateDiscount(s._id,e):await ez.apiClient.createDiscount(e),t()}catch(e){console.error("Error saving discount:",e),alert(e instanceof Error?e.message:"Error saving discount")}finally{f(!1)}};return(0,a.jsxs)("form",{onSubmit:b,className:"space-y-6 max-w-6xl mx-auto p-4",children:[(0,a.jsxs)(m.Zb,{children:[(0,a.jsxs)(m.Ol,{children:[(0,a.jsxs)(m.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(L.Z,{className:"h-5 w-5"}),"Basic Information"]}),(0,a.jsx)(m.SZ,{children:"Set the basic details for your discount"})]}),(0,a.jsxs)(m.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"name",children:"Discount Name *"}),(0,a.jsx)(c,{id:"name",value:d.name,onChange:e=>u({...d,name:e.target.value}),placeholder:"e.g., Summer Sale 2024",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"type",children:"Discount Type *"}),(0,a.jsxs)(J,{value:d.type,onValueChange:e=>u({...d,type:e}),children:[(0,a.jsx)(W,{children:(0,a.jsx)(X,{})}),(0,a.jsxs)(Q,{children:[(0,a.jsx)($,{value:"percentage",children:"Percentage"}),(0,a.jsx)($,{value:"fixed",children:"Fixed Amount"})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"description",children:"Description"}),(0,a.jsx)(sR,{id:"description",value:d.description,onChange:e=>u({...d,description:e.target.value}),placeholder:"Describe the discount and its terms...",rows:3})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"value",children:"Discount Value *"}),(0,a.jsx)(c,{id:"value",type:"number",value:d.value,onChange:e=>u({...d,value:e.target.value}),placeholder:"percentage"===d.type?"e.g., 10":"e.g., 100",min:"0",max:"percentage"===d.type?"100":void 0,step:"percentage"===d.type?"0.1":"0.01",required:!0}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"percentage"===d.type?"Enter percentage value (e.g., 10 for 10%)":"Enter fixed amount in INR"})]})]})]}),(0,a.jsxs)(m.Zb,{children:[(0,a.jsxs)(m.Ol,{children:[(0,a.jsxs)(m.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(sV.Z,{className:"h-5 w-5"}),"Target Configuration"]}),(0,a.jsx)(m.SZ,{children:"Choose which products this discount applies to"})]}),(0,a.jsxs)(m.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"targetType",children:"Target Type *"}),(0,a.jsxs)(J,{value:d.targetType,onValueChange:e=>u({...d,targetType:e}),children:[(0,a.jsx)(W,{children:(0,a.jsx)(X,{})}),(0,a.jsxs)(Q,{children:[(0,a.jsx)($,{value:"all",children:"All Products"}),(0,a.jsx)($,{value:"category",children:"Specific Category"}),(0,a.jsx)($,{value:"product",children:"Specific Product"})]})]})]}),"category"===d.targetType&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"targetCategory",children:"Category *"}),(0,a.jsxs)(J,{value:d.targetCategory,onValueChange:e=>u({...d,targetCategory:e}),children:[(0,a.jsx)(W,{children:(0,a.jsx)(X,{placeholder:"Select a category"})}),(0,a.jsx)(Q,{children:v?(0,a.jsx)($,{value:"loading-categories",disabled:!0,children:"Loading categories..."}):p.map(e=>(0,a.jsx)($,{value:e,children:e},e))})]})]}),"product"===d.targetType&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"targetProduct",children:"Product *"}),(0,a.jsxs)(J,{value:d.targetProduct,onValueChange:e=>u({...d,targetProduct:e}),children:[(0,a.jsx)(W,{children:(0,a.jsx)(X,{placeholder:"Select a product"})}),(0,a.jsx)(Q,{children:v?(0,a.jsx)($,{value:"loading-products",disabled:!0,children:"Loading products..."}):x.map(e=>(0,a.jsxs)($,{value:e._id,children:[e.code," - ",e.name]},e._id))})]})]})]})]}),(0,a.jsxs)(m.Zb,{children:[(0,a.jsxs)(m.Ol,{children:[(0,a.jsx)(m.ll,{children:"Conditions and Limits"}),(0,a.jsx)(m.SZ,{children:"Set conditions and usage limits for the discount"})]}),(0,a.jsxs)(m.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"minPurchaseAmount",children:"Minimum Purchase Amount"}),(0,a.jsx)(c,{id:"minPurchaseAmount",type:"number",value:d.minPurchaseAmount,onChange:e=>u({...d,minPurchaseAmount:e.target.value}),placeholder:"0",min:"0",step:"0.01"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Minimum purchase amount to qualify for discount"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"maxDiscountAmount",children:"Maximum Discount Amount"}),(0,a.jsx)(c,{id:"maxDiscountAmount",type:"number",value:d.maxDiscountAmount,onChange:e=>u({...d,maxDiscountAmount:e.target.value}),placeholder:"No limit",min:"0",step:"0.01"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Maximum discount amount per transaction"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"usageLimit",children:"Usage Limit"}),(0,a.jsx)(c,{id:"usageLimit",type:"number",value:d.usageLimit,onChange:e=>u({...d,usageLimit:e.target.value}),placeholder:"No limit",min:"1"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Maximum number of times this discount can be used"})]})]})]}),(0,a.jsxs)(m.Zb,{children:[(0,a.jsxs)(m.Ol,{children:[(0,a.jsx)(m.ll,{children:"Duration"}),(0,a.jsx)(m.SZ,{children:"Set the validity period for this discount"})]}),(0,a.jsx)(m.aY,{className:"space-y-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"startDate",children:"Start Date"}),(0,a.jsxs)(tT,{children:[(0,a.jsx)(tO,{asChild:!0,children:(0,a.jsxs)(n.z,{variant:"outline",className:(0,i.cn)("w-full justify-start text-left font-normal",!d.startDate&&"text-muted-foreground"),children:[(0,a.jsx)(tA.Z,{className:"mr-2 h-4 w-4"}),d.startDate?(0,tG.WU)(d.startDate,"PPP"):(0,a.jsx)("span",{children:"Pick a date"})]})}),(0,a.jsx)(tR,{className:"w-auto p-0",children:(0,a.jsx)(tV,{mode:"single",selected:d.startDate,onSelect:e=>{e&&u({...d,startDate:e,endDate:d.endDate&&d.endDate<e?e:d.endDate})},disabled:e=>e<new Date(new Date().setHours(0,0,0,0)),initialFocus:!0})})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"endDate",children:"End Date"}),(0,a.jsxs)(tT,{children:[(0,a.jsx)(tO,{asChild:!0,children:(0,a.jsxs)(n.z,{variant:"outline",className:(0,i.cn)("w-full justify-start text-left font-normal",!d.endDate&&"text-muted-foreground"),children:[(0,a.jsx)(tA.Z,{className:"mr-2 h-4 w-4"}),d.endDate?(0,tG.WU)(d.endDate,"PPP"):(0,a.jsx)("span",{children:"Pick a date"})]})}),(0,a.jsx)(tR,{className:"w-auto p-0",children:(0,a.jsx)(tV,{mode:"single",selected:d.endDate,onSelect:e=>{e&&u({...d,endDate:e})},disabled:e=>e<d.startDate,initialFocus:!0})})]})]})]})})]}),(0,a.jsxs)(m.Zb,{children:[(0,a.jsx)(m.Ol,{children:(0,a.jsx)(m.ll,{children:"Status"})}),(0,a.jsxs)(m.aY,{children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(eA,{id:"isActive",checked:d.isActive,onCheckedChange:e=>u({...d,isActive:e})}),(0,a.jsx)(o,{htmlFor:"isActive",children:"Active"})]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"Inactive discounts will not be applied to purchases"})]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-end gap-4 p-4 bg-background rounded-lg border",children:[(0,a.jsx)(n.z,{type:"button",variant:"outline",onClick:r,className:"w-full sm:w-auto",children:"Cancel"}),(0,a.jsx)(n.z,{type:"submit",disabled:g,className:"w-full sm:w-auto",children:g?"Saving...":s?"Update Discount":"Create Discount"})]})]})}var tJ=t(99388);function tX(e){var s;let{discount:t}=e,l=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e),r=e=>new Date(e).toLocaleDateString("en-IN",{year:"numeric",month:"long",day:"numeric"}),n=(e,s,t)=>{switch(e){case"all":return"All Products";case"category":return"Category: ".concat(s);case"product":return"Product: ".concat((null==t?void 0:t.name)||"Unknown"," (").concat((null==t?void 0:t.code)||"N/A",")");default:return e}},i=(e,s)=>"percentage"===e?"".concat(s,"% off"):"".concat(l(s)," off"),c=e=>{let s=new Date,t=new Date(e.startDate),a=new Date(e.endDate);return e.isActive&&s>=t&&s<=a},d=(e=>{c(e);let s=new Date,t=new Date(e.startDate),a=new Date(e.endDate);return e.isActive?s<t?{icon:C.Z,text:"Scheduled",color:"secondary",description:"Discount will start on ".concat(r(e.startDate))}:s>a?{icon:tJ.Z,text:"Expired",color:"destructive",description:"Discount expired on ".concat(r(e.endDate))}:{icon:e6.Z,text:"Active",color:"default",description:"Discount is valid until ".concat(r(e.endDate))}:{icon:tJ.Z,text:"Inactive",color:"secondary",description:"Discount has been manually deactivated"}})(t),o=(e=>{if(!e.usageLimit)return{status:"unlimited",color:"default",text:"Unlimited usage"};let s=e.usedCount/e.usageLimit*100;return s>=100?{status:"exhausted",color:"destructive",text:"Usage limit reached"}:s>=80?{status:"warning",color:"secondary",text:"".concat(Math.round(s),"% used")}:{status:"available",color:"default",text:"".concat(e.usedCount," / ").concat(e.usageLimit," used")}})(t),m=d.icon;return(0,a.jsxs)("div",{className:"w-full max-w-6xl mx-auto p-6 bg-white dark:bg-gray-900 rounded-xl shadow-lg border border-gray-200 dark:border-gray-800 max-h-[calc(100vh-4rem)] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"mb-6 text-center",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 mb-3",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:t.name}),(0,a.jsxs)(j.C,{variant:d.color,className:"text-sm px-3 py-1 font-semibold shadow-md",children:[(0,a.jsx)(m,{className:"h-4 w-4 mr-1"}),d.text]})]}),(0,a.jsx)("p",{className:"text-base text-gray-600 dark:text-gray-300 mb-3",children:t.description}),(0,a.jsx)("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg border border-blue-200 dark:border-blue-800",children:(0,a.jsx)("p",{className:"text-sm text-blue-800 dark:text-blue-200 font-medium",children:d.description})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[(0,a.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700 shadow-md",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,a.jsx)("div",{className:"p-1.5 bg-blue-100 dark:bg-blue-900 rounded-lg",children:(0,a.jsx)(L.Z,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),(0,a.jsx)("h2",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Discount Information"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-200 dark:border-gray-600",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Type"}),(0,a.jsx)(j.C,{variant:"outline",className:"text-xs px-2 py-1 font-medium",children:i(t.type,t.value)})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-200 dark:border-gray-600",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Value"}),(0,a.jsx)("span",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:"percentage"===t.type?"".concat(t.value,"%"):l(t.value)})]}),t.minPurchaseAmount>0&&(0,a.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-200 dark:border-gray-600",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Min Purchase"}),(0,a.jsx)("span",{className:"text-base font-medium text-gray-900 dark:text-white",children:l(t.minPurchaseAmount)})]}),t.maxDiscountAmount&&(0,a.jsxs)("div",{className:"flex justify-between items-center py-2",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Max Discount"}),(0,a.jsx)("span",{className:"text-base font-medium text-gray-900 dark:text-white",children:l(t.maxDiscountAmount)})]})]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700 shadow-md",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,a.jsx)("div",{className:"p-1.5 bg-green-100 dark:bg-green-900 rounded-lg",children:(0,a.jsx)(sV.Z,{className:"h-5 w-5 text-green-600 dark:text-green-400"})}),(0,a.jsx)("h2",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Target Information"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-200 dark:border-gray-600",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Target Type"}),(0,a.jsx)(j.C,{variant:"outline",className:"text-xs px-2 py-1 font-medium",children:t.targetType})]}),(0,a.jsxs)("div",{className:"py-2",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 block mb-2",children:"Applies To"}),(0,a.jsx)("div",{className:"bg-white dark:bg-gray-900 p-3 rounded-lg border border-gray-300 dark:border-gray-600",children:(0,a.jsx)("p",{className:"text-sm text-gray-800 dark:text-gray-200 leading-relaxed",children:n(t.targetType,t.targetCategory,t.targetProduct)})})]})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[(0,a.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700 shadow-md",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,a.jsx)("div",{className:"p-1.5 bg-purple-100 dark:bg-purple-900 rounded-lg",children:(0,a.jsx)(tA.Z,{className:"h-5 w-5 text-purple-600 dark:text-purple-400"})}),(0,a.jsx)("h2",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Duration"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"py-2 border-b border-gray-200 dark:border-gray-600",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 block mb-1",children:"Start Date"}),(0,a.jsx)("p",{className:"text-base font-medium text-gray-900 dark:text-white",children:r(t.startDate)})]}),(0,a.jsxs)("div",{className:"py-2",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 block mb-1",children:"End Date"}),(0,a.jsx)("p",{className:"text-base font-medium text-gray-900 dark:text-white",children:r(t.endDate)})]})]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700 shadow-md",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,a.jsx)("div",{className:"p-1.5 bg-orange-100 dark:bg-orange-900 rounded-lg",children:(0,a.jsx)(sY.Z,{className:"h-5 w-5 text-orange-600 dark:text-orange-400"})}),(0,a.jsx)("h2",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Usage Statistics"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-200 dark:border-gray-600",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Times Used"}),(0,a.jsx)(j.C,{variant:o.color,className:"text-xs px-2 py-1 font-medium",children:o.text})]}),t.usageLimit&&(0,a.jsxs)("div",{className:"space-y-3 pt-1",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Usage Progress"}),(0,a.jsxs)("span",{className:"text-lg font-bold text-orange-600 dark:text-orange-400",children:[Math.round(t.usedCount/t.usageLimit*100),"%"]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3 overflow-hidden",children:(0,a.jsx)("div",{className:"bg-gradient-to-r from-orange-400 to-orange-600 h-3 rounded-full transition-all duration-500 ease-out shadow-sm",style:{width:"".concat(Math.min(100,t.usedCount/t.usageLimit*100),"%")}})}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsxs)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:[t.usedCount," of ",t.usageLimit," uses"]})})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700 shadow-md mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,a.jsx)("div",{className:"p-1.5 bg-indigo-100 dark:bg-indigo-900 rounded-lg",children:(0,a.jsx)(B.Z,{className:"h-5 w-5 text-indigo-600 dark:text-indigo-400"})}),(0,a.jsx)("h2",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Additional Information"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-900 p-3 rounded-lg border border-gray-300 dark:border-gray-600 shadow-sm",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 block mb-1",children:"Created By"}),(0,a.jsx)("p",{className:"text-base font-medium text-gray-900 dark:text-white",children:(null===(s=t.createdBy)||void 0===s?void 0:s.name)||"Unknown"})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-900 p-3 rounded-lg border border-gray-300 dark:border-gray-600 shadow-sm",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 block mb-1",children:"Created Date"}),(0,a.jsx)("p",{className:"text-base font-medium text-gray-900 dark:text-white",children:r(t.createdAt)})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-900 p-3 rounded-lg border border-gray-300 dark:border-gray-600 shadow-sm",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 block mb-1",children:"Last Updated"}),(0,a.jsx)("p",{className:"text-base font-medium text-gray-900 dark:text-white",children:r(t.updatedAt)})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-900 p-3 rounded-lg border border-gray-300 dark:border-gray-600 shadow-sm",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 block mb-1",children:"Discount ID"}),(0,a.jsx)("p",{className:"text-xs font-mono font-medium text-gray-600 dark:text-gray-400 break-all leading-relaxed",children:t._id})]})]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700 shadow-md",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,a.jsx)("div",{className:"p-1.5 bg-teal-100 dark:bg-teal-900 rounded-lg",children:(0,a.jsx)(e6.Z,{className:"h-5 w-5 text-teal-600 dark:text-teal-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Conditions Summary"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-1",children:"Summary of conditions that must be met for this discount to apply"})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3 p-3 bg-green-100 dark:bg-green-900/30 rounded-xl border border-green-300 dark:border-green-700 shadow-sm",children:[(0,a.jsx)(e6.Z,{className:"h-4 w-4 text-green-600 dark:text-green-400 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("span",{className:"text-sm text-green-800 dark:text-green-200 leading-relaxed font-medium",children:["Discount type: ",i(t.type,t.value)]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-3 p-3 bg-green-100 dark:bg-green-900/30 rounded-xl border border-green-300 dark:border-green-700 shadow-sm",children:[(0,a.jsx)(e6.Z,{className:"h-4 w-4 text-green-600 dark:text-green-400 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("span",{className:"text-sm text-green-800 dark:text-green-200 leading-relaxed font-medium",children:["Applies to: ",n(t.targetType,t.targetCategory,t.targetProduct)]})]}),t.minPurchaseAmount>0&&(0,a.jsxs)("div",{className:"flex items-start gap-3 p-3 bg-green-100 dark:bg-green-900/30 rounded-xl border border-green-300 dark:border-green-700 shadow-sm",children:[(0,a.jsx)(e6.Z,{className:"h-4 w-4 text-green-600 dark:text-green-400 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("span",{className:"text-sm text-green-800 dark:text-green-200 leading-relaxed font-medium",children:["Minimum purchase amount: ",l(t.minPurchaseAmount)]})]}),t.maxDiscountAmount&&(0,a.jsxs)("div",{className:"flex items-start gap-3 p-3 bg-green-100 dark:bg-green-900/30 rounded-xl border border-green-300 dark:border-green-700 shadow-sm",children:[(0,a.jsx)(e6.Z,{className:"h-4 w-4 text-green-600 dark:text-green-400 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("span",{className:"text-sm text-green-800 dark:text-green-200 leading-relaxed font-medium",children:["Maximum discount amount: ",l(t.maxDiscountAmount)]})]}),t.usageLimit&&(0,a.jsxs)("div",{className:"flex items-start gap-3 p-3 rounded-xl border shadow-sm ".concat("exhausted"===o.status?"bg-red-100 dark:bg-red-900/30 border-red-300 dark:border-red-700":"bg-green-100 dark:bg-green-900/30 border-green-300 dark:border-green-700"),children:["exhausted"===o.status?(0,a.jsx)(tJ.Z,{className:"h-4 w-4 text-red-600 dark:text-red-400 mt-0.5 flex-shrink-0"}):(0,a.jsx)(e6.Z,{className:"h-4 w-4 text-green-600 dark:text-green-400 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("span",{className:"text-sm leading-relaxed font-medium ".concat("exhausted"===o.status?"text-red-800 dark:text-red-200":"text-green-800 dark:text-green-200"),children:["Usage limit: ",t.usedCount," / ",t.usageLimit]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-3 p-3 rounded-xl border shadow-sm ".concat("Active"===d.text?"bg-green-100 dark:bg-green-900/30 border-green-300 dark:border-green-700":"bg-yellow-100 dark:bg-yellow-900/30 border-yellow-300 dark:border-yellow-700"),children:["Active"===d.text?(0,a.jsx)(e6.Z,{className:"h-4 w-4 text-green-600 dark:text-green-400 mt-0.5 flex-shrink-0"}):(0,a.jsx)(e4.Z,{className:"h-4 w-4 text-yellow-600 dark:text-yellow-400 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("span",{className:"text-sm leading-relaxed font-medium ".concat("Active"===d.text?"text-green-800 dark:text-green-200":"text-yellow-800 dark:text-yellow-200"),children:["Valid from ",r(t.startDate)," to ",r(t.endDate)]})]})]})]})]})}function tW(){let[e,s]=(0,l.useState)([]),[t,r]=(0,l.useState)(!0),[i,d]=(0,l.useState)(""),[o,u]=(0,l.useState)(""),[x,h]=(0,l.useState)(""),[p,g]=(0,l.useState)(1),[f,v]=(0,l.useState)(1),[N,y]=(0,l.useState)(null),[b,w]=(0,l.useState)(!1),[C,S]=(0,l.useState)(!1),[k,D]=(0,l.useState)(null),[z,P]=(0,l.useState)(!1),[A,Z]=(0,l.useState)(null),I=async()=>{try{r(!0);let e=await ez.apiClient.getDiscounts({page:p,limit:10,search:i,targetType:o,isActive:""!==x?x:void 0});s(e.discounts),v(e.totalPages)}catch(e){console.error("Error fetching discounts:",e)}finally{r(!1)}};(0,l.useEffect)(()=>{I()},[p,i,o,x]);let _=async s=>{let t=e.find(e=>e._id===s);t&&(Z(t),P(!0))},E=async()=>{if(A)try{await ez.apiClient.toggleDiscountStatus(A._id),await I(),P(!1),Z(null)}catch(e){console.error("Error toggling discount status:",e)}},F=async e=>{if(confirm("Are you sure you want to delete this discount?"))try{await ez.apiClient.deleteDiscount(e),await I()}catch(e){console.error("Error deleting discount:",e)}},T=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e),O=e=>new Date(e).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"}),R=(e,s,t)=>{switch(e){case"all":return"All Products";case"category":return"Category: ".concat(s);case"product":return"Product: ".concat((null==t?void 0:t.name)||"Unknown");default:return e}},B=(e,s)=>"percentage"===e?"".concat(s,"%"):T(s),M=e=>{let s=new Date,t=new Date(e.startDate),a=new Date(e.endDate);return e.isActive&&s>=t&&s<=a};return(0,a.jsxs)("div",{className:"space-y-6 max-w-7xl mx-auto p-4",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold tracking-tight",children:"Discount Management"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Create and manage discounts for products, categories, or all items"})]}),(0,a.jsxs)(eh,{open:b,onOpenChange:w,children:[(0,a.jsx)(ep,{asChild:!0,children:(0,a.jsxs)(n.z,{onClick:()=>D(null),className:"w-full sm:w-auto",children:[(0,a.jsx)(ew.Z,{className:"mr-2 h-4 w-4"}),"New Discount"]})}),(0,a.jsxs)(ef,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)(ev,{children:[(0,a.jsx)(ey,{children:k?"Edit Discount":"Create New Discount"}),(0,a.jsx)(eb,{children:k?"Update the discount details below.":"Create a new discount for your products."})]}),(0,a.jsx)(tH,{discount:k,onSuccess:()=>{w(!1),D(null),I()},onCancel:()=>{w(!1),D(null)}})]})]})]}),(0,a.jsxs)(m.Zb,{children:[(0,a.jsx)(m.Ol,{children:(0,a.jsxs)(m.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(sJ.Z,{className:"h-5 w-5"}),"Filters"]})}),(0,a.jsx)(m.aY,{children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(eC.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),(0,a.jsx)(c,{placeholder:"Search discounts...",value:i,onChange:e=>d(e.target.value),className:"pl-10"})]}),(0,a.jsxs)(J,{value:o,onValueChange:u,children:[(0,a.jsx)(W,{children:(0,a.jsx)(X,{placeholder:"Filter by target type"})}),(0,a.jsxs)(Q,{children:[(0,a.jsx)($,{value:"all-targets",children:"All Target Types"}),(0,a.jsx)($,{value:"all",children:"All Products"}),(0,a.jsx)($,{value:"category",children:"Category"}),(0,a.jsx)($,{value:"product",children:"Specific Product"})]})]}),(0,a.jsxs)(J,{value:x,onValueChange:h,children:[(0,a.jsx)(W,{children:(0,a.jsx)(X,{placeholder:"Filter by status"})}),(0,a.jsxs)(Q,{children:[(0,a.jsx)($,{value:"all-status",children:"All Status"}),(0,a.jsx)($,{value:"true",children:"Active"}),(0,a.jsx)($,{value:"false",children:"Inactive"})]})]})]})})]}),(0,a.jsxs)(m.Zb,{children:[(0,a.jsxs)(m.Ol,{children:[(0,a.jsx)(m.ll,{children:"Discounts"}),(0,a.jsx)(m.SZ,{children:"Manage your product discounts and promotions"})]}),(0,a.jsx)(m.aY,{children:t?(0,a.jsx)("div",{className:"text-center py-8",children:"Loading discounts..."}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(eU,{children:[(0,a.jsx)(eY,{children:(0,a.jsxs)(eV,{children:[(0,a.jsx)(eK,{children:"Name"}),(0,a.jsx)(eK,{children:"Type"}),(0,a.jsx)(eK,{children:"Target"}),(0,a.jsx)(eK,{children:"Duration"}),(0,a.jsx)(eK,{children:"Usage"}),(0,a.jsx)(eK,{children:"Status"}),(0,a.jsx)(eK,{className:"text-right",children:"Actions"})]})}),(0,a.jsx)(eq,{children:0===e.length?(0,a.jsx)(eV,{children:(0,a.jsx)(eG,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No discounts found. Create your first discount to get started."})}):e.map(e=>(0,a.jsxs)(eV,{className:"hover:bg-muted/50",children:[(0,a.jsx)(eG,{children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e.name}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:e.description})]})}),(0,a.jsx)(eG,{children:(0,a.jsx)(j.C,{variant:"outline",children:B(e.type,e.value)})}),(0,a.jsx)(eG,{children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(sV.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("span",{className:"text-sm",children:R(e.targetType,e.targetCategory,e.targetProduct)})]})}),(0,a.jsx)(eG,{children:(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("div",{children:O(e.startDate)}),(0,a.jsxs)("div",{className:"text-muted-foreground",children:["to ",O(e.endDate)]})]})}),(0,a.jsx)(eG,{children:(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsxs)("div",{children:[e.usedCount||0," of ",e.usageLimit||"∞"]}),(0,a.jsx)("div",{className:"text-muted-foreground",children:e.usageLimit?"".concat(Math.round((e.usedCount||0)/e.usageLimit*100),"% used"):"No limit"})]})}),(0,a.jsx)(eG,{children:(0,a.jsx)(j.C,{variant:M(e)?"default":"secondary",children:M(e)?"Active":"Inactive"})}),(0,a.jsx)(eG,{className:"text-right",children:(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(n.z,{variant:"ghost",size:"sm",onClick:()=>{y(e),S(!0)},children:(0,a.jsx)(L.Z,{className:"h-4 w-4"})}),(0,a.jsx)(n.z,{variant:"ghost",size:"sm",onClick:()=>{D(e),w(!0)},children:(0,a.jsx)(eS.Z,{className:"h-4 w-4"})}),(0,a.jsx)(n.z,{variant:"ghost",size:"sm",onClick:()=>_(e._id),children:e.isActive?(0,a.jsx)(t_.Z,{className:"h-4 w-4"}):(0,a.jsx)(tE.Z,{className:"h-4 w-4"})}),(0,a.jsx)(n.z,{variant:"ghost",size:"sm",onClick:()=>F(e._id),children:(0,a.jsx)(ek.Z,{className:"h-4 w-4"})})]})})]},e._id))})]})}),f>1&&(0,a.jsxs)("div",{className:"flex justify-between items-center mt-4",children:[(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Page ",p," of ",f]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(n.z,{variant:"outline",size:"sm",onClick:()=>g(e=>Math.max(1,e-1)),disabled:1===p,children:"Previous"}),(0,a.jsx)(n.z,{variant:"outline",size:"sm",onClick:()=>g(e=>Math.min(f,e+1)),disabled:p===f,children:"Next"})]})]})]})})]}),(0,a.jsx)(eh,{open:C,onOpenChange:S,children:(0,a.jsxs)(ef,{className:"max-w-2xl",children:[(0,a.jsx)(ev,{children:(0,a.jsx)(ey,{children:"Discount Details"})}),N&&(0,a.jsx)(tX,{discount:N})]})}),(0,a.jsx)(eh,{open:z,onOpenChange:P,children:(0,a.jsxs)(ef,{className:"max-w-md",children:[(0,a.jsxs)(ev,{children:[(0,a.jsxs)(ey,{className:"flex items-center gap-2",children:[(0,a.jsx)(e4.Z,{className:"h-5 w-5 text-amber-500"}),"Confirm Status Change"]}),(0,a.jsxs)(eb,{children:["Are you sure you want to change discount from",(0,a.jsx)("span",{className:"font-semibold",children:(null==A?void 0:A.isActive)?" active ":" inactive "})," to",(0,a.jsx)("span",{className:"font-semibold",children:(null==A?void 0:A.isActive)?" inactive ":" active "}),"?"]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3 mt-4",children:[(0,a.jsx)(n.z,{variant:"outline",onClick:()=>{P(!1),Z(null)},children:"Cancel"}),(0,a.jsx)(n.z,{onClick:E,children:"Confirm"})]})]})})]})}var tQ=t(83229),t$=t(64413),t0=t(12805);function t1(){let[e,s]=(0,l.useState)({storeName:"Supermarket Billing System",storeAddress:"",storePhone:"",storeEmail:"",gstNumber:"",currency:"INR",taxRate:18,enablePrint:!0,theme:"system"}),[t,r]=(0,l.useState)(!1),[i,d]=(0,l.useState)(!1),[x,h]=(0,l.useState)("");(0,l.useEffect)(()=>{p()},[]);let p=async()=>{try{r(!0);let e=localStorage.getItem("systemSettings");if(e){let t=JSON.parse(e);s(e=>({...e,...t}))}h("")}catch(e){console.error("Failed to load settings:",e),h("Failed to load settings")}finally{r(!1)}},j=async()=>{try{d(!0),localStorage.setItem("systemSettings",JSON.stringify(e)),f(e.theme),h("Settings saved successfully!"),setTimeout(()=>h(""),3e3)}catch(e){console.error("Failed to save settings:",e),h("Failed to save settings")}finally{d(!1)}},g=(e,t)=>{s(s=>({...s,[e]:t})),"theme"===e&&f(t)},f=e=>{let s=document.documentElement;"dark"===e?s.classList.add("dark"):"light"===e?s.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches?s.classList.add("dark"):s.classList.remove("dark")};return t?(0,a.jsxs)("div",{className:"flex items-center justify-center p-8",children:[(0,a.jsx)(eF.Z,{className:"h-6 w-6 animate-spin mr-2"}),"Loading settings..."]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"System Settings"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Configure your supermarket billing system preferences"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(n.z,{variant:"outline",onClick:()=>{try{let s=JSON.stringify(e,null,2),t=new Blob([s],{type:"application/json"}),a=URL.createObjectURL(t),l=document.createElement("a");l.href=a,l.download="supermarket-settings-".concat(new Date().toISOString().split("T")[0],".json"),document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(a),h("Settings exported successfully!"),setTimeout(()=>h(""),3e3)}catch(e){h("Failed to export settings")}},children:[(0,a.jsx)(e5.Z,{className:"mr-2 h-4 w-4"}),"Export"]}),(0,a.jsx)("label",{htmlFor:"import-settings",children:(0,a.jsx)(n.z,{variant:"outline",asChild:!0,children:(0,a.jsxs)("span",{children:[(0,a.jsx)(E.Z,{className:"mr-2 h-4 w-4"}),"Import"]})})}),(0,a.jsx)("input",{id:"import-settings",type:"file",accept:".json",className:"hidden",onChange:e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!a)return;let l=new FileReader;l.onload=e=>{try{var t;let a=JSON.parse(null===(t=e.target)||void 0===t?void 0:t.result);s(e=>({...e,...a})),h("Settings imported successfully!"),setTimeout(()=>h(""),3e3)}catch(e){h("Failed to import settings: Invalid file format")}},l.readAsText(a),e.target.value=""}}),(0,a.jsxs)(n.z,{variant:"outline",onClick:()=>{confirm("Are you sure you want to reset all settings to defaults?")&&(localStorage.removeItem("systemSettings"),p(),h("Settings reset to defaults!"),setTimeout(()=>h(""),3e3))},children:[(0,a.jsx)(eF.Z,{className:"mr-2 h-4 w-4 ".concat(t?"animate-spin":"")}),"Reset"]}),(0,a.jsxs)(n.z,{onClick:j,disabled:i,children:[(0,a.jsx)(tQ.Z,{className:"mr-2 h-4 w-4"}),i?"Saving...":"Save Changes"]})]})]}),x&&(0,a.jsx)(u.bZ,{className:x.includes("success")?"border-green-200 bg-green-50":"border-red-200 bg-red-50",children:(0,a.jsx)(u.X,{children:x})}),(0,a.jsxs)(sI,{defaultValue:"store",className:"space-y-6",children:[(0,a.jsxs)(s_,{className:"grid w-full grid-cols-2",children:[(0,a.jsx)(sE,{value:"store",children:"Store"}),(0,a.jsx)(sE,{value:"appearance",children:"Appearance"})]}),(0,a.jsx)(sF,{value:"store",className:"space-y-6",children:(0,a.jsx)("div",{className:"grid grid-cols-1 gap-6",children:(0,a.jsxs)(m.Zb,{children:[(0,a.jsxs)(m.Ol,{children:[(0,a.jsxs)(m.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(t$.Z,{className:"h-5 w-5"}),"Store Information"]}),(0,a.jsx)(m.SZ,{children:"Basic information about your store"})]}),(0,a.jsxs)(m.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"storeName",children:"Store Name"}),(0,a.jsx)(c,{id:"storeName",value:e.storeName,onChange:e=>g("storeName",e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"storeAddress",children:"Address"}),(0,a.jsx)(c,{id:"storeAddress",value:e.storeAddress,onChange:e=>g("storeAddress",e.target.value)})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"storePhone",children:"Phone"}),(0,a.jsx)(c,{id:"storePhone",value:e.storePhone,onChange:e=>g("storePhone",e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"storeEmail",children:"Email"}),(0,a.jsx)(c,{id:"storeEmail",type:"email",value:e.storeEmail,onChange:e=>g("storeEmail",e.target.value)})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"gstNumber",children:"GST Number"}),(0,a.jsx)(c,{id:"gstNumber",value:e.gstNumber,onChange:e=>g("gstNumber",e.target.value)})]})]})]})})}),(0,a.jsx)(sF,{value:"appearance",className:"space-y-6",children:(0,a.jsx)("div",{className:"grid grid-cols-1 gap-6",children:(0,a.jsxs)(m.Zb,{children:[(0,a.jsxs)(m.Ol,{children:[(0,a.jsxs)(m.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(t0.Z,{className:"h-5 w-5"}),"Theme Settings"]}),(0,a.jsx)(m.SZ,{children:"Customize the appearance of the application"})]}),(0,a.jsx)(m.aY,{className:"space-y-4",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o,{htmlFor:"theme",children:"Theme"}),(0,a.jsxs)(J,{value:e.theme,onValueChange:e=>g("theme",e),children:[(0,a.jsx)(W,{children:(0,a.jsx)(X,{})}),(0,a.jsxs)(Q,{children:[(0,a.jsx)($,{value:"light",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(z.Z,{className:"h-4 w-4"}),"Light"]})}),(0,a.jsx)($,{value:"dark",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(P.Z,{className:"h-4 w-4"}),"Dark"]})}),(0,a.jsx)($,{value:"system",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(M.Z,{className:"h-4 w-4"}),"System"]})})]})]})]})})]})})})]})]})}var t2=t(70650);function t4(e){let{className:s,...t}=e;return(0,a.jsx)(t2.fC,{"data-slot":"avatar",className:(0,i.cn)("relative flex size-8 shrink-0 overflow-hidden rounded-full",s),...t})}function t3(e){let{className:s,...t}=e;return(0,a.jsx)(t2.Ee,{"data-slot":"avatar-image",className:(0,i.cn)("aspect-square size-full",s),...t})}function t5(e){let{className:s,...t}=e;return(0,a.jsx)(t2.NY,{"data-slot":"avatar-fallback",className:(0,i.cn)("bg-muted flex size-full items-center justify-center rounded-full",s),...t})}var t6=t(53581),t8=t(54001),t9=t(60044);function t7(){let{user:e}=(0,r.a)(),{toast:s}=sw(),[t,n]=(0,l.useState)(null),[i,c]=(0,l.useState)(!0),[d,o]=(0,l.useState)(!1),[m,u]=(0,l.useState)(null),[x,h]=(0,l.useState)(!1),[p,j]=(0,l.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),[g,f]=(0,l.useState)(!1),[v,N]=(0,l.useState)("photo");(0,l.useEffect)(()=>{y()},[]);let y=async()=>{try{if(c(!0),(null==e?void 0:e.role)==="admin"){let s={_id:e.id,user:{_id:e.id,name:e.name,email:e.email,employeeId:"ADMIN",role:"admin",isActive:!0},personalDetails:{firstName:e.name.split(" ")[0]||"Admin",lastName:e.name.split(" ")[1]||"User",dateOfBirth:"",gender:"",bloodGroup:""},contactDetails:{phone:"",emergencyPhone:"",address:{street:"",city:"",state:"",postalCode:"",country:""}},identification:{aadhaarNumber:"",panNumber:""},employmentDetails:{department:"Administration",position:"Administrator",dateOfJoining:new Date().toISOString().split("T")[0],salary:0,bankAccount:{accountNumber:"",bankName:"",ifscCode:"",branchName:""}},status:"active",leaveBalance:{casual:0,sick:0,earned:0},createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};n(s),u(s)}else if(null==e?void 0:e.employeeId){let s=await ez.apiClient.get("/employees/".concat(e.employeeId));n(s),u(s)}else n(null),u(null)}catch(e){s({title:"Error",description:"Failed to fetch profile data",variant:"destructive"})}finally{c(!1)}},b=async()=>{if(m)try{if((null==e?void 0:e.role)==="admin")n(m),o(!1),s({title:"Success",description:"Admin profile updated successfully"});else if(null==e?void 0:e.employeeId){let t=await ez.apiClient.put("/employees/".concat(e.employeeId),m);n(t),o(!1),s({title:"Success",description:"Profile updated successfully"})}}catch(e){s({title:"Error",description:"Failed to update profile",variant:"destructive"})}},w=async()=>{if(p.newPassword!==p.confirmPassword){s({title:"Error",description:"New passwords do not match",variant:"destructive"});return}if(p.newPassword.length<6){s({title:"Error",description:"Password must be at least 6 characters long",variant:"destructive"});return}try{await ez.apiClient.put("/auth/change-password",{currentPassword:p.currentPassword,newPassword:p.newPassword}),s({title:"Success",description:"Password changed successfully"}),j({currentPassword:"",newPassword:"",confirmPassword:""}),h(!1)}catch(e){s({title:"Error",description:"Failed to change password",variant:"destructive"})}},C=async(t,a)=>{var l;let r=null===(l=t.target.files)||void 0===l?void 0:l[0];if(!r)return;f(!0);let i=new FormData;i.append("file",r),i.append("documentType",a);try{let t=await ez.apiClient.put("/employees/".concat(null==e?void 0:e.employeeId,"/upload-document"),i);n(t),u(t),s({title:"Success",description:"".concat(a," uploaded successfully")})}catch(e){s({title:"Error",description:"Failed to upload ".concat(a),variant:"destructive"})}finally{f(!1)}};return i?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Loading profile data..."})]})}):t?(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsx)(ae,{profileData:t,editing:d,setEditing:o,handleSave:b,handleCancel:()=>{u(t),o(!1)},showPasswordDialog:x,setShowPasswordDialog:h,passwordData:p,setPasswordData:j,handlePasswordChange:w,activeDocumentTab:v,setActiveDocumentTab:N,editData:m,handleInputChange:(e,s,t)=>{m&&u(a=>{if(!a)return a;if("contactDetails"===e&&["street","city","state","postalCode","country"].includes(s))return{...a,contactDetails:{...a.contactDetails,address:{...a.contactDetails.address,[s]:t}}};let l=a[e];return{...a,[e]:{...l,[s]:t}}})},uploading:g,setUploading:f,handleFileUpload:C,getInitials:e=>e.split(" ").map(e=>e[0]).join("").toUpperCase(),calculateServicePeriod:()=>{if(!(null==t?void 0:t.employmentDetails.dateOfJoining))return"0 days";let e=new Date(t.employmentDetails.dateOfJoining),s=Math.ceil(Math.abs(new Date().getTime()-e.getTime())/864e5),a=Math.floor(s/365),l=Math.floor(s%365/30),r=s%30;return a>0?"".concat(a," year").concat(a>1?"s":""," ").concat(l," month").concat(l>1?"s":""):l>0?"".concat(l," month").concat(l>1?"s":""," ").concat(r," day").concat(r>1?"s":""):"".concat(r," day").concat(r>1?"s":"")}})}):(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-muted-foreground mb-2",children:"No profile data available"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Please contact your administrator"})]})})}function ae(e){var s;let{profileData:t,editing:l,setEditing:r,handleSave:i,handleCancel:d,showPasswordDialog:u,setShowPasswordDialog:x,passwordData:h,setPasswordData:p,handlePasswordChange:g,activeDocumentTab:f,setActiveDocumentTab:v,editData:N,handleInputChange:y,uploading:b,setUploading:w,handleFileUpload:C,getInitials:k,calculateServicePeriod:D}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.Zb,{className:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-950/20 dark:to-indigo-950/20",children:(0,a.jsx)(m.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)(t4,{className:"h-24 w-24",children:[(0,a.jsx)(t3,{src:null===(s=t.identification.photo)||void 0===s?void 0:s.path,alt:t.user.name}),(0,a.jsx)(t5,{className:"text-lg",children:k(t.user.name)})]}),(0,a.jsx)(n.z,{size:"sm",className:"absolute -bottom-2 -right-2 h-8 w-8 rounded-full",onClick:()=>v("photo"),children:(0,a.jsx)(t6.Z,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:t.user.name}),(0,a.jsx)("p",{className:"text-muted-foreground",children:t.employmentDetails.position}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 mt-2",children:[(0,a.jsx)(j.C,{variant:"secondary",children:t.user.employeeId}),(0,a.jsx)(j.C,{variant:t.user.isActive?"default":"destructive",children:t.user.isActive?"Active":"Inactive"}),(0,a.jsx)(j.C,{variant:"outline",children:t.user.role})]})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsxs)(eh,{open:u,onOpenChange:x,children:[(0,a.jsx)(ep,{asChild:!0,children:(0,a.jsxs)(n.z,{variant:"outline",children:[(0,a.jsx)(t8.Z,{className:"mr-2 h-4 w-4"}),"Change Password"]})}),(0,a.jsxs)(ef,{children:[(0,a.jsxs)(ev,{children:[(0,a.jsx)(ey,{children:"Change Password"}),(0,a.jsx)(eb,{children:"Enter your current password and a new password to update your credentials."})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{htmlFor:"currentPassword",children:"Current Password"}),(0,a.jsx)(c,{id:"currentPassword",type:"password",value:h.currentPassword,onChange:e=>p(s=>({...s,currentPassword:e.target.value}))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{htmlFor:"newPassword",children:"New Password"}),(0,a.jsx)(c,{id:"newPassword",type:"password",value:h.newPassword,onChange:e=>p(s=>({...s,newPassword:e.target.value}))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{htmlFor:"confirmPassword",children:"Confirm New Password"}),(0,a.jsx)(c,{id:"confirmPassword",type:"password",value:h.confirmPassword,onChange:e=>p(s=>({...s,confirmPassword:e.target.value}))})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)(n.z,{variant:"outline",onClick:()=>x(!1),children:"Cancel"}),(0,a.jsx)(n.z,{onClick:g,children:"Change Password"})]})]})]})]}),l?(0,a.jsxs)("div",{className:"space-x-2",children:[(0,a.jsxs)(n.z,{onClick:i,children:[(0,a.jsx)(tQ.Z,{className:"mr-2 h-4 w-4"}),"Save"]}),(0,a.jsxs)(n.z,{variant:"outline",onClick:d,children:[(0,a.jsx)(U.Z,{className:"mr-2 h-4 w-4"}),"Cancel"]})]}):(0,a.jsxs)(n.z,{onClick:()=>r(!0),children:[(0,a.jsx)(eS.Z,{className:"mr-2 h-4 w-4"}),"Edit Profile"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mt-6",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(sW.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("span",{className:"text-sm",children:t.user.email})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(tD.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("span",{className:"text-sm",children:t.contactDetails.phone})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(t9.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("span",{className:"text-sm",children:t.employmentDetails.department})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(tA.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("span",{className:"text-sm",children:D()})]})]})]})]})})}),(0,a.jsxs)(sI,{defaultValue:"personal",className:"space-y-4",children:[(0,a.jsxs)(s_,{className:"grid w-full grid-cols-2",children:[(0,a.jsx)(sE,{value:"personal",children:"Personal"}),(0,a.jsx)(sE,{value:"contact",children:"Contact"})]}),(0,a.jsx)(sF,{value:"personal",children:(0,a.jsxs)(m.Zb,{children:[(0,a.jsx)(m.Ol,{children:(0,a.jsxs)(m.ll,{className:"flex items-center",children:[(0,a.jsx)(S.Z,{className:"mr-2 h-5 w-5"}),"Personal Information"]})}),(0,a.jsxs)(m.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{htmlFor:"firstName",children:"First Name"}),l?(0,a.jsx)(c,{id:"firstName",value:(null==N?void 0:N.personalDetails.firstName)||"",onChange:e=>y("personalDetails","firstName",e.target.value)}):(0,a.jsx)("p",{className:"mt-1 text-sm font-medium",children:t.personalDetails.firstName})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{htmlFor:"lastName",children:"Last Name"}),l?(0,a.jsx)(c,{id:"lastName",value:(null==N?void 0:N.personalDetails.lastName)||"",onChange:e=>y("personalDetails","lastName",e.target.value)}):(0,a.jsx)("p",{className:"mt-1 text-sm font-medium",children:t.personalDetails.lastName})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{htmlFor:"dateOfBirth",children:"Date of Birth"}),l?(0,a.jsx)(c,{id:"dateOfBirth",type:"date",value:(null==N?void 0:N.personalDetails.dateOfBirth)||"",onChange:e=>y("personalDetails","dateOfBirth",e.target.value)}):(0,a.jsx)("p",{className:"mt-1 text-sm",children:new Date(t.personalDetails.dateOfBirth).toLocaleDateString()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{htmlFor:"gender",children:"Gender"}),l?(0,a.jsx)(c,{id:"gender",value:(null==N?void 0:N.personalDetails.gender)||"",onChange:e=>y("personalDetails","gender",e.target.value)}):(0,a.jsx)("p",{className:"mt-1 text-sm",children:t.personalDetails.gender})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{htmlFor:"bloodGroup",children:"Blood Group"}),l?(0,a.jsx)(c,{id:"bloodGroup",value:(null==N?void 0:N.personalDetails.bloodGroup)||"",onChange:e=>y("personalDetails","bloodGroup",e.target.value)}):(0,a.jsx)("p",{className:"mt-1 text-sm",children:t.personalDetails.bloodGroup||"Not specified"})]})]})]})}),(0,a.jsx)(sF,{value:"contact",children:(0,a.jsxs)(m.Zb,{children:[(0,a.jsx)(m.Ol,{children:(0,a.jsxs)(m.ll,{className:"flex items-center",children:[(0,a.jsx)(tD.Z,{className:"mr-2 h-5 w-5"}),"Contact Details"]})}),(0,a.jsxs)(m.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{htmlFor:"phone",children:"Phone Number"}),l?(0,a.jsx)(c,{id:"phone",value:(null==N?void 0:N.contactDetails.phone)||"",onChange:e=>y("contactDetails","phone",e.target.value)}):(0,a.jsx)("p",{className:"mt-1 text-sm font-medium",children:t.contactDetails.phone})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{htmlFor:"emergencyPhone",children:"Emergency Phone"}),l?(0,a.jsx)(c,{id:"emergencyPhone",value:(null==N?void 0:N.contactDetails.emergencyPhone)||"",onChange:e=>y("contactDetails","emergencyPhone",e.target.value)}):(0,a.jsx)("p",{className:"mt-1 text-sm",children:t.contactDetails.emergencyPhone||"Not specified"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{htmlFor:"street",children:"Street Address"}),l?(0,a.jsx)(c,{id:"street",value:(null==N?void 0:N.contactDetails.address.street)||"",onChange:e=>y("contactDetails","street",e.target.value)}):(0,a.jsx)("p",{className:"mt-1 text-sm",children:t.contactDetails.address.street})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{htmlFor:"city",children:"City"}),l?(0,a.jsx)(c,{id:"city",value:(null==N?void 0:N.contactDetails.address.city)||"",onChange:e=>y("contactDetails","city",e.target.value)}):(0,a.jsx)("p",{className:"mt-1 text-sm",children:t.contactDetails.address.city})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{htmlFor:"state",children:"State"}),l?(0,a.jsx)(c,{id:"state",value:(null==N?void 0:N.contactDetails.address.state)||"",onChange:e=>y("contactDetails","state",e.target.value)}):(0,a.jsx)("p",{className:"mt-1 text-sm",children:t.contactDetails.address.state})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{htmlFor:"postalCode",children:"Postal Code"}),l?(0,a.jsx)(c,{id:"postalCode",value:(null==N?void 0:N.contactDetails.address.postalCode)||"",onChange:e=>y("contactDetails","postalCode",e.target.value)}):(0,a.jsx)("p",{className:"mt-1 text-sm",children:t.contactDetails.address.postalCode})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{htmlFor:"country",children:"Country"}),l?(0,a.jsx)(c,{id:"country",value:(null==N?void 0:N.contactDetails.address.country)||"",onChange:e=>y("contactDetails","country",e.target.value)}):(0,a.jsx)("p",{className:"mt-1 text-sm",children:t.contactDetails.address.country})]})]})]})]})}),(0,a.jsx)(sF,{value:"settings",children:(0,a.jsxs)(m.Zb,{children:[(0,a.jsxs)(m.Ol,{children:[(0,a.jsxs)(m.ll,{className:"flex items-center",children:[(0,a.jsx)(M.Z,{className:"mr-2 h-5 w-5"}),"Security Settings"]}),(0,a.jsx)(m.SZ,{children:"Manage your account security and password"})]}),(0,a.jsx)(m.aY,{className:"space-y-4",children:(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-lg font-medium",children:"Change Password"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Update your password to keep your account secure"}),(0,a.jsxs)(n.z,{onClick:()=>x(!0),className:"w-full",children:[(0,a.jsx)(t8.Z,{className:"mr-2 h-4 w-4"}),"Change Password"]})]})})})]})})]})]})}var as=t(60610);function at(e){let{className:s,value:t,...l}=e;return(0,a.jsx)(as.fC,{"data-slot":"progress",className:(0,i.cn)("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",s),...l,children:(0,a.jsx)(as.z$,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:"translateX(-".concat(100-(t||0),"%)")}})})}var aa=t(92934),al=t(52636);let ar=()=>{let[e,s]=(0,l.useState)(null),[t,a]=(0,l.useState)(!0),[r,n]=(0,l.useState)(null),[i,c]=(0,l.useState)(!1),[d,o]=(0,l.useState)(!1),[m,u]=(0,l.useState)(!1),x=(0,l.useCallback)(async e=>{c(!0);try{console.log("Saving draft:",e),s(s=>({...s,...e})),n(null)}catch(e){n(e.message||"Failed to save draft")}finally{c(!1)}},[]),h=(0,l.useCallback)(async(e,s)=>{o(!0);try{console.log("Uploading file:",e,s),n(null)}catch(e){n(e.message||"Failed to upload file")}finally{o(!1)}},[]),p=(0,l.useCallback)(async()=>{u(!0);try{console.log("Submitting data"),s(e=>({...e,status:"pending_review"})),n(null)}catch(e){n(e.message||"Failed to submit")}finally{u(!1)}},[]),j=(0,l.useCallback)(async()=>{a(!0);try{console.log("Refreshing data"),n(null)}catch(e){n(e.message||"Failed to refresh")}finally{a(!1)}},[]);return(0,l.useEffect)(()=>{setTimeout(()=>{a(!1)},1e3)},[]),{data:e,isLoading:t,error:r,isSaving:i,isUploading:d,isSubmitting:m,saveDraft:x,uploadFile:h,submit:p,refresh:j}},an=[{id:"business",title:"Business Profile",description:"Store information"},{id:"tax",title:"Tax & Pricing",description:"Tax configuration"},{id:"items",title:"Item Master",description:"Product catalog"},{id:"receipt",title:"Receipt Sample",description:"Bill format"},{id:"review",title:"Review",description:"Submit for approval"}],ai=[{value:"gst",label:"GST (India)"},{value:"vat",label:"VAT"},{value:"sales_tax",label:"Sales Tax"},{value:"none",label:"No Tax"}],ac=[{value:"nearest",label:"Nearest"},{value:"up",label:"Always Up"},{value:"down",label:"Always Down"},{value:"none",label:"No Rounding"}];function ad(e){let{label:s,children:t,className:l}=e;return(0,a.jsxs)("div",{className:l,children:[(0,a.jsx)(o,{className:"text-xs font-medium text-muted-foreground",children:s}),(0,a.jsx)("div",{className:"mt-1.5",children:t})]})}function ao(e){let{currentStep:s,onStepChange:t}=e;return(0,a.jsx)("div",{className:"flex flex-wrap gap-3",children:an.map((e,l)=>{let r=e.id===s,n=an.findIndex(e=>e.id===s)>l;return(0,a.jsxs)("button",{type:"button",onClick:()=>t(e.id),className:(0,i.cn)("flex flex-col items-start rounded-lg border px-4 py-2 text-left",r&&"border-primary bg-primary/5",n&&"border-green-500 bg-green-50"),children:[(0,a.jsxs)("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:["Step ",l+1]}),(0,a.jsxs)("span",{className:"text-sm font-semibold flex items-center gap-2",children:[e.title,n&&(0,a.jsx)(aa.Z,{className:"h-4 w-4 text-green-600"})]})]},e.id)})})}function am(e){let{label:s,description:t,files:l,isUploading:r,accept:i,onChange:c}=e;return(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{className:"text-sm font-medium",children:s}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mb-2",children:t}),(0,a.jsx)("div",{className:"border-2 border-dashed border-muted-foreground/25 rounded-lg p-4 text-center",children:r?(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 text-muted-foreground",children:[(0,a.jsx)(x.Z,{className:"h-4 w-4 animate-spin"})," Uploading..."]}):(0,a.jsxs)("div",{children:[(0,a.jsx)(E.Z,{className:"mx-auto h-8 w-8 text-muted-foreground"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:"Drag & drop or click to browse"}),(0,a.jsx)("input",{type:"file",accept:i,onChange:c,className:"hidden",id:s}),(0,a.jsx)(n.z,{variant:"outline",size:"sm",className:"mt-2",asChild:!0,children:(0,a.jsx)("label",{htmlFor:s,children:"Choose File"})})]})}),l.length>0&&(0,a.jsx)("ul",{className:"mt-2 space-y-1",children:l.map((e,s)=>(0,a.jsxs)("li",{className:"text-xs text-muted-foreground flex items-center gap-2",children:[(0,a.jsx)(aa.Z,{className:"h-3 w-3 text-green-600"}),e.originalName]},s))})]})}function au(e){let{label:s,value:t}=e;return(0,a.jsxs)("div",{className:"flex justify-between py-2 border-b border-muted",children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:s}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:t})]})}function ax(e){let{title:s,description:t,children:l}=e;return(0,a.jsxs)(m.Zb,{children:[(0,a.jsxs)(m.Ol,{children:[(0,a.jsx)(m.ll,{children:s}),(0,a.jsx)(m.SZ,{children:t})]}),(0,a.jsx)(m.aY,{className:"space-y-4",children:l})]})}function ah(){let[e,s]=(0,l.useState)("business"),[t,r]=(0,l.useState)({}),[i,d]=(0,l.useState)({}),[o,m]=(0,l.useState)({}),[h,p]=(0,l.useState)(0),[j,g]=(0,l.useState)({}),{data:f,isLoading:v,error:N,isSaving:y,isUploading:b,isSubmitting:w,saveDraft:C,uploadFile:S,submit:k,refresh:D}=ar();(0,l.useEffect)(()=>{if(f){var e;r(f.businessProfile||{}),d(f.taxConfig||{}),m(f.receiptSample||{}),p((null===(e=f.itemMaster)||void 0===e?void 0:e.totalSkuCount)||0)}},[f]);let z=(0,l.useMemo)(()=>(an.findIndex(s=>s.id===e)+1)/an.length*100,[e]),P=(0,l.useMemo)(()=>(null==f?void 0:f.files)?{SKU_LIST:f.files.filter(e=>"SKU_LIST"===e.type),TAX_PROOF:f.files.filter(e=>"TAX_PROOF"===e.type),BILL_SAMPLE:f.files.filter(e=>"BILL_SAMPLE"===e.type)}:{SKU_LIST:[],TAX_PROOF:[],BILL_SAMPLE:[]},[null==f?void 0:f.files]),A=()=>{var e,s,a,l;let r={};return(null===(e=t.storeName)||void 0===e?void 0:e.trim())||(r.storeName="Store name is required"),(null===(s=t.contactName)||void 0===s?void 0:s.trim())||(r.contactName="Contact name is required"),(null===(a=t.contactPhone)||void 0===a?void 0:a.trim())?/^\+?[0-9]{10,15}$/.test(t.contactPhone.replace(/\s/g,""))||(r.contactPhone="Please enter a valid phone number"):r.contactPhone="Contact phone is required",(null===(l=t.contactEmail)||void 0===l?void 0:l.trim())?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.contactEmail)||(r.contactEmail="Please enter a valid email address"):r.contactEmail="Contact email is required",g(e=>({...e,businessProfile:Object.keys(r).length>0?r:void 0})),0===Object.keys(r).length},Z=()=>{var e;let s={};return i.regime||(s.regime="Tax regime is required"),"gst"!==i.regime||(null===(e=i.gstin)||void 0===e?void 0:e.trim())?i.gstin&&!/^[0-9A-Z]{5}[0-9A-Z]{4}[0-9A-Z]{1}[0-9A-Z]{1}[0-9A-Z]{3}$/.test(i.gstin)&&(s.gstin="Please enter a valid GSTIN format"):s.gstin="GSTIN is required for GST regime",i.roundingPreference||(s.roundingPreference="Rounding preference is required"),g(e=>({...e,taxConfig:Object.keys(s).length>0?s:void 0})),0===Object.keys(s).length},I=()=>{var e;let s={};return o.useSystemDefault||(null===(e=o.notes)||void 0===e?void 0:e.trim())||(s.notes="Notes are required when using custom receipt format"),g(e=>({...e,receiptSample:Object.keys(s).length>0?s:void 0})),0===Object.keys(s).length},_=(0,l.useCallback)(async()=>{A()&&(await C({businessProfile:t}),s("tax"))},[t,C,j]),E=(0,l.useCallback)(async()=>{Z()&&(await C({taxConfig:i}),s("items"))},[i,C,j]),F=(0,l.useCallback)(async()=>{I()&&(await C({receiptSample:o}),s("review"))},[o,C,j]),T=(0,l.useCallback)(async(e,s)=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];a&&await S(a,s)},[S]);return v?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(x.Z,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Loading client data..."})]})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Client Data Intake"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Complete your business setup to unlock billing features"})]}),(0,a.jsxs)(n.z,{variant:"outline",onClick:()=>D(),children:[(0,a.jsx)(al.Z,{className:"mr-2 h-4 w-4"}),"Refresh"]})]}),(null==f?void 0:f.status)==="pending_review"&&(0,a.jsxs)(u.bZ,{children:[(0,a.jsx)(sL.Z,{className:"h-4 w-4"}),(0,a.jsx)(u.X,{children:"Your data is currently under review. You can still make changes, but you'll need to resubmit."})]}),(null==f?void 0:f.status)==="complete"&&(0,a.jsxs)(u.bZ,{children:[(0,a.jsx)(aa.Z,{className:"h-4 w-4"}),(0,a.jsx)(u.X,{children:"Your client data has been approved. All features are now available."})]}),Object.keys(j).length>0&&(0,a.jsxs)(u.bZ,{children:[(0,a.jsx)(sL.Z,{className:"h-4 w-4"}),(0,a.jsxs)(u.X,{children:["Please fix the following errors before proceeding:",(0,a.jsx)("ul",{className:"list-disc list-inside mt-2",children:Object.entries(j).map(e=>{let[s,t]=e;return(0,a.jsxs)("li",{children:[(0,a.jsxs)("strong",{children:[s,":"]}),(0,a.jsx)("ul",{className:"list-disc list-inside ml-4",children:Object.entries(t).map(e=>{let[s,t]=e;return(0,a.jsx)("li",{children:String(t)},s)})})]},s)})})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(ao,{currentStep:e,onStepChange:s}),(0,a.jsx)(at,{value:z,className:"w-full"})]}),(()=>{var l,p,j;switch(e){case"business":return(0,a.jsxs)(ax,{title:"Business Profile",description:"Store information and contact details",children:[(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsx)(ad,{label:"Store Name",children:(0,a.jsx)(c,{value:t.storeName||"",onChange:e=>r(s=>({...s,storeName:e.target.value})),placeholder:"Your store name"})}),(0,a.jsx)(ad,{label:"Contact Name",children:(0,a.jsx)(c,{value:t.contactName||"",onChange:e=>r(s=>({...s,contactName:e.target.value})),placeholder:"Primary contact person"})}),(0,a.jsx)(ad,{label:"Contact Phone",children:(0,a.jsx)(c,{value:t.contactPhone||"",onChange:e=>r(s=>({...s,contactPhone:e.target.value})),placeholder:"+91 98765 43210"})}),(0,a.jsx)(ad,{label:"Contact Email",children:(0,a.jsx)(c,{type:"email",value:t.contactEmail||"",onChange:e=>r(s=>({...s,contactEmail:e.target.value})),placeholder:"contact@store.com"})})]}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsxs)(n.z,{onClick:_,disabled:y,children:[y?(0,a.jsx)(x.Z,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Save & Continue"]})})]});case"tax":return(0,a.jsxs)(ax,{title:"Tax Configuration",description:"Tax settings and pricing preferences",children:[(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsx)(ad,{label:"Tax Regime",children:(0,a.jsxs)(J,{value:i.regime||"",onValueChange:e=>d(s=>({...s,regime:e})),children:[(0,a.jsx)(W,{children:(0,a.jsx)(X,{placeholder:"Select tax regime"})}),(0,a.jsx)(Q,{children:ai.map(e=>(0,a.jsx)($,{value:e.value,children:e.label},e.value))})]})}),(0,a.jsx)(ad,{label:"GSTIN (Optional)",children:(0,a.jsx)(c,{value:i.gstin||"",onChange:e=>d(s=>({...s,gstin:e.target.value})),placeholder:"29ABCDE1234F1ZV"})}),(0,a.jsx)(ad,{label:"Rounding Preference",children:(0,a.jsxs)(J,{value:i.roundingPreference||"",onValueChange:e=>d(s=>({...s,roundingPreference:e})),children:[(0,a.jsx)(W,{children:(0,a.jsx)(X,{placeholder:"Select rounding"})}),(0,a.jsx)(Q,{children:ac.map(e=>(0,a.jsx)($,{value:e.value,children:e.label},e.value))})]})})]}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsxs)(n.z,{onClick:E,disabled:y,children:[y?(0,a.jsx)(x.Z,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Save & Continue"]})})]});case"items":return(0,a.jsx)(ax,{title:"Item Master Upload",description:"Upload your product catalog with pricing",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(am,{label:"SKU List (CSV/Excel)",description:"Upload your complete product catalog with SKU codes, names, and prices",files:P.SKU_LIST,isUploading:b,accept:".csv,.xlsx,.xls",onChange:e=>T(e,"SKU_LIST")}),h>0&&(0,a.jsx)("div",{className:"p-4 bg-muted rounded-lg",children:(0,a.jsxs)("p",{className:"text-sm",children:[(0,a.jsx)("strong",{children:"Total SKUs:"})," ",h]})}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)(n.z,{variant:"outline",onClick:()=>s("tax"),children:"Back"}),(0,a.jsx)(n.z,{onClick:()=>s("receipt"),disabled:0===P.SKU_LIST.length,children:"Continue"})]})]})});case"receipt":return(0,a.jsxs)(ax,{title:"Receipt Sample",description:"Bill format and layout preferences",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"grid gap-4 md:grid-cols-2",children:(0,a.jsx)(ad,{label:"Receipt Format",children:(0,a.jsxs)(J,{value:!1!==o.useSystemDefault?"system":"custom",onValueChange:e=>m(s=>({...s,useSystemDefault:"system"===e})),children:[(0,a.jsx)(W,{children:(0,a.jsx)(X,{})}),(0,a.jsxs)(Q,{children:[(0,a.jsx)($,{value:"system",children:"System Default"}),(0,a.jsx)($,{value:"custom",children:"Custom Format"})]})]})})}),(0,a.jsx)(ad,{label:"Notes",children:(0,a.jsx)(sR,{rows:3,value:null!==(l=o.notes)&&void 0!==l?l:"",onChange:e=>m(s=>({...s,notes:e.target.value}))})})]}),!o.useSystemDefault&&(0,a.jsx)(am,{label:"Sample Printed Bill (PDF/Image)",description:"Photos from your receipt printer work too",files:P.BILL_SAMPLE,isUploading:b,accept:".pdf,.png,.jpg,.jpeg",onChange:e=>T(e,"BILL_SAMPLE")}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)(n.z,{variant:"outline",onClick:()=>s("items"),children:"Back"}),(0,a.jsxs)(n.z,{onClick:F,disabled:y,children:[y?(0,a.jsx)(x.Z,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Save & Continue"]})]})]});case"review":return(0,a.jsxs)(ax,{title:"Review",description:"Double-check everything before submitting",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(au,{label:"Store Name",value:t.storeName||"-"}),(0,a.jsx)(au,{label:"Contact",value:"".concat(t.contactName||"-"," (").concat(t.contactPhone||"N/A",")")}),(0,a.jsx)(au,{label:"Tax Regime",value:(null===(p=ai.find(e=>e.value===i.regime))||void 0===p?void 0:p.label)||i.regime||"-"}),(0,a.jsx)(au,{label:"Rounding",value:(null===(j=ac.find(e=>e.value===i.roundingPreference))||void 0===j?void 0:j.label)||i.roundingPreference||"-"}),(0,a.jsx)(au,{label:"SKU File",value:P.SKU_LIST.length?"".concat(P.SKU_LIST.length," file(s)"):"Not uploaded"}),(0,a.jsx)(au,{label:"Tax Documents",value:P.TAX_PROOF.length?"".concat(P.TAX_PROOF.length," file(s)"):"Not uploaded"}),(0,a.jsx)(au,{label:"Receipt Sample",value:o.useSystemDefault?"Using default":P.BILL_SAMPLE.length?"Uploaded":"Pending"})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-3 justify-between",children:[(0,a.jsx)(n.z,{variant:"outline",onClick:()=>s("receipt"),children:"Back"}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)(n.z,{variant:"ghost",onClick:()=>D(),disabled:w,children:"Refresh"}),(0,a.jsxs)(n.z,{onClick:()=>k(),disabled:w||(null==f?void 0:f.status)==="pending_review"||(null==f?void 0:f.status)==="complete",children:[w?(0,a.jsx)(x.Z,{className:"mr-2 h-4 w-4 animate-spin"}):(0,a.jsx)(aa.Z,{className:"mr-2 h-4 w-4"}),(null==f?void 0:f.status)==="pending_review"||(null==f?void 0:f.status)==="complete"?"Awaiting Approval":"Submit for Review"]})]})]}),(null==f?void 0:f.status)==="pending_review"&&(0,a.jsxs)(u.bZ,{className:"mt-4",children:[(0,a.jsx)(sL.Z,{className:"h-4 w-4"}),(0,a.jsx)(u.X,{children:"Your data is pending admin approval. You'll be notified once it's marked complete."})]}),(null==f?void 0:f.status)==="complete"&&(0,a.jsx)(u.bZ,{className:"mt-4",variant:"default",children:(0,a.jsx)(u.X,{children:"All set! Billing and voice workflows are unlocked."})})]})}})()]})}function ap(e){let{isFullscreen:s=!1}=e;return(0,a.jsx)("div",{className:s?"h-full w-full":"p-6",children:(0,a.jsx)(sA,{})})}function aj(){return(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(eE,{})})}function ag(){return(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(s0,{})})}function af(){return(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(sK,{})})}function av(){return(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(tC,{})})}function aN(){return(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(tb,{})})}function ay(){return(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(tW,{})})}function ab(){return(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(tI,{})})}function aw(){return(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(t1,{})})}function aC(){return(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(ah,{})})}function aS(){return(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(t7,{})})}function ak(){let[e,s]=(0,l.useState)("billing"),[t,r]=(0,l.useState)(!0),{isFullscreen:n,showExitConfirmation:i,toggleFullscreen:c,exitFullscreen:d,setShowExitConfirmation:o}=function(){let[e,s]=(0,l.useState)(!1),[t,a]=(0,l.useState)(!1),r=(0,l.useCallback)(()=>!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement),[]),n=(0,l.useCallback)(async e=>{try{let t=e||document.documentElement;t.requestFullscreen?await t.requestFullscreen():t.webkitRequestFullscreen?await t.webkitRequestFullscreen():t.mozRequestFullScreen?await t.mozRequestFullScreen():t.msRequestFullscreen&&await t.msRequestFullscreen(),s(!0)}catch(e){console.error("Error entering fullscreen:",e)}},[]),i=(0,l.useCallback)(async()=>{try{document.exitFullscreen?await document.exitFullscreen():document.webkitExitFullscreen?await document.webkitExitFullscreen():document.mozCancelFullScreen?await document.mozCancelFullScreen():document.msExitFullscreen&&await document.msExitFullscreen(),s(!1),a(!1)}catch(e){console.error("Error exiting fullscreen:",e)}},[]),c=(0,l.useCallback)(async e=>{r()?a(!0):await n(e)},[r,n]),d=(0,l.useCallback)(()=>{s(r())},[r]),o=(0,l.useCallback)(s=>{"F11"===s.key?(s.preventDefault(),c()):"Escape"===s.key&&e&&(s.preventDefault(),a(!0))},[c,e]);return(0,l.useEffect)(()=>(document.addEventListener("fullscreenchange",d),document.addEventListener("webkitfullscreenchange",d),document.addEventListener("mozfullscreenchange",d),document.addEventListener("MSFullscreenChange",d),document.addEventListener("keydown",o),()=>{document.removeEventListener("fullscreenchange",d),document.removeEventListener("webkitfullscreenchange",d),document.removeEventListener("mozfullscreenchange",d),document.removeEventListener("MSFullscreenChange",d),document.removeEventListener("keydown",o)}),[d,o]),(0,l.useEffect)(()=>(e?(document.body.classList.add("fullscreen-mode"),document.body.style.overflow="hidden"):(document.body.classList.remove("fullscreen-mode"),document.body.style.overflow=""),()=>{document.body.classList.remove("fullscreen-mode"),document.body.style.overflow=""}),[e]),{isFullscreen:e,showExitConfirmation:t,enterFullscreen:n,exitFullscreen:i,toggleFullscreen:c,setShowExitConfirmation:a}}();return(0,a.jsxs)(p,{children:[(0,a.jsxs)("div",{className:"min-h-screen bg-background",children:[!n&&(0,a.jsx)(I,{onTabChange:s}),(0,a.jsxs)("div",{className:"flex",children:[!n&&(0,a.jsx)(q,{activeTab:e,onTabChange:s,isSidebarOpen:t,onSidebarToggle:r}),(0,a.jsx)("main",{className:"flex-1 ".concat(n?"w-screen h-screen":""),children:(()=>{switch(e){case"billing":return(0,a.jsx)(ap,{isFullscreen:n});case"client-data":return(0,a.jsx)(aC,{});case"products":return(0,a.jsx)(aj,{});case"inventory":return(0,a.jsx)(av,{});case"bills":return(0,a.jsx)(ag,{});case"shifts":return(0,a.jsx)(af,{});case"reports":return(0,a.jsx)(aN,{});case"discounts":return(0,a.jsx)(ay,{});case"users":return(0,a.jsx)(ab,{});case"settings":return(0,a.jsx)(aw,{});case"profile":return(0,a.jsx)(aS,{});default:return(0,a.jsx)(ap,{})}})()})]})]}),(0,a.jsx)(ea,{open:i,onOpenChange:o,children:(0,a.jsxs)(en,{children:[(0,a.jsxs)(ei,{children:[(0,a.jsx)(ed,{children:"Exit Fullscreen Mode?"}),(0,a.jsx)(eo,{children:"Are you sure you want to exit fullscreen mode? You can press F11 to toggle fullscreen again at any time."})]}),(0,a.jsxs)(ec,{children:[(0,a.jsx)(eu,{children:"Cancel"}),(0,a.jsx)(em,{onClick:d,children:"Exit Fullscreen"})]})]})})]})}},24880:function(e,s,t){"use strict";t.d(s,{LanguageProvider:function(){return i},Z:function(){return c}});var a=t(57437),l=t(2265);let r={en:{supermarket_store:"SUPERMARKET STORE",bill:"BILL",date:"DATE",cashier:"CASHIER",customer:"CUSTOMER",phone:"PHONE",email:"EMAIL",items:"ITEMS",subtotal:"SUBTOTAL",loyalty_discount:"LOYALTY DISCOUNT",total_tax:"TOTAL TAX",round_off:"ROUND OFF",total:"TOTAL",payment_method:"PAYMENT METHOD",cash_tendered:"CASH TENDERED",change:"CHANGE",thank_you:"THANK YOU FOR YOUR PURCHASE!",please_visit_again:"PLEASE VISIT AGAIN",paid:"*** PAID ***",walk_in_customer:"Walk-in Customer",client_data_title:"Client Data Intake",client_data_subtitle:"Complete your business setup to unlock billing features",step_business:"Business Profile",step_business_desc:"Store information",step_tax:"Tax & Pricing",step_tax_desc:"Tax configuration",step_items:"Item Master",step_items_desc:"Product catalog",step_receipt:"Receipt Sample",step_receipt_desc:"Bill format",step_review:"Review",step_review_desc:"Submit for approval",store_name:"Store Name",contact_name:"Contact Name",contact_phone:"Contact Phone",contact_email:"Contact Email",tax_regime:"Tax Regime",gstin:"GSTIN",rounding_preference:"Rounding Preference",upload_sku_list:"Upload SKU List",upload_tax_proof:"Upload Tax Proof",upload_receipt_sample:"Upload Receipt Sample",use_system_default:"Use System Default",custom_receipt_notes:"Custom Receipt Notes",save_draft:"Save Draft",next:"Next",back:"Back",submit:"Submit for Review",refresh:"Refresh",validation_required:"This field is required",validation_email:"Please enter a valid email address",validation_phone:"Please enter a valid phone number",validation_gstin:"Please enter a valid GSTIN format"},ta:{supermarket_store:"சூப்பர்மார்க்கெட் ஸ்டோர்",bill:"பில்",date:"தேதி",cashier:"பணம் வசூலிப்பவர்",customer:"வாடிக்கையாளர்",phone:"தொலைபேசி",email:"மின்னஞ்சல்",items:"பொருட்கள்",subtotal:"மொத்தம்",loyalty_discount:"விசுவாசத் தள்ளுபடி",total_tax:"மொத்த வரி",round_off:"சுற்றளவு",total:"மொத்தம்",payment_method:"கட்டண முறை",cash_tendered:"பணம் கொடுக்கப்பட்டது",change:"மாற்றுத் தொகை",thank_you:"உங்கள் கொள்முதலுக்கு நன்றி!",please_visit_again:"மீண்டும் வருகையிடுங்கள்",paid:"*** செலுத்தப்பட்டது ***",walk_in_customer:"நேரடி வாடிக்கையாளர்",client_data_title:"வாடிக்கையாளர் தரவு உள்வாங்கல்",client_data_subtitle:"பில்லிங் அம்சங்களை செயல்படுத்த உங்கள் வணிக அமைப்பை முடிக்கவும்",step_business:"வணிக சுயவிவரம்",step_business_desc:"கடை தகவல்",step_tax:"வரி மற்றும் விலை",step_tax_desc:"வரி உள்ளமைப்பு",step_items:"பொருள் முதன்மை",step_items_desc:"தயாரிப்பு கேட்லாக்",step_receipt:"ரசீது மாதிரி",step_receipt_desc:"பில் வடிவம்",step_review:"மதிப்பாய்வு",step_review_desc:"அங்கீகாரத்திற்கு சமர்ப்பிக்கவும்",store_name:"கடை பெயர்",contact_name:"தொடர்பு பெயர்",contact_phone:"தொடர்பு தொலைபேசி",contact_email:"தொடர்பு மின்னஞ்சல்",tax_regime:"வரி அரசு",gstin:"GSTIN",rounding_preference:"சுற்றளவு விருப்பம்",upload_sku_list:"SKU பட்டியலை பதிவேற்றவும்",upload_tax_proof:"வரி ஆதாரத்தை பதிவேற்றவும்",upload_receipt_sample:"ரசீது மாதிரியை பதிவேற்றவும்",use_system_default:"கணினி இயல்புநிலையைப் பயன்படுத்தவும்",custom_receipt_notes:"தனிப்பயன் ரசீது குறிப்புகள்",save_draft:"வரைவை சேமிக்கவும்",next:"அடுத்து",back:"பின்",submit:"மதிப்பாய்வுக்கு சமர்ப்பிக்கவும்",refresh:"புதுப்பிக்கவும்",validation_required:"இந்த புலம் தேவை",validation_email:"சரியான மின்னஞ்சல் முகவரியை உள்ளிடவும்",validation_phone:"சரியான தொலைபேசி எண்ணை உள்ளிடவும்",validation_gstin:"சரியான GSTIN வடிவத்தை உள்ளிடவும்"},bilingual:{supermarket_store:"SUPERMARKET STORE",bill:"BILL",date:"DATE",cashier:"CASHIER",customer:"CUSTOMER",phone:"PHONE",email:"EMAIL",items:"ITEMS",subtotal:"SUBTOTAL",loyalty_discount:"LOYALTY DISCOUNT",total_tax:"TOTAL TAX",round_off:"ROUND OFF",total:"TOTAL",payment_method:"PAYMENT METHOD",cash_tendered:"CASH TENDERED",change:"CHANGE",thank_you:"THANK YOU FOR YOUR PURCHASE!",please_visit_again:"PLEASE VISIT AGAIN",paid:"*** PAID ***",walk_in_customer:"Walk-in Customer",client_data_title:"Client Data Intake",client_data_subtitle:"Complete your business setup to unlock billing features",step_business:"Business Profile",step_business_desc:"Store information",step_tax:"Tax & Pricing",step_tax_desc:"Tax configuration",step_items:"Item Master",step_items_desc:"Product catalog",step_receipt:"Receipt Sample",step_receipt_desc:"Bill format",step_review:"Review",step_review_desc:"Submit for approval",store_name:"Store Name",contact_name:"Contact Name",contact_phone:"Contact Phone",contact_email:"Contact Email",tax_regime:"Tax Regime",gstin:"GSTIN",rounding_preference:"Rounding Preference",upload_sku_list:"Upload SKU List",upload_tax_proof:"Upload Tax Proof",upload_receipt_sample:"Upload Receipt Sample",use_system_default:"Use System Default",custom_receipt_notes:"Custom Receipt Notes",save_draft:"Save Draft",next:"Next",back:"Back",submit:"Submit for Review",refresh:"Refresh",validation_required:"This field is required",validation_email:"Please enter a valid email address",validation_phone:"Please enter a valid phone number",validation_gstin:"Please enter a valid GSTIN format"}},n=(0,l.createContext)(void 0);function i(e){let{children:s}=e,[t,i]=(0,l.useState)("en");return(0,a.jsx)(n.Provider,{value:{language:t,setLanguage:i,t:e=>r[t][e]||e},children:s})}function c(){let e=(0,l.useContext)(n);if(void 0===e)throw Error("useLanguage must be used within a LanguageProvider");return e}}},function(e){e.O(0,[383,66,508,971,117,744],function(){return e(e.s=70812)}),_N_E=e.O()}]);
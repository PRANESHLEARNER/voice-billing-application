(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{70812:function(e,t,s){Promise.resolve().then(s.bind(s,31233))},31233:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return aw}});var a=s(57437),r=s(2265),n=s(35410),l=s(37053),i=s(90535),c=s(61994),d=s(53335);function o(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,d.m6)((0,c.W)(t))}function m(e){return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2,maximumFractionDigits:2}).format(e)}let u=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}}),x=r.forwardRef((e,t)=>{let{className:s,variant:r,size:n,asChild:i=!1,...c}=e,d=i?l.g7:"button";return(0,a.jsx)(d,{ref:t,"data-slot":"button",className:o(u({variant:r,size:n,className:s})),...c})});function h(e){let{className:t,type:s,...r}=e;return(0,a.jsx)("input",{type:s,"data-slot":"input",className:o("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...r})}x.displayName="Button";var p=s(6394);function g(e){let{className:t,...s}=e;return(0,a.jsx)(p.f,{"data-slot":"label",className:o("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...s})}function j(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card",className:o("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...s})}function f(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-header",className:o("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...s})}function v(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-title",className:o("leading-none font-semibold",t),...s})}function y(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-description",className:o("text-muted-foreground text-sm",t),...s})}function N(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-content",className:o("px-6",t),...s})}let b=(0,i.j)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function w(e){let{className:t,variant:s,...r}=e;return(0,a.jsx)("div",{"data-slot":"alert",role:"alert",className:o(b({variant:s}),t),...r})}function C(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"alert-description",className:o("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",t),...s})}var S=s(51817);function D(){let[e,t]=(0,r.useState)(""),[s,l]=(0,r.useState)(""),[i,c]=(0,r.useState)(""),[d,o]=(0,r.useState)(!1),{login:m}=(0,n.a)(),u=async t=>{t.preventDefault(),c(""),o(!0);try{await m(e,s)}catch(e){c(e instanceof Error?e.message:"Login failed")}finally{o(!1)}};return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary/10 to-secondary/10 p-4",children:(0,a.jsxs)(j,{className:"w-full max-w-md",children:[(0,a.jsxs)(f,{className:"text-center",children:[(0,a.jsx)("div",{className:"flex justify-center mb-3",children:(0,a.jsx)("div",{className:"text-primary p-2 rounded-lg",children:(0,a.jsx)("img",{src:"/_next/static/media/FortuMars Dark Logo PNG.70e46a3e.png",alt:"Logo",className:"h-15 w-70 bg-gradient-to-br"})})}),(0,a.jsx)(v,{className:"text-2xl font-bold text-primary",children:"Supermarket POS"}),(0,a.jsx)(y,{children:"Sign in to access the billing system"})]}),(0,a.jsxs)(N,{children:[(0,a.jsxs)("form",{onSubmit:u,className:"space-y-4",children:[i&&(0,a.jsx)(w,{variant:"destructive",children:(0,a.jsx)(C,{children:i})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"email",children:"Email"}),(0,a.jsx)(h,{id:"email",type:"email",placeholder:"Enter your email",value:e,onChange:e=>t(e.target.value),required:!0,disabled:d})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"password",children:"Password"}),(0,a.jsx)(h,{id:"password",type:"password",placeholder:"Enter your password",value:s,onChange:e=>l(e.target.value),required:!0,disabled:d})]}),(0,a.jsx)(x,{type:"submit",className:"w-full",disabled:d,children:d?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(S.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Signing in..."]}):"Sign In"})]}),(0,a.jsx)("br",{})]})]})})}function k(e){let{children:t,requiredRole:s}=e,{isAuthenticated:r,isLoading:l,user:i}=(0,n.a)();return l?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(S.Z,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-primary"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Loading..."})]})}):r||l?s&&(null==i?void 0:i.role)!==s?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-destructive mb-2",children:"Access Denied"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"You don't have permission to access this page."})]})}):(0,a.jsx)(a.Fragment,{children:t}):(0,a.jsx)(D,{})}let P=(0,i.j)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function A(e){let{className:t,variant:s,asChild:r=!1,...n}=e,i=r?l.g7:"span";return(0,a.jsx)(i,{"data-slot":"badge",className:o(P({variant:s}),t),...n})}var I=s(70085);function T(e){let{...t}=e;return(0,a.jsx)(I.fC,{"data-slot":"dropdown-menu",...t})}function E(e){let{...t}=e;return(0,a.jsx)(I.xz,{"data-slot":"dropdown-menu-trigger",...t})}function F(e){let{className:t,sideOffset:s=4,...r}=e;return(0,a.jsx)(I.Uv,{children:(0,a.jsx)(I.VY,{"data-slot":"dropdown-menu-content",sideOffset:s,className:o("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",t),...r})})}function z(e){let{className:t,inset:s,variant:r="default",...n}=e;return(0,a.jsx)(I.ck,{"data-slot":"dropdown-menu-item","data-inset":s,"data-variant":r,className:o("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...n})}function O(e){let{className:t,inset:s,...r}=e;return(0,a.jsx)(I.__,{"data-slot":"dropdown-menu-label","data-inset":s,className:o("px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",t),...r})}function Z(e){let{className:t,...s}=e;return(0,a.jsx)(I.Z0,{"data-slot":"dropdown-menu-separator",className:o("bg-border -mx-1 my-1 h-px",t),...s})}var _=s(91723),L=s(92369),R=s(47692),B={src:"/_next/static/media/image.e0ae90d6.png"},U=s(85929),M=s(97226),q=s(99897);function V(){let[e,t]=(0,r.useState)("system"),[s,n]=(0,r.useState)(!1);(0,r.useEffect)(()=>{n(!0);try{let e=localStorage.getItem("systemSettings");if(e){let s=JSON.parse(e);t(s.theme||"system")}}catch(e){console.error("Failed to load theme:",e)}},[]);let l=e=>{let s=document.documentElement;"dark"===e?s.classList.add("dark"):"light"===e?s.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches?s.classList.add("dark"):s.classList.remove("dark");try{let t=localStorage.getItem("systemSettings"),s=t?JSON.parse(t):{};s.theme=e,localStorage.setItem("systemSettings",JSON.stringify(s))}catch(e){console.error("Failed to save theme:",e)}t(e)};return s?(0,a.jsxs)(T,{children:[(0,a.jsx)(E,{asChild:!0,children:(0,a.jsxs)(x,{variant:"ghost",size:"icon",className:"w-9 h-9",children:["light"===e?(0,a.jsx)(U.Z,{className:"h-4 w-4"}):"dark"===e?(0,a.jsx)(M.Z,{className:"h-4 w-4"}):(0,a.jsx)(q.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Toggle theme"})]})}),(0,a.jsxs)(F,{align:"end",children:[(0,a.jsxs)(z,{onClick:()=>l("light"),children:[(0,a.jsx)(U.Z,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Light"})]}),(0,a.jsxs)(z,{onClick:()=>l("dark"),children:[(0,a.jsx)(M.Z,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Dark"})]}),(0,a.jsxs)(z,{onClick:()=>l("system"),children:[(0,a.jsx)(q.Z,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"System"})]})]})]}):(0,a.jsx)(x,{variant:"ghost",size:"icon",className:"w-9 h-9",children:(0,a.jsx)(U.Z,{className:"h-4 w-4"})})}function J(e){let{onTabChange:t}=e,{user:s,logout:l,isAdmin:i}=(0,n.a)(),[c,d]=(0,r.useState)(new Date);(0,r.useEffect)(()=>{let e=setInterval(()=>{d(new Date)},1e3);return()=>clearInterval(e)},[]);let o=e=>e.toLocaleString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"});return s?(0,a.jsx)("header",{className:"bg-[#1e293B] text-white shadow-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between px-6 py-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"bg-[#1e293B] text-primary p-2 rounded-lg",children:(0,a.jsx)("img",{src:B.src,alt:"Logo",className:"h-10 w-50 bg-[#1e293B]"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl font-bold",children:"SUPERMARKET BILLING SOFTWARE"}),(0,a.jsx)("p",{className:"text-sm text-white/80",children:"Point of Sale System"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-sm",children:[(0,a.jsx)(_.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"font-mono",children:o(c)})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(V,{}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"font-medium",children:s.name}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(A,{variant:i?"secondary":"outline",className:"text-white text-xs",children:s.role.toUpperCase()}),(0,a.jsxs)("span",{className:"text-xs text-white",children:["ID: ",s.employeeId]})]})]}),(0,a.jsxs)(T,{children:[(0,a.jsx)(E,{asChild:!0,children:(0,a.jsx)("button",{className:"p-2 rounded-full hover:bg-primary-foreground/10 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-foreground","aria-label":"User Menu",children:(0,a.jsx)(L.Z,{className:"h-5 w-5 text-white"})})}),(0,a.jsxs)(F,{align:"end",className:"w-56",children:[(0,a.jsx)(O,{children:"My Account"}),(0,a.jsx)(Z,{}),"cashier"!==s.role&&(0,a.jsxs)(z,{onClick:()=>null==t?void 0:t("profile"),children:[(0,a.jsx)(L.Z,{className:"mr-2 h-4 w-4"}),"Profile"]}),(0,a.jsx)(Z,{}),(0,a.jsxs)(z,{onClick:l,className:"text-destructive",children:[(0,a.jsx)(R.Z,{className:"mr-2 h-4 w-4"}),"Logout"]})]})]})]})]})}):(0,a.jsx)("header",{className:"bg-[#1e293B] text-white shadow-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between px-6 py-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"bg-[#1e293B]  text-primary p-2 rounded-lg",children:(0,a.jsx)("img",{src:B.src,alt:"Logo",className:"h-10 w-50 bg-[#1e293B]"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl font-bold",children:"SUPERMARKET BILLING SOFTWARE"}),(0,a.jsx)("p",{className:"text-sm text-white/80",children:"Point of Sale System"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-sm",children:[(0,a.jsx)(_.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"font-mono",children:o(c)})]}),(0,a.jsx)("div",{children:(0,a.jsx)(x,{variant:"ghost",disabled:!0,children:"Loading..."})})]})})}var G=s(16275),H=s(44794),K=s(59426),W=s(48736),Y=s(96215),Q=s(62720),$=s(95805),X=s(98728),ee=s(32489),et=s(58293);function es(e){let{activeTab:t,onTabChange:s,isSidebarOpen:l,onSidebarToggle:i}=e,{user:c,isAdmin:d}=(0,n.a)(),[m,u]=(0,r.useState)(!1),h=[{id:"billing",label:"Billing",icon:G.Z,roles:["admin","cashier"]},{id:"products",label:"Products",icon:H.Z,roles:["admin"]},{id:"inventory",label:"Inventory",icon:K.Z,roles:["admin"]},{id:"bills",label:"Bill History",icon:W.Z,roles:["admin","cashier"]},{id:"shifts",label:"Shifts",icon:_.Z,roles:["admin","cashier"]},{id:"reports",label:"Reports",icon:Y.Z,roles:["admin"]},{id:"discounts",label:"Discounts",icon:Q.Z,roles:["admin"]},{id:"users",label:"Cashiers",icon:$.Z,roles:["admin"]},{id:"settings",label:"Settings",icon:X.Z,roles:["admin"]}],p=d?"admin":"cashier",g=h.filter(e=>e.roles.includes(p)),j=e=>{let{item:r}=e,n=r.icon,l=t===r.id;return(0,a.jsxs)(x,{variant:l?"secondary":"ghost",className:o("justify-start w-full text-white hover:text-white",l&&"bg-secondary text-secondary-foreground"),onClick:()=>{s(r.id),u(!1)},children:[(0,a.jsx)(n,{className:"mr-2 h-4 w-4 text-white"}),r.label,"billing"===r.id&&(0,a.jsx)(A,{variant:"outline",className:"ml-auto text-white",children:"Active"})]})};return(0,r.useEffect)(()=>{let e=e=>{"Escape"===e.key&&(u(!1),i(!1))};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"lg:hidden bg-card border-b p-4",children:(0,a.jsxs)(x,{variant:"outline",size:"sm",onClick:()=>u(!m),children:[m?(0,a.jsx)(ee.Z,{className:"h-4 w-4"}):(0,a.jsx)(et.Z,{className:"h-4 w-4"}),"Menu"]})}),(0,a.jsx)("nav",{className:"hidden lg:block bg-[#1e293B] border-r border-slate-600 min-h-screen transition-all duration-300 ".concat(l?"w-64":"w-16"),children:(0,a.jsxs)("div",{className:"p-4 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[l&&(0,a.jsx)("h2",{className:"text-lg font-semibold text-white",children:"Navigation"}),(0,a.jsx)(x,{variant:"ghost",size:"sm",onClick:()=>i(!l),className:"ml-auto",children:l?(0,a.jsx)(ee.Z,{className:"h-4 w-4"}):(0,a.jsx)(et.Z,{className:"h-4 w-4"})})]}),l&&g.map(e=>(0,a.jsx)(j,{item:e},e.id)),!l&&(0,a.jsx)("div",{className:"space-y-2",children:g.map(e=>(0,a.jsx)(x,{variant:t===e.id?"default":"ghost",size:"sm",onClick:()=>s(e.id),className:o("w-full justify-center text-white hover:text-white",t===e.id&&"bg-secondary text-secondary-foreground"),title:e.label,children:(0,a.jsx)(e.icon,{className:"h-4 w-4 text-white"})},e.id))})]})}),m&&(0,a.jsx)("div",{className:"lg:hidden fixed inset-0 z-50 bg-background/80 backdrop-blur-sm",children:(0,a.jsx)("div",{className:"fixed left-0 top-0 h-full w-64 bg-[#1e293B] border-r border-slate-600 shadow-lg",children:(0,a.jsxs)("div",{className:"p-4 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-white",children:"Navigation"}),(0,a.jsx)(x,{variant:"ghost",size:"sm",onClick:()=>u(!1),children:(0,a.jsx)(ee.Z,{className:"h-4 w-4 "})})]}),g.map(e=>(0,a.jsx)(j,{item:e},e.id))]})})})]})}var ea=s(33911),er=s(40875),en=s(30401),el=s(22135);function ei(e){let{...t}=e;return(0,a.jsx)(ea.fC,{"data-slot":"select",...t})}function ec(e){let{...t}=e;return(0,a.jsx)(ea.B4,{"data-slot":"select-value",...t})}function ed(e){let{className:t,size:s="default",children:r,...n}=e;return(0,a.jsxs)(ea.xz,{"data-slot":"select-trigger","data-size":s,className:o("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...n,children:[r,(0,a.jsx)(ea.JO,{asChild:!0,children:(0,a.jsx)(er.Z,{className:"size-4 opacity-50"})})]})}function eo(e){let{className:t,children:s,position:r="popper",...n}=e;return(0,a.jsx)(ea.h_,{children:(0,a.jsxs)(ea.VY,{"data-slot":"select-content",className:o("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...n,children:[(0,a.jsx)(eu,{}),(0,a.jsx)(ea.l_,{className:o("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:s}),(0,a.jsx)(ex,{})]})})}function em(e){let{className:t,children:s,...r}=e;return(0,a.jsxs)(ea.ck,{"data-slot":"select-item",className:o("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...r,children:[(0,a.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,a.jsx)(ea.wU,{children:(0,a.jsx)(en.Z,{className:"size-4"})})}),(0,a.jsx)(ea.eT,{children:s})]})}function eu(e){let{className:t,...s}=e;return(0,a.jsx)(ea.u_,{"data-slot":"select-scroll-up-button",className:o("flex cursor-default items-center justify-center py-1",t),...s,children:(0,a.jsx)(el.Z,{className:"size-4"})})}function ex(e){let{className:t,...s}=e;return(0,a.jsx)(ea.$G,{"data-slot":"select-scroll-down-button",className:o("flex cursor-default items-center justify-center py-1",t),...s,children:(0,a.jsx)(er.Z,{className:"size-4"})})}var eh=s(90277);function ep(e){let{...t}=e;return(0,a.jsx)(eh.fC,{"data-slot":"alert-dialog",...t})}function eg(e){let{...t}=e;return(0,a.jsx)(eh.h_,{"data-slot":"alert-dialog-portal",...t})}function ej(e){let{className:t,...s}=e;return(0,a.jsx)(eh.aV,{"data-slot":"alert-dialog-overlay",className:o("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...s})}function ef(e){let{className:t,...s}=e;return(0,a.jsxs)(eg,{children:[(0,a.jsx)(ej,{}),(0,a.jsx)(eh.VY,{"data-slot":"alert-dialog-content",className:o("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...s})]})}function ev(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"alert-dialog-header",className:o("flex flex-col gap-2 text-center sm:text-left",t),...s})}function ey(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"alert-dialog-footer",className:o("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...s})}function eN(e){let{className:t,...s}=e;return(0,a.jsx)(eh.Dx,{"data-slot":"alert-dialog-title",className:o("text-lg font-semibold",t),...s})}function eb(e){let{className:t,...s}=e;return(0,a.jsx)(eh.dk,{"data-slot":"alert-dialog-description",className:o("text-muted-foreground text-sm",t),...s})}function ew(e){let{className:t,...s}=e;return(0,a.jsx)(eh.aU,{className:o(u(),t),...s})}function eC(e){let{className:t,...s}=e;return(0,a.jsx)(eh.$j,{className:o(u({variant:"outline"}),t),...s})}var eS=s(49027);function eD(e){let{...t}=e;return(0,a.jsx)(eS.fC,{"data-slot":"dialog",...t})}function ek(e){let{...t}=e;return(0,a.jsx)(eS.xz,{"data-slot":"dialog-trigger",...t})}function eP(e){let{...t}=e;return(0,a.jsx)(eS.h_,{"data-slot":"dialog-portal",...t})}function eA(e){let{className:t,...s}=e;return(0,a.jsx)(eS.aV,{"data-slot":"dialog-overlay",className:o("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...s})}function eI(e){let{className:t,children:s,showCloseButton:r=!0,...n}=e;return(0,a.jsxs)(eP,{"data-slot":"dialog-portal",children:[(0,a.jsx)(eA,{}),(0,a.jsxs)(eS.VY,{"data-slot":"dialog-content",className:o("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...n,children:[s,r&&(0,a.jsxs)(eS.x8,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,a.jsx)(ee.Z,{}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function eT(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"dialog-header",className:o("flex flex-col gap-2 text-center sm:text-left",t),...s})}function eE(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"dialog-footer",className:o("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...s})}function eF(e){let{className:t,...s}=e;return(0,a.jsx)(eS.Dx,{"data-slot":"dialog-title",className:o("text-lg leading-none font-semibold",t),...s})}function ez(e){let{className:t,...s}=e;return(0,a.jsx)(eS.dk,{"data-slot":"dialog-description",className:o("text-muted-foreground text-sm",t),...s})}var eO=s(99397),eZ=s(73247),e_=s(15868),eL=s(18930),eR=s(26937),eB=s(29116),eU=s(50721);function eM(e){let{className:t,...s}=e;return(0,a.jsx)(eU.fC,{"data-slot":"switch",className:o("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...s,children:(0,a.jsx)(eU.bU,{"data-slot":"switch-thumb",className:o("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}let eq=["Beverages","Bakery","Groceries","Dairy","Confectionery","Fruits & Vegetables","Meat & Seafood","Frozen Foods","Personal Care","Household","Electronics","Other"],eV=["pcs","kg","gm","liter","ml","bottle","packet","box","can","jar"];function eJ(e){let{product:t,isOpen:s,onClose:n,onSuccess:l,initialValues:i}=e,[c,d]=(0,r.useState)({code:"",name:"",barcode:"",category:"",basePrice:"",baseCost:"",unit:"pcs",taxRate:"",isActive:!0}),[o,m]=(0,r.useState)([{size:"",price:0,cost:0,stock:0,sku:"",isActive:!0}]),[u,p]=(0,r.useState)(!1),[j,f]=(0,r.useState)(""),v=e=>{var t,s,a,r,n,l;return{code:null!==(t=null==e?void 0:e.code)&&void 0!==t?t:"",name:null!==(s=null==e?void 0:e.name)&&void 0!==s?s:"",barcode:null!==(a=null==e?void 0:e.barcode)&&void 0!==a?a:"",category:null!==(r=null==e?void 0:e.category)&&void 0!==r?r:"",basePrice:(null==e?void 0:e.basePrice)!==void 0&&(null==e?void 0:e.basePrice)!==null?e.basePrice.toString():"",baseCost:(null==e?void 0:e.baseCost)!==void 0&&(null==e?void 0:e.baseCost)!==null?e.baseCost.toString():"",unit:null!==(n=null==e?void 0:e.unit)&&void 0!==n?n:"pcs",taxRate:(null==e?void 0:e.taxRate)!==void 0&&(null==e?void 0:e.taxRate)!==null?e.taxRate.toString():"",isActive:null===(l=null==e?void 0:e.isActive)||void 0===l||l}},y=e=>e&&e.length>0?e.map(e=>({size:e.size,price:e.price,cost:e.cost,stock:e.stock,sku:e.sku,barcode:e.barcode,isActive:e.isActive})):[{size:"",price:0,cost:0,stock:0,sku:"",isActive:!0}];(0,r.useEffect)(()=>{if(t)d(v(t)),m(y(t.variants));else{var e;d(v(i)),m(y((null==i?void 0:null===(e=i.variants)||void 0===e?void 0:e.length)?i.variants:void 0))}f("")},[t,s,i]);let N=async e=>{e.preventDefault(),f(""),p(!0);try{let e=o.filter(e=>""!==e.size.trim()&&""!==e.sku.trim());if(0===e.length){f("At least one variant with size and SKU is required"),p(!1);return}let s=e.map(e=>({...e,sku:e.sku.trim()||"".concat(c.code,"-").concat(e.size).toUpperCase()})),a={code:c.code.toUpperCase(),name:c.name,barcode:c.barcode||void 0,category:c.category,basePrice:Number.parseFloat(c.basePrice),baseCost:Number.parseFloat(c.baseCost),unit:c.unit,taxRate:Number.parseFloat(c.taxRate),isActive:c.isActive,variants:s};t?await eB.apiClient.updateProduct(t._id,a):await eB.apiClient.createProduct(a),l(),n()}catch(e){f(e instanceof Error?e.message:"An error occurred")}finally{p(!1)}},b=(e,t)=>{d(s=>({...s,[e]:t}))},D=(e,t,s)=>{m(a=>{let r=[...a];return r[e]={...r[e],[t]:s},r})},k=e=>{o.length>1&&m(t=>t.filter((t,s)=>s!==e))};return(0,a.jsx)(eD,{open:s,onOpenChange:n,children:(0,a.jsxs)(eI,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)(eT,{children:[(0,a.jsx)(eF,{children:t?"Edit Product":"Add New Product"}),(0,a.jsx)(ez,{children:t?"Update the product information below.":"Enter the details for the new product."})]}),(0,a.jsxs)("form",{onSubmit:N,className:"space-y-4",children:[j&&(0,a.jsx)(w,{variant:"destructive",children:(0,a.jsx)(C,{children:j})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"code",children:"Product Code *"}),(0,a.jsx)(h,{id:"code",value:c.code,onChange:e=>b("code",e.target.value.toUpperCase()),placeholder:"ABC-001",required:!0,disabled:u})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"barcode",children:"Barcode"}),(0,a.jsx)(h,{id:"barcode",value:c.barcode,onChange:e=>b("barcode",e.target.value),placeholder:"1234567890123",disabled:u})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"name",children:"Product Name *"}),(0,a.jsx)(h,{id:"name",value:c.name,onChange:e=>b("name",e.target.value),placeholder:"Enter product name",required:!0,disabled:u})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"category",children:"Category *"}),(0,a.jsxs)(ei,{value:c.category,onValueChange:e=>b("category",e),disabled:u,children:[(0,a.jsx)(ed,{children:(0,a.jsx)(ec,{placeholder:"Select category"})}),(0,a.jsx)(eo,{children:eq.map(e=>(0,a.jsx)(em,{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"unit",children:"Unit *"}),(0,a.jsxs)(ei,{value:c.unit,onValueChange:e=>b("unit",e),disabled:u,children:[(0,a.jsx)(ed,{children:(0,a.jsx)(ec,{placeholder:"Select unit"})}),(0,a.jsx)(eo,{children:eV.map(e=>(0,a.jsx)(em,{value:e,children:e},e))})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"baseCost",children:"Base Cost Price *"}),(0,a.jsx)(h,{id:"baseCost",type:"number",step:"0.01",min:"0",value:c.baseCost,onChange:e=>b("baseCost",e.target.value),placeholder:"0.00",required:!0,disabled:u})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"basePrice",children:"Base Selling Price *"}),(0,a.jsx)(h,{id:"basePrice",type:"number",step:"0.01",min:"0",value:c.basePrice,onChange:e=>b("basePrice",e.target.value),placeholder:"0.00",required:!0,disabled:u})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"taxRate",children:"Tax Rate (%)"}),(0,a.jsx)(h,{id:"taxRate",type:"number",step:"0.01",min:"0",max:"100",value:c.taxRate,onChange:e=>b("taxRate",e.target.value),placeholder:"0.00",disabled:u})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Product Variants"}),(0,a.jsxs)(x,{type:"button",variant:"outline",size:"sm",onClick:()=>{m(e=>[...e,{size:"",price:0,cost:0,stock:0,sku:"",isActive:!0}])},disabled:u,children:[(0,a.jsx)(eO.Z,{className:"mr-2 h-4 w-4"}),"Add Variant"]})]}),o.map((e,t)=>(0,a.jsxs)("div",{className:"border rounded-lg p-4 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("h4",{className:"font-medium",children:["Variant ",t+1]}),o.length>1&&(0,a.jsxs)(x,{type:"button",variant:"outline",size:"sm",onClick:()=>k(t),disabled:u,children:[(0,a.jsx)(eL.Z,{className:"mr-2 h-4 w-4"}),"Remove"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"size-".concat(t),children:"Size *"}),(0,a.jsx)(h,{id:"size-".concat(t),value:e.size,onChange:e=>D(t,"size",e.target.value),placeholder:"250ml, 500ml, 1L",required:!0,disabled:u})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"sku-".concat(t),children:"SKU *"}),(0,a.jsx)(h,{id:"sku-".concat(t),value:e.sku,onChange:e=>D(t,"sku",e.target.value.toUpperCase()),placeholder:"AUTO-GENERATED",disabled:u})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"variantCost-".concat(t),children:"Cost Price *"}),(0,a.jsx)(h,{id:"variantCost-".concat(t),type:"number",step:"0.01",min:"0",value:e.cost,onChange:e=>D(t,"cost",Number.parseFloat(e.target.value)||0),placeholder:"0.00",required:!0,disabled:u})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"variantPrice-".concat(t),children:"Selling Price *"}),(0,a.jsx)(h,{id:"variantPrice-".concat(t),type:"number",step:"0.01",min:"0",value:e.price,onChange:e=>D(t,"price",Number.parseFloat(e.target.value)||0),placeholder:"0.00",required:!0,disabled:u})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"stock-".concat(t),children:"Stock Quantity *"}),(0,a.jsx)(h,{id:"stock-".concat(t),type:"number",min:"0",value:e.stock,onChange:e=>D(t,"stock",Number.parseInt(e.target.value)||0),placeholder:"0",required:!0,disabled:u})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"barcode-".concat(t),children:"Barcode"}),(0,a.jsx)(h,{id:"barcode-".concat(t),value:e.barcode||"",onChange:e=>D(t,"barcode",e.target.value),placeholder:"1234567890123",disabled:u})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(eM,{id:"isActive-".concat(t),checked:e.isActive,onCheckedChange:e=>D(t,"isActive",e),disabled:u}),(0,a.jsx)(g,{htmlFor:"isActive-".concat(t),children:"Active Variant"})]})]},t))]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(eM,{id:"isActive",checked:c.isActive,onCheckedChange:e=>b("isActive",e),disabled:u}),(0,a.jsx)(g,{htmlFor:"isActive",children:"Active Product"})]}),(0,a.jsxs)(eE,{children:[(0,a.jsx)(x,{type:"button",variant:"outline",onClick:n,disabled:u,children:"Cancel"}),(0,a.jsx)(x,{type:"submit",disabled:u,children:u?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(S.Z,{className:"mr-2 h-4 w-4 animate-spin"}),t?"Updating...":"Creating..."]}):t?"Update Product":"Create Product"})]})]})]})})}function eG(){let[e,t]=(0,r.useState)([]),[s,n]=(0,r.useState)(!0),[l,i]=(0,r.useState)(""),[c,d]=(0,r.useState)(""),[o,m]=(0,r.useState)("all"),[u,p]=(0,r.useState)("all"),[b,D]=(0,r.useState)(null),[k,P]=(0,r.useState)(!1),[I,T]=(0,r.useState)(null),[E,F]=(0,r.useState)(!1),[z,O]=(0,r.useState)(null),[Z,_]=(0,r.useState)(null),[L,R]=(0,r.useState)(""),[B,U]=(0,r.useState)(!1),M=async()=>{try{n(!0),i("");let e={};c&&(e.search=c),"all"!==o&&(e.category=o),"all"!==u&&(e.active="active"===u);let s=await eB.apiClient.getProducts(e);t(s)}catch(e){i(e instanceof Error?e.message:"Failed to load products")}finally{n(!1)}};(0,r.useEffect)(()=>{M()},[c,o,u]);let q=e=>{D(e),P(!0)},V=async()=>{if(I)try{F(!0),await eB.apiClient.deleteProduct(I._id),await M(),T(null)}catch(e){i(e instanceof Error?e.message:"Failed to delete product")}finally{F(!1)}},J=e=>{O(z===e?null:e)},G=(e,t)=>{_({product:e,variantIndex:t}),R("")},K=async()=>{if(Z&&L)try{U(!0);let{product:e,variantIndex:t}=Z,s=parseInt(L);if(isNaN(s)||s<=0){i("Please enter a valid restock amount");return}let a={...e};a.variants=[...e.variants],a.variants[t]={...e.variants[t],stock:e.variants[t].stock+s},await eB.apiClient.updateProduct(e._id,a),await M(),_(null),R(""),i("")}catch(e){i(e instanceof Error?e.message:"Failed to restock variant")}finally{U(!1)}},W=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e),Y=e=>0===e?{label:"Out of Stock",variant:"destructive"}:e<10?{label:"Low Stock",variant:"secondary"}:{label:"In Stock",variant:"default"};return(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)(j,{children:[(0,a.jsx)(f,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(v,{className:"flex items-center gap-2",children:[(0,a.jsx)(H.Z,{className:"h-5 w-5"}),"Product Management"]}),(0,a.jsx)(y,{children:"Manage your product catalog and inventory"})]}),(0,a.jsxs)(x,{onClick:()=>{D(null),P(!0)},children:[(0,a.jsx)(eO.Z,{className:"mr-2 h-4 w-4"}),"Add Product"]})]})}),(0,a.jsxs)(N,{children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(eZ.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),(0,a.jsx)(h,{placeholder:"Search products by name, code, or barcode...",value:c,onChange:e=>d(e.target.value),className:"pl-10"})]}),(0,a.jsxs)(ei,{value:o,onValueChange:m,children:[(0,a.jsx)(ed,{className:"w-full sm:w-48",children:(0,a.jsx)(ec,{placeholder:"All Categories"})}),(0,a.jsxs)(eo,{children:[(0,a.jsx)(em,{value:"all",children:"All Categories"}),["Beverages","Bakery","Groceries","Dairy","Confectionery","Fruits & Vegetables","Meat & Seafood","Frozen Foods","Personal Care","Household","Electronics","Other"].map(e=>(0,a.jsx)(em,{value:e,children:e},e))]})]}),(0,a.jsxs)(ei,{value:u,onValueChange:p,children:[(0,a.jsx)(ed,{className:"w-full sm:w-32",children:(0,a.jsx)(ec,{})}),(0,a.jsxs)(eo,{children:[(0,a.jsx)(em,{value:"all",children:"All"}),(0,a.jsx)(em,{value:"active",children:"Active"}),(0,a.jsx)(em,{value:"inactive",children:"Inactive"})]})]})]}),l&&(0,a.jsx)(w,{variant:"destructive",className:"mb-4",children:(0,a.jsx)(C,{children:l})}),(0,a.jsx)("div",{className:"space-y-6",children:s?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(S.Z,{className:"h-6 w-6 animate-spin mx-auto mb-2"}),"Loading products..."]}):0===e.length?(0,a.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No products found"}):Object.entries(e.reduce((e,t)=>{let s=t.category||"Uncategorized";return e[s]||(e[s]=[]),e[s].push(t),e},{})).map(e=>{let[t,s]=e;return(0,a.jsxs)(j,{children:[(0,a.jsx)(f,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(v,{className:"flex items-center gap-2",children:[(0,a.jsx)(H.Z,{className:"h-5 w-5"}),t]}),(0,a.jsxs)(y,{children:[s.length," product",1!==s.length?"s":""]})]}),(0,a.jsxs)(A,{variant:"outline",children:[s.reduce((e,t)=>e+t.variants.reduce((e,t)=>e+t.stock,0),0)," total items"]})]})}),(0,a.jsx)(N,{children:(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map(e=>{var t;let s=e.variants.reduce((e,t)=>e+t.stock,0),r=Y(s),n=e.variants.length>0,l=z===e._id;return(0,a.jsxs)("div",{className:"border rounded-lg p-4 space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"font-medium flex items-center gap-2",children:[e.name,n&&(0,a.jsx)("span",{className:"text-xs text-muted-foreground cursor-pointer",onClick:()=>J(e._id),children:l?"▼":"▶"})]}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground font-mono",children:e.code}),e.barcode&&(0,a.jsxs)("div",{className:"text-xs text-muted-foreground font-mono",children:["Barcode: ",e.barcode]})]}),(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)(x,{variant:"ghost",size:"sm",onClick:t=>{t.stopPropagation(),q(e)},children:(0,a.jsx)(e_.Z,{className:"h-4 w-4"})}),(0,a.jsx)(x,{variant:"ghost",size:"sm",onClick:t=>{t.stopPropagation(),T(e)},children:(0,a.jsx)(eL.Z,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Price:"}),(0,a.jsx)("span",{className:"font-medium",children:W((null===(t=e.variants[0])||void 0===t?void 0:t.price)||e.basePrice||0)})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Stock:"}),(0,a.jsxs)(A,{variant:r.variant,children:[r.label," (",s," ",e.unit,")"]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Status:"}),(0,a.jsx)(A,{variant:e.isActive?"default":"secondary",children:e.isActive?"Active":"Inactive"})]}),n&&(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:[e.variants.length," variant",1!==e.variants.length?"s":""," ",l?"(shown)":"(click to expand)"]}),n&&l&&(0,a.jsx)("div",{className:"space-y-2 pt-2 border-t",children:e.variants.map((t,s)=>{let r=Y(t.stock);return(0,a.jsxs)("div",{className:"bg-muted/30 rounded p-3 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"font-medium",children:t.size}),(0,a.jsx)(A,{variant:r.variant,className:"text-xs",children:r.label})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"SKU: "}),(0,a.jsx)("span",{className:"font-mono",children:t.sku})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Price: "}),(0,a.jsx)("span",{children:W(t.price)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Stock: "}),(0,a.jsxs)("span",{children:[t.stock," ",e.unit]})]}),(0,a.jsx)("div",{children:(0,a.jsxs)(x,{variant:"outline",size:"sm",className:"h-6 text-xs",onClick:t=>{t.stopPropagation(),G(e,s)},children:[(0,a.jsx)(eR.Z,{className:"h-3 w-3 mr-1"}),"Restock"]})})]})]},s)})})]},e._id)})})})]},t)})}),(0,a.jsx)(eJ,{product:b,isOpen:k,onClose:()=>P(!1),onSuccess:M}),(0,a.jsx)(ep,{open:!!I,onOpenChange:()=>T(null),children:(0,a.jsxs)(ef,{children:[(0,a.jsxs)(ev,{children:[(0,a.jsx)(eN,{children:"Delete Product"}),(0,a.jsxs)(eb,{children:['Are you sure you want to delete "',null==I?void 0:I.name,'"? This action will deactivate the product and cannot be undone.']})]}),(0,a.jsxs)(ey,{children:[(0,a.jsx)(eC,{disabled:E,children:"Cancel"}),(0,a.jsx)(ew,{onClick:V,disabled:E,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:E?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(S.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Deleting..."]}):"Delete"})]})]})}),(0,a.jsx)(eD,{open:!!Z,onOpenChange:()=>_(null),children:(0,a.jsxs)(eI,{className:"sm:max-w-[425px]",children:[(0,a.jsxs)(eT,{children:[(0,a.jsx)(eF,{children:"Restock Variant"}),(0,a.jsxs)(ez,{children:["Add stock to ",null==Z?void 0:Z.product.name," - ",null==Z?void 0:Z.product.variants[(null==Z?void 0:Z.variantIndex)||0].size]})]}),(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(g,{htmlFor:"restock-amount",className:"text-right",children:"Amount"}),(0,a.jsx)(h,{id:"restock-amount",type:"number",min:"1",value:L,onChange:e=>R(e.target.value),className:"col-span-3",placeholder:"Enter restock amount"})]}),Z&&(0,a.jsxs)("div",{className:"text-sm text-muted-foreground bg-muted/50 p-3 rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Current Stock:"})," ",Z.product.variants[Z.variantIndex].stock," ",Z.product.unit]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"SKU:"})," ",Z.product.variants[Z.variantIndex].sku]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Price:"})," ",W(Z.product.variants[Z.variantIndex].price)]})]})]}),(0,a.jsxs)(eE,{children:[(0,a.jsx)(x,{variant:"outline",onClick:()=>_(null),children:"Cancel"}),(0,a.jsx)(x,{onClick:K,disabled:!L||B,children:B?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(S.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Restocking..."]}):"Restock"})]})]})})]})]})})}var eH=s(17625),eK=s(82431),eW=s(82023),eY=s(87414),eQ=s(86595),e$=s(91804),eX=s(247);function e0(e){let{onProductSelect:t}=e,[s,n]=(0,r.useState)(""),[l,i]=(0,r.useState)([]),[c,d]=(0,r.useState)(!1),[o,m]=(0,r.useState)(!1),u=(0,r.useRef)(null);(0,r.useEffect)(()=>{let e=e=>{u.current&&!u.current.contains(e.target)&&m(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,r.useEffect)(()=>{let e=setTimeout(async()=>{if(s.length<2){i([]),m(!1);return}d(!0);try{let e=await eB.apiClient.getProducts({search:s,active:!0});i(e.slice(0,10)),m(!0)}catch(e){console.error("Search error:",e),i([])}finally{d(!1)}},300);return()=>clearTimeout(e)},[s]);let p=async(e,s)=>{await t(e,s),n(""),m(!1)},g=async()=>{if(s)try{d(!0);let e=await eB.apiClient.getProductByIdentifier(s);if(e.variants&&e.variants.length>0){let t=e.variants.find(e=>e.sku===s.toUpperCase()||e.barcode===s);t?p(e,t):p(e,e.variants[0])}else p(e,{size:"Default",price:e.basePrice||0,cost:e.baseCost||0,stock:0,sku:e.code,isActive:!0})}catch(e){console.error("Barcode search error:",e)}finally{d(!1)}},f=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e);return(0,a.jsxs)("div",{ref:u,className:"relative",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(eZ.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),(0,a.jsx)(h,{placeholder:"Search products by name, code, or scan barcode...",value:s,onChange:e=>n(e.target.value),className:"pl-10",onFocus:()=>s.length>=2&&m(!0)})]}),(0,a.jsx)(x,{variant:"outline",onClick:g,disabled:c||!s,children:(0,a.jsx)(eX.Z,{className:"h-4 w-4"})})]}),o&&l.length>0&&(0,a.jsx)(j,{className:"absolute top-full left-0 right-0 z-50 mt-1 max-h-80 overflow-y-auto",children:(0,a.jsx)(N,{className:"p-0",children:l.map(e=>(0,a.jsxs)("div",{className:"border-b last:border-b-0",children:[(0,a.jsx)("div",{className:"flex items-center justify-between p-3 bg-muted/50",children:(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"font-medium",children:e.name}),(0,a.jsx)(A,{variant:"outline",className:"text-xs",children:e.code})]}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:[e.category," • ",e.unit]})]})}),(0,a.jsx)("div",{className:"p-2 space-y-1",children:(e.variants||[]).map((t,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 hover:bg-muted cursor-pointer rounded",onClick:()=>p(e,t),children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:t.size}),(0,a.jsx)(A,{variant:"secondary",className:"text-xs",children:t.sku}),!t.isActive&&(0,a.jsx)(A,{variant:"destructive",className:"text-xs",children:"Inactive"})]}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Stock: ",t.stock," ",e.unit,t.barcode&&" • Barcode: ".concat(t.barcode)]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"font-medium text-sm",children:f(t.price)}),(0,a.jsx)(x,{size:"sm",variant:"ghost",className:"h-5 w-5 p-0",children:(0,a.jsx)(eO.Z,{className:"h-3 w-3"})})]})]},"".concat(e._id,"-").concat(t.sku||s)))})]},e._id))})})]})}function e1(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,a.jsx)("table",{"data-slot":"table",className:o("w-full caption-bottom text-sm",t),...s})})}function e2(e){let{className:t,...s}=e;return(0,a.jsx)("thead",{"data-slot":"table-header",className:o("[&_tr]:border-b",t),...s})}function e4(e){let{className:t,...s}=e;return(0,a.jsx)("tbody",{"data-slot":"table-body",className:o("[&_tr:last-child]:border-0",t),...s})}function e3(e){let{className:t,...s}=e;return(0,a.jsx)("tr",{"data-slot":"table-row",className:o("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...s})}function e5(e){let{className:t,...s}=e;return(0,a.jsx)("th",{"data-slot":"table-head",className:o("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...s})}function e6(e){let{className:t,...s}=e;return(0,a.jsx)("td",{"data-slot":"table-cell",className:o("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...s})}var e8=s(21047);function e9(e){let{items:t,onUpdateItem:s,onRemoveItem:r}=e,n=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e),l=(e,t)=>{t<=0||s(e,{quantity:t})};return(0,a.jsx)("div",{className:"border rounded-lg bg-card ",children:(0,a.jsxs)(e1,{children:[(0,a.jsx)(e2,{children:(0,a.jsxs)(e3,{className:"bg-primary text-primary-foreground hover:bg-primary",children:[(0,a.jsx)(e5,{className:"text-primary-foreground",children:"Code"}),(0,a.jsx)(e5,{className:"text-primary-foreground",children:"Item Name"}),(0,a.jsx)(e5,{className:"text-primary-foreground w-24",children:"Qty"}),(0,a.jsx)(e5,{className:"text-primary-foreground w-32",children:"Rate"}),(0,a.jsx)(e5,{className:"text-primary-foreground w-32",children:"Discount"}),(0,a.jsx)(e5,{className:"text-primary-foreground w-24",children:"Tax%"}),(0,a.jsx)(e5,{className:"text-primary-foreground w-32",children:"Amount"}),(0,a.jsx)(e5,{className:"text-primary-foreground w-16",children:"Action"})]})}),(0,a.jsx)(e4,{children:0===t.length?(0,a.jsx)(e3,{children:(0,a.jsx)(e6,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"No items added. Search and add products to start billing."})}):t.map(e=>(0,a.jsxs)(e3,{className:"hover:bg-muted/50",children:[(0,a.jsx)(e6,{children:(0,a.jsx)(A,{variant:"outline",className:"font-mono",children:e.product.code})}),(0,a.jsx)(e6,{children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e.product.name}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:[e.product.category," • ",e.variant.size,(0,a.jsx)(A,{variant:"outline",className:"ml-2 text-xs",children:e.variant.sku})]})]})}),(0,a.jsx)(e6,{children:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(x,{variant:"outline",size:"sm",className:"h-6 w-6 p-0 bg-transparent",onClick:()=>l(e.id,e.quantity-1),disabled:e.quantity<=1,children:(0,a.jsx)(e8.Z,{className:"h-3 w-3"})}),(0,a.jsx)(h,{type:"number",min:"1",step:"0.01",value:e.quantity,onChange:t=>l(e.id,Number.parseFloat(t.target.value)||1),className:"h-8 w-16 text-center"}),(0,a.jsx)(x,{variant:"outline",size:"sm",className:"h-6 w-6 p-0 bg-transparent",onClick:()=>l(e.id,e.quantity+1),children:(0,a.jsx)(eO.Z,{className:"h-3 w-3"})})]})}),(0,a.jsx)(e6,{children:(0,a.jsx)("div",{className:"font-medium",children:n(e.rate)})}),(0,a.jsx)(e6,{children:e.discount?(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(A,{variant:"secondary",className:"text-xs",children:"percentage"===e.discount.discountType?"".concat(e.discount.discountValue,"%"):n(e.discount.discountValue)}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:["-",n(e.discount.discountAmount)]})]}):(0,a.jsx)("span",{className:"text-muted-foreground text-sm",children:"No discount"})}),(0,a.jsx)(e6,{children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)(A,{variant:"secondary",children:[e.product.taxRate,"%"]}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground mt-1",children:n(e.taxAmount)})]})}),(0,a.jsx)(e6,{children:(0,a.jsx)("div",{className:"text-right",children:(0,a.jsx)("div",{className:"font-medium",children:n(e.totalAmount)})})}),(0,a.jsx)(e6,{children:(0,a.jsx)(x,{variant:"ghost",size:"sm",onClick:()=>r(e.id),className:"h-8 w-8 p-0 text-destructive hover:text-destructive",children:(0,a.jsx)(eL.Z,{className:"h-4 w-4"})})})]},e.id))})]})})}var e7=s(55156);function te(e){let{className:t,orientation:s="horizontal",decorative:r=!0,...n}=e;return(0,a.jsx)(e7.f,{"data-slot":"separator",decorative:r,orientation:s,className:o("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",t),...n})}function tt(e){let{items:t,loyaltyStatus:s}=e,r=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e),n=t.reduce((e,t)=>{var s;let a=t.quantity*t.rate;return e.subtotal+=a,e.totalTax+=t.taxAmount,e.totalDiscount+=(null===(s=t.discount)||void 0===s?void 0:s.discountAmount)||0,e.totalItems+=t.quantity,e},{subtotal:0,totalTax:0,totalDiscount:0,totalItems:0}),l=(null==s?void 0:s.isEligible)?Math.round((n.subtotal+n.totalTax)*.02):0,i=n.subtotal-n.totalDiscount,c=i+n.totalTax-l,d=Math.round(c)-c,o=Math.round(c);return(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-between text-[11px]",children:[(0,a.jsx)("span",{children:"Total Items:"}),(0,a.jsx)("span",{className:"font-medium",children:n.totalItems})]}),(0,a.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,a.jsx)("span",{children:"Subtotal:"}),(0,a.jsx)("span",{className:"font-medium",children:r(n.subtotal)})]}),n.totalDiscount>0&&(0,a.jsxs)("div",{className:"flex justify-between text-xs text-green-600",children:[(0,a.jsx)("span",{children:"Total Discount:"}),(0,a.jsxs)("span",{className:"font-medium",children:["-",r(n.totalDiscount)]})]}),l>0&&(0,a.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,a.jsx)("span",{className:"text-green-600",children:"Loyalty Discount (2%):"}),(0,a.jsxs)("span",{className:"font-medium text-green-600",children:["-",r(l)]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,a.jsx)("span",{children:"Discounted Subtotal:"}),(0,a.jsx)("span",{className:"font-medium",children:r(i)})]}),(0,a.jsxs)("div",{className:"flex justify-between text-xs font-semibold text-blue-600",children:[(0,a.jsxs)("span",{children:["Total Tax (",n.totalTax>0?(n.totalTax/i*100).toFixed(1):0,"%):"]}),(0,a.jsx)("span",{className:"font-bold",children:r(n.totalTax)})]}),Math.abs(d)>.01&&(0,a.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,a.jsx)("span",{children:"Round Off:"}),(0,a.jsxs)("span",{className:"font-medium",children:[d>0?"+":"",r(d)]})]}),(0,a.jsx)(te,{className:"my-2"}),(0,a.jsxs)("div",{className:"flex justify-between text-xs font-bold",children:[(0,a.jsx)("span",{children:"Grand Total:"}),(0,a.jsx)("span",{className:"text-primary",children:r(o)})]})]})}var ts=s(67404),ta=s(43681),tr=s(88226),tn=s(33388),tl=s(28124),ti=s(49322);function tc(e){let{isOpen:t,onClose:s,amount:n,paymentMethod:l,onSuccess:i,onError:c}=e,[d,o]=(0,r.useState)(!1),[m,u]=(0,r.useState)(""),[h,p]=(0,r.useState)(!1),[g,f]=(0,r.useState)(!1);(0,r.useEffect)(()=>{if(window.Razorpay)window.Razorpay&&f(!0);else{let e=document.createElement("script");e.src="https://checkout.razorpay.com/v1/checkout.js",e.async=!0,e.onload=()=>f(!0),e.onerror=()=>{u("Failed to load Razorpay. Please refresh the page and try again.")},document.body.appendChild(e)}return()=>{let e=document.querySelector('script[src="https://checkout.razorpay.com/v1/checkout.js"]');e&&document.body.removeChild(e)}},[]);let v=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e),y=async()=>{try{return await eB.apiClient.createPaymentOrder({amount:Math.round(100*n),currency:"INR",paymentMethod:l})}catch(e){throw Error("Failed to create payment order: ".concat(e instanceof Error?e.message:"Unknown error"))}},b=async e=>{try{return await eB.apiClient.verifyPayment(e)}catch(e){throw Error("Payment verification failed: ".concat(e instanceof Error?e.message:"Unknown error"))}},w=async()=>{if(!g){u("Razorpay is still loading. Please wait...");return}o(!0),u("");try{let e=await y(),t=e.id;if(console.log("\uD83D\uDD0D Created Razorpay order:",{orderId:t}),!t||""===t.trim())throw Error("Failed to create valid Razorpay order: Order ID is empty");let a={key:"rzp_test_RJ8Bz6OxwnZehD",amount:e.amount,currency:e.currency,name:"SuperMarket Billing",description:"Payment for purchase",order_id:t,prefill:{name:"Customer",email:"customer@example.com",contact:"9999999999"},theme:{color:"#3399cc"},modal:{amount_editable:!1,ondismiss:()=>{o(!1),c("Payment was cancelled by user")}},handler:async e=>{console.log("\uD83D\uDD0D Razorpay response received:",e),p(!0),u("");try{let a=e.razorpay_payment_id?e.razorpay_payment_id.trim():"",r=e.razorpay_order_id||t?(e.razorpay_order_id||t||"").trim():"",n=(e.razorpay_signature,(e.razorpay_signature||"pending").trim());if(console.log("\uD83D\uDD0D Extracted payment parameters:",{paymentId:a?"".concat(a.substring(0,10),"..."):"empty",orderId:r?"".concat(r.substring(0,10),"..."):"empty",signature:n?"".concat(n.substring(0,10),"..."):"empty",razorpayOrderId:t?"".concat(t.substring(0,10),"..."):"empty",responseOrderId:e.razorpay_order_id?"".concat(e.razorpay_order_id.substring(0,10),"..."):"missing"}),!a||!r)throw Error('Invalid payment parameters: { orderId: "'.concat(r,'", paymentId: "').concat(a,'" }'));let l=await b({paymentId:a,orderId:r,signature:n});console.log("✅ Payment verification successful:",l),i({paymentId:a,orderId:r,signature:n,method:"card"}),s()}catch(t){console.error("❌ Payment verification failed:",t);let e=t instanceof Error?t.message:"Payment verification failed";u(e),c(e)}finally{p(!1)}}};new window.Razorpay(a).open()}catch(t){console.error("❌ Card payment failed:",t);let e=t instanceof Error?t.message:"Card payment failed";u(e),c(e),o(!1)}},C=async()=>{if(!g){u("Razorpay is still loading. Please wait...");return}o(!0),u("");try{let e=await y(),t=e.id;if(console.log("\uD83D\uDD0D Created Razorpay order:",{orderId:t,fullOrderData:e,orderDataId:null==e?void 0:e.id,orderDataExists:!!e}),!t||""===t.trim())throw Error("Failed to create valid Razorpay order: Order ID is empty");let a={key:"rzp_test_RJ8Bz6OxwnZehD",amount:e.amount,currency:e.currency,name:"SuperMarket Billing",description:"Payment for purchase",order_id:t,prefill:{contact:"9999999999",email:"customer@example.com"},theme:{color:"#3399cc"},config:{display:{hide:[{method:"card"},{method:"netbanking"},{method:"wallet"},{method:"emi"},{method:"paylater"}]}},modal:{amount_editable:!1,ondismiss:()=>{o(!1),c("UPI payment was cancelled by user")}},handler:async e=>{console.log("\uD83D\uDD0D Razorpay UPI response received:",e),p(!0),u("");try{let a=e.razorpay_payment_id?e.razorpay_payment_id.trim():"",r=e.razorpay_order_id||t?(e.razorpay_order_id||t||"").trim():"",n=(e.razorpay_signature,(e.razorpay_signature||"pending").trim());if(console.log("\uD83D\uDD0D Extracted UPI payment parameters:",{paymentId:a?"".concat(a.substring(0,10),"..."):"empty",orderId:r?"".concat(r.substring(0,10),"..."):"empty",signature:n?"".concat(n.substring(0,10),"..."):"empty",rawResponse:e,razorpayOrderId:t?"".concat(t.substring(0,10),"..."):"empty",responseOrderId:e.razorpay_order_id?"".concat(e.razorpay_order_id.substring(0,10),"..."):"missing"}),!a||!r)throw Error('Invalid UPI payment parameters: { orderId: "'.concat(r,'", paymentId: "').concat(a,'" }'));let l=await b({paymentId:a,orderId:r,signature:n});console.log("✅ UPI payment verification successful:",l),i({paymentId:a,orderId:r,signature:n,method:"upi"}),s()}catch(t){console.error("❌ UPI payment verification failed:",t);let e=t instanceof Error?t.message:"UPI payment verification failed";u(e),c(e)}finally{p(!1)}}};new window.Razorpay(a).open()}catch(t){console.error("❌ UPI payment failed:",t);let e=t instanceof Error?t.message:"UPI payment failed";u(e),c(e),o(!1)}};return(0,a.jsx)(eD,{open:t,onOpenChange:s,children:(0,a.jsxs)(eI,{className:"sm:max-w-md",children:[(0,a.jsx)(eT,{children:(0,a.jsxs)(eF,{className:"flex items-center gap-2",children:["card"===l?(0,a.jsx)(tr.Z,{className:"h-5 w-5"}):(0,a.jsx)(tn.Z,{className:"h-5 w-5"}),"card"===l?"Card Payment":"UPI Payment"]})}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(j,{children:(0,a.jsx)(N,{className:"pt-6",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Amount:"}),(0,a.jsx)("span",{className:"font-bold text-lg",children:v(n)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Payment Method:"}),(0,a.jsx)(A,{variant:"card"===l?"default":"secondary",children:"card"===l?"Card":"UPI"})]})]})})}),m&&(0,a.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-destructive/10 border border-destructive/20 rounded-md",children:[(0,a.jsx)(ti.Z,{className:"h-4 w-4 text-destructive"}),(0,a.jsx)("span",{className:"text-sm text-destructive",children:m})]}),h&&(0,a.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-green-50 border border-green-200 rounded-md",children:[(0,a.jsx)(S.Z,{className:"h-4 w-4 text-green-600 animate-spin"}),(0,a.jsx)("span",{className:"text-sm text-green-700",children:"Processing payment..."})]}),(0,a.jsx)(te,{}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"font-medium",children:"Payment Instructions:"}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground space-y-1",children:"card"===l?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{children:'• Click "Proceed to Payment" to open Razorpay checkout'}),(0,a.jsx)("p",{children:"• Enter your card details securely"}),(0,a.jsx)("p",{children:"• Complete the payment using OTP if required"}),(0,a.jsx)("p",{children:"• Wait for payment verification"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{children:'• Click "Proceed to Payment" to open Razorpay checkout'}),(0,a.jsx)("p",{children:"• Select your preferred UPI app"}),(0,a.jsx)("p",{children:"• Approve the payment request in your UPI app"}),(0,a.jsx)("p",{children:"• Wait for payment verification"})]})})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(x,{variant:"outline",onClick:s,disabled:d||h,className:"flex-1",children:"Cancel"}),(0,a.jsx)(x,{onClick:()=>{"card"===l?w():C()},disabled:d||h||!g,className:"flex-1",children:d?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(S.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Loading..."]}):"Proceed to ".concat(v(n))})]}),!g&&(0,a.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-yellow-50 border border-yellow-200 rounded-md",children:[(0,a.jsx)(S.Z,{className:"h-4 w-4 text-yellow-600 animate-spin"}),(0,a.jsx)("span",{className:"text-sm text-yellow-700",children:"Loading Razorpay..."})]})]})]})})}var td=s(92735);function to(e){let{isOpen:t,onClose:s}=e;return(0,a.jsx)(eD,{open:t,onOpenChange:s,children:(0,a.jsxs)(eI,{className:"sm:max-w-md",children:[(0,a.jsx)(eT,{children:(0,a.jsxs)(eF,{className:"flex items-center gap-2",children:[(0,a.jsx)(ts.Z,{className:"h-5 w-5"}),"Store QR Code"]})}),(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4 py-4",children:[(0,a.jsx)("div",{className:"border-4 border-white shadow-lg rounded-xl overflow-hidden bg-white p-2",children:(0,a.jsx)("div",{className:"w-64 h-64 bg-gray-100 flex items-center justify-center text-gray-400",children:(0,a.jsxs)("div",{className:"text-center p-4",children:[(0,a.jsx)(ts.Z,{className:"h-16 w-16 mx-auto mb-2 opacity-20"}),(0,a.jsx)("p",{className:"text-sm",children:"Scan to Pay via UPI"}),(0,a.jsx)("p",{className:"text-xs mt-1 text-muted-foreground",children:"(Store UPI QR Placeholder)"})]})})}),(0,a.jsxs)("div",{className:"text-center space-y-1",children:[(0,a.jsx)("h3",{className:"font-semibold text-lg",children:"Scan to Pay"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Accepting GPay, PhonePe, Paytm, BHIM"})]}),(0,a.jsxs)("div",{className:"flex w-full gap-2",children:[(0,a.jsxs)(x,{variant:"outline",className:"flex-1",onClick:()=>{let e=document.createElement("a");e.href="/assets/upi-qr-placeholder.png",e.download="store-qr-code.png",document.body.appendChild(e),e.click(),document.body.removeChild(e)},children:[(0,a.jsx)(td.Z,{className:"mr-2 h-4 w-4"}),"Save Image"]}),(0,a.jsx)(x,{className:"flex-1",onClick:s,children:"Done"})]})]})]})})}function tm(e){let{grandTotal:t,onPayment:s,isProcessing:n}=e,[l,i]=(0,r.useState)(""),[c,d]=(0,r.useState)(""),[o,m]=(0,r.useState)("cash"),[u,p]=(0,r.useState)(""),[j,f]=(0,r.useState)(""),[v,y]=(0,r.useState)(!1),[N,b]=(0,r.useState)("card"),[w,C]=(0,r.useState)(0),[D,k]=(0,r.useState)(!1),[P,A]=(0,r.useState)(!1),I=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e),T=Number.parseFloat(l)||0,E=Number.parseFloat(u)||0,F=Number.parseFloat(j)||0,z=Math.max(0,T-t),O=T+E+F,Z=Math.max(0,t-O),_=(e,t)=>{b(e),C(t),y(!0)},L=async e=>{try{let a={paymentMethod:(null==e?void 0:e.method)||o};"cash"===o?a.cashTendered=T:"card"===o?(a.cardAmount=t,a.razorpayDetails=e):"upi"===o?(a.upiAmount=t,a.razorpayDetails=e):"mixed"===o&&(a.cashTendered=T,a.cardAmount=E,a.upiAmount=F,E>0&&(null==e?void 0:e.method)==="card"?a.razorpayDetails=e:F>0&&(null==e?void 0:e.method)==="upi"&&(a.razorpayDetails=e)),await s(a),k(!0),i(""),p(""),f("")}catch(e){d(e instanceof Error?e.message:"Payment failed")}},R=async()=>{if(d(""),"cash"===o&&T<t){d("Cash tendered is less than the total amount");return}if("mixed"===o&&O<t){d("Total payment is less than the grand total");return}try{await L()}catch(e){d(e instanceof Error?e.message:"Payment failed")}},B=[t,100*Math.ceil(t/100),500*Math.ceil(t/500),1e3*Math.ceil(t/1e3)].filter((e,s,a)=>a.indexOf(e)===s&&e>=t);return(0,r.useEffect)(()=>{k(!1)},[o,t]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-foreground",children:"Payment"}),(0,a.jsxs)(x,{variant:"outline",size:"sm",className:"h-7 text-xs gap-1",onClick:()=>A(!0),children:[(0,a.jsx)(ts.Z,{className:"h-3 w-3"}),"Show QR"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-1 mt-2",children:[(0,a.jsxs)(x,{variant:"cash"===o?"default":"outline",size:"sm",onClick:()=>m("cash"),className:"flex flex-col items-center gap-1 p-2 h-auto min-h-[48px]",children:[(0,a.jsx)(ta.Z,{className:"h-3 w-3"}),(0,a.jsx)("span",{className:"text-xs font-medium",children:"Cash"})]}),(0,a.jsxs)(x,{variant:"card"===o?"default":"outline",size:"sm",onClick:()=>m("card"),className:"flex flex-col items-center gap-1 p-2 h-auto min-h-[48px]",children:[(0,a.jsx)(tr.Z,{className:"h-3 w-3"}),(0,a.jsx)("span",{className:"text-xs font-medium",children:"Card"})]}),(0,a.jsxs)(x,{variant:"upi"===o?"default":"outline",size:"sm",onClick:()=>m("upi"),className:"flex flex-col items-center gap-1 p-2 h-auto min-h-[48px]",children:[(0,a.jsx)(tn.Z,{className:"h-3 w-3"}),(0,a.jsx)("span",{className:"text-xs font-medium",children:"UPI"})]}),(0,a.jsxs)(x,{variant:"mixed"===o?"default":"outline",size:"sm",onClick:()=>m("mixed"),className:"flex flex-col items-center gap-1 p-2 h-auto min-h-[48px]",children:[(0,a.jsx)(tl.Z,{className:"h-3 w-3"}),(0,a.jsx)("span",{className:"text-xs font-medium",children:"Mixed"})]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm font-bold",children:[(0,a.jsx)("span",{children:"Total Amount:"}),(0,a.jsx)("span",{className:"text-primary",children:I(t)})]}),("cash"===o||"mixed"===o)&&(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(g,{htmlFor:"cashTendered",className:"text-xs",children:"Cash Tendered"}),(0,a.jsx)(h,{id:"cashTendered",type:"number",step:"0.01",min:"0",value:l,onChange:e=>i(e.target.value),placeholder:"0.00",className:"text-sm"})]}),"mixed"===o&&(0,a.jsx)(x,{onClick:()=>_("card",Z),disabled:n||Z<=0,className:"w-full h-8 text-sm",size:"sm",children:n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(S.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"Pay Card - ".concat(I(Z))}),"card"===o&&(0,a.jsx)(x,{onClick:()=>_("card",t),disabled:n,className:"w-full h-8 text-sm",size:"sm",children:n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(S.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"Pay ".concat(I(t))}),"mixed"===o&&(0,a.jsx)(x,{onClick:()=>_("upi",Z),disabled:n||Z<=0,className:"w-full h-8 text-sm",size:"sm",children:n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(S.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"Pay UPI - ".concat(I(Z))}),"upi"===o&&(0,a.jsx)(x,{onClick:()=>_("upi",t),disabled:n,className:"w-full h-8 text-sm",size:"sm",children:n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(S.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"Pay ".concat(I(t))}),("cash"===o||"mixed"===o)&&(0,a.jsx)("div",{className:"grid grid-cols-2 gap-1",children:B.slice(0,4).map(e=>(0,a.jsx)(x,{variant:"outline",size:"sm",onClick:()=>i(e.toString()),className:"text-xs h-7",children:I(e)},e))}),(T>0||E>0||F>0)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(te,{}),(0,a.jsxs)("div",{className:"space-y-1",children:[T>0&&(0,a.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,a.jsx)("span",{children:"Cash Tendered:"}),(0,a.jsx)("span",{className:"font-medium",children:I(T)})]}),E>0&&(0,a.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,a.jsx)("span",{children:"Card Amount:"}),(0,a.jsx)("span",{className:"font-medium",children:I(E)})]}),F>0&&(0,a.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,a.jsx)("span",{children:"UPI Amount:"}),(0,a.jsx)("span",{className:"font-medium",children:I(F)})]}),(0,a.jsxs)("div",{className:"flex justify-between font-bold text-xs",children:[(0,a.jsx)("span",{children:"Total Paid:"}),(0,a.jsx)("span",{className:"text-primary",children:I(O)})]}),"cash"===o&&T>0&&(0,a.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,a.jsx)("span",{children:"Change Due:"}),(0,a.jsx)("span",{className:"font-medium text-green-600",children:I(z)})]}),"mixed"===o&&Z>0&&(0,a.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,a.jsx)("span",{children:"Remaining:"}),(0,a.jsx)("span",{className:"font-medium text-orange-600",children:I(Z)})]})]})]}),c&&(0,a.jsx)("div",{className:"text-sm text-destructive",children:c}),("cash"===o||"mixed"===o)&&(0,a.jsx)(x,{onClick:R,disabled:n||"cash"===o&&T<t||"mixed"===o&&O<t,className:"w-full h-8 text-sm",size:"sm",children:n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(S.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"Complete Sale - ".concat(I(t))})]}),(0,a.jsx)(tc,{isOpen:v,onClose:()=>y(!1),amount:w,paymentMethod:N,onSuccess:e=>{y(!1),"mixed"===o?"card"===e.method?p(w.toString()):f(w.toString()):L(e)},onError:e=>{y(!1),d(e)}}),(0,a.jsx)(to,{isOpen:P,onClose:()=>A(!1)})]})}function tu(e){let{customerInfo:t,onCustomerInfoChange:s}=e,[n,l]=(0,r.useState)(t);(0,r.useEffect)(()=>{l(t)},[t]);let i=(e,t)=>{let a={...n,[e]:t};l(a),s(a)},c=Object.values(t).some(e=>e&&""!==e.trim());return(0,a.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-card border rounded-lg shadow-sm",children:[(0,a.jsx)(L.Z,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-wrap flex-1",children:[(0,a.jsx)(h,{value:n.name||"",onChange:e=>i("name",e.target.value),placeholder:"Customer Name",className:"h-10 text-base w-40"}),(0,a.jsx)(h,{value:n.phone||"",onChange:e=>i("phone",e.target.value),placeholder:"Customer Phone",className:"h-10 text-base w-40"}),(0,a.jsx)(h,{value:n.email||"",onChange:e=>i("email",e.target.value),type:"email",placeholder:"Customer Email",className:"h-10 text-base w-40"}),(0,a.jsx)(h,{value:n.address||"",onChange:e=>i("address",e.target.value),placeholder:"Customer Address",className:"h-10 text-base w-48"}),(0,a.jsx)(h,{value:n.gstNumber||"",onChange:e=>i("gstNumber",e.target.value.toUpperCase()),placeholder:"Customer GST",className:"h-10 text-base w-36"})]}),c&&(0,a.jsx)("button",{onClick:()=>{s({}),l({})},className:"flex-shrink-0 p-1 hover:bg-muted rounded transition-colors",children:(0,a.jsx)(ee.Z,{className:"h-3 w-3 text-muted-foreground"})})]})}var tx=s(48662),th=s(33276),tp=s(89227),tg=s(94394),tj=s(61094),tf=s(24880);let tv={en:"en-IN",ta:"ta-IN",bilingual:"en-IN"},ty={idle:"bg-slate-100 text-slate-700",listening:"bg-green-100 text-green-700",paused:"bg-amber-100 text-amber-700",processing:"bg-blue-100 text-blue-700",error:"bg-destructive/10 text-destructive"};function tN(e){let{onTranscript:t}=e,{language:s}=(0,tf.Z)(),{devices:n,selectedDeviceId:l,selectDevice:i,permissionState:c,ensurePermission:d,refreshDevices:m,isEnumerating:u,supportsDeviceSelection:h,deviceChangePending:p,acknowledgeDeviceChange:g}=function(){let[e,t]=(0,r.useState)([]),[s,a]=(0,r.useState)("default"),[n,l]=(0,r.useState)("prompt"),[i,c]=(0,r.useState)(!1),[d,o]=(0,r.useState)(!1),m=!!navigator.mediaDevices,u=(0,r.useRef)(null),x=(0,r.useCallback)(async()=>{var e;if(m&&(null===(e=navigator.mediaDevices)||void 0===e?void 0:e.enumerateDevices)){c(!0);try{let e=(await navigator.mediaDevices.enumerateDevices()).filter(e=>"audioinput"===e.kind);if(t(e),0===e.length){a("default");return}"default"===s||e.some(e=>e.deviceId===s)||a(e[0].deviceId||"default")}catch(e){console.error("Failed to enumerate audio devices",e)}finally{c(!1)}}},[s,m]),h=(0,r.useCallback)(async()=>{var e;if(!m||!(null===(e=navigator.mediaDevices)||void 0===e?void 0:e.getUserMedia))return l("unsupported"),!1;try{return(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(e=>e.stop()),l("granted"),await x(),!0}catch(e){return console.error("Microphone permission denied",e),l("denied"),!1}},[x,m]),p=(0,r.useCallback)(e=>{o(!1),a(e)},[]),g=(0,r.useCallback)(()=>{o(!1)},[]);(0,r.useEffect)(()=>{var e,t;if(!m){l("unsupported");return}x(),(null===(e=navigator.permissions)||void 0===e?void 0:e.query)&&navigator.permissions.query({name:"microphone"}).then(e=>{var t;l(e.state);let s=()=>l(e.state);null===(t=e.addEventListener)||void 0===t||t.call(e,"change",s),e.onchange=s,u.current=()=>{var t;null===(t=e.removeEventListener)||void 0===t||t.call(e,"change",s),e.onchange=null}}).catch(()=>{});let s=()=>{o(!0),x()};return null===(t=navigator.mediaDevices)||void 0===t||t.addEventListener("devicechange",s),()=>{var e,t;null===(e=navigator.mediaDevices)||void 0===e||e.removeEventListener("devicechange",s),null===(t=u.current)||void 0===t||t.call(u)}},[x,m]);let j=(0,r.useMemo)(()=>e.length>1,[e.length]);return{devices:e,selectedDeviceId:s,selectDevice:p,permissionState:n,ensurePermission:h,refreshDevices:x,isEnumerating:i,supportsDeviceSelection:j,deviceChangePending:d,acknowledgeDeviceChange:g}}(),{supported:j,status:f,error:v,transcripts:y,start:N,pause:b,resume:S,stop:D,inputLevel:k}=function(e){let{language:t,onTranscript:s,deviceId:a}=e,n=(0,r.useRef)(null),l=(0,r.useRef)(null),i=(0,r.useRef)(null),c=(0,r.useRef)(null),d=(0,r.useRef)(),[o,m]=(0,r.useState)(!1),[u,x]=(0,r.useState)("idle"),[h,p]=(0,r.useState)(null),[g,j]=(0,r.useState)([]),[f,v]=(0,r.useState)(0),y=(0,r.useRef)(!1),N=(0,r.useMemo)(()=>{var e;return null!==(e=tv[t])&&void 0!==e?e:"en-IN"},[t]),b=(0,r.useMemo)(()=>{if(a&&"default"!==a)return{exact:a}},[a]),w=(0,r.useCallback)(()=>{var e,t,s;d.current&&(cancelAnimationFrame(d.current),d.current=void 0),null===(e=c.current)||void 0===e||e.disconnect(),c.current=null,null===(t=i.current)||void 0===t||t.close().catch(()=>void 0),i.current=null,null===(s=l.current)||void 0===s||s.getTracks().forEach(e=>e.stop()),l.current=null,v(0)},[]),C=(0,r.useCallback)(()=>{if(!c.current)return;let e=c.current,t=new Uint8Array(e.fftSize),s=()=>{e.getByteTimeDomainData(t);let a=0;for(let e=0;e<t.length;e++){let s=t[e]/128-1;a+=s*s}let r=Math.sqrt(a/t.length);v(Number.isFinite(r)?Math.min(1,2.5*r):0),d.current=requestAnimationFrame(s)};d.current=requestAnimationFrame(s)},[]),S=(0,r.useCallback)(async()=>{var e;if(l.current)return l.current;if(!(null===(e=navigator.mediaDevices)||void 0===e?void 0:e.getUserMedia))return null;try{let e=await navigator.mediaDevices.getUserMedia({audio:{deviceId:b,noiseSuppression:!0,echoCancellation:!0,autoGainControl:!1},video:!1});l.current=e;let t=new AudioContext;i.current=t;let s=t.createMediaStreamSource(e),a=t.createAnalyser();return a.fftSize=256,c.current=a,s.connect(a),C(),e}catch(e){return console.error("Unable to access microphone",e),p("Unable to access microphone. Check device permissions or selection."),x("error"),null}},[b,C]),D=(0,r.useCallback)(()=>{if(n.current)return n.current;let e=window.SpeechRecognition||window.webkitSpeechRecognition;if(!e)return m(!1),null;let t=new e;return t.continuous=!0,t.interimResults=!0,t.maxAlternatives=1,t.onresult=e=>{let t=[];for(let a=e.resultIndex;a<e.results.length;a++){let r=e.results[a],n=r[0],l=n.transcript.trim();if(!l)continue;let i={id:"".concat(Date.now(),"-").concat(a),text:l,confidence:n.confidence,isFinal:r.isFinal,timestamp:Date.now()};t.unshift(i),r.isFinal&&(null==s||s(l,n.confidence))}t.length>0&&j(e=>[...t,...e].slice(0,10)),t.some(e=>e.isFinal)&&x("processing")},t.onerror=e=>{console.error("Voice billing error",e),p(e.error||"Voice recognition error"),x("error")},t.onend=()=>{if(y.current){x("paused");return}x("idle")},n.current=t,m(!0),t},[s]);(0,r.useEffect)(()=>{let e=D();return e&&(e.lang=N),()=>{null==e||e.stop(),n.current=null,w()}},[D,N,w]),(0,r.useEffect)(()=>{"listening"===u&&(w(),S())},[b,S,u,w]);let k=(0,r.useCallback)(async()=>{let e=D();if(!e){p("Voice recognition is not supported in this browser");return}try{if(!await S())return;y.current=!1,e.lang=N,e.start(),p(null),x("listening")}catch(e){console.error("Failed to start voice recognition",e),p("Unable to start microphone. Check permissions and try again."),x("error")}},[S,D,N]),P=(0,r.useCallback)(()=>{let e=n.current;e&&(y.current=!1,e.stop(),x("idle"),w())},[]),A=(0,r.useCallback)(()=>{let e=n.current;e&&(y.current=!0,e.stop(),x("paused"))},[]),I=(0,r.useCallback)(()=>{if(!y.current){k();return}y.current=!1,k()},[k]);return{supported:o,status:u,error:h,transcripts:g,start:k,pause:A,resume:I,stop:P,inputLevel:f}}({language:s,onTranscript:t,deviceId:l}),[P,I]=(0,r.useState)(null),[T,E]=(0,r.useState)(!1),[F,z]=(0,r.useState)("ok"),O=(0,r.useRef)(null),Z=(0,r.useRef)(null),_=(0,r.useRef)(!1);(0,r.useEffect)(()=>{"prompt"===c&&d()},[c,d]),(0,r.useEffect)(()=>{let e=window.localStorage.getItem("voiceNoiseBaseline");if(e){let t=Number(e);Number.isNaN(t)||I(t)}},[]),(0,r.useEffect)(()=>{null!==P&&window.localStorage.setItem("voiceNoiseBaseline",P.toString())},[P]),(0,r.useEffect)(()=>()=>{O.current&&(window.clearInterval(O.current),O.current=null)},[]),(0,r.useEffect)(()=>{if(null!==P){if("listening"!==f){Z.current=null,"autopaused"!==F&&z("ok");return}k-P>.35?Z.current?Date.now()-Z.current>2500&&!_.current&&(_.current=!0,z("autopaused"),b()):(Z.current=Date.now(),"ok"===F&&z("warning")):(Z.current=null,"autopaused"!==F&&"ok"!==F&&z("ok"),"autopaused"===F&&"paused"!==f&&(_.current=!1,z("ok")),"warning"===F&&z("ok"))}},[k,P,b,f,F]);let L=()=>{if(T)return;E(!0);let e=[],t=Date.now();O.current=window.setInterval(()=>{e.push(k),Date.now()-t>=3e3&&(O.current&&(window.clearInterval(O.current),O.current=null),I(Math.min(.8,Math.max(.05,e.length?e.reduce((e,t)=>e+t,0)/e.length:k))),E(!1))},150)},R=()=>{_.current=!1,z("ok"),S()};return j?(0,a.jsxs)("div",{className:"flex flex-col gap-2 p-3 rounded-lg border bg-muted/30",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"p-2 rounded-full bg-primary/10 text-primary",children:(0,a.jsx)(tx.Z,{className:"h-4 w-4"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:"Voice Billing"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Tap start and speak product commands"})]})]}),(0,a.jsx)(A,{className:o("text-xs capitalize",ty[f]),children:f})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[(0,a.jsx)("span",{children:"Input level"}),(0,a.jsxs)("span",{children:[Math.round(100*k),"%"]})]}),(0,a.jsx)("div",{className:"h-2 rounded-full bg-muted overflow-hidden",children:(0,a.jsx)("div",{className:o("h-full bg-primary transition-all duration-200",{"bg-amber-500":k>.65,"bg-green-500":k<=.65&&k>.25,"bg-red-500":k<=.25}),style:{width:"".concat(Math.min(100,Math.round(100*k)),"%")}})})]}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2 text-xs text-muted-foreground",children:[(0,a.jsxs)("span",{children:["Baseline:"," ",null!==P?"".concat(Math.round(100*P),"%"):"Not calibrated"]}),(0,a.jsx)(x,{size:"sm",variant:"outline",onClick:L,disabled:T,children:T?"Calibrating...":"Calibrate Noise"})]}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[h&&(0,a.jsxs)(ei,{value:l,onValueChange:i,children:[(0,a.jsx)(ed,{className:"flex-1 min-w-[160px]",children:(0,a.jsx)(ec,{placeholder:"Select microphone"})}),(0,a.jsx)(eo,{children:n.map(e=>(0,a.jsx)(em,{value:e.deviceId||"default",children:e.label||"System default"},e.deviceId||e.label))})]}),(0,a.jsx)(x,{size:"sm",variant:"outline",onClick:()=>d(),disabled:"granted"===c,children:"Grant Mic Access"}),(0,a.jsxs)(x,{size:"sm",variant:"ghost",onClick:()=>m(),disabled:u,children:[(0,a.jsx)(eK.Z,{className:o("h-4 w-4 mr-1",{"animate-spin":u})}),"Rescan"]})]}),"denied"===c&&(0,a.jsx)(w,{variant:"destructive",className:"text-xs",children:(0,a.jsx)(C,{children:"Microphone access denied. Please allow access in your browser settings and click “Grant Mic Access”."})}),p&&(0,a.jsx)(w,{className:"text-xs",children:(0,a.jsxs)(C,{className:"flex items-center justify-between gap-2",children:["New audio device detected. Select it above or continue with the current microphone.",(0,a.jsx)(x,{size:"sm",variant:"outline",onClick:g,children:"Dismiss"})]})}),"denied"===c&&(0,a.jsx)(w,{variant:"destructive",className:"text-xs",children:(0,a.jsx)(C,{children:"Microphone access denied. Please allow access in your browser settings and click “Grant Mic Access”."})}),null===P&&(0,a.jsx)(w,{className:"text-xs border-amber-200 bg-amber-50",children:(0,a.jsx)(C,{children:"Calibrate the noise baseline to improve accuracy in busy environments."})}),"warning"===F&&(0,a.jsx)(w,{className:"text-xs border-amber-200 bg-amber-50",children:(0,a.jsx)(C,{children:"High ambient noise detected. Voice capture sensitivity has been reduced; consider pausing or recalibrating."})}),"autopaused"===F&&(0,a.jsx)(w,{variant:"destructive",className:"text-xs",children:(0,a.jsxs)(C,{className:"flex flex-col gap-2",children:["Voice billing was paused because of sustained noise. Resume once the environment is quieter or recalibrate with the current noise level.",(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(x,{size:"sm",variant:"secondary",onClick:R,children:"Resume anyway"}),(0,a.jsx)(x,{size:"sm",variant:"outline",onClick:L,disabled:T,children:"Recalibrate"})]})]})}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(x,{variant:"secondary",size:"sm",onClick:()=>{_.current=!1,z("ok"),N()},disabled:"listening"===f,children:[(0,a.jsx)(th.Z,{className:"h-4 w-4 mr-1"})," Start"]}),(0,a.jsxs)(x,{variant:"outline",size:"sm",onClick:()=>{_.current=!1,b()},disabled:"listening"!==f,children:[(0,a.jsx)(tp.Z,{className:"h-4 w-4 mr-1"})," Pause"]}),(0,a.jsxs)(x,{variant:"outline",size:"sm",onClick:R,disabled:"paused"!==f,children:[(0,a.jsx)(tg.Z,{className:"h-4 w-4 mr-1"})," Resume"]}),(0,a.jsxs)(x,{variant:"ghost",size:"sm",onClick:()=>{_.current=!1,z("ok"),D()},children:[(0,a.jsx)(tj.Z,{className:"h-4 w-4 mr-1"})," Stop"]})]}),v&&(0,a.jsx)("p",{className:"text-xs text-destructive",children:v}),y.length>0&&(0,a.jsx)("div",{className:"max-h-32 overflow-y-auto rounded-md bg-background border text-xs divide-y",children:y.map(e=>(0,a.jsxs)("div",{className:"p-2 flex items-center justify-between gap-2",children:[(0,a.jsx)("span",{className:"truncate",children:e.text}),(0,a.jsxs)("span",{className:"text-muted-foreground",children:[Math.round(100*e.confidence),"%"]})]},e.id))})]}):(0,a.jsx)("div",{className:"flex flex-col gap-2 p-3 rounded-lg border bg-muted/30",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground text-sm",children:[(0,a.jsx)(tx.Z,{className:"h-4 w-4"}),"Browser voice APIs unavailable. Please use Chrome/Edge or enable the feature flag backend stack."]})})}var tb=s(77945);function tw(){let{language:e,setLanguage:t}=(0,tf.Z)();return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(tb.Z,{className:"h-4 w-4"}),(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)(x,{variant:"en"===e?"default":"outline",size:"sm",onClick:()=>t("en"),children:"English"}),(0,a.jsx)(x,{variant:"ta"===e?"default":"outline",size:"sm",onClick:()=>t("ta"),children:"தமிழ்"}),(0,a.jsx)(x,{variant:"bilingual"===e?"default":"outline",size:"sm",onClick:()=>t("bilingual"),children:"Both"})]})]})}let tC={ஒன்று:1,ஒரு:1,ரெண்டு:2,இரண்டு:2,மூன்று:3,நான்கு:4,ஐந்து:5,ஆறு:6,ஏழு:7,எட்டு:8,ஒன்பது:9,பத்து:10},tS={add:["add","give","need","want","include","plus"],remove:["remove","delete","minus","take out"],hold:["hold bill","hold"],clear:["clear","reset"]},tD={add:["சேர்","வேண்டும்","போடு","வாங்கு"],remove:["அகற்று","நீக்கு","குறை"],hold:["பில் ஹோல்ட்","ஹோல்ட்"],clear:["க்ளியர்","திருத்து"]},tk=/\b(\d+(?:\.\d+)?)\b/,tP=0,tA=new Map,tI=e=>{if(tA.has(e))return;let t=setTimeout(()=>{tA.delete(e),tz({type:"REMOVE_TOAST",toastId:e})},1e6);tA.set(e,t)},tT=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?tI(s):e.toasts.forEach(e=>{tI(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},tE=[],tF={toasts:[]};function tz(e){tF=tT(tF,e),tE.forEach(e=>{e(tF)})}function tO(e){let{...t}=e,s=(tP=(tP+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>tz({type:"DISMISS_TOAST",toastId:s});return tz({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||a()}}}),{id:s,dismiss:a,update:e=>tz({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function tZ(){let[e,t]=r.useState(tF);return r.useEffect(()=>(tE.push(t),()=>{let e=tE.indexOf(t);e>-1&&tE.splice(e,1)}),[e]),{...e,toast:tO,dismiss:e=>tz({type:"DISMISS_TOAST",toastId:e})}}let t_=[{canonical:"milk",matchers:["paal","pal","பால்","milk packet","taza milk"]},{canonical:"curd",matchers:["thayir","தயிர்","yogurt"]},{canonical:"rice",matchers:["arisi","அரிசி","rice bag","samba rice","ponni"]},{canonical:"sugar",matchers:["sakkarai","சர்க்கரை","cheeni"]},{canonical:"oil",matchers:["ennai","எண்ணெய்","cooking oil","sunflower oil","chekku"]},{canonical:"soap",matchers:["saboon","சோப்பு","bath bar"]},{canonical:"dal",matchers:["paruppu","பருப்பு","lentils"]},{canonical:"tea",matchers:["chai","tea powder","தேநீர்"]},{canonical:"coffee",matchers:["kaapi","காபி","coffee powder"]}].map(e=>({canonical:tL(e.canonical),matchers:e.matchers.map(e=>tL(e)).filter(Boolean)}));function tL(e){return e?e.toLowerCase().normalize("NFKD").replace(/[\u0300-\u036f]/g,"").replace(RegExp("[^\\p{L}\\p{N}\\s]","gu")," ").replace(/\s+/g," ").trim():""}function tR(e,t,s){if(!s)return 0;let a=s.split(" ").filter(Boolean);if(0===a.length)return 0;let r=[e.name,e.code,e.category,t.size,t.sku,t.barcode],n=0;for(let e of r){let t=tL(e);if(!t)continue;if(t===s){n=Math.max(n,1);continue}if(t.includes(s)||s.includes(t)){n=Math.max(n,.85);continue}let r=a.filter(e=>t.includes(e)).length/a.length;r>0&&(n=Math.max(n,.8*r))}return n}function tB(e){return e.split(" ").filter(Boolean).map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}function tU(){let{toast:e}=tZ(),{language:t}=(0,tf.Z)(),[s,n]=(0,r.useState)([]),[l,i]=(0,r.useState)({name:"",phone:""}),[c,d]=(0,r.useState)(!1),[o,m]=(0,r.useState)(""),[u,h]=(0,r.useState)(""),[p,g]=(0,r.useState)(null),[y,b]=(0,r.useState)([]),[D,k]=(0,r.useState)(null),[P,I]=(0,r.useState)(!1),[T,E]=(0,r.useState)(""),[F,z]=(0,r.useState)([]),[O,Z]=(0,r.useState)(!1),[_,L]=(0,r.useState)([]),[R,B]=(0,r.useState)(!1),[U,M]=(0,r.useState)(void 0),q=(0,r.useCallback)(e=>{let t=e.quantity*e.rate,s=0;e.discount&&(s="percentage"===e.discount.discountType?e.discount.discountValue/100*t:Math.min(e.discount.discountValue*e.quantity,t));let a=t-s,r=e.product.taxRate/100*a;return{...e,amount:a,taxAmount:r,totalAmount:a+r,discount:e.discount?{...e.discount,discountAmount:s}:void 0}},[]),V=async function(e,t){var a,r;let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=Math.max(1,null!==(a=l.quantity)&&void 0!==a?a:1),c=null!==(r=l.source)&&void 0!==r?r:"manual",d=null;try{console.log("\uD83D\uDD0D Fetching discounts for product:",e._id,e.name,"variant:",t.size);let s=await eB.apiClient.getApplicableDiscounts(e._id);console.log("\uD83D\uDCE6 Found discounts:",s),s&&s.length>0?(d=s.sort((e,s)=>{let a="percentage"===e.type?t.price*e.value/100:Math.min(e.value,t.price);return("percentage"===s.type?t.price*s.value/100:Math.min(s.value,t.price))-a})[0],console.log("\uD83C\uDFC6 Best discount selected:",d)):console.log("❌ No applicable discounts found for product:",e.name)}catch(e){console.error("❌ Error fetching discounts:",e)}let o=s.findIndex(s=>s.product._id===e._id&&s.variant.size===t.size);if(o>=0){let e=s[o],t=q({...e,quantity:e.quantity+i,discount:e.discount});n(e=>e.map((e,s)=>s===o?t:e))}else{let s=q({id:"".concat(e._id,"-").concat(t.sku||t.size,"-").concat(Date.now()),product:e,variant:t,quantity:i,rate:t.price,source:c,discount:d?{discountId:d._id,discountName:d.name,discountType:d.type,discountValue:d.value,discountAmount:0}:void 0});n(e=>[...e,s])}},J=e=>{n(t=>t.filter(t=>t.id!==e))},H=async()=>{if(p){d(!0);try{let e=await eB.apiClient.generateBillPDF(p,t),s=window.URL.createObjectURL(e);window.open(s)}catch(e){m("Failed to generate receipt PDF")}finally{d(!1)}}},K=()=>{g(null),n([]),i({name:"",phone:"",email:"",address:"",gstNumber:""}),m(""),h("")};s.reduce((e,t)=>e+t.totalAmount,0);let Y=s.reduce((e,t)=>{var s;let a=t.quantity*t.rate;return e.subtotal+=a,e.totalTax+=t.taxAmount,e.totalDiscount+=(null===(s=t.discount)||void 0===s?void 0:s.discountAmount)||0,e},{subtotal:0,totalTax:0,totalDiscount:0}),Q=(null==D?void 0:D.isEligible)?Math.round((Y.subtotal+Y.totalTax)*.02):0,$=Math.round(Y.subtotal+Y.totalTax-Q),X=(0,r.useCallback)(async e=>{if(!e||""===e.trim()){k(null);return}I(!0);try{let t=await eB.apiClient.getCustomerLoyaltyStatus(e);k(t),console.log("\uD83C\uDFAF Loyalty status checked:",t)}catch(e){console.error("❌ Error checking loyalty status:",e),k(null)}finally{I(!1)}},[]);(0,r.useEffect)(()=>{if(l.phone&&""!==l.phone.trim()){let e=setTimeout(()=>{X(l.phone)},500);return()=>clearTimeout(e)}k(null)},[l.phone,X]),(0,r.useEffect)(()=>{let e=localStorage.getItem("heldBills");if(console.log("\uD83D\uDD0D Loading held bills from localStorage:",e),e)try{let t=JSON.parse(e);console.log("✅ Parsed held bills:",t),b(t)}catch(e){console.error("❌ Error parsing held bills:",e)}else console.log("ℹ️ No held bills found in localStorage")},[]),(0,r.useEffect)(()=>{console.log("\uD83D\uDCBE Saving held bills to localStorage:",y),localStorage.setItem("heldBills",JSON.stringify(y))},[y]);let ee=()=>{if(0===s.length){m("No items to hold");return}let e={id:Date.now().toString(),billItems:[...s],customerInfo:{...l},heldAt:new Date().toISOString(),grandTotal:Math.round($)};console.log("\uD83D\uDCCB Holding bill:",e),b(t=>{let s=[e,...t];return console.log("\uD83D\uDCDD Updated held bills:",s),s}),h("Bill held successfully! (".concat(s.length," items, ₹").concat(e.grandTotal.toLocaleString("en-IN"),")")),K()},et=e=>{let t=y.find(t=>t.id===e);if(!t){m("Held bill not found");return}n(t.billItems),i(t.customerInfo),b(t=>t.filter(t=>t.id!==e)),h("Held bill retrieved! (".concat(t.billItems.length," items, ₹").concat(t.grandTotal.toLocaleString("en-IN"),")"))},es=e=>{b(t=>t.filter(t=>t.id!==e))},ea=(0,r.useCallback)(t=>{if(!t)return!1;let a=tL(t);if(!a)return!1;let r=null;for(let e of s){let t=tR(e.product,e.variant,a);(!r||t>r.score)&&(r={item:e,score:t})}return!!r&&r.score>=.35&&(J(r.item.id),e({title:"Voice removal",description:"".concat(r.item.product.name," (").concat(r.item.variant.size,") removed")}),!0)},[s,J,e]),er=(0,r.useCallback)(async function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};s.skipSpinner||Z(!0);try{"add"===t.action&&(await V(t.product,t.variant,{quantity:t.quantity,source:"voice"}),e({title:"Voice item added",description:"".concat(t.quantity," \xd7 ").concat(t.product.name," (").concat(t.variant.size,")")})),z(e=>e.filter(e=>e.id!==t.id))}catch(t){console.error("Voice suggestion apply failed",t),e({title:"Voice action failed",description:"Unable to apply the suggested product. Please try again.",variant:"destructive"})}finally{s.skipSpinner||Z(!1)}},[V,e]),el=(0,r.useCallback)(e=>{z(t=>t.filter(t=>t.id!==e))},[]),ei=(0,r.useCallback)(async e=>{let{transcript:s,normalizedName:a,confidence:r}=e;if(!a)return;let n={id:"".concat(Date.now(),"-").concat(Math.random()),transcript:s,normalizedName:a,language:t,confidence:r,createdAt:new Date().toISOString()};L(e=>[n,...e].slice(0,5));try{await eB.apiClient.logVoiceMissingItem({transcript:s,normalizedName:a,language:t,confidence:r})}catch(e){console.warn("Failed to log missing voice item",e)}},[t]),ec=(0,r.useCallback)(e=>{L(t=>t.filter(t=>t.id!==e))},[]),ed=(0,r.useCallback)(e=>{M({name:tB(e.normalizedName)}),B(!0),ec(e.id)},[ec]),eo=(0,r.useCallback)(()=>{B(!1),M(void 0)},[]),em=(0,r.useCallback)(()=>{e({title:"Product created",description:"The inventory has been updated with your new item."}),eo()},[eo,e]),eu=(0,r.useCallback)(async(t,a)=>{let r=t.trim();if(r){if(E(r),a<.55){e({title:"Voice confidence low",description:"Could not confidently detect the product. Please speak again clearly."});return}Z(!0),z([]);try{var n,l,i;let t=function(e){let t=e.trim().toLowerCase();if(!t)return{action:"unknown"};let s=function(e){let t=e.match(tk);if(t)return Number(t[1])||void 0;for(let[t,s]of Object.entries(tC))if(e.includes(t))return s}(t),a=function(e){for(let t of[tS,tD]){if(t.add.some(t=>e.includes(t)))break;if(t.remove.some(t=>e.includes(t)))return"remove";if(t.hold.some(t=>e.includes(t)))return"hold";if(t.clear.some(t=>e.includes(t)))return"clear"}return"add"}(t),r=function(e,t){if("hold"===t||"clear"===t||"unknown"===t)return;let s=e;for(let e of[...tS.add,...tS.remove,...tD.add,...tD.remove]){let t=RegExp(e,"gi");s=s.replace(t,"")}return(s=(s=(s=s.replace(tk,"")).replace(/\b(pieces?|units?)\b/gi,"")).replace(/[\s-]+/g," ").trim())||void 0}(t,a);return{action:a,quantity:s,terms:r}}(r),c=Math.max(1,null!==(n=t.quantity)&&void 0!==n?n:1);if("hold"===t.action){ee(),e({title:"Bill held",description:"Current bill moved to held bills via voice command."});return}if("clear"===t.action){0===s.length?e({title:"Nothing to clear",description:"No items in the bill currently."}):(K(),e({title:"Bill cleared",description:"All items removed from the bill via voice."}));return}if("remove"===t.action){ea(t.terms)||e({title:"No matching item",description:"Could not match a billed item to remove.",variant:"destructive"});return}let d=t.terms;if(!d){e({title:"Product not detected",description:"Please include the product name in your voice command."});return}let{variants:o,normalized:m,matchedCanonicals:u}=function(e){let t=tL(e),s=new Set,a=new Set;for(let e of(t&&s.add(t),t_))e.canonical&&e.matchers.some(e=>e&&t.includes(e))&&(a.add(e.canonical),s.add(e.canonical));return t.includes(" and ")&&t.split(" and ").map(e=>e.trim()).filter(Boolean).forEach(e=>s.add(e)),{normalized:t,variants:Array.from(s),matchedCanonicals:Array.from(a)}}(d),x=o.length>0?o:m?[m]:[];if(0===x.length){e({title:"Product not detected",description:"Please include the product name in your voice command."});return}let h=new Map,p=async e=>{let t=[];try{t=await eB.apiClient.getProducts({search:e,active:!0})}catch(t){console.error("Voice lookup failed for term:",e,t)}if(0===t.length)try{let s=await eB.apiClient.getProductByIdentifier(e);s&&(t=[s])}catch(e){}for(let e of t)h.has(e._id)||h.set(e._id,e)};for(let e of x)await p(e);if(0===h.size&&u.length>0)for(let e of u)await p(e);let g=Array.from(h.values());if(0===g.length){let t=x[0]||m;t&&await ei({transcript:r,normalizedName:t,confidence:a}),e({title:"Product not found",description:"This item is not in inventory yet. Use the quick add suggestion below."});return}let j=[];for(let e of g){let s=e.variants&&e.variants.length>0?e.variants:[{size:"Default",price:null!==(l=e.basePrice)&&void 0!==l?l:0,cost:null!==(i=e.baseCost)&&void 0!==i?i:0,stock:0,sku:e.code,isActive:!0}],n=tL(e.name),d=u.some(e=>e&&e===n);for(let n of s){if(!1===n.isActive)continue;let s=x.reduce((t,s)=>Math.max(t,tR(e,n,s)),0);if(s<=0)continue;let l=d?.1:0,i=Math.min(1,.6*s+.3*a+l);i<.3||j.push({id:"".concat(e._id,"-").concat(n.sku||n.size,"-").concat(Date.now(),"-").concat(Math.random()),product:e,variant:n,quantity:c,action:t.action,transcript:r,score:i})}}j.sort((e,t)=>t.score-e.score);let f=j.slice(0,3);if(0===f.length){let t=x[0]||m;t&&await ei({transcript:r,normalizedName:t,confidence:a}),e({title:"Product not found",description:"This item is not in inventory yet. Use the quick add suggestion below."});return}z(f);let v=f[0];v.score>=.65?(await er(v,{skipSpinner:!0}),e({title:"Voice match added",description:"".concat(v.quantity," \xd7 ").concat(v.product.name," added automatically.")})):e({title:"Voice suggestions ready",description:"Review the suggested products below and tap apply."})}catch(t){console.error("Voice transcript handling failed",t),e({title:"Voice processing failed",description:"Could not process the voice command. Please retry.",variant:"destructive"})}finally{Z(!1)}}},[!0,e,ee,s,K,ea,er,ei]),ex=async e=>{if(0===s.length){m("No items in the bill");return}d(!0),m("");try{let r={},c=[];if(e.razorpayDetails&&(r={razorpayPaymentId:e.razorpayDetails.paymentId,razorpayOrderId:e.razorpayDetails.orderId,razorpaySignature:e.razorpayDetails.signature,paymentStatus:"completed"},"card"===e.razorpayDetails.method?r.cardType="Credit Card":"upi"===e.razorpayDetails.method&&(r.upiId="customer@upi")),"cash"===e.paymentMethod)c.push({method:"cash",amount:e.cashTendered||$});else if("card"===e.paymentMethod)c.push({method:"card",amount:$,details:e.razorpayDetails?{razorpayPaymentId:e.razorpayDetails.paymentId,razorpayOrderId:e.razorpayDetails.orderId,razorpaySignature:e.razorpayDetails.signature}:void 0});else if("upi"===e.paymentMethod)c.push({method:"upi",amount:$,details:e.razorpayDetails?{razorpayPaymentId:e.razorpayDetails.paymentId,razorpayOrderId:e.razorpayDetails.orderId,razorpaySignature:e.razorpayDetails.signature}:void 0});else if("mixed"===e.paymentMethod){var t,a;e.cashTendered&&e.cashTendered>0&&c.push({method:"cash",amount:e.cashTendered}),e.cardAmount&&e.cardAmount>0&&c.push({method:"card",amount:e.cardAmount,details:(null===(t=e.razorpayDetails)||void 0===t?void 0:t.method)==="card"?{razorpayPaymentId:e.razorpayDetails.paymentId,razorpayOrderId:e.razorpayDetails.orderId,razorpaySignature:e.razorpayDetails.signature}:void 0}),e.upiAmount&&e.upiAmount>0&&c.push({method:"upi",amount:e.upiAmount,details:(null===(a=e.razorpayDetails)||void 0===a?void 0:a.method)==="upi"?{razorpayPaymentId:e.razorpayDetails.paymentId,razorpayOrderId:e.razorpayDetails.orderId,razorpaySignature:e.razorpayDetails.signature}:void 0})}let d={items:s.map(e=>({product:e.product._id,size:e.variant.size,quantity:e.quantity,rate:e.rate,taxRate:e.product.taxRate,discount:e.discount?{discountId:e.discount.discountId,discountName:e.discount.discountName,discountType:e.discount.discountType,discountValue:e.discount.discountValue,discountAmount:e.discount.discountAmount}:void 0})),customer:l,cashTendered:e.cashTendered,paymentMethod:e.paymentMethod,paymentDetails:Object.keys(r).length>0?r:void 0,paymentBreakdown:c.length>0?c:void 0,applyLoyaltyDiscount:(null==D?void 0:D.isEligible)||!1},o=await eB.apiClient.createBill(d);if(l.email&&""!==l.email.trim())try{await eB.apiClient.sendBillByEmail(o._id,l.email);let e="Bill ".concat(o.billNumber," created successfully and sent via email to ").concat(l.email,"!");(null==D?void 0:D.isEligible)&&(e+=" \uD83C\uDF89 2% Loyalty discount applied!"),h(e),g(o._id)}catch(t){console.error("Failed to send email:",t);let e="Bill ".concat(o.billNumber," created successfully! (Email delivery failed)");(null==D?void 0:D.isEligible)&&(e+=" \uD83C\uDF89 2% Loyalty discount applied!"),h(e),g(o._id)}else{let e="Bill ".concat(o.billNumber," created successfully!");(null==D?void 0:D.isEligible)&&(e+=" \uD83C\uDF89 2% Loyalty discount applied!"),h(e),g(o._id)}n([]),i({name:"",phone:"",email:"",address:"",gstNumber:""})}catch(e){m(e instanceof Error?e.message:"Failed to create bill")}finally{d(!1)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"h-full bg-background overflow-hidden",children:(0,a.jsx)(j,{className:"h-full flex flex-col overflow-hidden",children:(0,a.jsxs)(N,{className:"flex-1 p-0 flex flex-col lg:flex-row overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex-1 flex flex-col p-6 space-y-6 min-w-0 overflow-hidden",children:[o&&(0,a.jsx)(w,{variant:"destructive",className:"mb-4",children:(0,a.jsx)(C,{children:o})}),u&&(0,a.jsx)(w,{className:"border-green-200 bg-green-50 text-green-800 mb-4",children:(0,a.jsxs)(C,{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{children:u}),p&&(0,a.jsxs)(x,{size:"sm",variant:"outline",className:"h-7 text-xs gap-1 ml-2 bg-white",onClick:H,children:[(0,a.jsx)(eH.Z,{className:"h-3 w-3"}),"Print Bill"]})]})}),(0,a.jsxs)("div",{className:"flex-shrink-0 space-y-4",children:[(0,a.jsxs)("div",{className:"flex gap-3 items-end",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(e0,{onProductSelect:V})}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(x,{variant:"outline",onClick:K,disabled:0===s.length,children:[(0,a.jsx)(eK.Z,{className:"mr-2 h-4 w-4"}),"Clear All"]}),(0,a.jsxs)(x,{variant:"outline",onClick:ee,disabled:0===s.length,children:[(0,a.jsx)(W.Z,{className:"mr-2 h-4 w-4"}),"Hold Bill"]})]}),(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(tw,{})})]}),(0,a.jsx)(tN,{onTranscript:eu}),T&&(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Last voice command: ",(0,a.jsx)("span",{className:"font-medium text-foreground",children:T})]}),(O||F.length>0)&&(0,a.jsxs)("div",{className:"rounded-lg border bg-background/60 p-3 space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 font-medium text-foreground",children:[(0,a.jsx)(eW.Z,{className:"h-3.5 w-3.5 text-primary"}),"Voice suggestions"]}),O&&(0,a.jsxs)(A,{variant:"outline",className:"text-[10px] gap-1",children:[(0,a.jsx)(S.Z,{className:"h-3 w-3 animate-spin"}),"Processing"]})]}),F.map(e=>(0,a.jsxs)("div",{className:"border rounded-md p-2 text-xs flex flex-col gap-2 bg-muted/30",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-sm text-foreground",children:e.product.name}),(0,a.jsxs)("p",{className:"text-muted-foreground text-[11px]",children:[e.variant.size," • Qty ",e.quantity]}),(0,a.jsxs)("p",{className:"text-[11px] text-muted-foreground",children:["Confidence ",(100*e.score).toFixed(0),"%"]})]}),(0,a.jsx)(A,{variant:"secondary",className:"text-[10px] capitalize",children:e.action})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsxs)(x,{size:"sm",onClick:()=>er(e),disabled:O,className:"text-[11px] gap-1",children:[(0,a.jsx)(en.Z,{className:"h-3 w-3"}),"Apply"]}),(0,a.jsx)(x,{variant:"ghost",size:"sm",onClick:()=>el(e.id),disabled:O,className:"text-[11px]",children:"Dismiss"})]})]},e.id)),!O&&0===F.length&&(0,a.jsx)("p",{className:"text-[11px] text-muted-foreground",children:"Waiting for voice matches…"})]}),_.length>0&&(0,a.jsxs)("div",{className:"rounded-lg border border-dashed bg-muted/20 p-3 space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs font-medium text-muted-foreground",children:[(0,a.jsx)("span",{children:"Not in inventory yet"}),(0,a.jsxs)(A,{variant:"secondary",className:"text-[10px]",children:[_.length," pending"]})]}),_.map(e=>(0,a.jsxs)("div",{className:"border rounded-md bg-background p-3 space-y-2 text-xs",children:[(0,a.jsx)("div",{className:"font-semibold text-foreground",children:tB(e.normalizedName)}),(0,a.jsxs)("div",{className:"text-[11px] text-muted-foreground",children:["“",e.transcript,"”"]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsx)(x,{size:"sm",variant:"default",onClick:()=>ed(e),children:"Add to inventory"}),(0,a.jsx)(x,{size:"sm",variant:"ghost",onClick:()=>ec(e.id),children:"Dismiss"})]})]},e.id))]})]}),(0,a.jsxs)("div",{className:"flex-shrink-0",children:[(0,a.jsx)(tu,{customerInfo:{name:l.name||"",phone:l.phone||"",email:l.email,address:l.address,gstNumber:l.gstNumber},onCustomerInfoChange:e=>{i({name:e.name||"",phone:e.phone||"",email:e.email,address:e.address,gstNumber:e.gstNumber})}}),P&&(0,a.jsx)("div",{className:"mt-2 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"animate-spin h-4 w-4 border-2 border-blue-600 border-t-transparent rounded-full"}),(0,a.jsx)("span",{className:"text-sm text-blue-700",children:"Checking loyalty status..."})]})}),D&&!P&&(0,a.jsx)("div",{className:"mt-2 p-3 rounded-lg border ".concat(D.isEligible?"bg-green-50 border-green-200":"bg-amber-50 border-amber-200"),children:(0,a.jsx)("div",{className:"flex items-center gap-2",children:D.isEligible?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eY.Z,{className:"h-4 w-4 text-green-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-green-800",children:"\uD83C\uDF89 Loyalty Discount Available!"}),(0,a.jsx)("p",{className:"text-xs text-green-700",children:"2% discount will be applied on this purchase"})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eQ.Z,{className:"h-4 w-4 text-amber-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-amber-800",children:"Loyalty Status"}),(0,a.jsxs)("p",{className:"text-xs text-amber-700",children:[D.purchaseCount," purchases made •",D.nextPurchaseForDiscount>0?"".concat(D.nextPurchaseForDiscount," more purchase").concat(D.nextPurchaseForDiscount>1?"s":""," for 2% discount"):"Next purchase eligible for discount!"]})]})]})})})]}),(0,a.jsx)("div",{className:"flex-1 min-h-0",children:(0,a.jsxs)(j,{className:"h-full flex flex-col overflow-hidden",children:[(0,a.jsx)(f,{className:"flex-shrink-0 pb-3",children:(0,a.jsxs)(v,{className:"text-lg",children:["Items (",s.length,")"]})}),(0,a.jsx)(N,{className:"flex-1 overflow-hidden p-0",children:(0,a.jsx)("div",{className:"h-full overflow-y-auto scrollbar-thin scrollbar-thumb-muted scrollbar-track-muted/20 hover:scrollbar-thumb-muted-foreground",children:(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)(e9,{items:s,onUpdateItem:(e,t)=>{n(s=>s.map(s=>s.id===e?q({...s,...t}):s))},onRemoveItem:J})})})})]})})]}),(0,a.jsxs)("div",{className:"w-full lg:w-80 flex-shrink-0 border-l bg-muted/50 flex flex-col",children:[(0,a.jsx)("div",{className:"flex-shrink-0 p-4 border-b",children:(0,a.jsxs)(j,{className:"bg-gradient-to-br from-background to-muted/30 shadow-sm",children:[(0,a.jsx)(f,{className:"pb-1",children:(0,a.jsxs)(v,{className:"text-lg flex items-center gap-2",children:[(0,a.jsx)(G.Z,{className:"h-5 w-5"}),"Bill Summary",s.length>0&&(0,a.jsxs)("span",{className:"ml-auto text-sm bg-primary/10 text-primary px-2 py-1 rounded-full",children:[s.length," items"]})]})}),(0,a.jsx)(N,{className:"pt-0",children:(0,a.jsx)(tt,{items:s,loyaltyStatus:D})})]})}),s.length>0&&(0,a.jsx)("div",{className:"flex-shrink-0 p-4 border-b",children:(0,a.jsxs)(j,{className:"bg-gradient-to-br from-background to-muted/30 shadow-sm",children:[(0,a.jsx)(f,{className:"pb-1",children:(0,a.jsxs)(v,{className:"text-lg flex items-center gap-2",children:[(0,a.jsx)(e$.Z,{className:"h-5 w-5"}),"Payment",(0,a.jsxs)("span",{className:"ml-auto text-sm bg-primary/10 text-primary px-2 py-1 rounded-full",children:["₹",Math.round($).toLocaleString("en-IN")]})]})}),(0,a.jsx)(N,{className:"pt-0",children:(0,a.jsx)(tm,{grandTotal:Math.round($),onPayment:ex,isProcessing:c})})]})}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:0===s.length&&(0,a.jsxs)(j,{className:"bg-gradient-to-br from-background to-muted/30 shadow-sm",children:[(0,a.jsx)(f,{className:"pb-2",children:(0,a.jsxs)(v,{className:"text-lg flex items-center gap-2",children:[(0,a.jsx)(W.Z,{className:"h-5 w-5"}),"Held Bills",(0,a.jsxs)("span",{className:"ml-auto text-sm bg-primary/10 text-primary px-2 py-1 rounded-full",children:[y.length," held"]})]})}),(0,a.jsx)(N,{className:"pt-0 space-y-2",children:y.length>0?y.map(e=>(0,a.jsxs)("div",{className:"p-3 border rounded-lg bg-background/50 hover:bg-background transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("span",{className:"text-sm font-medium",children:[e.billItems.length," items"]}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"•"}),(0,a.jsxs)("span",{className:"text-sm font-semibold text-primary",children:["₹",e.grandTotal.toLocaleString("en-IN")]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(x,{size:"sm",variant:"outline",onClick:()=>et(e.id),className:"h-7 px-2 text-xs",children:"Retrieve"}),(0,a.jsx)(x,{size:"sm",variant:"ghost",onClick:()=>es(e.id),className:"h-7 px-2 text-xs text-destructive hover:text-destructive",children:"\xd7"})]})]}),e.customerInfo.name&&(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Customer: ",e.customerInfo.name,e.customerInfo.phone&&" • ".concat(e.customerInfo.phone)]}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground mt-1",children:["Held: ",new Date(e.heldAt).toLocaleString()]})]},e.id)):(0,a.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,a.jsx)(W.Z,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),(0,a.jsx)("p",{className:"text-sm",children:"No held bills yet"}),(0,a.jsx)("p",{className:"text-xs mt-1",children:'Add items to a bill and click "Hold Bill" to save it here'})]})})]})})]})]})})}),(0,a.jsx)(eJ,{product:null,isOpen:R,onClose:eo,onSuccess:em,initialValues:U})]})}var tM=s(20271);function tq(e){let{className:t,...s}=e;return(0,a.jsx)(tM.fC,{"data-slot":"tabs",className:o("flex flex-col gap-2",t),...s})}function tV(e){let{className:t,...s}=e;return(0,a.jsx)(tM.aV,{"data-slot":"tabs-list",className:o("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",t),...s})}function tJ(e){let{className:t,...s}=e;return(0,a.jsx)(tM.xz,{"data-slot":"tabs-trigger",className:o("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...s})}function tG(e){let{className:t,...s}=e;return(0,a.jsx)(tM.VY,{"data-slot":"tabs-content",className:o("flex-1 outline-none",t),...s})}var tH=s(95252);function tK(e){let{isOpen:t,onClose:s,onStartShift:n}=e,[l,i]=(0,r.useState)(""),[c,d]=(0,r.useState)(!1),[o,m]=(0,r.useState)(""),u=async e=>{e.preventDefault(),m("");let t=Number.parseFloat(l);if(isNaN(t)||t<0){m("Please enter a valid opening cash amount");return}d(!0);try{await n(t),i("")}catch(e){m(e instanceof Error?e.message:"Failed to start shift")}finally{d(!1)}},p=()=>{c||(i(""),m(""),s())};return(0,a.jsx)(eD,{open:t,onOpenChange:p,children:(0,a.jsxs)(eI,{children:[(0,a.jsxs)(eT,{children:[(0,a.jsxs)(eF,{className:"flex items-center gap-2",children:[(0,a.jsx)(th.Z,{className:"h-5 w-5"}),"Start New Shift"]}),(0,a.jsx)(ez,{children:"Enter the opening cash amount in the register to start your shift. This will be used to calculate the expected cash at the end of your shift."})]}),(0,a.jsxs)("form",{onSubmit:u,className:"space-y-4",children:[o&&(0,a.jsx)(w,{variant:"destructive",children:(0,a.jsx)(C,{children:o})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"openingCash",children:"Opening Cash Amount"}),(0,a.jsx)(h,{id:"openingCash",type:"number",step:"0.01",min:"0",value:l,onChange:e=>i(e.target.value),placeholder:"0.00",required:!0,disabled:c,className:"text-lg"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{children:"Quick Amounts"}),(0,a.jsx)("div",{className:"grid grid-cols-5 gap-2",children:[0,500,1e3,2e3,5e3].map(e=>(0,a.jsxs)(x,{type:"button",variant:"outline",size:"sm",onClick:()=>i(e.toString()),disabled:c,className:"text-xs",children:["₹",e]},e))})]}),(0,a.jsxs)(eE,{children:[(0,a.jsx)(x,{type:"button",variant:"outline",onClick:p,disabled:c,children:"Cancel"}),(0,a.jsx)(x,{type:"submit",disabled:c,children:c?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(S.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Starting..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(th.Z,{className:"mr-2 h-4 w-4"}),"Start Shift"]})})]})]})]})})}function tW(e){let{className:t,...s}=e;return(0,a.jsx)("textarea",{"data-slot":"textarea",className:o("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...s})}var tY=s(76865);function tQ(e){let{isOpen:t,onClose:s,onEndShift:n,currentShift:l}=e,[i,c]=(0,r.useState)(""),[d,o]=(0,r.useState)(""),[m,u]=(0,r.useState)(!1),[p,j]=(0,r.useState)(""),f=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e),v=l?l.openingCash+l.totalSales:0,y=Number.parseFloat(i)||0,N=y-v,b=Math.abs(N)>.01,D=async e=>{if(e.preventDefault(),j(""),isNaN(y)||y<0){j("Please enter a valid closing cash amount");return}u(!0);try{await n(y,d||void 0),c(""),o("")}catch(e){j(e instanceof Error?e.message:"Failed to end shift")}finally{u(!1)}},k=()=>{m||(c(""),o(""),j(""),s())};return l?(0,a.jsx)(eD,{open:t,onOpenChange:k,children:(0,a.jsxs)(eI,{className:"max-w-md",children:[(0,a.jsxs)(eT,{children:[(0,a.jsxs)(eF,{className:"flex items-center gap-2",children:[(0,a.jsx)(tj.Z,{className:"h-5 w-5"}),"End Shift"]}),(0,a.jsx)(ez,{children:"Count the cash in the register and enter the closing amount to end your shift."})]}),(0,a.jsxs)("form",{onSubmit:D,className:"space-y-4",children:[p&&(0,a.jsx)(w,{variant:"destructive",children:(0,a.jsx)(C,{children:p})}),(0,a.jsxs)("div",{className:"space-y-3 p-4 bg-muted rounded-lg",children:[(0,a.jsx)("h4",{className:"font-medium",children:"Shift Summary"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Opening Cash:"}),(0,a.jsx)("span",{children:f(l.openingCash)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Total Sales:"}),(0,a.jsx)("span",{className:"text-green-600 dark:text-green-400",children:f(l.totalSales)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Bills Created:"}),(0,a.jsx)("span",{children:l.totalBills})]}),(0,a.jsx)(te,{}),(0,a.jsxs)("div",{className:"flex justify-between font-medium",children:[(0,a.jsx)("span",{children:"Expected Cash:"}),(0,a.jsx)("span",{children:f(v)})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"closingCash",children:"Actual Cash in Register"}),(0,a.jsx)(h,{id:"closingCash",type:"number",step:"0.01",min:"0",value:i,onChange:e=>c(e.target.value),placeholder:"0.00",required:!0,disabled:m,className:"text-lg"})]}),i&&b&&(0,a.jsxs)(w,{variant:N<0?"destructive":"default",children:[(0,a.jsx)(tY.Z,{className:"h-4 w-4"}),(0,a.jsxs)(C,{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{children:"Cash Difference:"}),(0,a.jsxs)("span",{className:"font-medium ".concat(N<0?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"),children:[N>0?"+":"",f(N)]})]}),N<0?"Cash shortage detected":"Cash overage detected"]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"notes",children:"Notes (Optional)"}),(0,a.jsx)(tW,{id:"notes",value:d,onChange:e=>o(e.target.value),placeholder:"Add any notes about the shift...",disabled:m,rows:3})]}),(0,a.jsxs)(eE,{children:[(0,a.jsx)(x,{type:"button",variant:"outline",onClick:k,disabled:m,children:"Cancel"}),(0,a.jsx)(x,{type:"submit",disabled:m,variant:"destructive",children:m?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(S.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Ending..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(tj.Z,{className:"mr-2 h-4 w-4"}),"End Shift"]})})]})]})]})}):null}function t$(){let{isAdmin:e,isCashier:t}=(0,n.a)(),[s,l]=(0,r.useState)(null),[i,c]=(0,r.useState)(!0),[d,o]=(0,r.useState)(""),[m,u]=(0,r.useState)(!1),[h,p]=(0,r.useState)(!1),g=async()=>{try{c(!0),o("");let e=await eB.apiClient.getCurrentShift();l(e)}catch(e){o(e instanceof Error?e.message:"Failed to load shift data")}finally{c(!1)}};(0,r.useEffect)(()=>{g()},[]);let y=async e=>{try{await eB.apiClient.startShift(e),await g(),u(!1)}catch(e){throw e}},b=async(e,t)=>{try{await eB.apiClient.endShift(e,t),await g(),p(!1)}catch(e){throw e}},D=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e),k=e=>{let t=new Date(e),s=new Date().getTime()-t.getTime();return"".concat(Math.floor(s/36e5),"h ").concat(Math.floor(s%36e5/6e4),"m")};return i?(0,a.jsx)(j,{children:(0,a.jsxs)(N,{className:"flex items-center justify-center py-8",children:[(0,a.jsx)(S.Z,{className:"h-6 w-6 animate-spin mr-2"}),"Loading shift status..."]})}):(0,a.jsxs)("div",{className:"space-y-6",children:[d&&(0,a.jsx)(w,{variant:"destructive",children:(0,a.jsx)(C,{children:d})}),(0,a.jsxs)(j,{children:[(0,a.jsx)(f,{children:(0,a.jsxs)(v,{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(_.Z,{className:"h-5 w-5"}),"Shift Status"]}),s?(0,a.jsx)(A,{variant:"default",className:"bg-green-600 dark:bg-green-700",children:"Active Shift"}):(0,a.jsx)(A,{variant:"secondary",children:"No Active Shift"})]})}),(0,a.jsx)(N,{children:s?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Shift Started"}),(0,a.jsx)("p",{className:"font-medium",children:new Date(s.startTime).toLocaleString()}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Duration: ",k(s.startTime)]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Opening Cash"}),(0,a.jsx)("p",{className:"font-medium text-lg",children:D(s.openingCash)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Sales"}),(0,a.jsx)("p",{className:"font-medium text-lg text-green-600 dark:text-green-400",children:D(s.totalSales)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Bills Created"}),(0,a.jsx)("p",{className:"font-medium text-lg",children:s.totalBills})]})]}),(0,a.jsx)("div",{className:"bg-muted p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Expected Cash in Drawer"}),(0,a.jsx)("p",{className:"text-xl font-bold",children:D(s.openingCash+s.totalSales)})]}),(0,a.jsxs)(x,{onClick:()=>p(!0),variant:"destructive",children:[(0,a.jsx)(tj.Z,{className:"mr-2 h-4 w-4"}),"End Shift"]})]})})]}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(_.Z,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),(0,a.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No Active Shift"}),(0,a.jsx)("p",{className:"text-muted-foreground mb-4",children:e?"Admin users cannot start shifts. Please ask a cashier to start a shift.":"Start a new shift to begin processing sales"}),!e&&(0,a.jsxs)(x,{onClick:()=>u(!0),children:[(0,a.jsx)(th.Z,{className:"mr-2 h-4 w-4"}),"Start Shift"]})]})})]}),s&&(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsx)(j,{children:(0,a.jsxs)(N,{className:"flex items-center p-6",children:[(0,a.jsx)(tH.Z,{className:"h-8 w-8 text-green-600 dark:text-green-400 mr-3"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Average Sale"}),(0,a.jsx)("p",{className:"text-xl font-bold",children:D(s.totalBills>0?s.totalSales/s.totalBills:0)})]})]})}),(0,a.jsx)(j,{children:(0,a.jsxs)(N,{className:"flex items-center p-6",children:[(0,a.jsx)(W.Z,{className:"h-8 w-8 text-blue-600 dark:text-blue-400 mr-3"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Sales per Hour"}),(0,a.jsx)("p",{className:"text-xl font-bold",children:(()=>{let e=(new Date().getTime()-new Date(s.startTime).getTime())/36e5;return e>0?Math.round(s.totalBills/e):0})()})]})]})}),(0,a.jsx)(j,{children:(0,a.jsxs)(N,{className:"flex items-center p-6",children:[(0,a.jsx)(_.Z,{className:"h-8 w-8 text-purple-600 dark:text-purple-400 mr-3"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Shift Duration"}),(0,a.jsx)("p",{className:"text-xl font-bold",children:k(s.startTime)})]})]})})]}),(0,a.jsx)(tK,{isOpen:m,onClose:()=>u(!1),onStartShift:y}),(0,a.jsx)(tQ,{isOpen:h,onClose:()=>p(!1),onEndShift:b,currentShift:s})]})}function tX(){let[e,t]=(0,r.useState)([]),[s,n]=(0,r.useState)(!0),[l,i]=(0,r.useState)(""),[c,d]=(0,r.useState)(1),[o,m]=(0,r.useState)(1),[u,p]=(0,r.useState)(""),[g,b]=(0,r.useState)(""),D=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;try{n(!0),i("");let s={page:e,limit:10};u&&(s.startDate=u),g&&(s.endDate=g);let a=await eB.apiClient.getShifts(s);t(a.shifts),m(a.totalPages),d(a.currentPage)}catch(e){i(e instanceof Error?e.message:"Failed to load shifts")}finally{n(!1)}};(0,r.useEffect)(()=>{D()},[u,g]);let k=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e),P=(e,t)=>{let s=new Date(e),a=(t?new Date(t):new Date).getTime()-s.getTime();return"".concat(Math.floor(a/36e5),"h ").concat(Math.floor(a%36e5/6e4),"m")},I=e=>{if("active"===e.status||void 0===e.closingCash)return null;let t=e.openingCash+e.totalSales;return e.closingCash-t};return(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)(j,{children:[(0,a.jsxs)(f,{children:[(0,a.jsxs)(v,{className:"flex items-center gap-2",children:[(0,a.jsx)(_.Z,{className:"h-5 w-5"}),"Shift History"]}),(0,a.jsx)(y,{children:"View and manage shift records"})]}),(0,a.jsxs)(N,{children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(h,{type:"date",value:u,onChange:e=>p(e.target.value),placeholder:"Start Date"})}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(h,{type:"date",value:g,onChange:e=>b(e.target.value),placeholder:"End Date"})}),(0,a.jsx)(x,{variant:"outline",onClick:()=>{p(""),b("")},children:"Clear"})]}),l&&(0,a.jsx)(w,{variant:"destructive",className:"mb-4",children:(0,a.jsx)(C,{children:l})}),(0,a.jsx)("div",{className:"border rounded-lg",children:(0,a.jsxs)(e1,{children:[(0,a.jsx)(e2,{children:(0,a.jsxs)(e3,{children:[(0,a.jsx)(e5,{children:"Cashier"}),(0,a.jsx)(e5,{children:"Start Time"}),(0,a.jsx)(e5,{children:"Duration"}),(0,a.jsx)(e5,{children:"Sales"}),(0,a.jsx)(e5,{children:"Bills"}),(0,a.jsx)(e5,{children:"Cash Difference"}),(0,a.jsx)(e5,{children:"Status"})]})}),(0,a.jsx)(e4,{children:s?(0,a.jsx)(e3,{children:(0,a.jsxs)(e6,{colSpan:7,className:"text-center py-8",children:[(0,a.jsx)(S.Z,{className:"h-6 w-6 animate-spin mx-auto mb-2"}),"Loading shifts..."]})}):0===e.length?(0,a.jsx)(e3,{children:(0,a.jsx)(e6,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No shifts found"})}):e.map(e=>{let t=I(e);return(0,a.jsxs)(e3,{children:[(0,a.jsx)(e6,{children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e.cashierName}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:new Date(e.startTime).toLocaleDateString()})]})}),(0,a.jsx)(e6,{children:(0,a.jsxs)("div",{className:"text-sm",children:[new Date(e.startTime).toLocaleTimeString(),e.endTime&&(0,a.jsxs)("div",{className:"text-muted-foreground",children:["to ",new Date(e.endTime).toLocaleTimeString()]})]})}),(0,a.jsx)(e6,{children:P(e.startTime,e.endTime)}),(0,a.jsx)(e6,{children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:k(e.totalSales)}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Avg: ",e.totalBills>0?k(e.totalSales/e.totalBills):"₹0"]})]})}),(0,a.jsx)(e6,{children:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(W.Z,{className:"h-4 w-4 text-muted-foreground"}),e.totalBills]})}),(0,a.jsx)(e6,{children:null!==t?(0,a.jsx)("div",{className:"font-medium ".concat(.01>Math.abs(t)?"text-green-600 dark:text-green-400":t<0?"text-red-600 dark:text-red-400":"text-blue-600 dark:text-blue-400"),children:.01>Math.abs(t)?"Balanced":"".concat(t>0?"+":"").concat(k(t))}):(0,a.jsx)("span",{className:"text-muted-foreground",children:"-"})}),(0,a.jsx)(e6,{children:(0,a.jsx)(A,{variant:"active"===e.status?"default":"secondary",children:"active"===e.status?"Active":"Closed"})})]},e._id)})})]})}),o>1&&(0,a.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Page ",c," of ",o]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(x,{variant:"outline",size:"sm",onClick:()=>D(c-1),disabled:c<=1||s,children:"Previous"}),(0,a.jsx)(x,{variant:"outline",size:"sm",onClick:()=>D(c+1),disabled:c>=o||s,children:"Next"})]})]})]})]})})}var t0=s(70525),t1=s(85954),t2=s(58896);function t4(){var e,t,s;let{user:l}=(0,n.a)(),[i,c]=(0,r.useState)(null),[d,o]=(0,r.useState)([]),[m,u]=(0,r.useState)(null),[h,p]=(0,r.useState)(!1),[g,y]=(0,r.useState)(""),[b,S]=(0,r.useState)({isOpen:!1,shiftId:"",shiftDetails:null}),[D,k]=(0,r.useState)({startDate:"",endDate:""}),P=(null==l?void 0:l.role)==="admin",I=e=>{let t=Math.floor(e);return"".concat(t,"h ").concat(Math.round((e-t)*60),"m")},T=async()=>{if(P)try{var e,t;p(!0),y("");let s=new URLSearchParams;D.startDate&&s.append("startDate",D.startDate),D.endDate&&s.append("endDate",D.endDate);let[a,r,n]=await Promise.all([eB.apiClient.getShiftSummary(D),eB.apiClient.getActiveShifts(),eB.apiClient.getAvailableCashiers()]);console.log("\uD83D\uDD0D Available Cashiers Data:",n),console.log("\uD83D\uDD0D Available Cashiers Data structure:",{hasData:!!n,hasAvailableCashiers:!!(n&&n.availableCashiers),availableCashiersLength:(null==n?void 0:null===(e=n.availableCashiers)||void 0===e?void 0:e.length)||0,allCashiersLength:(null==n?void 0:null===(t=n.allCashiers)||void 0===t?void 0:t.length)||0,activeShiftCashiers:(null==n?void 0:n.activeShiftCashiers)||0,fullData:JSON.stringify(n,null,2)}),console.log("\uD83D\uDD0D Active Shifts Data:",r),c(a),o(r),u(n)}catch(e){y(e instanceof Error?e.message:"Failed to load admin data")}finally{p(!1)}};(0,r.useEffect)(()=>{P&&T()},[P]);let E=(e,t)=>{S({isOpen:!0,shiftId:e,shiftDetails:t})},F=async()=>{try{await eB.apiClient.forceEndShift(b.shiftId),await T(),S({isOpen:!1,shiftId:"",shiftDetails:null})}catch(e){y(e instanceof Error?e.message:"Failed to end shift")}},z=()=>{S({isOpen:!1,shiftId:"",shiftDetails:null})},O=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e);return(0,a.jsxs)("div",{className:"space-y-6",children:[g&&(0,a.jsx)(w,{variant:"destructive",children:(0,a.jsx)(C,{children:g})}),(0,a.jsxs)(tq,{defaultValue:P?"overview":"status",className:"w-full",children:[(0,a.jsxs)(tV,{className:"grid w-full ".concat(P?"grid-cols-3":"grid-cols-2"),children:[!P&&(0,a.jsx)(tJ,{value:"status",children:"Current Shift"}),(0,a.jsx)(tJ,{value:"history",children:"Shift History"}),P&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(tJ,{value:"overview",children:"Overview"}),(0,a.jsx)(tJ,{value:"active",children:"Active Shifts"})]})]}),!P&&(0,a.jsx)(tG,{value:"status",className:"space-y-6",children:(0,a.jsx)(t$,{})}),(0,a.jsx)(tG,{value:"history",className:"space-y-6",children:(0,a.jsx)(tX,{})}),P&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(tG,{value:"overview",className:"space-y-6",children:[(0,a.jsxs)(j,{children:[(0,a.jsx)(f,{children:(0,a.jsx)(v,{children:"Date Range Filter"})}),(0,a.jsx)(N,{children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Start Date"}),(0,a.jsx)("input",{type:"date",className:"w-full p-2 border rounded-md",value:D.startDate,onChange:e=>k(t=>({...t,startDate:e.target.value}))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"End Date"}),(0,a.jsx)("input",{type:"date",className:"w-full p-2 border rounded-md",value:D.endDate,onChange:e=>k(t=>({...t,endDate:e.target.value}))})]}),(0,a.jsx)("div",{className:"flex items-end",children:(0,a.jsx)(x,{onClick:T,className:"w-full",disabled:h,children:h?"Loading...":"Apply Filter"})})]})})]}),h?(0,a.jsx)(j,{children:(0,a.jsxs)(N,{className:"flex items-center justify-center py-8",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"}),(0,a.jsx)("span",{className:"ml-2",children:"Loading overview..."})]})}):i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsx)(j,{children:(0,a.jsxs)(N,{className:"flex items-center p-6",children:[(0,a.jsx)(_.Z,{className:"h-8 w-8 text-blue-600 mr-3"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Shifts"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:i.totalShifts}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[i.activeShifts," active • ",i.closedShifts," closed"]})]})]})}),(0,a.jsx)(j,{children:(0,a.jsxs)(N,{className:"flex items-center p-6",children:[(0,a.jsx)(t0.Z,{className:"h-8 w-8 text-green-600 mr-3"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Sales"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:O(i.totalSales)}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[i.totalBills," bills • ",O(i.totalSales/i.totalBills||0)," avg/bill"]})]})]})}),(0,a.jsx)(j,{children:(0,a.jsxs)(N,{className:"flex items-center p-6",children:[(0,a.jsx)(t1.Z,{className:"h-8 w-8 text-purple-600 mr-3"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Avg Duration"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:I(i.averageShiftDuration)}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Per closed shift"})]})]})}),(0,a.jsx)(j,{children:(0,a.jsxs)(N,{className:"flex items-center p-6",children:[(0,a.jsx)(tH.Z,{className:"h-8 w-8 text-orange-600 mr-3"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Cash Variance"}),(0,a.jsx)("p",{className:"text-2xl font-bold ".concat(i.totalCashVariance>=0?"text-green-600":"text-red-600"),children:O(i.totalCashVariance)}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[O(i.averageCashVariance)," avg/shift"]})]})]})})]}),(0,a.jsxs)(j,{children:[(0,a.jsx)(f,{children:(0,a.jsxs)(v,{className:"flex items-center gap-2",children:[(0,a.jsx)(Y.Z,{className:"h-5 w-5"}),"Peak Sales Hours"]})}),(0,a.jsx)(N,{children:i.peakHours&&i.peakHours.length>0?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:i.peakHours.map((e,t)=>(0,a.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)(A,{variant:0===t?"default":"secondary",children:["#",t+1]}),(0,a.jsx)("span",{className:"font-semibold",children:e.hour})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("p",{className:"text-sm",children:["Sales: ",O(e.totalSales)]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[e.shiftCount," shifts"]})]})]},t))}):(0,a.jsx)("p",{className:"text-muted-foreground text-center py-4",children:"No peak hours data available"})})]}),(0,a.jsxs)(j,{children:[(0,a.jsx)(f,{children:(0,a.jsxs)(v,{className:"flex items-center gap-2",children:[(0,a.jsx)(t2.Z,{className:"h-5 w-5"}),"Detailed Cashier Performance"]})}),(0,a.jsx)(N,{children:(0,a.jsx)("div",{className:"space-y-4",children:Object.entries(i.shiftsByCashier).map(e=>{let[t,s]=e;return(0,a.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold text-lg",children:t}),(0,a.jsxs)("div",{className:"flex gap-4 text-sm text-muted-foreground",children:[(0,a.jsxs)("span",{children:[s.totalShifts," total shifts"]}),(0,a.jsxs)("span",{children:[s.activeShifts," active"]}),(0,a.jsxs)("span",{children:[s.closedShifts," closed"]})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"font-bold text-lg",children:O(s.totalSales)}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Sales"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-muted-foreground",children:"Bills"}),(0,a.jsx)("p",{className:"font-medium",children:s.totalBills}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[s.averageBillsPerShift.toFixed(1),"/shift"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-muted-foreground",children:"Avg Sales"}),(0,a.jsx)("p",{className:"font-medium",children:O(s.averageSalesPerShift)}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"per shift"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-muted-foreground",children:"Duration"}),(0,a.jsx)("p",{className:"font-medium",children:I(s.averageDuration)}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"avg shift"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-muted-foreground",children:"Cash Variance"}),(0,a.jsx)("p",{className:"font-medium ".concat(s.cashVariance>=0?"text-green-600":"text-red-600"),children:O(s.cashVariance)}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"total variance"})]})]})]},t)})})})]})]}):null]}),(0,a.jsx)(tG,{value:"active",className:"space-y-6",children:h?(0,a.jsx)(j,{children:(0,a.jsxs)(N,{className:"flex items-center justify-center py-8",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"}),(0,a.jsx)("span",{className:"ml-2",children:"Loading active shifts..."})]})}):(0,a.jsxs)(a.Fragment,{children:[console.log("\uD83D\uDD0D Rendering available cashiers section:",{availableCashiers:!!m,hasAllCashiers:!!(m&&m.allCashiers),allCashiersArray:null==m?void 0:m.allCashiers,allCashiersLength:(null==m?void 0:null===(e=m.allCashiers)||void 0===e?void 0:e.length)||0,availableCashiersLength:(null==m?void 0:null===(t=m.availableCashiers)||void 0===t?void 0:t.length)||0}),m&&m.allCashiers&&(0,a.jsxs)(j,{children:[(0,a.jsx)(f,{children:(0,a.jsxs)(v,{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{children:"All Cashiers"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(A,{variant:"secondary",children:[m.allCashiers.length," total"]}),(0,a.jsxs)(A,{variant:"outline",children:[m.availableCashiers.length," available"]}),(0,a.jsxs)(A,{variant:"destructive",children:[m.activeShiftCashiers," on shift"]})]})]})}),(0,a.jsx)(N,{children:m.allCashiers.length>0?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:m.allCashiers.map(e=>{let t=!m.availableCashiers.some(t=>t._id===e._id);return(0,a.jsxs)("div",{className:"p-4 border rounded-lg ".concat(t?"bg-destructive/10 border-destructive/30 dark:bg-destructive/20 dark:border-destructive/40":"bg-green-100 border-green-300 dark:bg-green-900/30 dark:border-green-700"),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("p",{className:"font-medium",children:e.user.name}),(0,a.jsx)(A,{variant:t?"destructive":"default",children:t?"On Shift":"Available"})]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:e.user.employeeId}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:e.user.email}),(0,a.jsx)(A,{variant:"outline",className:"mt-2",children:e.employmentDetails.department})]},e._id)})}):(0,a.jsx)("p",{className:"text-center text-muted-foreground py-4",children:"No cashiers found in the system."})})]}),(0,a.jsxs)(j,{children:[(0,a.jsx)(f,{children:(0,a.jsxs)(v,{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{children:"Currently Active Shifts"}),(0,a.jsxs)(A,{variant:"destructive",children:[d.length," active"]})]})}),(0,a.jsx)(N,{children:d.length>0?(0,a.jsx)("div",{className:"space-y-4",children:d.map(e=>{var t,s;return(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-green-100 border-green-300 dark:bg-green-900/30 dark:border-green-700",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsx)("p",{className:"font-medium text-lg",children:(null===(t=e.cashier)||void 0===t?void 0:t.name)||"Unknown"}),(0,a.jsx)(A,{className:"bg-green-600 dark:bg-green-700",children:"Active Shift"})]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Employee ID: ",(null===(s=e.cashier)||void 0===s?void 0:s.employeeId)||"N/A"]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Started: ",new Date(e.startTime).toLocaleString()]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-3",children:[(0,a.jsxs)("div",{className:"text-center p-2 bg-background rounded border",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Opening Cash"}),(0,a.jsx)("p",{className:"font-semibold",children:O(e.openingCash)})]}),(0,a.jsxs)("div",{className:"text-center p-2 bg-background rounded border",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Total Sales"}),(0,a.jsx)("p",{className:"font-semibold text-green-600 dark:text-green-400",children:O(e.totalSales)})]}),(0,a.jsxs)("div",{className:"text-center p-2 bg-background rounded border",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Bills"}),(0,a.jsx)("p",{className:"font-semibold",children:e.totalBills})]}),(0,a.jsxs)("div",{className:"text-center p-2 bg-background rounded border",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Duration"}),(0,a.jsx)("p",{className:"font-semibold",children:I((new Date().getTime()-new Date(e.startTime).getTime())/36e5)})]})]})]}),(0,a.jsx)("div",{className:"ml-4",children:(0,a.jsx)(x,{size:"sm",variant:"destructive",onClick:()=>E(e._id,e),className:"whitespace-nowrap",children:"Force End Shift"})})]},e._id)})}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("div",{className:"text-muted-foreground mb-2",children:"No active shifts at the moment."}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"All cashiers are currently available to start their shifts."})]})})]})]})})]})]}),(0,a.jsx)(eD,{open:b.isOpen,onOpenChange:z,children:(0,a.jsxs)(eI,{children:[(0,a.jsxs)(eT,{children:[(0,a.jsxs)(eF,{className:"flex items-center gap-2",children:[(0,a.jsx)(tY.Z,{className:"h-5 w-5 text-destructive"}),"Confirm Force End Shift"]}),(0,a.jsxs)(ez,{children:["Are you sure you want to force end the shift for ",null===(s=b.shiftDetails)||void 0===s?void 0:s.employeeName,"? This action cannot be undone and may affect the employee's current session."]})]}),b.shiftDetails&&(0,a.jsxs)("div",{className:"space-y-3 p-4 bg-muted rounded-lg",children:[(0,a.jsx)("h4",{className:"font-medium",children:"Shift Details"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Employee:"}),(0,a.jsx)("span",{children:b.shiftDetails.employeeName})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Start Time:"}),(0,a.jsx)("span",{children:new Date(b.shiftDetails.startTime).toLocaleString()})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Total Sales:"}),(0,a.jsx)("span",{className:"text-green-600 dark:text-green-400",children:O(b.shiftDetails.totalSales)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Bills Created:"}),(0,a.jsx)("span",{children:b.shiftDetails.totalBills})]})]})]}),(0,a.jsxs)(eE,{children:[(0,a.jsx)(x,{type:"button",variant:"outline",onClick:z,children:"Cancel"}),(0,a.jsx)(x,{type:"button",variant:"destructive",onClick:F,children:"Force End Shift"})]})]})})]})}var t3=s(42208),t5=s(90740);function t6(e){let{onSearch:t,isLoading:s}=e,[n,l]=(0,r.useState)({}),[i,c]=(0,r.useState)(!1),d=(e,s)=>{let a={...n,[e]:s||void 0};l(a),t(a)},o=Object.values(n).some(e=>e);return(0,a.jsxs)(j,{children:[(0,a.jsx)(f,{children:(0,a.jsxs)(v,{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(eZ.Z,{className:"h-5 w-5"}),"Search Bills"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(x,{variant:"outline",size:"sm",onClick:()=>c(!i),className:"text-xs",children:[(0,a.jsx)(t5.Z,{className:"mr-1 h-3 w-3"}),i?"Simple":"Advanced"]}),o&&(0,a.jsxs)(x,{variant:"outline",size:"sm",onClick:()=>{l({}),t({})},className:"text-xs bg-transparent",children:[(0,a.jsx)(ee.Z,{className:"mr-1 h-3 w-3"}),"Clear"]})]})]})}),(0,a.jsxs)(N,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"search",children:"Search by Bill Number, Customer Name, or Phone"}),(0,a.jsx)(h,{id:"search",placeholder:"Enter bill number, customer name, or phone...",value:n.search||"",onChange:e=>d("search",e.target.value),disabled:s})]}),i&&(0,a.jsxs)("div",{className:"space-y-4 pt-4 border-t",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"startDate",children:"Start Date"}),(0,a.jsx)(h,{id:"startDate",type:"date",value:n.startDate||"",onChange:e=>d("startDate",e.target.value),disabled:s})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"endDate",children:"End Date"}),(0,a.jsx)(h,{id:"endDate",type:"date",value:n.endDate||"",onChange:e=>d("endDate",e.target.value),disabled:s})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"status",children:"Status"}),(0,a.jsxs)(ei,{value:n.status||"all",onValueChange:e=>d("status",e),children:[(0,a.jsx)(ed,{children:(0,a.jsx)(ec,{placeholder:"All Statuses"})}),(0,a.jsxs)(eo,{children:[(0,a.jsx)(em,{value:"all",children:"All Statuses"}),(0,a.jsx)(em,{value:"completed",children:"Completed"}),(0,a.jsx)(em,{value:"cancelled",children:"Cancelled"}),(0,a.jsx)(em,{value:"refunded",children:"Refunded"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"cashier",children:"Cashier ID"}),(0,a.jsx)(h,{id:"cashier",placeholder:"Enter cashier ID...",value:n.cashier||"",onChange:e=>d("cashier",e.target.value),disabled:s})]})]})]})]})]})}var t8=s(89345),t9=s(53417);function t7(e){var t,n,l,i,c;let{bill:d,isOpen:o,onClose:m}=e;if(!d)return null;let{language:u}=(0,tf.Z)(),[h,p]=(0,r.useState)(!1),[g,j]=(0,r.useState)((null===(t=d.customer)||void 0===t?void 0:t.email)||""),[f,v]=(0,r.useState)(!1),[y,N]=(0,r.useState)(""),[b,w]=(0,r.useState)(!1),[C,D]=(0,r.useState)(!1),k=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e),P=async()=>{try{console.log("\uD83C\uDF0D Current language from context:",u),console.log("\uD83D\uDD0D Language type:",typeof u);let{apiClient:e}=await Promise.resolve().then(s.bind(s,29116)),t=await e.generateBillPDF(d._id,u),a=window.URL.createObjectURL(t),r=document.createElement("a");r.href=a,r.download="bill_".concat(d.billNumber,"_").concat(u,".pdf"),document.body.appendChild(r),r.click(),setTimeout(()=>{document.body.removeChild(r),window.URL.revokeObjectURL(a)},100)}catch(t){console.error("Error downloading PDF:",t);let e=window.open("","_blank");if(e){let t=E(d);e.document.write(t),e.document.close(),e.print()}}},I=async()=>{if(!g.trim()){N("Please enter an email address");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(g)){N("Please enter a valid email address");return}N(""),p(!0);try{var e;await (0,eB.f)(d._id,g),v(!1),j((null===(e=d.customer)||void 0===e?void 0:e.email)||""),console.log("Bill sent successfully to:",g)}catch(e){console.error("Error sending bill:",e),N("Failed to send bill. Please try again.")}finally{p(!1)}},T=async()=>{var e;if(d&&(null===(e=d.customer)||void 0===e?void 0:e.phone)){w(!0),D(!1);try{let e=await (0,eB.t)(d._id,d.customer.phone);e.whatsappUrl&&window.open(e.whatsappUrl,"_blank"),console.log("Bill sent successfully via WhatsApp!")}catch(e){console.error("Error sending WhatsApp:",e)}finally{w(!1)}}},E=e=>{let t=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:2}).format(e),s=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:38,a=t.toString(),r=e.toString(),n=s-r.length-a.length;return r+" ".repeat(Math.max(1,n))+a},a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:42,s=e.length,a=Math.floor((t-s)/2);return" ".repeat(Math.max(0,a))+e+" ".repeat(Math.max(0,t-s-a))},r="\n       *************************************\n       *".concat(a("SUPERMARKET STORE",35),"*\n       *").concat(a("123 Main Street, City",35),"*\n       *").concat(a("State, Country - 123456",35),"*\n       *").concat(a("Phone: +1 234 567 8900",35),"*\n       *************************************\n       \n       BILL #: ").concat(e.billNumber,"\n       DATE:  ").concat(new Date(e.createdAt).toLocaleString("en-IN",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),"\n       CASHIER: ").concat(e.cashierName,"\n       -------------------------------------\n      ");if(e.customer&&(r+="\n       CUSTOMER: ".concat(e.customer.name||"Walk-in Customer","\n       ").concat(e.customer.phone?"PHONE: ".concat(e.customer.phone):"","\n       ").concat(e.customer.email?"EMAIL: ".concat(e.customer.email):"","\n      --------------------------------------\n        ")),r+="     ITEMS                  AMOUNT\n      --------------------------------------\n",e.items.forEach(e=>{let a=" ".concat(e.productName," ").concat(e.size?"(".concat(e.size,")"):""),n=a.length>30?a.substring(0,27)+"...":a,l=t(e.totalAmount),i=" ".concat(e.quantity," x ").concat(t(e.rate));r+="     ".concat(n,"\n")+"     ".concat(s(i,l),"\n")+"\n"}),r+="     ---------------------------------------\n"+"     ".concat(s("SUBTOTAL:",t(e.subtotal)),"\n"),e.loyaltyDiscount&&e.loyaltyDiscount.discountAmount>0&&(r+="     ".concat(s("LOYALTY DISCOUNT:","-"+t(e.loyaltyDiscount.discountAmount)),"\n")),e.totalDiscount>0&&(r+="     ".concat(s("TOTAL DISCOUNT:","-"+t(e.totalDiscount)),"\n")),r+="     ".concat(s("TOTAL TAX:",t(e.totalTax)),"\n"),Math.abs(e.roundOff)>.01){let a=(e.roundOff>0?"+":"")+t(e.roundOff);r+="     ".concat(s("ROUND OFF:",a),"\n")}return r+="     =======================================\n"+"     ".concat(s("TOTAL:",t(e.grandTotal)),"\n")+"     =======================================\n     \n"+"     PAYMENT METHOD: ".concat(e.paymentMethod.toUpperCase(),"\n"),"cash"===e.paymentMethod&&(r+="     ".concat(s("CASH TENDERED:",t(e.cashTendered)),"\n")+"     ".concat(s("CHANGE:",t(e.changeDue)),"\n")),r+="\n    ---------------------------------------\n         THANK YOU FOR YOUR PURCHASE!\n              PLEASE VISIT AGAIN\n           ".concat("completed"===e.status?"     *** PAID ***":"","\n    ****************************************\n      "),'\n      <!DOCTYPE html>\n      <html lang="en">\n      <head>\n        <meta charset="UTF-8">\n        <meta name="viewport" content="width=device-width, initial-scale=1.0">\n        <title>Bill '.concat(e.billNumber,"</title>\n        <style>\n          * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n          }\n          \n          body {\n            font-family: 'Courier New', monospace;\n            font-size: 9px;\n            line-height: 1.2;\n            background: white;\n            color: black;\n            padding: 2px;\n            max-width: 280px;\n            margin: 0 auto;\n            white-space: pre;\n          }\n          \n          .no-print {\n            margin-top: 20px;\n            text-align: center;\n            white-space: normal;\n          }\n          \n          .no-print button {\n            padding: 8px 16px;\n            margin: 5px;\n            cursor: pointer;\n            border: 1px solid #ccc;\n            background: #f5f5f5;\n            border-radius: 4px;\n            font-family: Arial, sans-serif;\n            font-size: 12px;\n          }\n          \n          @media print {\n            body {\n              margin: 0;\n              padding: 0;\n              font-size: 8px;\n            }\n            .no-print {\n              display: none;\n            }\n          }\n        </style>\n      </head>\n      <body>\n        ").concat(r,'\n        \n        <div class="no-print">\n          <button onclick="window.print()">Print Receipt</button>\n          <button onclick="window.close()">Close</button>\n        </div>\n      </body>\n      </html>\n    ')};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eD,{open:o,onOpenChange:m,children:(0,a.jsxs)(eI,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)(eT,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)(A,{variant:(e=>{switch(e){case"completed":return"default";case"cancelled":return"destructive";case"refunded":return"secondary";default:return"outline"}})(d.status),children:d.status.toUpperCase()})}),(0,a.jsxs)("div",{className:"flex items-center gap-2 pr-8",children:[(0,a.jsxs)(x,{variant:"outline",size:"sm",onClick:()=>{var e,t;let s=E(d),a=document.createElement("iframe");a.style.display="none",document.body.appendChild(a);let r=a.contentDocument||(null===(e=a.contentWindow)||void 0===e?void 0:e.document);r&&(r.open(),r.write(s),r.close(),null===(t=a.contentWindow)||void 0===t||t.print(),setTimeout(()=>{document.body.removeChild(a)},1e3))},children:[(0,a.jsx)(eH.Z,{className:"mr-2 h-4 w-4"}),"Print"]}),(0,a.jsxs)(x,{variant:"outline",size:"sm",onClick:P,children:[(0,a.jsx)(td.Z,{className:"mr-2 h-4 w-4"}),"PDF"]}),(0,a.jsxs)(x,{variant:"outline",size:"sm",onClick:()=>v(!0),children:[(0,a.jsx)(t8.Z,{className:"mr-2 h-4 w-4"}),"Email"]}),(0,a.jsx)(x,{variant:"outline",size:"sm",onClick:()=>{var e;if(!(null===(e=d.customer)||void 0===e?void 0:e.phone)||""===d.customer.phone.trim()){console.error("Customer phone number is required to send WhatsApp message");return}D(!0)},disabled:b||!(null===(n=d.customer)||void 0===n?void 0:n.phone)||""===d.customer.phone.trim(),className:"text-green-600 hover:text-green-700 hover:bg-green-50",children:b?(0,a.jsx)(S.Z,{className:"h-4 w-4 animate-spin"}):(0,a.jsx)(t9.Z,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(eF,{className:"text-2xl font-bold mb-2",children:"Supermarket"}),(0,a.jsxs)(ez,{className:"text-sm",children:["123 Main Street, City",(0,a.jsx)("br",{}),"State, Country - 123456",(0,a.jsx)("br",{}),"Phone: +1 234 567 8900"]}),(0,a.jsx)("div",{className:"border-b border-dashed border-gray-300 my-4"})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,a.jsx)("div",{className:"space-y-2",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold mb-2",children:"Bill Information"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Bill Number:"}),(0,a.jsx)("span",{className:"font-mono font-medium",children:d.billNumber})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Date & Time:"}),(0,a.jsx)("span",{className:"text-right",children:new Date(d.createdAt).toLocaleString()})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Cashier:"}),(0,a.jsx)("span",{className:"text-right",children:d.cashierName})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Payment Method:"}),(0,a.jsx)("span",{className:"capitalize text-right",children:d.paymentMethod})]})]})]})}),(0,a.jsx)("div",{className:"space-y-2",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold mb-2",children:"Customer Information"}),(0,a.jsx)("div",{className:"space-y-2 text-sm",children:(null===(l=d.customer)||void 0===l?void 0:l.name)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Name:"}),(0,a.jsx)("span",{className:"text-right",children:d.customer.name})]}),d.customer.phone&&(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Phone:"}),(0,a.jsx)("span",{className:"text-right",children:d.customer.phone})]}),d.customer.address&&(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsx)("span",{className:"text-muted-foreground mt-1",children:"Address:"}),(0,a.jsx)("span",{className:"text-right max-w-[60%]",children:d.customer.address})]}),d.customer.gstNumber&&(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"GST Number:"}),(0,a.jsx)("span",{className:"font-mono text-right break-all",children:d.customer.gstNumber})]})]}):(0,a.jsx)("div",{className:"text-muted-foreground italic",children:"Walk-in Customer"})})]})})]}),(0,a.jsx)(te,{}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"font-semibold mb-4",children:["Items (",d.items.length,")"]}),(0,a.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,a.jsxs)(e1,{className:"w-full table-fixed",children:[(0,a.jsx)(e2,{children:(0,a.jsxs)(e3,{children:[(0,a.jsx)(e5,{className:"text-right w-[8%]",children:"S.No"}),(0,a.jsx)(e5,{className:"w-[32%]",children:"Product"}),(0,a.jsx)(e5,{className:"text-center w-[8%] px-0",children:"Qty"}),(0,a.jsx)(e5,{className:"text-right w-[12%]",children:"Rate"}),(0,a.jsx)(e5,{className:"text-right w-[12%]",children:"Discount"}),(0,a.jsx)(e5,{className:"text-right w-[12%]",children:"Tax"}),(0,a.jsx)(e5,{className:"text-right w-[14%] font-semibold",children:"Amount"})]})}),(0,a.jsx)(e4,{children:d.items.map((e,t)=>(0,a.jsxs)(e3,{children:[(0,a.jsx)(e6,{className:"align-top py-2",children:t+1}),(0,a.jsx)(e6,{className:"align-top py-2",children:(0,a.jsxs)("div",{className:"font-medium break-words whitespace-normal",children:[e.productName,e.size&&(0,a.jsxs)("span",{className:"text-xs text-blue-600 ml-2",children:["(",e.size,")"]})]})}),(0,a.jsx)(e6,{className:"text-center align-middle py-2 px-0",children:e.quantity}),(0,a.jsx)(e6,{className:"text-right align-middle py-2",children:k(e.rate)}),(0,a.jsx)(e6,{className:"text-right align-middle py-2",children:e.discount&&e.discount.discountAmount>0?(0,a.jsxs)("span",{className:"text-green-600",children:["-",k(e.discount.discountAmount)]}):"-"}),(0,a.jsx)(e6,{className:"text-right align-middle py-2",children:e.taxAmount>0?k(e.taxAmount):"-"}),(0,a.jsx)(e6,{className:"text-right align-middle py-2 font-semibold",children:k(e.totalAmount)})]},t))})]})})]})]}),(0,a.jsx)(te,{}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h3",{className:"font-semibold",children:"Payment Details"}),(0,a.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Payment Method:"}),(0,a.jsx)(A,{variant:"outline",className:"capitalize",children:d.paymentMethod})]}),d.paymentBreakdown&&d.paymentBreakdown.length>0&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"font-medium text-muted-foreground",children:"Payment Breakdown:"}),(0,a.jsx)("div",{className:"space-y-1",children:d.paymentBreakdown.map((e,t)=>{var s,r;return(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"capitalize",children:"card"===e.method&&(null===(s=e.details)||void 0===s?void 0:s.cardLast4)?"Card (**** ".concat(e.details.cardLast4,")"):"upi"===e.method&&(null===(r=e.details)||void 0===r?void 0:r.upiId)?"UPI (".concat(e.details.upiId,")"):e.method}),(0,a.jsx)("span",{className:"font-medium",children:k(e.amount)})]},t)})})]}),d.paymentDetails&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"font-medium text-muted-foreground",children:"Payment Information:"}),(0,a.jsxs)("div",{className:"space-y-1",children:[d.paymentDetails.razorpayPaymentId&&(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Transaction ID:"}),(0,a.jsx)("span",{className:"font-mono text-xs break-all",children:d.paymentDetails.razorpayPaymentId})]}),d.paymentDetails.cardLast4&&(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Card Number:"}),(0,a.jsxs)("span",{children:["**** ",d.paymentDetails.cardLast4]})]}),d.paymentDetails.cardType&&(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Card Type:"}),(0,a.jsx)("span",{className:"capitalize",children:d.paymentDetails.cardType})]}),d.paymentDetails.upiId&&(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"UPI ID:"}),(0,a.jsx)("span",{children:d.paymentDetails.upiId})]}),d.paymentDetails.paymentStatus&&(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Payment Status:"}),(0,a.jsx)(A,{variant:"completed"===d.paymentDetails.paymentStatus?"default":"failed"===d.paymentDetails.paymentStatus?"destructive":"secondary",className:"capitalize",children:d.paymentDetails.paymentStatus})]})]})]}),"cash"===d.paymentMethod&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Cash Tendered:"}),(0,a.jsx)("span",{className:"font-medium",children:k(d.cashTendered)})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Change Due:"}),(0,a.jsx)("span",{className:"text-green-600 font-medium",children:k(d.changeDue)})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h3",{className:"font-semibold",children:"Bill Summary"}),(0,a.jsx)("div",{className:"space-y-2 text-sm",children:(()=>{var e,t;let s=d.items.reduce((e,t)=>{var s;let a=t.quantity*t.rate;return e.subtotal+=a,e.totalTax+=t.taxAmount,e.totalDiscount+=(null===(s=t.discount)||void 0===s?void 0:s.discountAmount)||0,e},{subtotal:0,totalTax:0,totalDiscount:0}),r=(null===(e=d.loyaltyDiscount)||void 0===e?void 0:e.discountAmount)||0,n=s.subtotal+s.totalTax-r,l=Math.round(n)-n,i=Math.round(n);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Subtotal:"}),(0,a.jsx)("span",{className:"font-medium text-right",children:k(s.subtotal)})]}),s.totalDiscount>0&&(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Total Discount:"}),(0,a.jsxs)("span",{className:"font-medium text-right text-green-600",children:["-",k(s.totalDiscount)]})]}),r>0&&(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,a.jsxs)("span",{className:"text-muted-foreground",children:["Loyalty Discount (",(null===(t=d.loyaltyDiscount)||void 0===t?void 0:t.discountValue)||2,"%):"]}),(0,a.jsxs)("span",{className:"font-medium text-right text-emerald-600",children:["-",k(r)]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Total Tax:"}),(0,a.jsx)("span",{className:"font-medium text-right",children:k(s.totalTax)})]}),Math.abs(l)>.01&&(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Round Off:"}),(0,a.jsxs)("span",{className:"font-medium text-right",children:[l>0?"+":"",k(l)]})]}),(0,a.jsx)(te,{}),(0,a.jsxs)("div",{className:"flex justify-between items-center text-lg font-bold",children:[(0,a.jsx)("span",{children:"Grand Total:"}),(0,a.jsx)("span",{className:"text-right",children:k(i)})]})]})})()})]})]})]})}),(0,a.jsx)(eD,{open:f,onOpenChange:v,children:(0,a.jsxs)(eI,{className:"max-w-md",children:[(0,a.jsxs)(eT,{children:[(0,a.jsx)(eF,{children:"Send Bill via Email"}),(0,a.jsx)(ez,{children:"Enter the email address to send the bill PDF to."})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"email",className:"text-sm font-medium",children:"Email Address"}),(0,a.jsx)("input",{id:"email",type:"email",value:g,onChange:e=>j(e.target.value),placeholder:"customer@example.com",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),y&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:y})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(x,{variant:"outline",onClick:()=>{v(!1),N("")},disabled:h,children:"Cancel"}),(0,a.jsx)(x,{onClick:I,disabled:h,children:h?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(S.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Sending..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t8.Z,{className:"mr-2 h-4 w-4"}),"Send Bill"]})})]})]})]})}),(0,a.jsx)(eD,{open:C,onOpenChange:D,children:(0,a.jsxs)(eI,{className:"max-w-md",children:[(0,a.jsxs)(eT,{children:[(0,a.jsx)(eF,{children:"Send Bill via WhatsApp"}),(0,a.jsxs)(ez,{children:["Are you sure you want to send this bill to ",(null==d?void 0:null===(i=d.customer)||void 0===i?void 0:i.name)||"the customer"," via WhatsApp?"]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"space-y-2",children:(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["The bill will be sent to: ",(null==d?void 0:null===(c=d.customer)||void 0===c?void 0:c.phone)||"No phone number available"]})}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(x,{variant:"outline",onClick:()=>D(!1),disabled:b,children:"Cancel"}),(0,a.jsx)(x,{onClick:T,disabled:b,className:"bg-green-600 hover:bg-green-700",children:b?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(S.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Sending..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t9.Z,{className:"mr-2 h-4 w-4"}),"Send via WhatsApp"]})})]})]})]})})]})}function se(){let[e,t]=(0,r.useState)([]),[s,n]=(0,r.useState)(!0),[l,i]=(0,r.useState)(""),[c,d]=(0,r.useState)(1),[o,m]=(0,r.useState)(1),[u,h]=(0,r.useState)(0),[p,g]=(0,r.useState)({}),[b,D]=(0,r.useState)(null),[k,P]=(0,r.useState)(!1),I=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p;try{n(!0),i("");let a={page:e,limit:20,...s},r=await eB.apiClient.getBills(a);t(r.bills),m(r.totalPages),d(r.currentPage),h(r.total)}catch(e){i(e instanceof Error?e.message:"Failed to load bills")}finally{n(!1)}};(0,r.useEffect)(()=>{I()},[]);let T=async e=>{try{let t=await eB.apiClient.getBill(e._id);D(t),P(!0)}catch(e){i(e instanceof Error?e.message:"Failed to load bill details")}},E=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e),F=e=>{switch(e){case"completed":return"default";case"cancelled":return"destructive";case"refunded":return"secondary";default:return"outline"}},z=e=>{switch(e){case"cash":return"\uD83D\uDCB5";case"card":return"\uD83D\uDCB3";case"upi":return"\uD83D\uDCF1";case"mixed":return"\uD83D\uDD04";default:return"\uD83D\uDCB0"}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(t6,{onSearch:e=>{g(e),d(1),I(1,e)},isLoading:s}),l&&(0,a.jsx)(w,{variant:"destructive",children:(0,a.jsx)(C,{children:l})}),(0,a.jsxs)(j,{children:[(0,a.jsx)(f,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(v,{className:"flex items-center gap-2",children:[(0,a.jsx)(W.Z,{className:"h-5 w-5"}),"Bill History"]}),(0,a.jsx)(y,{children:u>0?"Showing ".concat(e.length," of ").concat(u," bills"):"No bills found"})]}),(0,a.jsxs)(x,{variant:"outline",onClick:()=>I(c),disabled:s,children:[(0,a.jsx)(eK.Z,{className:"mr-2 h-4 w-4 ".concat(s?"animate-spin":"")}),"Refresh"]})]})}),(0,a.jsxs)(N,{children:[(0,a.jsx)("div",{className:"border rounded-lg",children:(0,a.jsxs)(e1,{children:[(0,a.jsx)(e2,{children:(0,a.jsxs)(e3,{children:[(0,a.jsx)(e5,{children:"Bill Number"}),(0,a.jsx)(e5,{children:"Date & Time"}),(0,a.jsx)(e5,{children:"Customer"}),(0,a.jsx)(e5,{children:"Items"}),(0,a.jsx)(e5,{children:"Amount"}),(0,a.jsx)(e5,{children:"Payment"}),(0,a.jsx)(e5,{children:"Cashier"}),(0,a.jsx)(e5,{children:"Status"}),(0,a.jsx)(e5,{children:"Actions"})]})}),(0,a.jsx)(e4,{children:s?(0,a.jsx)(e3,{children:(0,a.jsxs)(e6,{colSpan:9,className:"text-center py-8",children:[(0,a.jsx)(S.Z,{className:"h-6 w-6 animate-spin mx-auto mb-2"}),"Loading bills..."]})}):0===e.length?(0,a.jsx)(e3,{children:(0,a.jsx)(e6,{colSpan:9,className:"text-center py-8 text-muted-foreground",children:"No bills found matching your criteria"})}):e.map(e=>{var t;return(0,a.jsxs)(e3,{className:"hover:bg-muted/50",children:[(0,a.jsx)(e6,{children:(0,a.jsx)("div",{className:"font-mono font-medium",children:e.billNumber})}),(0,a.jsx)(e6,{children:(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("div",{children:new Date(e.createdAt).toLocaleDateString()}),(0,a.jsx)("div",{className:"text-muted-foreground",children:new Date(e.createdAt).toLocaleTimeString()})]})}),(0,a.jsx)(e6,{children:(0,a.jsx)("div",{className:"text-sm",children:(null===(t=e.customer)||void 0===t?void 0:t.name)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"font-medium",children:e.customer.name}),e.customer.phone&&(0,a.jsx)("div",{className:"text-muted-foreground",children:e.customer.phone})]}):(0,a.jsx)("span",{className:"text-muted-foreground",children:"Walk-in Customer"})})}),(0,a.jsx)(e6,{children:(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsxs)("div",{className:"font-medium",children:[e.items.length," items"]}),(0,a.jsxs)("div",{className:"text-muted-foreground",children:["Qty: ",e.items.reduce((e,t)=>e+t.quantity,0)]})]})}),(0,a.jsx)(e6,{children:(0,a.jsx)("div",{className:"text-sm",children:(0,a.jsx)("div",{className:"font-medium",children:E(e.grandTotal)})})}),(0,a.jsxs)(e6,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 text-sm",children:[(0,a.jsx)("span",{children:z(e.paymentMethod)}),(0,a.jsx)("span",{className:"capitalize",children:e.paymentMethod})]}),e.changeDue>0&&(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Change: ",E(e.changeDue)]})]}),(0,a.jsx)(e6,{children:(0,a.jsx)("div",{className:"text-sm",children:(0,a.jsx)("div",{className:"font-medium",children:e.cashierName})})}),(0,a.jsx)(e6,{children:(0,a.jsx)(A,{variant:F(e.status),children:e.status.toUpperCase()})}),(0,a.jsx)(e6,{children:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(x,{variant:"ghost",size:"sm",onClick:()=>T(e),children:(0,a.jsx)(t3.Z,{className:"h-4 w-4"})}),(0,a.jsx)(x,{variant:"ghost",size:"sm",disabled:!0,children:(0,a.jsx)(eH.Z,{className:"h-4 w-4"})})]})})]},e._id)})})]})}),o>1&&(0,a.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Page ",c," of ",o," • ",u," total bills"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(x,{variant:"outline",size:"sm",onClick:()=>I(c-1),disabled:c<=1||s,children:"Previous"}),(0,a.jsx)(x,{variant:"outline",size:"sm",onClick:()=>I(c+1),disabled:c>=o||s,children:"Next"})]})]})]})]}),(0,a.jsx)(t7,{bill:b,isOpen:k,onClose:()=>{P(!1),D(null)}})]})}var st=s(88501),ss=s(3085);function sa(e){let{startDate:t,endDate:s}=e,[n,l]=(0,r.useState)(null),[i,c]=(0,r.useState)(!0),[d,o]=(0,r.useState)(""),m=async()=>{try{c(!0),o("");let e=await eB.apiClient.getSalesSummary({startDate:t,endDate:s});l(e)}catch(e){o(e instanceof Error?e.message:"Failed to load sales data")}finally{c(!1)}};(0,r.useEffect)(()=>{m()},[t,s]);let u=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e);if(i)return(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[void 0,void 0,void 0,void 0].map((e,t)=>(0,a.jsx)(j,{children:(0,a.jsx)(N,{className:"p-6",children:(0,a.jsxs)("div",{className:"animate-pulse",children:[(0,a.jsx)("div",{className:"h-4 bg-muted rounded w-3/4 mb-2"}),(0,a.jsx)("div",{className:"h-8 bg-muted rounded w-1/2"})]})})},t))});if(d||!n)return(0,a.jsx)(j,{children:(0,a.jsx)(N,{className:"p-6 text-center text-muted-foreground",children:d||"No sales data available"})});let{totals:x}=n;return(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsx)(j,{children:(0,a.jsxs)(N,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Sales"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:u(x.totalSales)})]}),(0,a.jsx)("div",{className:"bg-green-100 p-3 rounded-full",children:(0,a.jsx)(tH.Z,{className:"h-6 w-6 text-green-600"})})]}),(0,a.jsxs)("div",{className:"mt-2 flex items-center",children:[(0,a.jsx)(t0.Z,{className:"h-4 w-4 text-green-600 mr-1"}),(0,a.jsx)("span",{className:"text-sm text-green-600",children:"Revenue"})]})]})}),(0,a.jsx)(j,{children:(0,a.jsxs)(N,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Bills"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:x.totalBills})]}),(0,a.jsx)("div",{className:"bg-blue-100 p-3 rounded-full",children:(0,a.jsx)(G.Z,{className:"h-6 w-6 text-blue-600"})})]}),(0,a.jsx)("div",{className:"mt-2 flex items-center",children:(0,a.jsxs)(A,{variant:"outline",className:"text-xs",children:["Avg: ",u(x.avgBillValue)]})})]})}),(0,a.jsx)(j,{children:(0,a.jsxs)(N,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Items Sold"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:x.totalItems})]}),(0,a.jsx)("div",{className:"bg-purple-100 p-3 rounded-full",children:(0,a.jsx)(H.Z,{className:"h-6 w-6 text-purple-600"})})]}),(0,a.jsx)("div",{className:"mt-2 flex items-center",children:(0,a.jsxs)("span",{className:"text-sm text-muted-foreground",children:[x.totalBills>0?(x.totalItems/x.totalBills).toFixed(1):0," per bill"]})})]})}),(0,a.jsx)(j,{children:(0,a.jsxs)(N,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Discount"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:u(x.totalDiscount)})]}),(0,a.jsx)("div",{className:"bg-orange-100 p-3 rounded-full",children:(0,a.jsx)(ss.Z,{className:"h-6 w-6 text-orange-600"})})]}),(0,a.jsx)("div",{className:"mt-2 flex items-center",children:(0,a.jsxs)("span",{className:"text-sm text-muted-foreground",children:[x.totalSales>0?(x.totalDiscount/x.totalSales*100).toFixed(1):0,"% of sales"]})})]})})]})}function sr(e){let{startDate:t,endDate:s,limit:n=10}=e,[l,i]=(0,r.useState)([]),[c,d]=(0,r.useState)(!0),[o,m]=(0,r.useState)(""),u=async()=>{try{d(!0),m("");let e=await eB.apiClient.getTopProducts({startDate:t,endDate:s,limit:n});i(e)}catch(e){m(e instanceof Error?e.message:"Failed to load top products")}finally{d(!1)}};(0,r.useEffect)(()=>{u()},[t,s,n]);let x=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e);return(0,a.jsxs)(j,{children:[(0,a.jsxs)(f,{children:[(0,a.jsxs)(v,{className:"flex items-center gap-2",children:[(0,a.jsx)(H.Z,{className:"h-5 w-5"}),"Top Selling Products"]}),(0,a.jsx)(y,{children:"Best performing products by revenue"})]}),(0,a.jsx)(N,{children:c?(0,a.jsx)("div",{className:"space-y-3",children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,a.jsx)("div",{className:"animate-pulse",children:(0,a.jsx)("div",{className:"h-4 bg-muted rounded w-full mb-2"})},t))}):o?(0,a.jsx)("div",{className:"text-center text-muted-foreground py-8",children:o}):0===l.length?(0,a.jsx)("div",{className:"text-center text-muted-foreground py-8",children:"No products data available"}):(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)(e1,{children:[(0,a.jsx)(e2,{children:(0,a.jsxs)(e3,{children:[(0,a.jsx)(e5,{children:"Rank"}),(0,a.jsx)(e5,{children:"Product"}),(0,a.jsx)(e5,{className:"text-right",children:"Quantity"}),(0,a.jsx)(e5,{className:"text-right",children:"Revenue"}),(0,a.jsx)(e5,{className:"text-right",children:"Orders"})]})}),(0,a.jsx)(e4,{children:l.map((e,t)=>(0,a.jsxs)(e3,{children:[(0,a.jsx)(e6,{children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(A,{variant:t<3?"default":"outline",className:"w-8 h-8 rounded-full p-0 flex items-center justify-center",children:t+1}),0===t&&(0,a.jsx)(t0.Z,{className:"h-4 w-4 text-green-600"})]})}),(0,a.jsx)(e6,{children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e._id.productName}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Code: ",e._id.productCode]})]})}),(0,a.jsx)(e6,{className:"text-right font-medium",children:e.totalQuantity}),(0,a.jsx)(e6,{className:"text-right font-medium text-green-600",children:x(e.totalRevenue)}),(0,a.jsx)(e6,{className:"text-right",children:e.totalOrders})]},e._id.productId))})]})})})]})}var sn=s(77031),sl=s(56940),si=s(97059),sc=s(62994),sd=s(8147),so=s(22190),sm=s(31699),su=s(5481),sx=s(23263),sh=s(21156),sp=s(54061),sg=s(47625),sj=s(75169),sf=s(3574),sv=s(20407),sy=s(42488),sN=s(40370);let sb=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8","#82CA9D"];function sw(e){let{startDate:t,endDate:s}=e,[n,l]=(0,r.useState)([]),[i,c]=(0,r.useState)([]),[d,o]=(0,r.useState)(!0),[m,u]=(0,r.useState)(""),[h,p]=(0,r.useState)("line"),[g,b]=(0,r.useState)("daily"),w=async()=>{try{o(!0),u("");let e=(await eB.apiClient.getSalesSummary({startDate:t,endDate:s,period:g})).salesData.map(e=>{let t="";return"daily"===g?t="".concat(e._id.day,"/").concat(e._id.month,"/").concat(e._id.year):"weekly"===g?t="Week ".concat(e._id.week,", ").concat(e._id.year):"monthly"===g&&(t="".concat(["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e._id.month-1]," ").concat(e._id.year)),{date:t,sales:e.totalSales,bills:e.totalBills,items:e.totalItems,discount:e.totalDiscount,tax:e.totalTax}});l(e);let a=await eB.apiClient.getPaymentMethodsReport({startDate:t,endDate:s}),r=a.reduce((e,t)=>e+t.totalAmount,0),n=a.map(e=>({method:e._id,count:e.totalTransactions,amount:e.totalAmount,percentage:r>0?e.totalAmount/r*100:0}));c(n)}catch(e){u(e instanceof Error?e.message:"Failed to load chart data")}finally{o(!1)}};(0,r.useEffect)(()=>{w()},[t,s,g]);let C=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),S=e=>{let{active:t,payload:s,label:r}=e;return t&&s&&s.length?(0,a.jsxs)("div",{className:"bg-white p-3 border rounded-lg shadow-lg",children:[(0,a.jsx)("p",{className:"font-semibold text-gray-800",children:r}),s.map((e,t)=>(0,a.jsxs)("p",{style:{color:e.color},children:["sales"===e.dataKey&&"Sales: ".concat(C(e.value)),"bills"===e.dataKey&&"Bills: ".concat(e.value),"items"===e.dataKey&&"Items: ".concat(e.value),"discount"===e.dataKey&&"Discount: ".concat(C(e.value)),"tax"===e.dataKey&&"Tax: ".concat(C(e.value))]},t))]}):null};return d?(0,a.jsxs)(j,{children:[(0,a.jsxs)(f,{children:[(0,a.jsxs)(v,{className:"flex items-center gap-2",children:[(0,a.jsx)(sy.Z,{className:"h-5 w-5"}),"Sales Trends"]}),(0,a.jsx)(y,{children:"Daily sales performance over time"})]}),(0,a.jsx)(N,{children:(0,a.jsxs)("div",{className:"animate-pulse",children:[(0,a.jsx)("div",{className:"h-64 bg-muted rounded mb-4"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("div",{className:"h-8 bg-muted rounded w-20"}),(0,a.jsx)("div",{className:"h-8 bg-muted rounded w-20"}),(0,a.jsx)("div",{className:"h-8 bg-muted rounded w-20"})]})]})})]}):m?(0,a.jsxs)(j,{children:[(0,a.jsxs)(f,{children:[(0,a.jsxs)(v,{className:"flex items-center gap-2",children:[(0,a.jsx)(sy.Z,{className:"h-5 w-5"}),"Sales Trends"]}),(0,a.jsx)(y,{children:"Daily sales performance over time"})]}),(0,a.jsx)(N,{children:(0,a.jsx)("div",{className:"text-center text-muted-foreground py-8",children:m})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(j,{children:[(0,a.jsx)(f,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(v,{className:"flex items-center gap-2",children:[(0,a.jsx)(sy.Z,{className:"h-5 w-5"}),"Sales Trends"]}),(0,a.jsx)(y,{children:"Daily sales performance over time"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(x,{variant:"line"===h?"default":"outline",size:"sm",onClick:()=>p("line"),children:"Line"}),(0,a.jsx)(x,{variant:"bar"===h?"default":"outline",size:"sm",onClick:()=>p("bar"),children:"Bar"}),(0,a.jsx)(x,{variant:"area"===h?"default":"outline",size:"sm",onClick:()=>p("area"),children:"Area"})]})]})}),(0,a.jsx)(N,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(x,{variant:"daily"===g?"default":"outline",size:"sm",onClick:()=>b("daily"),children:"Daily"}),(0,a.jsx)(x,{variant:"weekly"===g?"default":"outline",size:"sm",onClick:()=>b("weekly"),children:"Weekly"}),(0,a.jsx)(x,{variant:"monthly"===g?"default":"outline",size:"sm",onClick:()=>b("monthly"),children:"Monthly"})]}),(0,a.jsx)("div",{className:"h-64",children:(0,a.jsx)(sg.h,{width:"100%",height:"100%",children:(()=>{let e={data:n,margin:{top:5,right:30,left:20,bottom:5}};switch(h){case"bar":return(0,a.jsxs)(sn.v,{...e,children:[(0,a.jsx)(sl.q,{strokeDasharray:"3 3"}),(0,a.jsx)(si.K,{dataKey:"date"}),(0,a.jsx)(sc.B,{}),(0,a.jsx)(sd.u,{content:(0,a.jsx)(S,{})}),(0,a.jsx)(so.D,{}),(0,a.jsx)(sm.$,{dataKey:"sales",fill:"#8884d8",name:"Sales Amount"}),(0,a.jsx)(sm.$,{dataKey:"discount",fill:"#82ca9d",name:"Discount"})]});case"area":return(0,a.jsxs)(su.T,{...e,children:[(0,a.jsx)(sl.q,{strokeDasharray:"3 3"}),(0,a.jsx)(si.K,{dataKey:"date"}),(0,a.jsx)(sc.B,{}),(0,a.jsx)(sd.u,{content:(0,a.jsx)(S,{})}),(0,a.jsx)(so.D,{}),(0,a.jsx)(sx.u,{type:"monotone",dataKey:"sales",stackId:"1",stroke:"#8884d8",fill:"#8884d8",name:"Sales Amount"}),(0,a.jsx)(sx.u,{type:"monotone",dataKey:"discount",stackId:"2",stroke:"#82ca9d",fill:"#82ca9d",name:"Discount"})]});default:return(0,a.jsxs)(sh.w,{...e,children:[(0,a.jsx)(sl.q,{strokeDasharray:"3 3"}),(0,a.jsx)(si.K,{dataKey:"date"}),(0,a.jsx)(sc.B,{}),(0,a.jsx)(sd.u,{content:(0,a.jsx)(S,{})}),(0,a.jsx)(so.D,{}),(0,a.jsx)(sp.x,{type:"monotone",dataKey:"sales",stroke:"#8884d8",name:"Sales Amount",strokeWidth:2}),(0,a.jsx)(sp.x,{type:"monotone",dataKey:"bills",stroke:"#82ca9d",name:"Number of Bills",strokeWidth:2})]})}})()})})]})})]}),(0,a.jsxs)(j,{children:[(0,a.jsxs)(f,{children:[(0,a.jsxs)(v,{className:"flex items-center gap-2",children:[(0,a.jsx)(sN.Z,{className:"h-5 w-5"}),"Payment Methods Distribution"]}),(0,a.jsx)(y,{children:"Breakdown of payment methods used"})]}),(0,a.jsx)(N,{children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsx)("div",{className:"h-48",children:(0,a.jsx)(sg.h,{width:"100%",height:"100%",children:(0,a.jsxs)(sj.u,{children:[(0,a.jsx)(sf.b,{data:i,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{method:t,percentage:s}=e;return"".concat(t,": ").concat(s.toFixed(1),"%")},outerRadius:60,fill:"#8884d8",dataKey:"amount",children:i.map((e,t)=>(0,a.jsx)(sv.b,{fill:sb[t%sb.length]},"cell-".concat(t)))}),(0,a.jsx)(sd.u,{formatter:e=>C(e)})]})})}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h4",{className:"font-semibold",children:"Payment Method Details"}),i.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:sb[t%sb.length]}}),(0,a.jsx)("span",{className:"font-medium",children:e.method})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"font-semibold",children:C(e.amount)}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:[e.count," bills"]})]})]},e.method))]})]})})]})]})}var sC=s(962);function sS(e){let{...t}=e;return(0,a.jsx)(sC.fC,{"data-slot":"collapsible",...t})}function sD(e){let{...t}=e;return(0,a.jsx)(sC.Fw,{"data-slot":"collapsible-content",...t})}var sk=s(49474),sP=s(10407),sA=s(66142);let sI=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884d8","#82ca9d","#ffc658","#ff7300"];function sT(e){let{startDate:t,endDate:s}=e,[n,l]=(0,r.useState)([]),[i,c]=(0,r.useState)([]),[d,o]=(0,r.useState)([]),[u,h]=(0,r.useState)(!0),[p,g]=(0,r.useState)(null),[b,w]=(0,r.useState)("bar"),[C,S]=(0,r.useState)("bar"),[D,k]=(0,r.useState)(new Set);(0,r.useEffect)(()=>{Promise.all([P(),I(),T()])},[t,s]);let P=async()=>{try{h(!0),g(null);let e=await eB.apiClient.getCategoriesPerformance({startDate:t,endDate:s});l(e)}catch(e){console.error("Error fetching categories performance:",e),g("Failed to fetch categories performance data")}finally{h(!1)}},I=async()=>{try{let e=await eB.apiClient.get("/reports/top-products-by-category?startDate=".concat(t||"","&endDate=").concat(s||""));c(e)}catch(e){console.error("Error fetching top products by category:",e)}},T=async()=>{try{let e=await eB.apiClient.get("/reports/top-products?startDate=".concat(t||"","&endDate=").concat(s||"","&limit=10"));o(e)}catch(e){console.error("Error fetching top products:",e)}},E=e=>{let t=new Set(D);t.has(e)?t.delete(e):t.add(e),k(t)},F=e=>{let t=i.find(t=>t.category===e);return t?t.products:[]};return u?(0,a.jsxs)(j,{children:[(0,a.jsxs)(f,{children:[(0,a.jsxs)(v,{className:"flex items-center gap-2",children:[(0,a.jsx)(t0.Z,{className:"h-5 w-5"}),"Product Categories Performance"]}),(0,a.jsx)(y,{children:"Loading categories performance data..."})]}),(0,a.jsx)(N,{children:(0,a.jsx)("div",{className:"h-64 flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})})]}):p?(0,a.jsxs)(j,{children:[(0,a.jsxs)(f,{children:[(0,a.jsxs)(v,{className:"flex items-center gap-2",children:[(0,a.jsx)(t0.Z,{className:"h-5 w-5"}),"Product Categories Performance"]}),(0,a.jsx)(y,{children:"Error loading data"})]}),(0,a.jsx)(N,{children:(0,a.jsx)("div",{className:"h-64 flex items-center justify-center text-red-500",children:p})})]}):(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)(j,{children:[(0,a.jsx)(f,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(v,{className:"flex items-center gap-2",children:[(0,a.jsx)(t0.Z,{className:"h-5 w-5"}),"Product Categories Performance"]}),(0,a.jsx)(y,{children:"Revenue and quantity by product category"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(x,{variant:"bar"===b?"default":"outline",size:"sm",onClick:()=>w("bar"),children:"Bar"}),(0,a.jsx)(x,{variant:"pie"===b?"default":"outline",size:"sm",onClick:()=>w("pie"),children:"Pie"})]})]})}),(0,a.jsx)(N,{children:(0,a.jsx)("div",{className:"h-64",children:(0,a.jsx)(sg.h,{width:"100%",height:"100%",children:"bar"===b?(0,a.jsxs)(sn.v,{data:n,children:[(0,a.jsx)(sl.q,{strokeDasharray:"3 3"}),(0,a.jsx)(si.K,{dataKey:"category",angle:-45,textAnchor:"end",height:80,fontSize:12}),(0,a.jsx)(sc.B,{tick:{fontSize:12},width:60}),(0,a.jsx)(sd.u,{formatter:(e,t)=>"totalRevenue"===t?m(e):e.toLocaleString()}),(0,a.jsx)(so.D,{}),(0,a.jsx)(sm.$,{dataKey:"totalRevenue",fill:"#8884d8",name:"Total Revenue"}),(0,a.jsx)(sm.$,{dataKey:"totalQuantity",fill:"#82ca9d",name:"Total Quantity"})]}):(0,a.jsxs)(sj.u,{children:[(0,a.jsx)(sf.b,{data:n,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{category:t,totalRevenue:s}=e;return"".concat(t,": ").concat(m(s))},outerRadius:80,fill:"#8884d8",dataKey:"totalRevenue",children:n.map((e,t)=>(0,a.jsx)(sv.b,{fill:sI[t%sI.length]},"cell-".concat(t)))}),(0,a.jsx)(sd.u,{formatter:e=>m(e)})]})})})})]}),(0,a.jsxs)(j,{children:[(0,a.jsxs)(f,{children:[(0,a.jsxs)(v,{className:"flex items-center gap-2",children:[(0,a.jsx)(sN.Z,{className:"h-5 w-5"}),"Category Details"]}),(0,a.jsx)(y,{children:"Detailed breakdown of each category's performance"})]}),(0,a.jsx)(N,{children:(0,a.jsx)("div",{className:"space-y-3",children:n.map((e,t)=>{let s=0===t,r=1===t,l=n.length>0?e.totalRevenue/n[0].totalRevenue*100:0,i=F(e.category),c=D.has(e.category);return(0,a.jsxs)(sS,{open:c,onOpenChange:()=>E(e.category),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg transition-all hover:shadow-md cursor-pointer ".concat(s?"bg-gradient-to-r from-yellow-50 to-amber-50 dark:from-yellow-950/20 dark:to-amber-950/10 border-yellow-200 dark:border-yellow-800":r?"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-950/20 dark:to-indigo-950/10 border-blue-200 dark:border-blue-800":"bg-background"),onClick:()=>E(e.category),children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[s?(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-yellow-400 to-amber-500 flex items-center justify-center text-white font-bold text-sm shadow-sm",children:(0,a.jsx)(sk.Z,{className:"w-4 h-4"})}):r?(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-blue-400 to-indigo-500 flex items-center justify-center text-white font-bold text-sm shadow-sm",children:(0,a.jsx)(eQ.Z,{className:"w-4 h-4"})}):(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-muted flex items-center justify-center text-muted-foreground font-bold text-sm",children:t+1}),(0,a.jsx)("div",{className:"w-4 h-4 rounded-full mt-1",style:{backgroundColor:sI[t%sI.length]}})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"font-semibold text-base text-foreground",children:e.category}),s&&(0,a.jsx)(A,{className:"bg-gradient-to-r from-yellow-400 to-amber-500 text-white border-none text-xs",children:"Best Seller"}),r&&(0,a.jsx)(A,{variant:"secondary",className:"bg-gradient-to-r from-blue-400 to-indigo-500 text-white text-xs",children:"Top Performer"}),i.length>0&&(0,a.jsxs)(A,{variant:"outline",className:"text-xs",children:[i.length," top products"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm text-muted-foreground mt-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(H.Z,{className:"w-3 h-3"}),(0,a.jsxs)("span",{children:[e.totalQuantity.toLocaleString()," items"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(G.Z,{className:"w-3 h-3"}),(0,a.jsxs)("span",{children:[e.totalOrders," orders"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(eQ.Z,{className:"w-3 h-3"}),(0,a.jsxs)("span",{children:[e.uniqueProductsCount," products"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(t0.Z,{className:"w-3 h-3"}),(0,a.jsxs)("span",{children:[m(e.totalRevenue/e.totalQuantity),"/item"]})]})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(tH.Z,{className:"w-4 h-4 text-green-600 dark:text-green-400"}),(0,a.jsx)("span",{className:"font-bold text-lg text-green-700 dark:text-green-400",children:m(e.totalRevenue)})]}),(0,a.jsxs)("div",{className:"space-y-1 mt-2",children:[(0,a.jsx)("div",{className:"flex items-center justify-end gap-1 text-sm text-muted-foreground",children:(0,a.jsxs)("span",{children:["Avg: ",m(e.avgOrderValue),"/order"]})}),(0,a.jsx)("div",{className:"flex items-center justify-end gap-1 text-xs text-muted-foreground",children:(0,a.jsxs)("span",{children:[(e.totalRevenue/n.reduce((e,t)=>e+t.totalRevenue,0)*100).toFixed(1),"% of total"]})}),l<100&&(0,a.jsx)("div",{className:"flex items-center justify-end gap-1 text-xs text-muted-foreground",children:(0,a.jsxs)("span",{children:[l.toFixed(1),"% of top"]})})]}),(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsxs)(A,{variant:"outline",className:"text-xs ".concat(s?"border-green-200 text-green-700 dark:border-green-800 dark:text-green-400":r?"border-blue-200 text-blue-700 dark:border-blue-800 dark:text-blue-400":"border-gray-200 text-gray-600 dark:border-gray-700 dark:text-gray-400"),children:["#",t+1," Rank"]})})]}),(0,a.jsx)("div",{className:"flex flex-col items-center",children:c?(0,a.jsx)(er.Z,{className:"w-5 h-5 text-muted-foreground"}):(0,a.jsx)(sP.Z,{className:"w-5 h-5 text-muted-foreground"})})]})]}),(0,a.jsx)(sD,{className:"mt-2",children:(0,a.jsxs)("div",{className:"ml-16 p-4 bg-muted/50 rounded-lg border border-border",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(sA.Z,{className:"w-4 h-4 text-amber-600"}),(0,a.jsxs)("span",{className:"font-medium text-sm text-foreground",children:["Top Products in ",e.category]})]}),(0,a.jsxs)(A,{variant:"outline",className:"text-xs",children:[i.length," products"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2 mb-3 text-xs text-muted-foreground bg-background/50 p-2 rounded",children:[(0,a.jsx)("div",{className:"text-center",children:"Product"}),(0,a.jsx)("div",{className:"text-center",children:"Revenue"}),(0,a.jsx)("div",{className:"text-center",children:"Avg Price"})]}),i.length>0?(0,a.jsx)("div",{className:"space-y-2",children:i.map((t,s)=>(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2 p-3 bg-background rounded-lg border border-border items-center",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-6 h-6 rounded-full bg-gradient-to-r from-amber-100 to-yellow-100 dark:from-amber-900/30 dark:to-yellow-900/30 flex items-center justify-center text-amber-700 dark:text-amber-300 font-bold text-xs",children:s+1}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-sm text-foreground truncate",title:t.productName,children:t.productName}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:[t.totalQuantity.toLocaleString()," • ",t.totalOrders," orders"]})]})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"font-semibold text-green-700 dark:text-green-400",children:m(t.totalRevenue)}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:[(t.totalRevenue/e.totalRevenue*100).toFixed(1),"% of category"]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"font-semibold text-blue-700 dark:text-blue-400",children:m(t.avgPrice)}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"avg price"})]})]},t.productId))}):(0,a.jsx)("div",{className:"text-center py-4 text-muted-foreground text-sm",children:"No product data available for this category"})]})})]},e.category)})})})]}),(0,a.jsxs)(j,{className:"lg:col-span-2",children:[(0,a.jsx)(f,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(v,{className:"flex items-center gap-2",children:[(0,a.jsx)(sk.Z,{className:"h-5 w-5"}),"Best Selling Products Performance"]}),(0,a.jsx)(y,{children:"Revenue and quantity analysis of top-performing products"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(x,{variant:"bar"===C?"default":"outline",size:"sm",onClick:()=>S("bar"),children:"Bar"}),(0,a.jsx)(x,{variant:"pie"===C?"default":"outline",size:"sm",onClick:()=>S("pie"),children:"Pie"})]})]})}),(0,a.jsxs)(N,{children:[(0,a.jsx)("div",{className:"h-80",children:(0,a.jsx)(sg.h,{width:"100%",height:"100%",children:(()=>{let e=d.map(e=>({...e,productId:e._id.productId,productName:e._id.productName,productCode:e._id.productCode}));return"bar"===C?(0,a.jsxs)(sn.v,{data:e,children:[(0,a.jsx)(sl.q,{strokeDasharray:"3 3"}),(0,a.jsx)(si.K,{dataKey:"productName",angle:-45,textAnchor:"end",height:100,fontSize:10,interval:0}),(0,a.jsx)(sc.B,{tick:{fontSize:12},width:80}),(0,a.jsx)(sd.u,{formatter:(e,t)=>"totalRevenue"===t||"avgPrice"===t?m(e):e.toLocaleString(),labelFormatter:e=>"Product: ".concat(e)}),(0,a.jsx)(so.D,{}),(0,a.jsx)(sm.$,{dataKey:"totalRevenue",fill:"#10B981",name:"Total Revenue"}),(0,a.jsx)(sm.$,{dataKey:"totalQuantity",fill:"#3B82F6",name:"Quantity Sold"})]}):(0,a.jsxs)(sj.u,{children:[(0,a.jsx)(sf.b,{data:e,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{productName:t,totalRevenue:s}=e;return"".concat(t.substring(0,15),"...: ").concat(m(s))},outerRadius:80,fill:"#8884d8",dataKey:"totalRevenue",nameKey:"productName",children:e.map((e,t)=>(0,a.jsx)(sv.b,{fill:sI[t%sI.length]},"cell-".concat(t)))}),(0,a.jsx)(sd.u,{formatter:e=>m(e),labelFormatter:e=>"Product: ".concat(e)}),(0,a.jsx)(so.D,{})]})})()})}),(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,a.jsx)(sA.Z,{className:"w-4 h-4 text-amber-600"}),(0,a.jsx)("h3",{className:"font-semibold text-sm",children:"Top 10 Best Selling Products"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-5 gap-2 mb-3 text-xs text-muted-foreground bg-muted/50 p-2 rounded font-medium",children:[(0,a.jsx)("div",{children:"Rank"}),(0,a.jsx)("div",{children:"Product Name"}),(0,a.jsx)("div",{className:"text-center",children:"Revenue"}),(0,a.jsx)("div",{className:"text-center",children:"Quantity"}),(0,a.jsx)("div",{className:"text-center",children:"Avg Price"})]}),(0,a.jsx)("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:d.map((e,t)=>{let s=e._id.productId,r=e._id.productName;return e._id.productCode,(0,a.jsxs)("div",{className:"grid grid-cols-5 gap-2 p-2 bg-background rounded border border-border text-sm",children:[(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold text-white ".concat(0===t?"bg-gradient-to-r from-yellow-400 to-amber-500":1===t?"bg-gradient-to-r from-gray-300 to-gray-400":2===t?"bg-gradient-to-r from-amber-600 to-amber-700":"bg-gradient-to-r from-blue-500 to-blue-600"),children:t+1})}),(0,a.jsx)("div",{className:"font-medium truncate",title:r,children:r}),(0,a.jsx)("div",{className:"text-center font-semibold text-green-700 dark:text-green-400",children:m(e.totalRevenue)}),(0,a.jsx)("div",{className:"text-center text-blue-700 dark:text-blue-400",children:e.totalQuantity.toLocaleString()}),(0,a.jsx)("div",{className:"text-center text-muted-foreground",children:m(e.avgPrice)})]},s)})})]})]})]})]})}function sE(){let[e,t]=(0,r.useState)(""),[s,n]=(0,r.useState)(""),l=e=>{let s=new Date,a=new Date;a.setDate(a.getDate()-e),t(a.toISOString().split("T")[0]),n(s.toISOString().split("T")[0])};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(j,{children:[(0,a.jsxs)(f,{children:[(0,a.jsxs)(v,{className:"flex items-center gap-2",children:[(0,a.jsx)(st.Z,{className:"h-5 w-5"}),"Reports & Analytics"]}),(0,a.jsx)(y,{children:"Comprehensive business insights and performance metrics"})]}),(0,a.jsx)(N,{children:(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4 items-end",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 flex-1",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"startDate",children:"Start Date"}),(0,a.jsx)(h,{id:"startDate",type:"date",value:e,onChange:e=>t(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"endDate",children:"End Date"}),(0,a.jsx)(h,{id:"endDate",type:"date",value:s,onChange:e=>n(e.target.value)})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,a.jsx)(x,{variant:"outline",size:"sm",onClick:()=>l(7),children:"Last 7 Days"}),(0,a.jsx)(x,{variant:"outline",size:"sm",onClick:()=>l(30),children:"Last 30 Days"}),(0,a.jsx)(x,{variant:"outline",size:"sm",onClick:()=>l(90),children:"Last 90 Days"}),(0,a.jsx)(x,{variant:"outline",size:"sm",onClick:()=>{t(""),n("")},children:"Clear"})]})]})})]}),(0,a.jsxs)(tq,{defaultValue:"sales",className:"w-full",children:[(0,a.jsxs)(tV,{className:"grid w-full grid-cols-2",children:[(0,a.jsx)(tJ,{value:"sales",children:"Sales Analytics"}),(0,a.jsx)(tJ,{value:"products",children:"Product Performance"})]}),(0,a.jsxs)(tG,{value:"sales",className:"space-y-6",children:[(0,a.jsx)(sa,{startDate:e,endDate:s}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsx)(sw,{startDate:e,endDate:s})}),(0,a.jsx)(sr,{startDate:e,endDate:s,limit:10})]})]}),(0,a.jsxs)(tG,{value:"products",className:"space-y-6",children:[(0,a.jsx)(sr,{startDate:e,endDate:s,limit:20}),(0,a.jsx)(sT,{startDate:e,endDate:s})]})]})]})}var sF=s(98420);function sz(){let[e,t]=(0,r.useState)(null),[s,n]=(0,r.useState)(!0),[l,i]=(0,r.useState)(""),[c,d]=(0,r.useState)(!1),[o,m]=(0,r.useState)(!1),[u,h]=(0,r.useState)(""),p=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{n(!0),i("");let s=await eB.apiClient.getInventoryReport({lowStock:e});t(s)}catch(e){i(e instanceof Error?e.message:"Failed to load inventory data")}finally{n(!1)}},g=async()=>{try{m(!0),h(""),await eB.apiClient.sendLowStockEmail(),h("✅ Low stock email sent successfully!")}catch(e){h("❌ Error sending email: ".concat(e instanceof Error?e.message:"Unknown error"))}finally{m(!1)}};(0,r.useEffect)(()=>{p(c)},[c]);let b=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e),w=e=>e<5?{label:"Out of Stock",variant:"destructive",icon:tY.Z}:e<20?{label:"Low Stock",variant:"secondary",icon:ss.Z}:{label:"In Stock",variant:"default",icon:H.Z};return(0,a.jsxs)("div",{className:"space-y-6",children:[e&&(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsx)(j,{children:(0,a.jsx)(N,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Products"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:e.summary.totalProducts})]}),(0,a.jsx)("div",{className:"bg-blue-100 p-3 rounded-full",children:(0,a.jsx)(H.Z,{className:"h-6 w-6 text-blue-600"})})]})})}),(0,a.jsx)(j,{children:(0,a.jsx)(N,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Inventory Value"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:b(e.summary.inventoryValue)})]}),(0,a.jsx)("div",{className:"bg-green-100 p-3 rounded-full",children:(0,a.jsx)(sF.Z,{className:"h-6 w-6 text-green-600"})})]})})}),(0,a.jsx)(j,{children:(0,a.jsx)(N,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Low Stock"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:e.summary.lowStockCount})]}),(0,a.jsx)("div",{className:"bg-orange-100 p-3 rounded-full",children:(0,a.jsx)(ss.Z,{className:"h-6 w-6 text-orange-600"})})]})})}),(0,a.jsx)(j,{children:(0,a.jsx)(N,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Out of Stock"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-red-600",children:e.summary.outOfStockCount})]}),(0,a.jsx)("div",{className:"bg-red-100 p-3 rounded-full",children:(0,a.jsx)(tY.Z,{className:"h-6 w-6 text-red-600"})})]})})})]}),(0,a.jsxs)(j,{children:[(0,a.jsxs)(f,{children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(v,{className:"flex items-center gap-2",children:[(0,a.jsx)(H.Z,{className:"h-5 w-5"}),"Inventory Status"]}),(0,a.jsx)(y,{children:c?"Products with low stock levels":"All active products"})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,a.jsxs)(x,{variant:"outline",onClick:g,disabled:o||!e||0===e.summary.lowStockCount,className:"flex items-center gap-2",children:[(0,a.jsx)(t8.Z,{className:"h-4 w-4"}),o?"Sending...":"Send Low Stock Email"]}),(0,a.jsx)(x,{variant:c?"default":"outline",onClick:()=>d(!c),children:c?"Show All":"Show Low Stock"})]})]}),u&&(0,a.jsx)("div",{className:"space-y-1",children:(0,a.jsx)("div",{className:"text-sm p-2 rounded bg-muted",children:u})})]}),(0,a.jsx)(N,{children:s?(0,a.jsx)("div",{className:"space-y-3",children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,a.jsx)("div",{className:"animate-pulse",children:(0,a.jsx)("div",{className:"h-4 bg-muted rounded w-full mb-2"})},t))}):l?(0,a.jsx)("div",{className:"text-center text-muted-foreground py-8",children:l}):e&&0!==e.products.length?(0,a.jsxs)(e1,{children:[(0,a.jsx)(e2,{children:(0,a.jsxs)(e3,{children:[(0,a.jsx)(e5,{children:"Product"}),(0,a.jsx)(e5,{children:"Category"}),(0,a.jsx)(e5,{className:"text-right",children:"Stock"}),(0,a.jsx)(e5,{className:"text-right",children:"Cost Value"}),(0,a.jsx)(e5,{children:"Status"})]})}),(0,a.jsx)(e4,{children:e.products.slice(0,20).map(e=>{let t=w(e.stock),s=t.icon;return(0,a.jsxs)(e3,{children:[(0,a.jsx)(e6,{children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e.name}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Code: ",e.code]})]})}),(0,a.jsx)(e6,{children:e.category}),(0,a.jsx)(e6,{className:"text-right",children:(0,a.jsxs)("div",{className:"font-medium",children:[e.stock," ",e.unit]})}),(0,a.jsx)(e6,{className:"text-right",children:b(e.stock*e.cost)}),(0,a.jsx)(e6,{children:(0,a.jsxs)(A,{variant:t.variant,className:"flex items-center gap-1 w-fit",children:[(0,a.jsx)(s,{className:"h-3 w-3"}),t.label]})})]},e._id)})})]}):(0,a.jsx)("div",{className:"text-center text-muted-foreground py-8",children:"No products found"})})]})]})}var sO=s(16023);function sZ(e){let{employee:t,onSuccess:s,onCancel:n}=e,[l,i]=(0,r.useState)({email:(null==t?void 0:t.user.email)||"",password:"",role:"cashier",employeeId:(null==t?void 0:t.user.employeeId)||"",firstName:(null==t?void 0:t.personalDetails.firstName)||"",lastName:(null==t?void 0:t.personalDetails.lastName)||"",dateOfBirth:(null==t?void 0:t.personalDetails.dateOfBirth)?new Date(t.personalDetails.dateOfBirth).toISOString().split("T")[0]:"",gender:(null==t?void 0:t.personalDetails.gender)||"",bloodGroup:(null==t?void 0:t.personalDetails.bloodGroup)||"",phone:(null==t?void 0:t.contactDetails.phone)||"",emergencyPhone:(null==t?void 0:t.contactDetails.emergencyPhone)||"",street:(null==t?void 0:t.contactDetails.address.street)||"",city:(null==t?void 0:t.contactDetails.address.city)||"",state:(null==t?void 0:t.contactDetails.address.state)||"",postalCode:(null==t?void 0:t.contactDetails.address.postalCode)||"",country:(null==t?void 0:t.contactDetails.address.country)||"India",aadhaarNumber:(null==t?void 0:t.identification.aadhaarNumber)||"",panNumber:(null==t?void 0:t.identification.panNumber)||"",department:"cashier",position:(null==t?void 0:t.employmentDetails.position)||"Cashier",dateOfJoining:(null==t?void 0:t.employmentDetails.dateOfJoining)?new Date(t.employmentDetails.dateOfJoining).toISOString().split("T")[0]:"",salary:(null==t?void 0:t.employmentDetails.salary)||0,status:(null==t?void 0:t.status)||"active"}),[c,d]=(0,r.useState)({aadhaarCard:null,panCard:null,photo:null}),[o,m]=(0,r.useState)(!1),{toast:u}=tZ(),p=(e,t)=>{i(s=>({...s,[e]:t}))},y=(e,t)=>{d(s=>({...s,[e]:t}))},b=async e=>{e.preventDefault(),m(!0);try{let e=new FormData;e.append("email",l.email),e.append("password",l.password),e.append("role",l.role),e.append("employeeId",l.employeeId),e.append("personalDetails",JSON.stringify({firstName:l.firstName,lastName:l.lastName,dateOfBirth:l.dateOfBirth,gender:l.gender,bloodGroup:l.bloodGroup})),e.append("contactDetails",JSON.stringify({phone:l.phone,emergencyPhone:l.emergencyPhone,address:{street:l.street,city:l.city,state:l.state,postalCode:l.postalCode,country:l.country}})),e.append("identification",JSON.stringify({aadhaarNumber:l.aadhaarNumber,panNumber:l.panNumber})),e.append("employmentDetails",JSON.stringify({department:l.department,position:l.position,dateOfJoining:l.dateOfJoining,salary:l.salary||0})),c.aadhaarCard&&e.append("aadhaarCard",c.aadhaarCard),c.panCard&&e.append("panCard",c.panCard),c.photo&&e.append("photo",c.photo);let a=t?"http://localhost:5001/api/employees/".concat(t._id):"http://localhost:5001/api/employees",r=sO.O.getToken(),n=await fetch(a,{method:t?"PUT":"POST",body:e,headers:{Authorization:"Bearer ".concat(r)}});if(!n.ok){let e=await n.json();throw console.error("Server error response:",e),Error(e.message||e.error||"Failed to save employee (Status: ".concat(n.status,")"))}await n.json(),u({title:"Success",description:t?"Employee updated successfully":"Employee created successfully"}),s()}catch(e){console.error("Form submission error:",e),u({title:"Error",description:e instanceof Error?e.message:"Failed to save employee",variant:"destructive"})}finally{m(!1)}};return(0,a.jsxs)("form",{onSubmit:b,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)(j,{children:[(0,a.jsx)(f,{children:(0,a.jsx)(v,{children:"User Account Details"})}),(0,a.jsxs)(N,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{htmlFor:"email",children:"Email"}),(0,a.jsx)(h,{id:"email",type:"email",value:l.email,onChange:e=>p("email",e.target.value),required:!0})]}),!t&&(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{htmlFor:"password",children:"Password"}),(0,a.jsx)(h,{id:"password",type:"password",value:l.password,onChange:e=>p("password",e.target.value),required:!t})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{htmlFor:"employeeId",children:"Employee ID"}),(0,a.jsx)(h,{id:"employeeId",value:l.employeeId,onChange:e=>p("employeeId",e.target.value),required:!0})]})]})]}),(0,a.jsxs)(j,{children:[(0,a.jsx)(f,{children:(0,a.jsx)(v,{children:"Personal Details"})}),(0,a.jsxs)(N,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{htmlFor:"firstName",children:"First Name"}),(0,a.jsx)(h,{id:"firstName",value:l.firstName,onChange:e=>p("firstName",e.target.value),required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{htmlFor:"lastName",children:"Last Name"}),(0,a.jsx)(h,{id:"lastName",value:l.lastName,onChange:e=>p("lastName",e.target.value),required:!0})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{htmlFor:"dateOfBirth",children:"Date of Birth"}),(0,a.jsx)(h,{id:"dateOfBirth",type:"date",value:l.dateOfBirth,onChange:e=>p("dateOfBirth",e.target.value),required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{htmlFor:"gender",children:"Gender"}),(0,a.jsxs)(ei,{value:l.gender,onValueChange:e=>p("gender",e),children:[(0,a.jsx)(ed,{children:(0,a.jsx)(ec,{})}),(0,a.jsxs)(eo,{children:[(0,a.jsx)(em,{value:"male",children:"Male"}),(0,a.jsx)(em,{value:"female",children:"Female"}),(0,a.jsx)(em,{value:"other",children:"Other"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{htmlFor:"bloodGroup",children:"Blood Group"}),(0,a.jsxs)(ei,{value:l.bloodGroup,onValueChange:e=>p("bloodGroup",e),children:[(0,a.jsx)(ed,{children:(0,a.jsx)(ec,{placeholder:"Select blood group"})}),(0,a.jsxs)(eo,{children:[(0,a.jsx)(em,{value:"A+",children:"A+"}),(0,a.jsx)(em,{value:"A-",children:"A-"}),(0,a.jsx)(em,{value:"B+",children:"B+"}),(0,a.jsx)(em,{value:"B-",children:"B-"}),(0,a.jsx)(em,{value:"AB+",children:"AB+"}),(0,a.jsx)(em,{value:"AB-",children:"AB-"}),(0,a.jsx)(em,{value:"O+",children:"O+"}),(0,a.jsx)(em,{value:"O-",children:"O-"})]})]})]})]})]}),(0,a.jsxs)(j,{children:[(0,a.jsx)(f,{children:(0,a.jsx)(v,{children:"Contact Details"})}),(0,a.jsxs)(N,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{htmlFor:"phone",children:"Phone Number"}),(0,a.jsx)(h,{id:"phone",value:l.phone,onChange:e=>p("phone",e.target.value),required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{htmlFor:"emergencyPhone",children:"Emergency Phone"}),(0,a.jsx)(h,{id:"emergencyPhone",value:l.emergencyPhone,onChange:e=>p("emergencyPhone",e.target.value)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{htmlFor:"street",children:"Street Address"}),(0,a.jsx)(h,{id:"street",value:l.street,onChange:e=>p("street",e.target.value),required:!0})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{htmlFor:"city",children:"City"}),(0,a.jsx)(h,{id:"city",value:l.city,onChange:e=>p("city",e.target.value),required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{htmlFor:"state",children:"State"}),(0,a.jsx)(h,{id:"state",value:l.state,onChange:e=>p("state",e.target.value),required:!0})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{htmlFor:"postalCode",children:"Postal Code"}),(0,a.jsx)(h,{id:"postalCode",value:l.postalCode,onChange:e=>p("postalCode",e.target.value),required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{htmlFor:"country",children:"Country"}),(0,a.jsx)(h,{id:"country",value:l.country,onChange:e=>p("country",e.target.value),required:!0})]})]})]})]}),(0,a.jsxs)(j,{children:[(0,a.jsx)(f,{children:(0,a.jsx)(v,{children:"Identification"})}),(0,a.jsxs)(N,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{htmlFor:"aadhaarNumber",children:"Aadhaar Number"}),(0,a.jsx)(h,{id:"aadhaarNumber",value:l.aadhaarNumber,onChange:e=>p("aadhaarNumber",e.target.value),required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{htmlFor:"panNumber",children:"PAN Number"}),(0,a.jsx)(h,{id:"panNumber",value:l.panNumber,onChange:e=>p("panNumber",e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{children:"Aadhaar Card"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(h,{type:"file",accept:".pdf,.jpg,.jpeg,.png",onChange:e=>{var t;return y("aadhaarCard",(null===(t=e.target.files)||void 0===t?void 0:t[0])||null)}}),c.aadhaarCard&&(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:c.aadhaarCard.name})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{children:"PAN Card"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(h,{type:"file",accept:".pdf,.jpg,.jpeg,.png",onChange:e=>{var t;return y("panCard",(null===(t=e.target.files)||void 0===t?void 0:t[0])||null)}}),c.panCard&&(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:c.panCard.name})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{children:"Photo"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(h,{type:"file",accept:".jpg,.jpeg,.png",onChange:e=>{var t;return y("photo",(null===(t=e.target.files)||void 0===t?void 0:t[0])||null)}}),c.photo&&(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:c.photo.name})]})]})]})]})]}),(0,a.jsxs)(j,{children:[(0,a.jsx)(f,{children:(0,a.jsx)(v,{children:"Employment Details"})}),(0,a.jsxs)(N,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{htmlFor:"position",children:"Position"}),(0,a.jsx)(h,{id:"position",value:l.position,onChange:e=>p("position",e.target.value),placeholder:"e.g., Senior Cashier, Junior Cashier",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{htmlFor:"dateOfJoining",children:"Date of Joining"}),(0,a.jsx)(h,{id:"dateOfJoining",type:"date",value:l.dateOfJoining,onChange:e=>p("dateOfJoining",e.target.value),required:!0})]})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,a.jsx)(x,{type:"button",variant:"outline",onClick:n,children:"Cancel"}),(0,a.jsx)(x,{type:"submit",disabled:o,children:o?"Saving...":t?"Update Cashier":"Create Cashier"})]})]})}var s_=s(13041),sL=s(83774),sR=s(5005),sB=s(31047);function sU(e){var t,s,n;let{employee:l,onClose:i}=e,[c,d]=(0,r.useState)([]),[o,m]=(0,r.useState)(!0);(0,r.useEffect)(()=>{u()},[l._id]);let u=async()=>{try{let e=sO.O.getToken(),t=await fetch("http://localhost:5001/api/employees/".concat(l._id,"/leaves"),{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();d(e)}}catch(e){console.error("Failed to fetch employee leaves:",e)}finally{m(!1)}},h=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),p=(e,t)=>{if(e&&e.path){let s=document.createElement("a");s.href="http://localhost:5001/api/files/download?path=".concat(encodeURIComponent(e.path),"&filename=").concat(encodeURIComponent(t)),s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s)}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[l.identification.photo?(0,a.jsx)("img",{src:"http://localhost:5001/api/files/download?path=".concat(encodeURIComponent(l.identification.photo.path),"&filename=").concat(encodeURIComponent(l.identification.photo.filename)),alt:l.user.name,className:"w-16 h-16 rounded-full object-cover"}):(0,a.jsx)("div",{className:"w-16 h-16 rounded-full bg-gray-200 flex items-center justify-center",children:(0,a.jsx)(L.Z,{className:"w-8 h-8 text-gray-500"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold",children:l.user.name}),(0,a.jsx)("p",{className:"text-muted-foreground",children:l.user.employeeId}),(0,a.jsx)(A,{className:(e=>{switch(e){case"active":return"bg-green-100 text-green-800";case"inactive":return"bg-red-100 text-red-800";case"on_leave":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}})(l.status),children:l.status.replace("_"," ").toUpperCase()})]})]}),(0,a.jsx)(x,{onClick:i,variant:"outline",children:"Close"})]}),(0,a.jsxs)(tq,{defaultValue:"personal",className:"w-full",children:[(0,a.jsxs)(tV,{className:"grid w-full grid-cols-4",children:[(0,a.jsx)(tJ,{value:"personal",children:"Personal"}),(0,a.jsx)(tJ,{value:"employment",children:"Employment"}),(0,a.jsx)(tJ,{value:"documents",children:"Documents"}),(0,a.jsx)(tJ,{value:"leaves",children:"Leaves"})]}),(0,a.jsx)(tG,{value:"personal",className:"space-y-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)(j,{children:[(0,a.jsx)(f,{children:(0,a.jsxs)(v,{className:"flex items-center gap-2",children:[(0,a.jsx)(L.Z,{className:"w-5 h-5"}),"Personal Information"]})}),(0,a.jsxs)(N,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"First Name"}),(0,a.jsx)("p",{className:"text-lg",children:l.personalDetails.firstName})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Last Name"}),(0,a.jsx)("p",{className:"text-lg",children:l.personalDetails.lastName})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Date of Birth"}),(0,a.jsx)("p",{className:"text-lg",children:h(l.personalDetails.dateOfBirth)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Gender"}),(0,a.jsx)("p",{className:"text-lg capitalize",children:l.personalDetails.gender})]}),l.personalDetails.bloodGroup&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Blood Group"}),(0,a.jsx)("p",{className:"text-lg",children:l.personalDetails.bloodGroup})]})]})]}),(0,a.jsxs)(j,{children:[(0,a.jsx)(f,{children:(0,a.jsxs)(v,{className:"flex items-center gap-2",children:[(0,a.jsx)(s_.Z,{className:"w-5 h-5"}),"Contact Information"]})}),(0,a.jsxs)(N,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(t8.Z,{className:"w-4 h-4 text-muted-foreground"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Email"}),(0,a.jsx)("p",{className:"text-lg",children:l.user.email})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(s_.Z,{className:"w-4 h-4 text-muted-foreground"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Phone"}),(0,a.jsx)("p",{className:"text-lg",children:l.contactDetails.phone})]})]}),l.contactDetails.emergencyPhone&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Emergency Phone"}),(0,a.jsx)("p",{className:"text-lg",children:l.contactDetails.emergencyPhone})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(sL.Z,{className:"w-4 h-4 text-muted-foreground"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Address"}),(0,a.jsxs)("p",{className:"text-lg",children:[l.contactDetails.address.street,",",(0,a.jsx)("br",{}),l.contactDetails.address.city,", ",l.contactDetails.address.state," ",l.contactDetails.address.postalCode,(0,a.jsx)("br",{}),l.contactDetails.address.country]})]})]})]})]})]})}),(0,a.jsxs)(tG,{value:"employment",className:"space-y-6",children:[(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:(0,a.jsxs)(j,{children:[(0,a.jsx)(f,{children:(0,a.jsxs)(v,{className:"flex items-center gap-2",children:[(0,a.jsx)(sR.Z,{className:"w-5 h-5"}),"Employment Details"]})}),(0,a.jsxs)(N,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Department"}),(0,a.jsx)("p",{className:"text-lg capitalize",children:l.employmentDetails.department})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Position"}),(0,a.jsx)("p",{className:"text-lg",children:l.employmentDetails.position})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(sB.Z,{className:"w-4 h-4 text-muted-foreground"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Date of Joining"}),(0,a.jsx)("p",{className:"text-lg",children:h(l.employmentDetails.dateOfJoining)})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Role"}),(0,a.jsx)("p",{className:"text-lg capitalize",children:l.user.role})]})]})]})}),(0,a.jsxs)(j,{children:[(0,a.jsx)(f,{children:(0,a.jsx)(v,{children:"Leave Balance"})}),(0,a.jsx)(N,{children:(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:(null===(t=l.leaveBalance)||void 0===t?void 0:t.casual)||0}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Casual Leaves"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-green-600",children:(null===(s=l.leaveBalance)||void 0===s?void 0:s.sick)||0}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Sick Leaves"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-purple-600",children:(null===(n=l.leaveBalance)||void 0===n?void 0:n.earned)||0}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Earned Leaves"})]})]})})]})]}),(0,a.jsx)(tG,{value:"documents",className:"space-y-6",children:(0,a.jsxs)(j,{children:[(0,a.jsx)(f,{children:(0,a.jsxs)(v,{className:"flex items-center gap-2",children:[(0,a.jsx)(W.Z,{className:"w-5 h-5"}),"Identification Documents"]})}),(0,a.jsxs)(N,{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Aadhaar Number"}),(0,a.jsx)("p",{className:"text-lg",children:l.identification.aadhaarNumber})]}),l.identification.panNumber&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"PAN Number"}),(0,a.jsx)("p",{className:"text-lg",children:l.identification.panNumber})]}),(0,a.jsx)(te,{}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.identification.aadhaarCard&&(0,a.jsx)(j,{children:(0,a.jsxs)(N,{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("p",{className:"font-medium",children:"Aadhaar Card"}),(0,a.jsx)(x,{size:"sm",variant:"outline",onClick:()=>p(l.identification.aadhaarCard,l.identification.aadhaarCard.filename),children:(0,a.jsx)(td.Z,{className:"w-4 h-4"})})]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Uploaded: ",h(l.identification.aadhaarCard.uploadedAt)]})]})}),l.identification.panCard&&(0,a.jsx)(j,{children:(0,a.jsxs)(N,{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("p",{className:"font-medium",children:"PAN Card"}),(0,a.jsx)(x,{size:"sm",variant:"outline",onClick:()=>p(l.identification.panCard,l.identification.panCard.filename),children:(0,a.jsx)(td.Z,{className:"w-4 h-4"})})]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Uploaded: ",h(l.identification.panCard.uploadedAt)]})]})}),l.identification.photo&&(0,a.jsx)(j,{children:(0,a.jsxs)(N,{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("p",{className:"font-medium",children:"Photo"}),(0,a.jsx)(x,{size:"sm",variant:"outline",onClick:()=>p(l.identification.photo,l.identification.photo.filename),children:(0,a.jsx)(td.Z,{className:"w-4 h-4"})})]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Uploaded: ",h(l.identification.photo.uploadedAt)]})]})})]})]})]})}),(0,a.jsx)(tG,{value:"leaves",className:"space-y-6",children:(0,a.jsxs)(j,{children:[(0,a.jsx)(f,{children:(0,a.jsx)(v,{children:"Leave History"})}),(0,a.jsx)(N,{children:o?(0,a.jsx)("div",{className:"flex items-center justify-center h-32",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"})}):c.length>0?(0,a.jsx)("div",{className:"space-y-4",children:c.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"font-medium",children:[e.leaveType.charAt(0).toUpperCase()+e.leaveType.slice(1)," Leave"]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[h(e.startDate)," - ",h(e.endDate)]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.totalDays," days"]})]}),(0,a.jsx)(A,{className:"approved"===e.status?"bg-green-100 text-green-800":"rejected"===e.status?"bg-red-100 text-red-800":"pending"===e.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800",children:e.status.toUpperCase()})]},e._id))}):(0,a.jsx)("p",{className:"text-center text-muted-foreground",children:"No leave records found"})})]})})]})]})}function sM(){let[e,t]=(0,r.useState)([]),[s,l]=(0,r.useState)([]),[i,c]=(0,r.useState)(!0),[d,o]=(0,r.useState)(""),[m,u]=(0,r.useState)("all"),[p,g]=(0,r.useState)(null),[y,b]=(0,r.useState)(!1),[w,C]=(0,r.useState)(!1),[S,D]=(0,r.useState)(null),{toast:k}=tZ(),{isAdmin:P}=(0,n.a)();(0,r.useEffect)(()=>{I()},[]),(0,r.useEffect)(()=>{T()},[e,d,m]);let I=async()=>{try{let e=sO.O.getToken(),s=await fetch("http://localhost:5001/api/employees",{headers:{Authorization:"Bearer ".concat(e)}});if(s.ok){let e=await s.json();t(e)}else k({title:"Error",description:"Failed to fetch employees",variant:"destructive"})}catch(e){k({title:"Error",description:"Failed to fetch employees",variant:"destructive"})}finally{c(!1)}},T=()=>{let t=e;d&&(t=t.filter(e=>{var t,s,a,r;return(null===(s=e.user)||void 0===s?void 0:null===(t=s.name)||void 0===t?void 0:t.toLowerCase().includes(d.toLowerCase()))||(null===(r=e.user)||void 0===r?void 0:null===(a=r.employeeId)||void 0===a?void 0:a.toLowerCase().includes(d.toLowerCase()))||e.personalDetails.firstName.toLowerCase().includes(d.toLowerCase())||e.personalDetails.lastName.toLowerCase().includes(d.toLowerCase())||e.contactDetails.phone.includes(d)})),"all"!==m&&(t=t.filter(e=>e.status===m)),l(t)},E=e=>{D(e),b(!0)},F=e=>{g(e),C(!0)},z=async e=>{if(confirm("Are you sure you want to deactivate this employee?"))try{let t=sO.O.getToken();(await fetch("http://localhost:5001/api/employees/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}})).ok?(k({title:"Success",description:"Employee deactivated successfully"}),I()):k({title:"Error",description:"Failed to deactivate employee",variant:"destructive"})}catch(e){k({title:"Error",description:"Failed to deactivate employee",variant:"destructive"})}},O=e=>{switch(e){case"active":return"bg-green-100 text-green-800";case"inactive":return"bg-red-100 text-red-800";case"on_leave":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}};return i?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Cashier Management"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Manage cashiers and their details"})]}),P&&(0,a.jsxs)(eD,{open:y,onOpenChange:b,children:[(0,a.jsx)(ek,{asChild:!0,children:(0,a.jsxs)(x,{onClick:()=>D(null),children:[(0,a.jsx)(eO.Z,{className:"mr-2 h-4 w-4"}),"Add Cashier"]})}),(0,a.jsxs)(eI,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(eT,{children:(0,a.jsx)(eF,{children:S?"Edit Cashier":"Add New Cashier"})}),(0,a.jsx)(sZ,{employee:S,onSuccess:()=>{I(),b(!1),D(null)},onCancel:()=>{b(!1),D(null)}})]})]})]}),(0,a.jsxs)(j,{children:[(0,a.jsx)(f,{children:(0,a.jsx)(v,{children:"Filters"})}),(0,a.jsx)(N,{children:(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(eZ.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),(0,a.jsx)(h,{placeholder:"Search employees...",value:d,onChange:e=>o(e.target.value),className:"pl-10"})]})}),(0,a.jsxs)(ei,{value:m,onValueChange:u,children:[(0,a.jsx)(ed,{className:"w-48",children:(0,a.jsx)(ec,{placeholder:"Filter by status"})}),(0,a.jsxs)(eo,{children:[(0,a.jsx)(em,{value:"all",children:"All Status"}),(0,a.jsx)(em,{value:"active",children:"Active"}),(0,a.jsx)(em,{value:"inactive",children:"Inactive"}),(0,a.jsx)(em,{value:"on_leave",children:"On Leave"}),(0,a.jsx)(em,{value:"terminated",children:"Terminated"})]})]})]})})]}),(0,a.jsxs)(j,{children:[(0,a.jsx)(f,{children:(0,a.jsxs)(v,{children:["Cashiers (",s.length,")"]})}),(0,a.jsxs)(N,{children:[(0,a.jsxs)(e1,{children:[(0,a.jsx)(e2,{children:(0,a.jsxs)(e3,{children:[(0,a.jsx)(e5,{children:"Employee ID"}),(0,a.jsx)(e5,{children:"Name"}),(0,a.jsx)(e5,{children:"Department"}),(0,a.jsx)(e5,{children:"Position"}),(0,a.jsx)(e5,{children:"Contact"}),(0,a.jsx)(e5,{children:"Status"}),(0,a.jsx)(e5,{className:"text-right",children:"Actions"})]})}),(0,a.jsx)(e4,{children:s.map(e=>{var t,s,r;return(0,a.jsxs)(e3,{children:[(0,a.jsx)(e6,{className:"font-medium",children:(null===(t=e.user)||void 0===t?void 0:t.employeeId)||"N/A"}),(0,a.jsx)(e6,{children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:(null===(s=e.user)||void 0===s?void 0:s.name)||"Unknown"}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:(null===(r=e.user)||void 0===r?void 0:r.email)||"No email"})]})}),(0,a.jsx)(e6,{children:e.employmentDetails.department}),(0,a.jsx)(e6,{children:e.employmentDetails.position}),(0,a.jsx)(e6,{children:e.contactDetails.phone}),(0,a.jsx)(e6,{children:(0,a.jsx)(A,{className:O(e.status),children:e.status.replace("_"," ").toUpperCase()})}),(0,a.jsx)(e6,{className:"text-right",children:(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(x,{variant:"ghost",size:"sm",onClick:()=>F(e),children:(0,a.jsx)(t3.Z,{className:"h-4 w-4"})}),P&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x,{variant:"ghost",size:"sm",onClick:()=>E(e),children:(0,a.jsx)(e_.Z,{className:"h-4 w-4"})}),(0,a.jsx)(x,{variant:"ghost",size:"sm",onClick:()=>z(e._id),children:(0,a.jsx)(eL.Z,{className:"h-4 w-4"})})]})]})})]},e._id)})})]}),0===s.length&&(0,a.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No cashiers found matching your criteria"})]})]}),(0,a.jsx)(eD,{open:w,onOpenChange:C,children:(0,a.jsxs)(eI,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(eT,{children:(0,a.jsx)(eF,{children:"Cashier Details"})}),p&&(0,a.jsx)(sU,{employee:p,onClose:()=>C(!1)})]})})]})}var sq=s(26034),sV=s(38866),sJ=s(27312);function sG(e){let{...t}=e;return(0,a.jsx)(sJ.fC,{"data-slot":"popover",...t})}function sH(e){let{...t}=e;return(0,a.jsx)(sJ.xz,{"data-slot":"popover-trigger",...t})}function sK(e){let{className:t,align:s="center",sideOffset:r=4,...n}=e;return(0,a.jsx)(sJ.h_,{children:(0,a.jsx)(sJ.VY,{"data-slot":"popover-content",align:s,sideOffset:r,className:o("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",t),...n})})}var sW=s(45008),sY=s(92451),sQ=s(92658),s$=s(77090);function sX(){let e=(0,sW._)(["rtl:**:[.rdp-button_next>svg]:rotate-180"],["rtl:**:[.rdp-button\\_next>svg]:rotate-180"]);return sX=function(){return e},e}function s0(){let e=(0,sW._)(["rtl:**:[.rdp-button_previous>svg]:rotate-180"],["rtl:**:[.rdp-button\\_previous>svg]:rotate-180"]);return s0=function(){return e},e}function s1(e){let{className:t,classNames:s,showOutsideDays:r=!0,captionLayout:n="label",buttonVariant:l="ghost",formatters:i,components:c,...d}=e,m=(0,sQ.U)();return(0,a.jsx)(s$._,{showOutsideDays:r,className:o("bg-background group/calendar p-3 [--cell-size:--spacing(8)] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent",String.raw(sX()),String.raw(s0()),t),captionLayout:n,formatters:{formatMonthDropdown:e=>e.toLocaleString("default",{month:"short"}),...i},classNames:{root:o("w-fit",m.root),months:o("flex gap-4 flex-col md:flex-row relative",m.months),month:o("flex flex-col w-full gap-4",m.month),nav:o("flex items-center gap-1 w-full absolute top-0 inset-x-0 justify-between",m.nav),button_previous:o(u({variant:l}),"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",m.button_previous),button_next:o(u({variant:l}),"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",m.button_next),month_caption:o("flex items-center justify-center h-(--cell-size) w-full px-(--cell-size)",m.month_caption),dropdowns:o("w-full flex items-center text-sm font-medium justify-center h-(--cell-size) gap-1.5",m.dropdowns),dropdown_root:o("relative has-focus:border-ring border border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] rounded-md",m.dropdown_root),dropdown:o("absolute bg-popover inset-0 opacity-0",m.dropdown),caption_label:o("select-none font-medium","label"===n?"text-sm":"rounded-md pl-2 pr-1 flex items-center gap-1 text-sm h-8 [&>svg]:text-muted-foreground [&>svg]:size-3.5",m.caption_label),table:"w-full border-collapse",weekdays:o("flex",m.weekdays),weekday:o("text-muted-foreground rounded-md flex-1 font-normal text-[0.8rem] select-none",m.weekday),week:o("flex w-full mt-2",m.week),week_number_header:o("select-none w-(--cell-size)",m.week_number_header),week_number:o("text-[0.8rem] select-none text-muted-foreground",m.week_number),day:o("relative w-full h-full p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md group/day aspect-square select-none",m.day),range_start:o("rounded-l-md bg-accent",m.range_start),range_middle:o("rounded-none",m.range_middle),range_end:o("rounded-r-md bg-accent",m.range_end),today:o("bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none",m.today),outside:o("text-muted-foreground aria-selected:text-muted-foreground",m.outside),disabled:o("text-muted-foreground opacity-50",m.disabled),hidden:o("invisible",m.hidden),...s},components:{Root:e=>{let{className:t,rootRef:s,...r}=e;return(0,a.jsx)("div",{"data-slot":"calendar",ref:s,className:o(t),...r})},Chevron:e=>{let{className:t,orientation:s,...r}=e;return"left"===s?(0,a.jsx)(sY.Z,{className:o("size-4",t),...r}):"right"===s?(0,a.jsx)(sP.Z,{className:o("size-4",t),...r}):(0,a.jsx)(er.Z,{className:o("size-4",t),...r})},DayButton:s2,WeekNumber:e=>{let{children:t,...s}=e;return(0,a.jsx)("td",{...s,children:(0,a.jsx)("div",{className:"flex size-(--cell-size) items-center justify-center text-center",children:t})})},...c},...d})}function s2(e){let{className:t,day:s,modifiers:n,...l}=e,i=(0,sQ.U)(),c=r.useRef(null);return r.useEffect(()=>{var e;n.focused&&(null===(e=c.current)||void 0===e||e.focus())},[n.focused]),(0,a.jsx)(x,{ref:c,variant:"ghost",size:"icon","data-day":s.date.toLocaleDateString(),"data-selected-single":n.selected&&!n.range_start&&!n.range_end&&!n.range_middle,"data-range-start":n.range_start,"data-range-end":n.range_end,"data-range-middle":n.range_middle,className:o("data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 dark:hover:text-accent-foreground flex aspect-square size-auto w-full min-w-(--cell-size) flex-col gap-1 leading-none font-normal group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] data-[range-end=true]:rounded-md data-[range-end=true]:rounded-r-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md data-[range-start=true]:rounded-l-md [&>span]:text-xs [&>span]:opacity-70",i.day,t),...l})}var s4=s(52255);function s3(e){let{discount:t,onSuccess:s,onCancel:n}=e,[l,i]=(0,r.useState)({name:"",description:"",type:"percentage",value:"",targetType:"all",targetCategory:"",targetProduct:"",minPurchaseAmount:"",maxDiscountAmount:"",usageLimit:"",startDate:new Date,endDate:new Date(Date.now()+2592e6),isActive:!0}),[c,d]=(0,r.useState)([]),[m,u]=(0,r.useState)([]),[p,b]=(0,r.useState)(!1),[w,C]=(0,r.useState)(!0);(0,r.useEffect)(()=>{if(t){var e,s,a,r;i({name:t.name,description:t.description||"",type:t.type,value:t.value.toString(),targetType:t.targetType,targetCategory:t.targetCategory||"",targetProduct:(null===(e=t.targetProduct)||void 0===e?void 0:e._id)||"",minPurchaseAmount:(null===(s=t.minPurchaseAmount)||void 0===s?void 0:s.toString())||"",maxDiscountAmount:(null===(a=t.maxDiscountAmount)||void 0===a?void 0:a.toString())||"",usageLimit:(null===(r=t.usageLimit)||void 0===r?void 0:r.toString())||"",startDate:new Date(t.startDate),endDate:new Date(t.endDate),isActive:t.isActive})}},[t]),(0,r.useEffect)(()=>{S()},[]);let S=async()=>{try{C(!0);let e=await eB.apiClient.getProducts({active:!0});d(e||[]);let t=[...new Set(e.map(e=>e.category))];u(t)}catch(e){console.error("Error fetching products:",e)}finally{C(!1)}},D=async e=>{e.preventDefault(),b(!0);try{let e={...l,value:parseFloat(l.value),minPurchaseAmount:l.minPurchaseAmount?parseFloat(l.minPurchaseAmount):0,maxDiscountAmount:l.maxDiscountAmount?parseFloat(l.maxDiscountAmount):void 0,usageLimit:l.usageLimit?parseInt(l.usageLimit):void 0,startDate:l.startDate.toISOString(),endDate:l.endDate.toISOString(),type:l.type,targetType:l.targetType,targetProduct:"product"===l.targetType&&l.targetProduct?c.find(e=>e._id===l.targetProduct):void 0};t?await eB.apiClient.updateDiscount(t._id,e):await eB.apiClient.createDiscount(e),s()}catch(e){console.error("Error saving discount:",e),alert(e instanceof Error?e.message:"Error saving discount")}finally{b(!1)}};return(0,a.jsxs)("form",{onSubmit:D,className:"space-y-6 max-w-6xl mx-auto p-4",children:[(0,a.jsxs)(j,{children:[(0,a.jsxs)(f,{children:[(0,a.jsxs)(v,{className:"flex items-center gap-2",children:[(0,a.jsx)(Q.Z,{className:"h-5 w-5"}),"Basic Information"]}),(0,a.jsx)(y,{children:"Set the basic details for your discount"})]}),(0,a.jsxs)(N,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"name",children:"Discount Name *"}),(0,a.jsx)(h,{id:"name",value:l.name,onChange:e=>i({...l,name:e.target.value}),placeholder:"e.g., Summer Sale 2024",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"type",children:"Discount Type *"}),(0,a.jsxs)(ei,{value:l.type,onValueChange:e=>i({...l,type:e}),children:[(0,a.jsx)(ed,{children:(0,a.jsx)(ec,{})}),(0,a.jsxs)(eo,{children:[(0,a.jsx)(em,{value:"percentage",children:"Percentage"}),(0,a.jsx)(em,{value:"fixed",children:"Fixed Amount"})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"description",children:"Description"}),(0,a.jsx)(tW,{id:"description",value:l.description,onChange:e=>i({...l,description:e.target.value}),placeholder:"Describe the discount and its terms...",rows:3})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"value",children:"Discount Value *"}),(0,a.jsx)(h,{id:"value",type:"number",value:l.value,onChange:e=>i({...l,value:e.target.value}),placeholder:"percentage"===l.type?"e.g., 10":"e.g., 100",min:"0",max:"percentage"===l.type?"100":void 0,step:"percentage"===l.type?"0.1":"0.01",required:!0}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"percentage"===l.type?"Enter percentage value (e.g., 10 for 10%)":"Enter fixed amount in INR"})]})]})]}),(0,a.jsxs)(j,{children:[(0,a.jsxs)(f,{children:[(0,a.jsxs)(v,{className:"flex items-center gap-2",children:[(0,a.jsx)(t2.Z,{className:"h-5 w-5"}),"Target Configuration"]}),(0,a.jsx)(y,{children:"Choose which products this discount applies to"})]}),(0,a.jsxs)(N,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"targetType",children:"Target Type *"}),(0,a.jsxs)(ei,{value:l.targetType,onValueChange:e=>i({...l,targetType:e}),children:[(0,a.jsx)(ed,{children:(0,a.jsx)(ec,{})}),(0,a.jsxs)(eo,{children:[(0,a.jsx)(em,{value:"all",children:"All Products"}),(0,a.jsx)(em,{value:"category",children:"Specific Category"}),(0,a.jsx)(em,{value:"product",children:"Specific Product"})]})]})]}),"category"===l.targetType&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"targetCategory",children:"Category *"}),(0,a.jsxs)(ei,{value:l.targetCategory,onValueChange:e=>i({...l,targetCategory:e}),children:[(0,a.jsx)(ed,{children:(0,a.jsx)(ec,{placeholder:"Select a category"})}),(0,a.jsx)(eo,{children:w?(0,a.jsx)(em,{value:"loading-categories",disabled:!0,children:"Loading categories..."}):m.map(e=>(0,a.jsx)(em,{value:e,children:e},e))})]})]}),"product"===l.targetType&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"targetProduct",children:"Product *"}),(0,a.jsxs)(ei,{value:l.targetProduct,onValueChange:e=>i({...l,targetProduct:e}),children:[(0,a.jsx)(ed,{children:(0,a.jsx)(ec,{placeholder:"Select a product"})}),(0,a.jsx)(eo,{children:w?(0,a.jsx)(em,{value:"loading-products",disabled:!0,children:"Loading products..."}):c.map(e=>(0,a.jsxs)(em,{value:e._id,children:[e.code," - ",e.name]},e._id))})]})]})]})]}),(0,a.jsxs)(j,{children:[(0,a.jsxs)(f,{children:[(0,a.jsx)(v,{children:"Conditions and Limits"}),(0,a.jsx)(y,{children:"Set conditions and usage limits for the discount"})]}),(0,a.jsxs)(N,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"minPurchaseAmount",children:"Minimum Purchase Amount"}),(0,a.jsx)(h,{id:"minPurchaseAmount",type:"number",value:l.minPurchaseAmount,onChange:e=>i({...l,minPurchaseAmount:e.target.value}),placeholder:"0",min:"0",step:"0.01"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Minimum purchase amount to qualify for discount"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"maxDiscountAmount",children:"Maximum Discount Amount"}),(0,a.jsx)(h,{id:"maxDiscountAmount",type:"number",value:l.maxDiscountAmount,onChange:e=>i({...l,maxDiscountAmount:e.target.value}),placeholder:"No limit",min:"0",step:"0.01"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Maximum discount amount per transaction"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"usageLimit",children:"Usage Limit"}),(0,a.jsx)(h,{id:"usageLimit",type:"number",value:l.usageLimit,onChange:e=>i({...l,usageLimit:e.target.value}),placeholder:"No limit",min:"1"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Maximum number of times this discount can be used"})]})]})]}),(0,a.jsxs)(j,{children:[(0,a.jsxs)(f,{children:[(0,a.jsx)(v,{children:"Duration"}),(0,a.jsx)(y,{children:"Set the validity period for this discount"})]}),(0,a.jsx)(N,{className:"space-y-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"startDate",children:"Start Date"}),(0,a.jsxs)(sG,{children:[(0,a.jsx)(sH,{asChild:!0,children:(0,a.jsxs)(x,{variant:"outline",className:o("w-full justify-start text-left font-normal",!l.startDate&&"text-muted-foreground"),children:[(0,a.jsx)(sB.Z,{className:"mr-2 h-4 w-4"}),l.startDate?(0,s4.WU)(l.startDate,"PPP"):(0,a.jsx)("span",{children:"Pick a date"})]})}),(0,a.jsx)(sK,{className:"w-auto p-0",children:(0,a.jsx)(s1,{mode:"single",selected:l.startDate,onSelect:e=>{e&&i({...l,startDate:e,endDate:l.endDate&&l.endDate<e?e:l.endDate})},disabled:e=>e<new Date(new Date().setHours(0,0,0,0)),initialFocus:!0})})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"endDate",children:"End Date"}),(0,a.jsxs)(sG,{children:[(0,a.jsx)(sH,{asChild:!0,children:(0,a.jsxs)(x,{variant:"outline",className:o("w-full justify-start text-left font-normal",!l.endDate&&"text-muted-foreground"),children:[(0,a.jsx)(sB.Z,{className:"mr-2 h-4 w-4"}),l.endDate?(0,s4.WU)(l.endDate,"PPP"):(0,a.jsx)("span",{children:"Pick a date"})]})}),(0,a.jsx)(sK,{className:"w-auto p-0",children:(0,a.jsx)(s1,{mode:"single",selected:l.endDate,onSelect:e=>{e&&i({...l,endDate:e})},disabled:e=>e<l.startDate,initialFocus:!0})})]})]})]})})]}),(0,a.jsxs)(j,{children:[(0,a.jsx)(f,{children:(0,a.jsx)(v,{children:"Status"})}),(0,a.jsxs)(N,{children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(eM,{id:"isActive",checked:l.isActive,onCheckedChange:e=>i({...l,isActive:e})}),(0,a.jsx)(g,{htmlFor:"isActive",children:"Active"})]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"Inactive discounts will not be applied to purchases"})]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-end gap-4 p-4 bg-background rounded-lg border",children:[(0,a.jsx)(x,{type:"button",variant:"outline",onClick:n,className:"w-full sm:w-auto",children:"Cancel"}),(0,a.jsx)(x,{type:"submit",disabled:p,className:"w-full sm:w-auto",children:p?"Saving...":t?"Update Discount":"Create Discount"})]})]})}var s5=s(99388),s6=s(41671);function s8(e){var t;let{discount:s}=e,r=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e),n=e=>new Date(e).toLocaleDateString("en-IN",{year:"numeric",month:"long",day:"numeric"}),l=(e,t,s)=>{switch(e){case"all":return"All Products";case"category":return"Category: ".concat(t);case"product":return"Product: ".concat((null==s?void 0:s.name)||"Unknown"," (").concat((null==s?void 0:s.code)||"N/A",")");default:return e}},i=(e,t)=>"percentage"===e?"".concat(t,"% off"):"".concat(r(t)," off"),c=e=>{let t=new Date,s=new Date(e.startDate),a=new Date(e.endDate);return e.isActive&&t>=s&&t<=a},d=(e=>{c(e);let t=new Date,s=new Date(e.startDate),a=new Date(e.endDate);return e.isActive?t<s?{icon:_.Z,text:"Scheduled",color:"secondary",description:"Discount will start on ".concat(n(e.startDate))}:t>a?{icon:s5.Z,text:"Expired",color:"destructive",description:"Discount expired on ".concat(n(e.endDate))}:{icon:s6.Z,text:"Active",color:"default",description:"Discount is valid until ".concat(n(e.endDate))}:{icon:s5.Z,text:"Inactive",color:"secondary",description:"Discount has been manually deactivated"}})(s),o=(e=>{if(!e.usageLimit)return{status:"unlimited",color:"default",text:"Unlimited usage"};let t=e.usedCount/e.usageLimit*100;return t>=100?{status:"exhausted",color:"destructive",text:"Usage limit reached"}:t>=80?{status:"warning",color:"secondary",text:"".concat(Math.round(t),"% used")}:{status:"available",color:"default",text:"".concat(e.usedCount," / ").concat(e.usageLimit," used")}})(s),m=d.icon;return(0,a.jsxs)("div",{className:"w-full max-w-6xl mx-auto p-6 bg-white dark:bg-gray-900 rounded-xl shadow-lg border border-gray-200 dark:border-gray-800 max-h-[calc(100vh-4rem)] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"mb-6 text-center",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 mb-3",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:s.name}),(0,a.jsxs)(A,{variant:d.color,className:"text-sm px-3 py-1 font-semibold shadow-md",children:[(0,a.jsx)(m,{className:"h-4 w-4 mr-1"}),d.text]})]}),(0,a.jsx)("p",{className:"text-base text-gray-600 dark:text-gray-300 mb-3",children:s.description}),(0,a.jsx)("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg border border-blue-200 dark:border-blue-800",children:(0,a.jsx)("p",{className:"text-sm text-blue-800 dark:text-blue-200 font-medium",children:d.description})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[(0,a.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700 shadow-md",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,a.jsx)("div",{className:"p-1.5 bg-blue-100 dark:bg-blue-900 rounded-lg",children:(0,a.jsx)(Q.Z,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),(0,a.jsx)("h2",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Discount Information"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-200 dark:border-gray-600",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Type"}),(0,a.jsx)(A,{variant:"outline",className:"text-xs px-2 py-1 font-medium",children:i(s.type,s.value)})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-200 dark:border-gray-600",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Value"}),(0,a.jsx)("span",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:"percentage"===s.type?"".concat(s.value,"%"):r(s.value)})]}),s.minPurchaseAmount>0&&(0,a.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-200 dark:border-gray-600",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Min Purchase"}),(0,a.jsx)("span",{className:"text-base font-medium text-gray-900 dark:text-white",children:r(s.minPurchaseAmount)})]}),s.maxDiscountAmount&&(0,a.jsxs)("div",{className:"flex justify-between items-center py-2",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Max Discount"}),(0,a.jsx)("span",{className:"text-base font-medium text-gray-900 dark:text-white",children:r(s.maxDiscountAmount)})]})]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700 shadow-md",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,a.jsx)("div",{className:"p-1.5 bg-green-100 dark:bg-green-900 rounded-lg",children:(0,a.jsx)(t2.Z,{className:"h-5 w-5 text-green-600 dark:text-green-400"})}),(0,a.jsx)("h2",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Target Information"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-200 dark:border-gray-600",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Target Type"}),(0,a.jsx)(A,{variant:"outline",className:"text-xs px-2 py-1 font-medium",children:s.targetType})]}),(0,a.jsxs)("div",{className:"py-2",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 block mb-2",children:"Applies To"}),(0,a.jsx)("div",{className:"bg-white dark:bg-gray-900 p-3 rounded-lg border border-gray-300 dark:border-gray-600",children:(0,a.jsx)("p",{className:"text-sm text-gray-800 dark:text-gray-200 leading-relaxed",children:l(s.targetType,s.targetCategory,s.targetProduct)})})]})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[(0,a.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700 shadow-md",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,a.jsx)("div",{className:"p-1.5 bg-purple-100 dark:bg-purple-900 rounded-lg",children:(0,a.jsx)(sB.Z,{className:"h-5 w-5 text-purple-600 dark:text-purple-400"})}),(0,a.jsx)("h2",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Duration"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"py-2 border-b border-gray-200 dark:border-gray-600",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 block mb-1",children:"Start Date"}),(0,a.jsx)("p",{className:"text-base font-medium text-gray-900 dark:text-white",children:n(s.startDate)})]}),(0,a.jsxs)("div",{className:"py-2",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 block mb-1",children:"End Date"}),(0,a.jsx)("p",{className:"text-base font-medium text-gray-900 dark:text-white",children:n(s.endDate)})]})]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700 shadow-md",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,a.jsx)("div",{className:"p-1.5 bg-orange-100 dark:bg-orange-900 rounded-lg",children:(0,a.jsx)(t0.Z,{className:"h-5 w-5 text-orange-600 dark:text-orange-400"})}),(0,a.jsx)("h2",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Usage Statistics"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-200 dark:border-gray-600",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Times Used"}),(0,a.jsx)(A,{variant:o.color,className:"text-xs px-2 py-1 font-medium",children:o.text})]}),s.usageLimit&&(0,a.jsxs)("div",{className:"space-y-3 pt-1",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Usage Progress"}),(0,a.jsxs)("span",{className:"text-lg font-bold text-orange-600 dark:text-orange-400",children:[Math.round(s.usedCount/s.usageLimit*100),"%"]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3 overflow-hidden",children:(0,a.jsx)("div",{className:"bg-gradient-to-r from-orange-400 to-orange-600 h-3 rounded-full transition-all duration-500 ease-out shadow-sm",style:{width:"".concat(Math.min(100,s.usedCount/s.usageLimit*100),"%")}})}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsxs)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:[s.usedCount," of ",s.usageLimit," uses"]})})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700 shadow-md mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,a.jsx)("div",{className:"p-1.5 bg-indigo-100 dark:bg-indigo-900 rounded-lg",children:(0,a.jsx)($.Z,{className:"h-5 w-5 text-indigo-600 dark:text-indigo-400"})}),(0,a.jsx)("h2",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Additional Information"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-900 p-3 rounded-lg border border-gray-300 dark:border-gray-600 shadow-sm",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 block mb-1",children:"Created By"}),(0,a.jsx)("p",{className:"text-base font-medium text-gray-900 dark:text-white",children:(null===(t=s.createdBy)||void 0===t?void 0:t.name)||"Unknown"})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-900 p-3 rounded-lg border border-gray-300 dark:border-gray-600 shadow-sm",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 block mb-1",children:"Created Date"}),(0,a.jsx)("p",{className:"text-base font-medium text-gray-900 dark:text-white",children:n(s.createdAt)})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-900 p-3 rounded-lg border border-gray-300 dark:border-gray-600 shadow-sm",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 block mb-1",children:"Last Updated"}),(0,a.jsx)("p",{className:"text-base font-medium text-gray-900 dark:text-white",children:n(s.updatedAt)})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-900 p-3 rounded-lg border border-gray-300 dark:border-gray-600 shadow-sm",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 block mb-1",children:"Discount ID"}),(0,a.jsx)("p",{className:"text-xs font-mono font-medium text-gray-600 dark:text-gray-400 break-all leading-relaxed",children:s._id})]})]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700 shadow-md",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,a.jsx)("div",{className:"p-1.5 bg-teal-100 dark:bg-teal-900 rounded-lg",children:(0,a.jsx)(s6.Z,{className:"h-5 w-5 text-teal-600 dark:text-teal-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Conditions Summary"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-1",children:"Summary of conditions that must be met for this discount to apply"})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3 p-3 bg-green-100 dark:bg-green-900/30 rounded-xl border border-green-300 dark:border-green-700 shadow-sm",children:[(0,a.jsx)(s6.Z,{className:"h-4 w-4 text-green-600 dark:text-green-400 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("span",{className:"text-sm text-green-800 dark:text-green-200 leading-relaxed font-medium",children:["Discount type: ",i(s.type,s.value)]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-3 p-3 bg-green-100 dark:bg-green-900/30 rounded-xl border border-green-300 dark:border-green-700 shadow-sm",children:[(0,a.jsx)(s6.Z,{className:"h-4 w-4 text-green-600 dark:text-green-400 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("span",{className:"text-sm text-green-800 dark:text-green-200 leading-relaxed font-medium",children:["Applies to: ",l(s.targetType,s.targetCategory,s.targetProduct)]})]}),s.minPurchaseAmount>0&&(0,a.jsxs)("div",{className:"flex items-start gap-3 p-3 bg-green-100 dark:bg-green-900/30 rounded-xl border border-green-300 dark:border-green-700 shadow-sm",children:[(0,a.jsx)(s6.Z,{className:"h-4 w-4 text-green-600 dark:text-green-400 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("span",{className:"text-sm text-green-800 dark:text-green-200 leading-relaxed font-medium",children:["Minimum purchase amount: ",r(s.minPurchaseAmount)]})]}),s.maxDiscountAmount&&(0,a.jsxs)("div",{className:"flex items-start gap-3 p-3 bg-green-100 dark:bg-green-900/30 rounded-xl border border-green-300 dark:border-green-700 shadow-sm",children:[(0,a.jsx)(s6.Z,{className:"h-4 w-4 text-green-600 dark:text-green-400 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("span",{className:"text-sm text-green-800 dark:text-green-200 leading-relaxed font-medium",children:["Maximum discount amount: ",r(s.maxDiscountAmount)]})]}),s.usageLimit&&(0,a.jsxs)("div",{className:"flex items-start gap-3 p-3 rounded-xl border shadow-sm ".concat("exhausted"===o.status?"bg-red-100 dark:bg-red-900/30 border-red-300 dark:border-red-700":"bg-green-100 dark:bg-green-900/30 border-green-300 dark:border-green-700"),children:["exhausted"===o.status?(0,a.jsx)(s5.Z,{className:"h-4 w-4 text-red-600 dark:text-red-400 mt-0.5 flex-shrink-0"}):(0,a.jsx)(s6.Z,{className:"h-4 w-4 text-green-600 dark:text-green-400 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("span",{className:"text-sm leading-relaxed font-medium ".concat("exhausted"===o.status?"text-red-800 dark:text-red-200":"text-green-800 dark:text-green-200"),children:["Usage limit: ",s.usedCount," / ",s.usageLimit]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-3 p-3 rounded-xl border shadow-sm ".concat("Active"===d.text?"bg-green-100 dark:bg-green-900/30 border-green-300 dark:border-green-700":"bg-yellow-100 dark:bg-yellow-900/30 border-yellow-300 dark:border-yellow-700"),children:["Active"===d.text?(0,a.jsx)(s6.Z,{className:"h-4 w-4 text-green-600 dark:text-green-400 mt-0.5 flex-shrink-0"}):(0,a.jsx)(ti.Z,{className:"h-4 w-4 text-yellow-600 dark:text-yellow-400 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("span",{className:"text-sm leading-relaxed font-medium ".concat("Active"===d.text?"text-green-800 dark:text-green-200":"text-yellow-800 dark:text-yellow-200"),children:["Valid from ",n(s.startDate)," to ",n(s.endDate)]})]})]})]})]})}function s9(){let[e,t]=(0,r.useState)([]),[s,n]=(0,r.useState)(!0),[l,i]=(0,r.useState)(""),[c,d]=(0,r.useState)(""),[o,m]=(0,r.useState)(""),[u,p]=(0,r.useState)(1),[g,b]=(0,r.useState)(1),[w,C]=(0,r.useState)(null),[S,D]=(0,r.useState)(!1),[k,P]=(0,r.useState)(!1),[I,T]=(0,r.useState)(null),[E,F]=(0,r.useState)(!1),[z,O]=(0,r.useState)(null),Z=async()=>{try{n(!0);let e=await eB.apiClient.getDiscounts({page:u,limit:10,search:l,targetType:c,isActive:""!==o?o:void 0});t(e.discounts),b(e.totalPages)}catch(e){console.error("Error fetching discounts:",e)}finally{n(!1)}};(0,r.useEffect)(()=>{Z()},[u,l,c,o]);let _=async t=>{let s=e.find(e=>e._id===t);s&&(O(s),F(!0))},L=async()=>{if(z)try{await eB.apiClient.toggleDiscountStatus(z._id),await Z(),F(!1),O(null)}catch(e){console.error("Error toggling discount status:",e)}},R=async e=>{if(confirm("Are you sure you want to delete this discount?"))try{await eB.apiClient.deleteDiscount(e),await Z()}catch(e){console.error("Error deleting discount:",e)}},B=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e),U=e=>new Date(e).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"}),M=(e,t,s)=>{switch(e){case"all":return"All Products";case"category":return"Category: ".concat(t);case"product":return"Product: ".concat((null==s?void 0:s.name)||"Unknown");default:return e}},q=(e,t)=>"percentage"===e?"".concat(t,"%"):B(t),V=e=>{let t=new Date,s=new Date(e.startDate),a=new Date(e.endDate);return e.isActive&&t>=s&&t<=a};return(0,a.jsxs)("div",{className:"space-y-6 max-w-7xl mx-auto p-4",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold tracking-tight",children:"Discount Management"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Create and manage discounts for products, categories, or all items"})]}),(0,a.jsxs)(eD,{open:S,onOpenChange:D,children:[(0,a.jsx)(ek,{asChild:!0,children:(0,a.jsxs)(x,{onClick:()=>T(null),className:"w-full sm:w-auto",children:[(0,a.jsx)(eO.Z,{className:"mr-2 h-4 w-4"}),"New Discount"]})}),(0,a.jsxs)(eI,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)(eT,{children:[(0,a.jsx)(eF,{children:I?"Edit Discount":"Create New Discount"}),(0,a.jsx)(ez,{children:I?"Update the discount details below.":"Create a new discount for your products."})]}),(0,a.jsx)(s3,{discount:I,onSuccess:()=>{D(!1),T(null),Z()},onCancel:()=>{D(!1),T(null)}})]})]})]}),(0,a.jsxs)(j,{children:[(0,a.jsx)(f,{children:(0,a.jsxs)(v,{className:"flex items-center gap-2",children:[(0,a.jsx)(t5.Z,{className:"h-5 w-5"}),"Filters"]})}),(0,a.jsx)(N,{children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(eZ.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),(0,a.jsx)(h,{placeholder:"Search discounts...",value:l,onChange:e=>i(e.target.value),className:"pl-10"})]}),(0,a.jsxs)(ei,{value:c,onValueChange:d,children:[(0,a.jsx)(ed,{children:(0,a.jsx)(ec,{placeholder:"Filter by target type"})}),(0,a.jsxs)(eo,{children:[(0,a.jsx)(em,{value:"all-targets",children:"All Target Types"}),(0,a.jsx)(em,{value:"all",children:"All Products"}),(0,a.jsx)(em,{value:"category",children:"Category"}),(0,a.jsx)(em,{value:"product",children:"Specific Product"})]})]}),(0,a.jsxs)(ei,{value:o,onValueChange:m,children:[(0,a.jsx)(ed,{children:(0,a.jsx)(ec,{placeholder:"Filter by status"})}),(0,a.jsxs)(eo,{children:[(0,a.jsx)(em,{value:"all-status",children:"All Status"}),(0,a.jsx)(em,{value:"true",children:"Active"}),(0,a.jsx)(em,{value:"false",children:"Inactive"})]})]})]})})]}),(0,a.jsxs)(j,{children:[(0,a.jsxs)(f,{children:[(0,a.jsx)(v,{children:"Discounts"}),(0,a.jsx)(y,{children:"Manage your product discounts and promotions"})]}),(0,a.jsx)(N,{children:s?(0,a.jsx)("div",{className:"text-center py-8",children:"Loading discounts..."}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(e1,{children:[(0,a.jsx)(e2,{children:(0,a.jsxs)(e3,{children:[(0,a.jsx)(e5,{children:"Name"}),(0,a.jsx)(e5,{children:"Type"}),(0,a.jsx)(e5,{children:"Target"}),(0,a.jsx)(e5,{children:"Duration"}),(0,a.jsx)(e5,{children:"Usage"}),(0,a.jsx)(e5,{children:"Status"}),(0,a.jsx)(e5,{className:"text-right",children:"Actions"})]})}),(0,a.jsx)(e4,{children:0===e.length?(0,a.jsx)(e3,{children:(0,a.jsx)(e6,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No discounts found. Create your first discount to get started."})}):e.map(e=>(0,a.jsxs)(e3,{className:"hover:bg-muted/50",children:[(0,a.jsx)(e6,{children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e.name}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:e.description})]})}),(0,a.jsx)(e6,{children:(0,a.jsx)(A,{variant:"outline",children:q(e.type,e.value)})}),(0,a.jsx)(e6,{children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(t2.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("span",{className:"text-sm",children:M(e.targetType,e.targetCategory,e.targetProduct)})]})}),(0,a.jsx)(e6,{children:(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("div",{children:U(e.startDate)}),(0,a.jsxs)("div",{className:"text-muted-foreground",children:["to ",U(e.endDate)]})]})}),(0,a.jsx)(e6,{children:(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsxs)("div",{children:[e.usedCount||0," of ",e.usageLimit||"∞"]}),(0,a.jsx)("div",{className:"text-muted-foreground",children:e.usageLimit?"".concat(Math.round((e.usedCount||0)/e.usageLimit*100),"% used"):"No limit"})]})}),(0,a.jsx)(e6,{children:(0,a.jsx)(A,{variant:V(e)?"default":"secondary",children:V(e)?"Active":"Inactive"})}),(0,a.jsx)(e6,{className:"text-right",children:(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(x,{variant:"ghost",size:"sm",onClick:()=>{C(e),P(!0)},children:(0,a.jsx)(Q.Z,{className:"h-4 w-4"})}),(0,a.jsx)(x,{variant:"ghost",size:"sm",onClick:()=>{T(e),D(!0)},children:(0,a.jsx)(e_.Z,{className:"h-4 w-4"})}),(0,a.jsx)(x,{variant:"ghost",size:"sm",onClick:()=>_(e._id),children:e.isActive?(0,a.jsx)(sq.Z,{className:"h-4 w-4"}):(0,a.jsx)(sV.Z,{className:"h-4 w-4"})}),(0,a.jsx)(x,{variant:"ghost",size:"sm",onClick:()=>R(e._id),children:(0,a.jsx)(eL.Z,{className:"h-4 w-4"})})]})})]},e._id))})]})}),g>1&&(0,a.jsxs)("div",{className:"flex justify-between items-center mt-4",children:[(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Page ",u," of ",g]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(x,{variant:"outline",size:"sm",onClick:()=>p(e=>Math.max(1,e-1)),disabled:1===u,children:"Previous"}),(0,a.jsx)(x,{variant:"outline",size:"sm",onClick:()=>p(e=>Math.min(g,e+1)),disabled:u===g,children:"Next"})]})]})]})})]}),(0,a.jsx)(eD,{open:k,onOpenChange:P,children:(0,a.jsxs)(eI,{className:"max-w-2xl",children:[(0,a.jsx)(eT,{children:(0,a.jsx)(eF,{children:"Discount Details"})}),w&&(0,a.jsx)(s8,{discount:w})]})}),(0,a.jsx)(eD,{open:E,onOpenChange:F,children:(0,a.jsxs)(eI,{className:"max-w-md",children:[(0,a.jsxs)(eT,{children:[(0,a.jsxs)(eF,{className:"flex items-center gap-2",children:[(0,a.jsx)(ti.Z,{className:"h-5 w-5 text-amber-500"}),"Confirm Status Change"]}),(0,a.jsxs)(ez,{children:["Are you sure you want to change discount from",(0,a.jsx)("span",{className:"font-semibold",children:(null==z?void 0:z.isActive)?" active ":" inactive "})," to",(0,a.jsx)("span",{className:"font-semibold",children:(null==z?void 0:z.isActive)?" inactive ":" active "}),"?"]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3 mt-4",children:[(0,a.jsx)(x,{variant:"outline",onClick:()=>{F(!1),O(null)},children:"Cancel"}),(0,a.jsx)(x,{onClick:L,children:"Confirm"})]})]})})]})}var s7=s(17689),ae=s(83229),at=s(64413),as=s(12805);function aa(){let[e,t]=(0,r.useState)({storeName:"Supermarket Billing System",storeAddress:"",storePhone:"",storeEmail:"",gstNumber:"",currency:"INR",taxRate:18,enablePrint:!0,theme:"system"}),[s,n]=(0,r.useState)(!1),[l,i]=(0,r.useState)(!1),[c,d]=(0,r.useState)("");(0,r.useEffect)(()=>{o()},[]);let o=async()=>{try{n(!0);let e=localStorage.getItem("systemSettings");if(e){let s=JSON.parse(e);t(e=>({...e,...s}))}d("")}catch(e){console.error("Failed to load settings:",e),d("Failed to load settings")}finally{n(!1)}},m=async()=>{try{i(!0),localStorage.setItem("systemSettings",JSON.stringify(e)),p(e.theme),d("Settings saved successfully!"),setTimeout(()=>d(""),3e3)}catch(e){console.error("Failed to save settings:",e),d("Failed to save settings")}finally{i(!1)}},u=(e,s)=>{t(t=>({...t,[e]:s})),"theme"===e&&p(s)},p=e=>{let t=document.documentElement;"dark"===e?t.classList.add("dark"):"light"===e?t.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches?t.classList.add("dark"):t.classList.remove("dark")};return s?(0,a.jsxs)("div",{className:"flex items-center justify-center p-8",children:[(0,a.jsx)(eK.Z,{className:"h-6 w-6 animate-spin mr-2"}),"Loading settings..."]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"System Settings"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Configure your supermarket billing system preferences"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(x,{variant:"outline",onClick:()=>{try{let t=JSON.stringify(e,null,2),s=new Blob([t],{type:"application/json"}),a=URL.createObjectURL(s),r=document.createElement("a");r.href=a,r.download="supermarket-settings-".concat(new Date().toISOString().split("T")[0],".json"),document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(a),d("Settings exported successfully!"),setTimeout(()=>d(""),3e3)}catch(e){d("Failed to export settings")}},children:[(0,a.jsx)(td.Z,{className:"mr-2 h-4 w-4"}),"Export"]}),(0,a.jsx)("label",{htmlFor:"import-settings",children:(0,a.jsx)(x,{variant:"outline",asChild:!0,children:(0,a.jsxs)("span",{children:[(0,a.jsx)(s7.Z,{className:"mr-2 h-4 w-4"}),"Import"]})})}),(0,a.jsx)("input",{id:"import-settings",type:"file",accept:".json",className:"hidden",onChange:e=>{var s;let a=null===(s=e.target.files)||void 0===s?void 0:s[0];if(!a)return;let r=new FileReader;r.onload=e=>{try{var s;let a=JSON.parse(null===(s=e.target)||void 0===s?void 0:s.result);t(e=>({...e,...a})),d("Settings imported successfully!"),setTimeout(()=>d(""),3e3)}catch(e){d("Failed to import settings: Invalid file format")}},r.readAsText(a),e.target.value=""}}),(0,a.jsxs)(x,{variant:"outline",onClick:()=>{confirm("Are you sure you want to reset all settings to defaults?")&&(localStorage.removeItem("systemSettings"),o(),d("Settings reset to defaults!"),setTimeout(()=>d(""),3e3))},children:[(0,a.jsx)(eK.Z,{className:"mr-2 h-4 w-4 ".concat(s?"animate-spin":"")}),"Reset"]}),(0,a.jsxs)(x,{onClick:m,disabled:l,children:[(0,a.jsx)(ae.Z,{className:"mr-2 h-4 w-4"}),l?"Saving...":"Save Changes"]})]})]}),c&&(0,a.jsx)(w,{className:c.includes("success")?"border-green-200 bg-green-50":"border-red-200 bg-red-50",children:(0,a.jsx)(C,{children:c})}),(0,a.jsxs)(tq,{defaultValue:"store",className:"space-y-6",children:[(0,a.jsxs)(tV,{className:"grid w-full grid-cols-2",children:[(0,a.jsx)(tJ,{value:"store",children:"Store"}),(0,a.jsx)(tJ,{value:"appearance",children:"Appearance"})]}),(0,a.jsx)(tG,{value:"store",className:"space-y-6",children:(0,a.jsx)("div",{className:"grid grid-cols-1 gap-6",children:(0,a.jsxs)(j,{children:[(0,a.jsxs)(f,{children:[(0,a.jsxs)(v,{className:"flex items-center gap-2",children:[(0,a.jsx)(at.Z,{className:"h-5 w-5"}),"Store Information"]}),(0,a.jsx)(y,{children:"Basic information about your store"})]}),(0,a.jsxs)(N,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"storeName",children:"Store Name"}),(0,a.jsx)(h,{id:"storeName",value:e.storeName,onChange:e=>u("storeName",e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"storeAddress",children:"Address"}),(0,a.jsx)(h,{id:"storeAddress",value:e.storeAddress,onChange:e=>u("storeAddress",e.target.value)})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"storePhone",children:"Phone"}),(0,a.jsx)(h,{id:"storePhone",value:e.storePhone,onChange:e=>u("storePhone",e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"storeEmail",children:"Email"}),(0,a.jsx)(h,{id:"storeEmail",type:"email",value:e.storeEmail,onChange:e=>u("storeEmail",e.target.value)})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"gstNumber",children:"GST Number"}),(0,a.jsx)(h,{id:"gstNumber",value:e.gstNumber,onChange:e=>u("gstNumber",e.target.value)})]})]})]})})}),(0,a.jsx)(tG,{value:"appearance",className:"space-y-6",children:(0,a.jsx)("div",{className:"grid grid-cols-1 gap-6",children:(0,a.jsxs)(j,{children:[(0,a.jsxs)(f,{children:[(0,a.jsxs)(v,{className:"flex items-center gap-2",children:[(0,a.jsx)(as.Z,{className:"h-5 w-5"}),"Theme Settings"]}),(0,a.jsx)(y,{children:"Customize the appearance of the application"})]}),(0,a.jsx)(N,{className:"space-y-4",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g,{htmlFor:"theme",children:"Theme"}),(0,a.jsxs)(ei,{value:e.theme,onValueChange:e=>u("theme",e),children:[(0,a.jsx)(ed,{children:(0,a.jsx)(ec,{})}),(0,a.jsxs)(eo,{children:[(0,a.jsx)(em,{value:"light",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(U.Z,{className:"h-4 w-4"}),"Light"]})}),(0,a.jsx)(em,{value:"dark",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(M.Z,{className:"h-4 w-4"}),"Dark"]})}),(0,a.jsx)(em,{value:"system",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(X.Z,{className:"h-4 w-4"}),"System"]})})]})]})]})})]})})})]})]})}var ar=s(70650);function an(e){let{className:t,...s}=e;return(0,a.jsx)(ar.fC,{"data-slot":"avatar",className:o("relative flex size-8 shrink-0 overflow-hidden rounded-full",t),...s})}function al(e){let{className:t,...s}=e;return(0,a.jsx)(ar.Ee,{"data-slot":"avatar-image",className:o("aspect-square size-full",t),...s})}function ai(e){let{className:t,...s}=e;return(0,a.jsx)(ar.NY,{"data-slot":"avatar-fallback",className:o("bg-muted flex size-full items-center justify-center rounded-full",t),...s})}var ac=s(53581),ad=s(54001),ao=s(60044);function am(){let{user:e}=(0,n.a)(),{toast:t}=tZ(),[s,l]=(0,r.useState)(null),[i,c]=(0,r.useState)(!0),[d,o]=(0,r.useState)(!1),[m,u]=(0,r.useState)(null),[x,h]=(0,r.useState)(!1),[p,g]=(0,r.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),[j,f]=(0,r.useState)(!1),[v,y]=(0,r.useState)("photo");(0,r.useEffect)(()=>{N()},[]);let N=async()=>{try{if(c(!0),(null==e?void 0:e.role)==="admin"){let t={_id:e.id,user:{_id:e.id,name:e.name,email:e.email,employeeId:"ADMIN",role:"admin",isActive:!0},personalDetails:{firstName:e.name.split(" ")[0]||"Admin",lastName:e.name.split(" ")[1]||"User",dateOfBirth:"",gender:"",bloodGroup:""},contactDetails:{phone:"",emergencyPhone:"",address:{street:"",city:"",state:"",postalCode:"",country:""}},identification:{aadhaarNumber:"",panNumber:""},employmentDetails:{department:"Administration",position:"Administrator",dateOfJoining:new Date().toISOString().split("T")[0],salary:0,bankAccount:{accountNumber:"",bankName:"",ifscCode:"",branchName:""}},status:"active",leaveBalance:{casual:0,sick:0,earned:0},createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};l(t),u(t)}else if(null==e?void 0:e.employeeId){let t=await eB.apiClient.get("/employees/".concat(e.employeeId));l(t),u(t)}else l(null),u(null)}catch(e){t({title:"Error",description:"Failed to fetch profile data",variant:"destructive"})}finally{c(!1)}},b=async()=>{if(m)try{if((null==e?void 0:e.role)==="admin")l(m),o(!1),t({title:"Success",description:"Admin profile updated successfully"});else if(null==e?void 0:e.employeeId){let s=await eB.apiClient.put("/employees/".concat(e.employeeId),m);l(s),o(!1),t({title:"Success",description:"Profile updated successfully"})}}catch(e){t({title:"Error",description:"Failed to update profile",variant:"destructive"})}},w=async()=>{if(p.newPassword!==p.confirmPassword){t({title:"Error",description:"New passwords do not match",variant:"destructive"});return}if(p.newPassword.length<6){t({title:"Error",description:"Password must be at least 6 characters long",variant:"destructive"});return}try{await eB.apiClient.put("/auth/change-password",{currentPassword:p.currentPassword,newPassword:p.newPassword}),t({title:"Success",description:"Password changed successfully"}),g({currentPassword:"",newPassword:"",confirmPassword:""}),h(!1)}catch(e){t({title:"Error",description:"Failed to change password",variant:"destructive"})}},C=async(s,a)=>{var r;let n=null===(r=s.target.files)||void 0===r?void 0:r[0];if(!n)return;f(!0);let i=new FormData;i.append("file",n),i.append("documentType",a);try{let s=await eB.apiClient.put("/employees/".concat(null==e?void 0:e.employeeId,"/upload-document"),i);l(s),u(s),t({title:"Success",description:"".concat(a," uploaded successfully")})}catch(e){t({title:"Error",description:"Failed to upload ".concat(a),variant:"destructive"})}finally{f(!1)}};return i?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Loading profile data..."})]})}):s?(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsx)(au,{profileData:s,editing:d,setEditing:o,handleSave:b,handleCancel:()=>{u(s),o(!1)},showPasswordDialog:x,setShowPasswordDialog:h,passwordData:p,setPasswordData:g,handlePasswordChange:w,activeDocumentTab:v,setActiveDocumentTab:y,editData:m,handleInputChange:(e,t,s)=>{m&&u(a=>{if(!a)return a;if("contactDetails"===e&&["street","city","state","postalCode","country"].includes(t))return{...a,contactDetails:{...a.contactDetails,address:{...a.contactDetails.address,[t]:s}}};let r=a[e];return{...a,[e]:{...r,[t]:s}}})},uploading:j,setUploading:f,handleFileUpload:C,getInitials:e=>e.split(" ").map(e=>e[0]).join("").toUpperCase(),calculateServicePeriod:()=>{if(!(null==s?void 0:s.employmentDetails.dateOfJoining))return"0 days";let e=new Date(s.employmentDetails.dateOfJoining),t=Math.ceil(Math.abs(new Date().getTime()-e.getTime())/864e5),a=Math.floor(t/365),r=Math.floor(t%365/30),n=t%30;return a>0?"".concat(a," year").concat(a>1?"s":""," ").concat(r," month").concat(r>1?"s":""):r>0?"".concat(r," month").concat(r>1?"s":""," ").concat(n," day").concat(n>1?"s":""):"".concat(n," day").concat(n>1?"s":"")}})}):(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-muted-foreground mb-2",children:"No profile data available"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Please contact your administrator"})]})})}function au(e){var t;let{profileData:s,editing:r,setEditing:n,handleSave:l,handleCancel:i,showPasswordDialog:c,setShowPasswordDialog:d,passwordData:o,setPasswordData:m,handlePasswordChange:u,activeDocumentTab:p,setActiveDocumentTab:b,editData:w,handleInputChange:C,uploading:S,setUploading:D,handleFileUpload:k,getInitials:P,calculateServicePeriod:I}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(j,{className:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-950/20 dark:to-indigo-950/20",children:(0,a.jsx)(N,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)(an,{className:"h-24 w-24",children:[(0,a.jsx)(al,{src:null===(t=s.identification.photo)||void 0===t?void 0:t.path,alt:s.user.name}),(0,a.jsx)(ai,{className:"text-lg",children:P(s.user.name)})]}),(0,a.jsx)(x,{size:"sm",className:"absolute -bottom-2 -right-2 h-8 w-8 rounded-full",onClick:()=>b("photo"),children:(0,a.jsx)(ac.Z,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:s.user.name}),(0,a.jsx)("p",{className:"text-muted-foreground",children:s.employmentDetails.position}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 mt-2",children:[(0,a.jsx)(A,{variant:"secondary",children:s.user.employeeId}),(0,a.jsx)(A,{variant:s.user.isActive?"default":"destructive",children:s.user.isActive?"Active":"Inactive"}),(0,a.jsx)(A,{variant:"outline",children:s.user.role})]})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsxs)(eD,{open:c,onOpenChange:d,children:[(0,a.jsx)(ek,{asChild:!0,children:(0,a.jsxs)(x,{variant:"outline",children:[(0,a.jsx)(ad.Z,{className:"mr-2 h-4 w-4"}),"Change Password"]})}),(0,a.jsxs)(eI,{children:[(0,a.jsxs)(eT,{children:[(0,a.jsx)(eF,{children:"Change Password"}),(0,a.jsx)(ez,{children:"Enter your current password and a new password to update your credentials."})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{htmlFor:"currentPassword",children:"Current Password"}),(0,a.jsx)(h,{id:"currentPassword",type:"password",value:o.currentPassword,onChange:e=>m(t=>({...t,currentPassword:e.target.value}))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{htmlFor:"newPassword",children:"New Password"}),(0,a.jsx)(h,{id:"newPassword",type:"password",value:o.newPassword,onChange:e=>m(t=>({...t,newPassword:e.target.value}))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{htmlFor:"confirmPassword",children:"Confirm New Password"}),(0,a.jsx)(h,{id:"confirmPassword",type:"password",value:o.confirmPassword,onChange:e=>m(t=>({...t,confirmPassword:e.target.value}))})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)(x,{variant:"outline",onClick:()=>d(!1),children:"Cancel"}),(0,a.jsx)(x,{onClick:u,children:"Change Password"})]})]})]})]}),r?(0,a.jsxs)("div",{className:"space-x-2",children:[(0,a.jsxs)(x,{onClick:l,children:[(0,a.jsx)(ae.Z,{className:"mr-2 h-4 w-4"}),"Save"]}),(0,a.jsxs)(x,{variant:"outline",onClick:i,children:[(0,a.jsx)(ee.Z,{className:"mr-2 h-4 w-4"}),"Cancel"]})]}):(0,a.jsxs)(x,{onClick:()=>n(!0),children:[(0,a.jsx)(e_.Z,{className:"mr-2 h-4 w-4"}),"Edit Profile"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mt-6",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(t8.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("span",{className:"text-sm",children:s.user.email})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(s_.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("span",{className:"text-sm",children:s.contactDetails.phone})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(ao.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("span",{className:"text-sm",children:s.employmentDetails.department})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(sB.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("span",{className:"text-sm",children:I()})]})]})]})]})})}),(0,a.jsxs)(tq,{defaultValue:"personal",className:"space-y-4",children:[(0,a.jsxs)(tV,{className:"grid w-full grid-cols-2",children:[(0,a.jsx)(tJ,{value:"personal",children:"Personal"}),(0,a.jsx)(tJ,{value:"contact",children:"Contact"})]}),(0,a.jsx)(tG,{value:"personal",children:(0,a.jsxs)(j,{children:[(0,a.jsx)(f,{children:(0,a.jsxs)(v,{className:"flex items-center",children:[(0,a.jsx)(L.Z,{className:"mr-2 h-5 w-5"}),"Personal Information"]})}),(0,a.jsxs)(N,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{htmlFor:"firstName",children:"First Name"}),r?(0,a.jsx)(h,{id:"firstName",value:(null==w?void 0:w.personalDetails.firstName)||"",onChange:e=>C("personalDetails","firstName",e.target.value)}):(0,a.jsx)("p",{className:"mt-1 text-sm font-medium",children:s.personalDetails.firstName})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{htmlFor:"lastName",children:"Last Name"}),r?(0,a.jsx)(h,{id:"lastName",value:(null==w?void 0:w.personalDetails.lastName)||"",onChange:e=>C("personalDetails","lastName",e.target.value)}):(0,a.jsx)("p",{className:"mt-1 text-sm font-medium",children:s.personalDetails.lastName})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{htmlFor:"dateOfBirth",children:"Date of Birth"}),r?(0,a.jsx)(h,{id:"dateOfBirth",type:"date",value:(null==w?void 0:w.personalDetails.dateOfBirth)||"",onChange:e=>C("personalDetails","dateOfBirth",e.target.value)}):(0,a.jsx)("p",{className:"mt-1 text-sm",children:new Date(s.personalDetails.dateOfBirth).toLocaleDateString()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{htmlFor:"gender",children:"Gender"}),r?(0,a.jsx)(h,{id:"gender",value:(null==w?void 0:w.personalDetails.gender)||"",onChange:e=>C("personalDetails","gender",e.target.value)}):(0,a.jsx)("p",{className:"mt-1 text-sm",children:s.personalDetails.gender})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{htmlFor:"bloodGroup",children:"Blood Group"}),r?(0,a.jsx)(h,{id:"bloodGroup",value:(null==w?void 0:w.personalDetails.bloodGroup)||"",onChange:e=>C("personalDetails","bloodGroup",e.target.value)}):(0,a.jsx)("p",{className:"mt-1 text-sm",children:s.personalDetails.bloodGroup||"Not specified"})]})]})]})}),(0,a.jsx)(tG,{value:"contact",children:(0,a.jsxs)(j,{children:[(0,a.jsx)(f,{children:(0,a.jsxs)(v,{className:"flex items-center",children:[(0,a.jsx)(s_.Z,{className:"mr-2 h-5 w-5"}),"Contact Details"]})}),(0,a.jsxs)(N,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{htmlFor:"phone",children:"Phone Number"}),r?(0,a.jsx)(h,{id:"phone",value:(null==w?void 0:w.contactDetails.phone)||"",onChange:e=>C("contactDetails","phone",e.target.value)}):(0,a.jsx)("p",{className:"mt-1 text-sm font-medium",children:s.contactDetails.phone})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{htmlFor:"emergencyPhone",children:"Emergency Phone"}),r?(0,a.jsx)(h,{id:"emergencyPhone",value:(null==w?void 0:w.contactDetails.emergencyPhone)||"",onChange:e=>C("contactDetails","emergencyPhone",e.target.value)}):(0,a.jsx)("p",{className:"mt-1 text-sm",children:s.contactDetails.emergencyPhone||"Not specified"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{htmlFor:"street",children:"Street Address"}),r?(0,a.jsx)(h,{id:"street",value:(null==w?void 0:w.contactDetails.address.street)||"",onChange:e=>C("contactDetails","street",e.target.value)}):(0,a.jsx)("p",{className:"mt-1 text-sm",children:s.contactDetails.address.street})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{htmlFor:"city",children:"City"}),r?(0,a.jsx)(h,{id:"city",value:(null==w?void 0:w.contactDetails.address.city)||"",onChange:e=>C("contactDetails","city",e.target.value)}):(0,a.jsx)("p",{className:"mt-1 text-sm",children:s.contactDetails.address.city})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{htmlFor:"state",children:"State"}),r?(0,a.jsx)(h,{id:"state",value:(null==w?void 0:w.contactDetails.address.state)||"",onChange:e=>C("contactDetails","state",e.target.value)}):(0,a.jsx)("p",{className:"mt-1 text-sm",children:s.contactDetails.address.state})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{htmlFor:"postalCode",children:"Postal Code"}),r?(0,a.jsx)(h,{id:"postalCode",value:(null==w?void 0:w.contactDetails.address.postalCode)||"",onChange:e=>C("contactDetails","postalCode",e.target.value)}):(0,a.jsx)("p",{className:"mt-1 text-sm",children:s.contactDetails.address.postalCode})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(g,{htmlFor:"country",children:"Country"}),r?(0,a.jsx)(h,{id:"country",value:(null==w?void 0:w.contactDetails.address.country)||"",onChange:e=>C("contactDetails","country",e.target.value)}):(0,a.jsx)("p",{className:"mt-1 text-sm",children:s.contactDetails.address.country})]})]})]})]})}),(0,a.jsx)(tG,{value:"settings",children:(0,a.jsxs)(j,{children:[(0,a.jsxs)(f,{children:[(0,a.jsxs)(v,{className:"flex items-center",children:[(0,a.jsx)(X.Z,{className:"mr-2 h-5 w-5"}),"Security Settings"]}),(0,a.jsx)(y,{children:"Manage your account security and password"})]}),(0,a.jsx)(N,{className:"space-y-4",children:(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-lg font-medium",children:"Change Password"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Update your password to keep your account secure"}),(0,a.jsxs)(x,{onClick:()=>d(!0),className:"w-full",children:[(0,a.jsx)(ad.Z,{className:"mr-2 h-4 w-4"}),"Change Password"]})]})})})]})})]})]})}function ax(e){let{isFullscreen:t=!1}=e;return(0,a.jsx)("div",{className:t?"h-full w-full":"p-6",children:(0,a.jsx)(tU,{})})}function ah(){return(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(eG,{})})}function ap(){return(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(se,{})})}function ag(){return(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(t4,{})})}function aj(){return(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(sz,{})})}function af(){return(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(sE,{})})}function av(){return(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(s9,{})})}function ay(){return(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(sM,{})})}function aN(){return(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(aa,{})})}function ab(){return(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(am,{})})}function aw(){let[e,t]=(0,r.useState)("billing"),[s,n]=(0,r.useState)(!0),{isFullscreen:l,showExitConfirmation:i,toggleFullscreen:c,exitFullscreen:d,setShowExitConfirmation:o}=function(){let[e,t]=(0,r.useState)(!1),[s,a]=(0,r.useState)(!1),n=(0,r.useCallback)(()=>!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement),[]),l=(0,r.useCallback)(async e=>{try{let s=e||document.documentElement;s.requestFullscreen?await s.requestFullscreen():s.webkitRequestFullscreen?await s.webkitRequestFullscreen():s.mozRequestFullScreen?await s.mozRequestFullScreen():s.msRequestFullscreen&&await s.msRequestFullscreen(),t(!0)}catch(e){console.error("Error entering fullscreen:",e)}},[]),i=(0,r.useCallback)(async()=>{try{document.exitFullscreen?await document.exitFullscreen():document.webkitExitFullscreen?await document.webkitExitFullscreen():document.mozCancelFullScreen?await document.mozCancelFullScreen():document.msExitFullscreen&&await document.msExitFullscreen(),t(!1),a(!1)}catch(e){console.error("Error exiting fullscreen:",e)}},[]),c=(0,r.useCallback)(async e=>{n()?a(!0):await l(e)},[n,l]),d=(0,r.useCallback)(()=>{t(n())},[n]),o=(0,r.useCallback)(t=>{"F11"===t.key?(t.preventDefault(),c()):"Escape"===t.key&&e&&(t.preventDefault(),a(!0))},[c,e]);return(0,r.useEffect)(()=>(document.addEventListener("fullscreenchange",d),document.addEventListener("webkitfullscreenchange",d),document.addEventListener("mozfullscreenchange",d),document.addEventListener("MSFullscreenChange",d),document.addEventListener("keydown",o),()=>{document.removeEventListener("fullscreenchange",d),document.removeEventListener("webkitfullscreenchange",d),document.removeEventListener("mozfullscreenchange",d),document.removeEventListener("MSFullscreenChange",d),document.removeEventListener("keydown",o)}),[d,o]),(0,r.useEffect)(()=>(e?(document.body.classList.add("fullscreen-mode"),document.body.style.overflow="hidden"):(document.body.classList.remove("fullscreen-mode"),document.body.style.overflow=""),()=>{document.body.classList.remove("fullscreen-mode"),document.body.style.overflow=""}),[e]),{isFullscreen:e,showExitConfirmation:s,enterFullscreen:l,exitFullscreen:i,toggleFullscreen:c,setShowExitConfirmation:a}}();return(0,a.jsxs)(k,{children:[(0,a.jsxs)("div",{className:"min-h-screen bg-background",children:[!l&&(0,a.jsx)(J,{onTabChange:t}),(0,a.jsxs)("div",{className:"flex",children:[!l&&(0,a.jsx)(es,{activeTab:e,onTabChange:t,isSidebarOpen:s,onSidebarToggle:n}),(0,a.jsx)("main",{className:"flex-1 ".concat(l?"w-screen h-screen":""),children:(()=>{switch(e){case"billing":return(0,a.jsx)(ax,{isFullscreen:l});case"products":return(0,a.jsx)(ah,{});case"inventory":return(0,a.jsx)(aj,{});case"bills":return(0,a.jsx)(ap,{});case"shifts":return(0,a.jsx)(ag,{});case"reports":return(0,a.jsx)(af,{});case"discounts":return(0,a.jsx)(av,{});case"users":return(0,a.jsx)(ay,{});case"settings":return(0,a.jsx)(aN,{});case"profile":return(0,a.jsx)(ab,{});default:return(0,a.jsx)(ax,{})}})()})]})]}),(0,a.jsx)(ep,{open:i,onOpenChange:o,children:(0,a.jsxs)(ef,{children:[(0,a.jsxs)(ev,{children:[(0,a.jsx)(eN,{children:"Exit Fullscreen Mode?"}),(0,a.jsx)(eb,{children:"Are you sure you want to exit fullscreen mode? You can press F11 to toggle fullscreen again at any time."})]}),(0,a.jsxs)(ey,{children:[(0,a.jsx)(eC,{children:"Cancel"}),(0,a.jsx)(ew,{onClick:d,children:"Exit Fullscreen"})]})]})})]})}},24880:function(e,t,s){"use strict";s.d(t,{LanguageProvider:function(){return i},Z:function(){return c}});var a=s(57437),r=s(2265);let n={en:{supermarket_store:"SUPERMARKET STORE",bill:"BILL",date:"DATE",cashier:"CASHIER",customer:"CUSTOMER",phone:"PHONE",email:"EMAIL",items:"ITEMS",subtotal:"SUBTOTAL",loyalty_discount:"LOYALTY DISCOUNT",total_tax:"TOTAL TAX",round_off:"ROUND OFF",total:"TOTAL",payment_method:"PAYMENT METHOD",cash_tendered:"CASH TENDERED",change:"CHANGE",thank_you:"THANK YOU FOR YOUR PURCHASE!",please_visit_again:"PLEASE VISIT AGAIN",paid:"*** PAID ***",walk_in_customer:"Walk-in Customer"},ta:{supermarket_store:"சூப்பர்மார்க்கெட் ஸ்டோர்",bill:"பில்",date:"தேதி",cashier:"பணம் வசூலிப்பவர்",customer:"வாடிக்கையாளர்",phone:"தொலைபேசி",email:"மின்னஞ்சல்",items:"பொருட்கள்",subtotal:"மொத்தம்",loyalty_discount:"விசுவாசத் தள்ளுபடி",total_tax:"மொத்த வரி",round_off:"சுற்றளவு",total:"மொத்தம்",payment_method:"கட்டண முறை",cash_tendered:"பணம் கொடுக்கப்பட்டது",change:"மாற்றுத் தொகை",thank_you:"உங்கள் கொள்முதலுக்கு நன்றி!",please_visit_again:"மீண்டும் வருகையிடுங்கள்",paid:"*** செலுத்தப்பட்டது ***",walk_in_customer:"நேரடி வாடிக்கையாளர்"},bilingual:{supermarket_store:"SUPERMARKET STORE",bill:"BILL",date:"DATE",cashier:"CASHIER",customer:"CUSTOMER",phone:"PHONE",email:"EMAIL",items:"ITEMS",subtotal:"SUBTOTAL",loyalty_discount:"LOYALTY DISCOUNT",total_tax:"TOTAL TAX",round_off:"ROUND OFF",total:"TOTAL",payment_method:"PAYMENT METHOD",cash_tendered:"CASH TENDERED",change:"CHANGE",thank_you:"THANK YOU FOR YOUR PURCHASE!",please_visit_again:"PLEASE VISIT AGAIN",paid:"*** PAID ***",walk_in_customer:"Walk-in Customer"}},l=(0,r.createContext)(void 0);function i(e){let{children:t}=e,[s,i]=(0,r.useState)("en");return(0,a.jsx)(l.Provider,{value:{language:s,setLanguage:i,t:e=>n[s][e]||e},children:t})}function c(){let e=(0,r.useContext)(l);if(void 0===e)throw Error("useLanguage must be used within a LanguageProvider");return e}},35410:function(e,t,s){"use strict";s.d(t,{AuthProvider:function(){return i},a:function(){return c}});var a=s(57437),r=s(2265),n=s(16023);let l=(0,r.createContext)(void 0);function i(e){let{children:t}=e,[s,i]=(0,r.useState)(null),[c,d]=(0,r.useState)(!0);(0,r.useEffect)(()=>{(async()=>{try{let e=await n.O.getCurrentUser();i(e)}catch(e){console.error("Auth initialization error:",e)}finally{d(!1)}})()},[]);let o={user:s,isLoading:c,isAuthenticated:!!s,login:async(e,t)=>{try{let{user:s}=await n.O.login({email:e,password:t});i(s)}catch(e){throw e}},logout:()=>{d(!0),n.O.logout(),i(null),setTimeout(()=>{d(!1)},100)},isAdmin:(null==s?void 0:s.role)==="admin",isCashier:(null==s?void 0:s.role)==="cashier"};return(0,a.jsx)(l.Provider,{value:o,children:t})}function c(){let e=(0,r.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},29116:function(e,t,s){"use strict";s.d(t,{apiClient:function(){return l},f:function(){return i},t:function(){return c}});var a=s(16023);let r="http://10.25.111.44:5001/api";class n{async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=a.O.getToken(),n="".concat(r).concat(e);console.log("\uD83C\uDF10 API Request:",{url:n,method:t.method||"GET",body:t.body,hasToken:!!s,tokenPreview:s?s.substring(0,20)+"...":"none"});let l={headers:{..."undefined"!=typeof FormData&&t.body instanceof FormData?{}:{"Content-Type":"application/json"},...s&&{Authorization:"Bearer ".concat(s)},...t.headers},...t},i=await fetch(n,l);if(!i.ok){let e=await i.json().catch(()=>({message:"Network error"}));throw console.error("❌ API Error:",{status:i.status,statusText:i.statusText,error:e,url:n,hasToken:!!s}),Error(e.message||"HTTP ".concat(i.status))}let c=await i.json();return console.log("✅ API Response:",c),c}async getProducts(e){let t=new URLSearchParams;(null==e?void 0:e.search)&&t.append("search",e.search),(null==e?void 0:e.category)&&t.append("category",e.category),(null==e?void 0:e.active)!==void 0&&t.append("active",e.active.toString());let s=t.toString();return this.request("/products".concat(s?"?".concat(s):""))}async getProductByIdentifier(e){return this.request("/products/search/".concat(e))}async createProduct(e){return this.request("/products",{method:"POST",body:JSON.stringify(e)})}async updateProduct(e,t){return this.request("/products/".concat(e),{method:"PUT",body:JSON.stringify(t)})}async deleteProduct(e){return this.request("/products/".concat(e),{method:"DELETE"})}async logVoiceMissingItem(e){try{return await this.request("/voice/missing-items",{method:"POST",body:JSON.stringify(e)})}catch(e){return console.warn("Voice missing item logging failed",e),null}}async createBill(e){let t=e.items.reduce((e,t)=>{let s=t.rate*t.quantity,a=0;t.discount&&(a=void 0!==t.discount.discountAmount?t.discount.discountAmount:"percentage"===t.discount.discountType?t.discount.discountValue/100*s:Math.min(t.discount.discountValue*t.quantity,s));let r=s-a,n=t.taxRate/100*r;return{subtotal:e.subtotal+r,totalDiscount:e.totalDiscount+a,totalTax:e.totalTax+n,grandTotal:e.grandTotal+(r+n)}},{subtotal:0,totalDiscount:0,totalTax:0,grandTotal:0}),s=a.O.getUser();if(!s)throw Error("Unauthorized: cashier info missing");let r={...e,cashier:s.id,subtotal:t.subtotal,totalDiscount:t.totalDiscount,totalTax:t.totalTax,grandTotal:t.grandTotal,cashTendered:e.cashTendered||t.grandTotal};return this.request("/bills",{method:"POST",body:JSON.stringify(r)})}async getBills(e){let t=new URLSearchParams;(null==e?void 0:e.page)&&t.append("page",e.page.toString()),(null==e?void 0:e.limit)&&t.append("limit",e.limit.toString()),(null==e?void 0:e.search)&&t.append("search",e.search),(null==e?void 0:e.startDate)&&t.append("startDate",e.startDate),(null==e?void 0:e.endDate)&&t.append("endDate",e.endDate),(null==e?void 0:e.cashier)&&t.append("cashier",e.cashier),(null==e?void 0:e.status)&&t.append("status",e.status);let s=t.toString();return this.request("/bills".concat(s?"?".concat(s):""))}async getBill(e){return this.request("/bills/".concat(e))}async deleteBill(e){return this.request("/bills/".concat(e),{method:"DELETE"})}async sendBillByEmail(e,t){return this.request("/bills/".concat(e,"/send-email"),{method:"POST",body:JSON.stringify({email:t})})}async sendBillViaWhatsApp(e,t){return this.request("/bills/".concat(e,"/whatsapp"),{method:"POST",body:JSON.stringify({phoneNumber:t})})}async getCustomerLoyaltyStatus(e){return this.request("/bills/customer/".concat(e,"/purchase-count"))}async generateBillPDF(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en";console.log("\uD83C\uDF10 API: Generating PDF for bill:",e,"with language:",t);let s=new URLSearchParams;s.append("language",t);let n="".concat(r,"/bills/").concat(e,"/pdf?").concat(s.toString());console.log("\uD83C\uDF10 API: Full URL:",n);let l=await fetch(n,{method:"GET",headers:{Authorization:"Bearer ".concat(a.O.getToken())}});if(!l.ok)throw Error((await l.json().catch(()=>({message:"Network error"}))).message||"HTTP ".concat(l.status));return await l.blob()}async startShift(e){return this.request("/shifts/start",{method:"POST",body:JSON.stringify({openingCash:e})})}async endShift(e,t){return this.request("/shifts/end",{method:"POST",body:JSON.stringify({closingCash:e,notes:t})})}async getCurrentShift(){return this.request("/shifts/current")}async getShifts(e){let t=new URLSearchParams;(null==e?void 0:e.page)&&t.append("page",e.page.toString()),(null==e?void 0:e.limit)&&t.append("limit",e.limit.toString()),(null==e?void 0:e.startDate)&&t.append("startDate",e.startDate),(null==e?void 0:e.endDate)&&t.append("endDate",e.endDate);let s=t.toString();return this.request("/shifts".concat(s?"?".concat(s):""))}async getActiveShifts(){return this.request("/shifts/active")}async getShiftSummary(e){let t=new URLSearchParams;(null==e?void 0:e.startDate)&&t.append("startDate",e.startDate),(null==e?void 0:e.endDate)&&t.append("endDate",e.endDate);let s=t.toString();return this.request("/shifts/summary".concat(s?"?".concat(s):""))}async forceEndShift(e,t,s){return this.request("/shifts/".concat(e,"/end"),{method:"POST",body:JSON.stringify({closingCash:t,notes:s})})}async getAvailableCashiers(){return this.request("/shifts/available-cashiers")}async getClientData(){return this.request("/client-data/me")}async updateClientData(e){return this.request("/client-data/me",{method:"PATCH",body:JSON.stringify(e)})}async submitClientData(e){return this.request("/client-data/me/submit",{method:"POST",body:JSON.stringify(null!=e?e:{})})}async uploadClientDataFile(e){return this.request("/client-data/upload",{method:"POST",body:e,headers:{}})}async listClientData(){return this.request("/client-data")}async updateClientDataStatus(e,t){return this.request("/client-data/".concat(e,"/status"),{method:"PATCH",body:JSON.stringify(t)})}async getEmployees(e){let t=new URLSearchParams;return(null==e?void 0:e.page)&&t.append("page",e.page.toString()),(null==e?void 0:e.limit)&&t.append("limit",e.limit.toString()),(null==e?void 0:e.search)&&t.append("search",e.search),(null==e?void 0:e.department)&&t.append("department",e.department),(null==e?void 0:e.status)&&t.append("status",e.status),(null==e?void 0:e.sortBy)&&t.append("sortBy",e.sortBy),(null==e?void 0:e.sortOrder)&&t.append("sortOrder",e.sortOrder),await this.request("/employees?".concat(t.toString()))}async getEmployee(e){return await this.request("/employees/".concat(e))}async createEmployee(e){return await this.request("/employees",{method:"POST",body:JSON.stringify(e)})}async updateEmployee(e,t){return await this.request("/employees/".concat(e),{method:"PUT",body:JSON.stringify(t)})}async deleteEmployee(e){return await this.request("/employees/".concat(e),{method:"DELETE"})}async getLeaves(e){let t=new URLSearchParams;(null==e?void 0:e.status)&&t.append("status",e.status),(null==e?void 0:e.employee)&&t.append("employee",e.employee);let s=t.toString();return this.request("/leaves".concat(s?"?".concat(s):""))}async getMyLeaves(){return this.request("/leaves/my-leaves")}async getLeaveById(e){return this.request("/leaves/".concat(e))}async createLeave(e){return this.request("/leaves",{method:"POST",body:e,headers:{}})}async approveLeave(e){return this.request("/leaves/".concat(e,"/approve"),{method:"PUT"})}async rejectLeave(e,t){return this.request("/leaves/".concat(e,"/reject"),{method:"PUT",body:JSON.stringify({rejectedReason:t})})}async cancelLeave(e){return this.request("/leaves/".concat(e,"/cancel"),{method:"PUT"})}async getSalesSummary(e){let t=new URLSearchParams;(null==e?void 0:e.startDate)&&t.append("startDate",e.startDate),(null==e?void 0:e.endDate)&&t.append("endDate",e.endDate),(null==e?void 0:e.period)&&t.append("period",e.period);let s=t.toString();return this.request("/reports/sales-summary".concat(s?"?".concat(s):""))}async getTopProducts(e){let t=new URLSearchParams;(null==e?void 0:e.startDate)&&t.append("startDate",e.startDate),(null==e?void 0:e.endDate)&&t.append("endDate",e.endDate),(null==e?void 0:e.limit)&&t.append("limit",e.limit.toString());let s=t.toString();return this.request("/reports/top-products".concat(s?"?".concat(s):""))}async getCashierPerformance(e){let t=new URLSearchParams;(null==e?void 0:e.startDate)&&t.append("startDate",e.startDate),(null==e?void 0:e.endDate)&&t.append("endDate",e.endDate);let s=t.toString();return this.request("/reports/cashier-performance".concat(s?"?".concat(s):""))}async getInventoryReport(e){let t=new URLSearchParams;(null==e?void 0:e.category)&&t.append("category",e.category),(null==e?void 0:e.lowStock)!==void 0&&t.append("lowStock",e.lowStock.toString());let s=t.toString();return this.request("/reports/inventory".concat(s?"?".concat(s):""))}async getPaymentMethodsReport(e){let t=new URLSearchParams;(null==e?void 0:e.startDate)&&t.append("startDate",e.startDate),(null==e?void 0:e.endDate)&&t.append("endDate",e.endDate);let s=t.toString();return this.request("/reports/payment-methods".concat(s?"?".concat(s):""))}async getCategoriesPerformance(e){let t=new URLSearchParams;(null==e?void 0:e.startDate)&&t.append("startDate",e.startDate),(null==e?void 0:e.endDate)&&t.append("endDate",e.endDate);let s=t.toString();return this.request("/reports/categories-performance".concat(s?"?".concat(s):""))}async getTopProductsByCategory(e){let t=new URLSearchParams;(null==e?void 0:e.startDate)&&t.append("startDate",e.startDate),(null==e?void 0:e.endDate)&&t.append("endDate",e.endDate),(null==e?void 0:e.limit)&&t.append("limit",e.limit.toString());let s=t.toString();return this.request("/reports/top-products-by-category".concat(s?"?".concat(s):""))}async sendLowStockEmail(){return this.request("/reports/send-low-stock-email",{method:"POST"})}async getDiscounts(e){let t=new URLSearchParams;return(null==e?void 0:e.page)&&t.append("page",e.page.toString()),(null==e?void 0:e.limit)&&t.append("limit",e.limit.toString()),(null==e?void 0:e.search)&&t.append("search",e.search),(null==e?void 0:e.targetType)&&t.append("targetType",e.targetType),(null==e?void 0:e.isActive)!==void 0&&t.append("isActive",e.isActive),(null==e?void 0:e.sortBy)&&t.append("sortBy",e.sortBy),(null==e?void 0:e.sortOrder)&&t.append("sortOrder",e.sortOrder),await this.request("/discounts?".concat(t.toString()))}async getDiscount(e){return await this.request("/discounts/".concat(e))}async createDiscount(e){return await this.request("/discounts",{method:"POST",body:JSON.stringify(e)})}async updateDiscount(e,t){return await this.request("/discounts/".concat(e),{method:"PUT",body:JSON.stringify(t)})}async deleteDiscount(e){return await this.request("/discounts/".concat(e),{method:"DELETE"})}async getApplicableDiscounts(e){console.log("\uD83C\uDF10 API: Getting applicable discounts for product:",e);let t=await this.request("/discounts/applicable/".concat(e));return console.log("\uD83C\uDF10 API: Response from applicable discounts:",t),t}async getBestDiscount(e,t){let s=new URLSearchParams;return t&&s.append("quantity",t.toString()),await this.request("/discounts/best/".concat(e,"?").concat(s.toString()))}async getDiscountStats(){return await this.request("/discounts/stats/overview")}async toggleDiscountStatus(e){return await this.request("/discounts/".concat(e,"/toggle"),{method:"PATCH"})}async createPaymentOrder(e){return(await this.request("/payments/create-order",{method:"POST",body:JSON.stringify(e)})).data}async verifyPayment(e){return this.request("/payments/verify",{method:"POST",body:JSON.stringify(e)})}async get(e){return await this.request(e)}async put(e,t){return await this.request(e,{method:"PUT",body:JSON.stringify(t)})}}let l=new n,i=async(e,t)=>l.sendBillByEmail(e,t),c=async(e,t)=>l.sendBillViaWhatsApp(e,t)},16023:function(e,t,s){"use strict";s.d(t,{O:function(){return n}});let a="http://10.25.111.44:5001/api";class r{static getInstance(){return r.instance||(r.instance=new r),r.instance}async login(e){try{let t=await fetch("".concat(a,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){let e=await t.json();throw Error(e.message||"Login failed")}let s=await t.json();return this.token=s.token,this.user=s.user,localStorage.setItem("pos_token",s.token),localStorage.setItem("pos_user",JSON.stringify(s.user)),s}catch(e){throw e}}async getCurrentUser(){if(!this.token)return null;try{let e=await fetch("".concat(a,"/auth/me"),{headers:{Authorization:"Bearer ".concat(this.token)}});if(!e.ok)return this.clearAuth(),null;let t=await e.json();return this.user=t,localStorage.setItem("pos_user",JSON.stringify(t)),t}catch(e){return console.error("Error fetching current user:",e),this.clearAuth(),null}}logout(){this.clearAuth()}clearAuth(){this.token=null,this.user=null,localStorage.removeItem("pos_token"),localStorage.removeItem("pos_user")}getToken(){return this.token}getUser(){return this.user}isAuthenticated(){return!!this.token&&!!this.user}isAdmin(){var e;return(null===(e=this.user)||void 0===e?void 0:e.role)==="admin"}isCashier(){var e;return(null===(e=this.user)||void 0===e?void 0:e.role)==="cashier"}constructor(){this.token=null,this.user=null;{this.token=localStorage.getItem("pos_token");let e=localStorage.getItem("pos_user");if(e)try{this.user=JSON.parse(e)}catch(e){console.error("Error parsing user data:",e),this.clearAuth()}}}}let n=r.getInstance()}},function(e){e.O(0,[212,971,117,744],function(){return e(e.s=70812)}),_N_E=e.O()}]);